{"data":{"allMdx":{"edges":[{"node":{"fields":{"slug":"/"},"frontmatter":{"order":1,"title":"Overview","summary":null,"demo":null,"tags":null},"headings":[{"value":"Cloudflare Firewall Rules"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Cloudflare Firewall Rules","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":28,"offset":28},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":28,"offset":28},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules allow users to create rules that inspect incoming traffic and block, challenge, log, or allow specific requests.","position":{"start":{"line":4,"column":1,"offset":30},"end":{"line":4,"column":128,"offset":157},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":30},"end":{"line":4,"column":128,"offset":157},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Main features","position":{"start":{"line":6,"column":4,"offset":162},"end":{"line":6,"column":17,"offset":175},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":159},"end":{"line":6,"column":17,"offset":175},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Rule-based protection","position":{"start":{"line":8,"column":5,"offset":181},"end":{"line":8,"column":26,"offset":202},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":179},"end":{"line":8,"column":28,"offset":204},"indent":[]}},{"type":"text","value":": Use pre-defined rulesets provided by Cloudflare, or define your own Firewall Rules, including rules that perform rate limiting. Create rules in the Cloudflare dashboard or via API.","position":{"start":{"line":8,"column":28,"offset":204},"end":{"line":8,"column":210,"offset":386},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":179},"end":{"line":8,"column":210,"offset":386},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":177},"end":{"line":8,"column":210,"offset":386},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Complex custom rules","position":{"start":{"line":9,"column":5,"offset":391},"end":{"line":9,"column":25,"offset":411},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":389},"end":{"line":9,"column":27,"offset":413},"indent":[]}},{"type":"text","value":": Each rule's expression can reference multiple fields from all the available HTTP request parameters and fields, allowing you to create complex rules.","position":{"start":{"line":9,"column":27,"offset":413},"end":{"line":9,"column":178,"offset":564},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":389},"end":{"line":9,"column":178,"offset":564},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":387},"end":{"line":9,"column":178,"offset":564},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":177},"end":{"line":9,"column":178,"offset":564},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Availability","position":{"start":{"line":11,"column":4,"offset":569},"end":{"line":11,"column":16,"offset":581},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":566},"end":{"line":11,"column":16,"offset":581},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules are available to customers on all Cloudflare plans.","position":{"start":{"line":13,"column":1,"offset":583},"end":{"line":13,"column":67,"offset":649},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":583},"end":{"line":13,"column":67,"offset":649},"indent":[]}},{"type":"thematicBreak","position":{"start":{"line":15,"column":1,"offset":651},"end":{"line":15,"column":4,"offset":654},"indent":[]}},{"type":"html","value":"<ButtonGroup>\n  <Button type=\"primary\" href=\"/cf-dashboard\">Manage rules</Button>\n  <Button type=\"secondary\" href=\"/cf-firewall-rules\">Learn more</Button>\n</ButtonGroup>","position":{"start":{"line":17,"column":1,"offset":656},"end":{"line":20,"column":15,"offset":825},"indent":[1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":23,"column":89,"offset":916}}}}},{"node":{"fields":{"slug":"/recipes/block-ms-exchange-autodiscover"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Block Microsoft Exchange Autodiscover requests"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Block Microsoft Exchange Autodiscover requests","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":49,"offset":49},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":49,"offset":49},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In some cases, Microsoft Exchange Autodiscover service requests can be “noisy,” triggering large numbers of HTTP 404 (Page Not Found) errors.","position":{"start":{"line":4,"column":1,"offset":51},"end":{"line":4,"column":142,"offset":192},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":51},"end":{"line":4,"column":142,"offset":192},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example uses the ","position":{"start":{"line":6,"column":1,"offset":194},"end":{"line":6,"column":23,"offset":216},"indent":[]}},{"type":"inlineCode","value":"matches","position":{"start":{"line":6,"column":23,"offset":216},"end":{"line":6,"column":32,"offset":225},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":6,"column":32,"offset":225},"end":{"line":6,"column":33,"offset":226},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":6,"column":34,"offset":227},"end":{"line":6,"column":53,"offset":246},"indent":[]}}],"position":{"start":{"line":6,"column":33,"offset":226},"end":{"line":6,"column":151,"offset":344},"indent":[]}},{"type":"text","value":" and a regular expression to block ","position":{"start":{"line":6,"column":151,"offset":344},"end":{"line":6,"column":186,"offset":379},"indent":[]}},{"type":"inlineCode","value":"autodiscover.xml","position":{"start":{"line":6,"column":186,"offset":379},"end":{"line":6,"column":204,"offset":397},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":6,"column":204,"offset":397},"end":{"line":6,"column":209,"offset":402},"indent":[]}},{"type":"inlineCode","value":"autodiscover.src","position":{"start":{"line":6,"column":209,"offset":402},"end":{"line":6,"column":227,"offset":420},"indent":[]}},{"type":"text","value":" requests:","position":{"start":{"line":6,"column":227,"offset":420},"end":{"line":6,"column":237,"offset":430},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":194},"end":{"line":6,"column":237,"offset":430},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>http.request.uri.path matches \"/autodiscover.(xml|src)$\"</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":8,"column":1,"offset":432},"end":{"line":21,"column":9,"offset":683},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":24,"column":65,"offset":750}}}}},{"node":{"fields":{"slug":"/recipes/block-ip-reputation"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Block requests based on IP reputation"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Block requests based on IP reputation","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":40,"offset":40},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":40,"offset":40},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A powerful feature of Firewall Rules is its support for Cloudflare’s IP reputation score. To block requests based on IP reputation, use the ","position":{"start":{"line":4,"column":1,"offset":42},"end":{"line":4,"column":141,"offset":182},"indent":[]}},{"type":"inlineCode","value":"cf.threat_score","position":{"start":{"line":4,"column":141,"offset":182},"end":{"line":4,"column":158,"offset":199},"indent":[]}},{"type":"text","value":" field, which can contain a score from 0 to 100. Reputation scores are collected from ","position":{"start":{"line":4,"column":158,"offset":199},"end":{"line":4,"column":244,"offset":285},"indent":[]}},{"type":"link","title":null,"url":"https://www.projecthoneypot.org/","children":[{"type":"text","value":"Project Honeypot","position":{"start":{"line":4,"column":245,"offset":286},"end":{"line":4,"column":261,"offset":302},"indent":[]}}],"position":{"start":{"line":4,"column":244,"offset":285},"end":{"line":4,"column":296,"offset":337},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":4,"column":296,"offset":337},"end":{"line":4,"column":297,"offset":338},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":42},"end":{"line":4,"column":297,"offset":338},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example blocks requests from IP addresses that score greater than 0. This is equivalent to setting the Security Level in the Firewall app ","position":{"start":{"line":6,"column":1,"offset":340},"end":{"line":6,"column":144,"offset":483},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Settings","position":{"start":{"line":6,"column":146,"offset":485},"end":{"line":6,"column":154,"offset":493},"indent":[]}}],"position":{"start":{"line":6,"column":144,"offset":483},"end":{"line":6,"column":156,"offset":495},"indent":[]}},{"type":"text","value":" panel to ","position":{"start":{"line":6,"column":156,"offset":495},"end":{"line":6,"column":166,"offset":505},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"High","position":{"start":{"line":6,"column":167,"offset":506},"end":{"line":6,"column":171,"offset":510},"indent":[]}}],"position":{"start":{"line":6,"column":166,"offset":505},"end":{"line":6,"column":172,"offset":511},"indent":[]}},{"type":"text","value":". For more, refer to ","position":{"start":{"line":6,"column":172,"offset":511},"end":{"line":6,"column":193,"offset":532},"indent":[]}},{"type":"link","title":null,"url":"https://support.cloudflare.com/hc/en-us/articles/200170056-Understanding-the-Cloudflare-Security-Level","children":[{"type":"text","value":"Understanding the Cloudflare Security Level","position":{"start":{"line":6,"column":194,"offset":533},"end":{"line":6,"column":237,"offset":576},"indent":[]}}],"position":{"start":{"line":6,"column":193,"offset":532},"end":{"line":6,"column":342,"offset":681},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":342,"offset":681},"end":{"line":6,"column":343,"offset":682},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":340},"end":{"line":6,"column":343,"offset":682},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example also blocks requests based on country code (","position":{"start":{"line":8,"column":1,"offset":684},"end":{"line":8,"column":58,"offset":741},"indent":[]}},{"type":"link","title":null,"url":"https://www.iso.org/obp/ui/#search/code/","children":[{"type":"text","value":"ISO 3166-1 Alpha 2","position":{"start":{"line":8,"column":59,"offset":742},"end":{"line":8,"column":77,"offset":760},"indent":[]}}],"position":{"start":{"line":8,"column":58,"offset":741},"end":{"line":8,"column":120,"offset":803},"indent":[]}},{"type":"text","value":" format):","position":{"start":{"line":8,"column":120,"offset":803},"end":{"line":8,"column":129,"offset":812},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":684},"end":{"line":8,"column":129,"offset":812},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(ip.geoip.country in {'{'}\"CN\" \"TW\" \"US\" \"GB\"{'}'}) or cf.threat_score > 0</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":10,"column":1,"offset":814},"end":{"line":23,"column":9,"offset":1083},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":26,"column":65,"offset":1150}}}}},{"node":{"fields":{"slug":"/recipes/exempt-partners-hotlink-protection"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Exempt partners from Hotlink Protection"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Exempt partners from Hotlink Protection","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":42,"offset":42},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":42,"offset":42},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":4,"column":1,"offset":44},"end":{"line":4,"column":34,"offset":77},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you use this technique, disable Hotlink Protection within the ","position":{"start":{"line":6,"column":1,"offset":79},"end":{"line":6,"column":66,"offset":144},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Scrape Shield","position":{"start":{"line":6,"column":68,"offset":146},"end":{"line":6,"column":81,"offset":159},"indent":[]}}],"position":{"start":{"line":6,"column":66,"offset":144},"end":{"line":6,"column":83,"offset":161},"indent":[]}},{"type":"text","value":" app so that partner referrals are not blocked by that feature.","position":{"start":{"line":6,"column":83,"offset":161},"end":{"line":6,"column":146,"offset":224},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":79},"end":{"line":6,"column":146,"offset":224},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":8,"column":1,"offset":226},"end":{"line":8,"column":9,"offset":234},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When enabled, Cloudflare Hotlink Protection blocks all HTTP referrers that are not part of your domain or zone. That presents a problem if you allow partners to use inline links to your assets.","position":{"start":{"line":10,"column":1,"offset":236},"end":{"line":10,"column":194,"offset":429},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":236},"end":{"line":10,"column":194,"offset":429},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"However, with Firewall Rules you can maintain hotlink protection while allowing inline links from your partners.","position":{"start":{"line":12,"column":1,"offset":431},"end":{"line":12,"column":113,"offset":543},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":431},"end":{"line":12,"column":113,"offset":543},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example uses the ","position":{"start":{"line":14,"column":1,"offset":545},"end":{"line":14,"column":23,"offset":567},"indent":[]}},{"type":"inlineCode","value":"http.referer","position":{"start":{"line":14,"column":23,"offset":567},"end":{"line":14,"column":37,"offset":581},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":14,"column":37,"offset":581},"end":{"line":14,"column":38,"offset":582},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields#standard-fields","children":[{"type":"text","value":"field","position":{"start":{"line":14,"column":39,"offset":583},"end":{"line":14,"column":44,"offset":588},"indent":[]}}],"position":{"start":{"line":14,"column":38,"offset":582},"end":{"line":14,"column":133,"offset":677},"indent":[]}},{"type":"text","value":" to target HTTP referrals from partner sites.","position":{"start":{"line":14,"column":133,"offset":677},"end":{"line":14,"column":178,"offset":722},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":545},"end":{"line":14,"column":178,"offset":722},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":16,"column":1,"offset":724},"end":{"line":16,"column":5,"offset":728},"indent":[]}},{"type":"inlineCode","value":"not","position":{"start":{"line":16,"column":5,"offset":728},"end":{"line":16,"column":10,"offset":733},"indent":[]}},{"type":"text","value":" operator matches HTTP referrals that are not from partner sites, and the action blocks them:","position":{"start":{"line":16,"column":10,"offset":733},"end":{"line":16,"column":103,"offset":826},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":724},"end":{"line":16,"column":103,"offset":826},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>not (http.referer contains \"example.com\" or http.referer eq \"www.example.net\" or http.referer eq \"www.cloudflare.com\")</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":18,"column":1,"offset":828},"end":{"line":31,"column":9,"offset":1141},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":34,"column":65,"offset":1208}}}}},{"node":{"fields":{"slug":"/recipes/challenge-bad-bots"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Challenge bad bots"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Challenge bad bots","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":21,"offset":21},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":42,"offset":64},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to ","position":{"start":{"line":6,"column":1,"offset":66},"end":{"line":6,"column":11,"offset":76},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/get-started/bm-subscription","children":[{"type":"text","value":"Bot Management","position":{"start":{"line":6,"column":12,"offset":77},"end":{"line":6,"column":26,"offset":91},"indent":[]}}],"position":{"start":{"line":6,"column":11,"offset":76},"end":{"line":6,"column":95,"offset":160},"indent":[]}},{"type":"text","value":" requires a Cloudflare Enterprise plan with Bot Management enabled.","position":{"start":{"line":6,"column":95,"offset":160},"end":{"line":6,"column":162,"offset":227},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":66},"end":{"line":6,"column":162,"offset":227},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":8,"column":1,"offset":229},"end":{"line":8,"column":9,"offset":237},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare’s Bot Management feature scores the likelihood that a request originates from a bot.","position":{"start":{"line":10,"column":1,"offset":239},"end":{"line":10,"column":96,"offset":334},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":239},"end":{"line":10,"column":96,"offset":334},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Scores range from 1 through 99. Low scores indicate the request comes from a script, API service, or an automated agent. High scores indicate that a human issued the request from a standard desktop or mobile web browser.","position":{"start":{"line":12,"column":1,"offset":336},"end":{"line":12,"column":221,"offset":556},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":336},"end":{"line":12,"column":221,"offset":556},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"These examples use:","position":{"start":{"line":14,"column":1,"offset":558},"end":{"line":14,"column":20,"offset":577},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":558},"end":{"line":14,"column":20,"offset":577},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"cf.bot_management.score","position":{"start":{"line":15,"column":3,"offset":580},"end":{"line":15,"column":28,"offset":605},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":15,"column":28,"offset":605},"end":{"line":15,"column":29,"offset":606},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#dynamic-fields","children":[{"type":"text","value":"dynamic field","position":{"start":{"line":15,"column":30,"offset":607},"end":{"line":15,"column":43,"offset":620},"indent":[]}}],"position":{"start":{"line":15,"column":29,"offset":606},"end":{"line":15,"column":132,"offset":709},"indent":[]}},{"type":"text","value":" to target requests from bots","position":{"start":{"line":15,"column":132,"offset":709},"end":{"line":15,"column":161,"offset":738},"indent":[]}}],"position":{"start":{"line":15,"column":3,"offset":580},"end":{"line":15,"column":161,"offset":738},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":578},"end":{"line":15,"column":161,"offset":738},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"cf.bot_management.verified_bot","position":{"start":{"line":16,"column":3,"offset":741},"end":{"line":16,"column":35,"offset":773},"indent":[]}},{"type":"text","value":" to identify requests from ","position":{"start":{"line":16,"column":35,"offset":773},"end":{"line":16,"column":62,"offset":800},"indent":[]}},{"type":"link","title":null,"url":"/known-issues-and-faq#bots-currently-detected","children":[{"type":"text","value":"known good bots","position":{"start":{"line":16,"column":63,"offset":801},"end":{"line":16,"column":78,"offset":816},"indent":[]}}],"position":{"start":{"line":16,"column":62,"offset":800},"end":{"line":16,"column":126,"offset":864},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":741},"end":{"line":16,"column":126,"offset":864},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":739},"end":{"line":16,"column":126,"offset":864},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"cf.bot_management.ja3_hash","position":{"start":{"line":17,"column":3,"offset":867},"end":{"line":17,"column":31,"offset":895},"indent":[]}},{"type":"text","value":" to target specific ","position":{"start":{"line":17,"column":31,"offset":895},"end":{"line":17,"column":51,"offset":915},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/concepts/ja3-fingerprint","children":[{"type":"text","value":"JA3 Fingerprints","position":{"start":{"line":17,"column":52,"offset":916},"end":{"line":17,"column":68,"offset":932},"indent":[]}}],"position":{"start":{"line":17,"column":51,"offset":915},"end":{"line":17,"column":134,"offset":998},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":867},"end":{"line":17,"column":134,"offset":998},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":865},"end":{"line":17,"column":134,"offset":998},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":578},"end":{"line":17,"column":134,"offset":998},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Suggested rules","position":{"start":{"line":19,"column":4,"offset":1003},"end":{"line":19,"column":19,"offset":1018},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":1000},"end":{"line":19,"column":19,"offset":1018},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For best results:","position":{"start":{"line":21,"column":1,"offset":1020},"end":{"line":21,"column":18,"offset":1037},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":1020},"end":{"line":21,"column":18,"offset":1037},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":22,"column":3,"offset":1040},"end":{"line":22,"column":7,"offset":1044},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/get-started/bm-subscription#enable-bot-management-for-enterprise","children":[{"type":"text","value":"Bot Analytics","position":{"start":{"line":22,"column":8,"offset":1045},"end":{"line":22,"column":21,"offset":1058},"indent":[]}}],"position":{"start":{"line":22,"column":7,"offset":1044},"end":{"line":22,"column":127,"offset":1164},"indent":[]}},{"type":"text","value":" to learn about your traffic before applying rules","position":{"start":{"line":22,"column":127,"offset":1164},"end":{"line":22,"column":177,"offset":1214},"indent":[]}}],"position":{"start":{"line":22,"column":3,"offset":1040},"end":{"line":22,"column":177,"offset":1214},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1038},"end":{"line":22,"column":177,"offset":1214},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Start small and increase your bot threshold over time","position":{"start":{"line":23,"column":3,"offset":1217},"end":{"line":23,"column":56,"offset":1270},"indent":[]}}],"position":{"start":{"line":23,"column":3,"offset":1217},"end":{"line":23,"column":56,"offset":1270},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1215},"end":{"line":23,"column":56,"offset":1270},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1038},"end":{"line":23,"column":56,"offset":1270},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Your rules may also vary based on the ","position":{"start":{"line":25,"column":1,"offset":1272},"end":{"line":25,"column":39,"offset":1310},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/get-started/bm-subscription#5-create-additional-firewall-rules","children":[{"type":"text","value":"nature of your site","position":{"start":{"line":25,"column":40,"offset":1311},"end":{"line":25,"column":59,"offset":1330},"indent":[]}}],"position":{"start":{"line":25,"column":39,"offset":1310},"end":{"line":25,"column":163,"offset":1434},"indent":[]}},{"type":"text","value":" and your tolerance for false positives.","position":{"start":{"line":25,"column":163,"offset":1434},"end":{"line":25,"column":203,"offset":1474},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1272},"end":{"line":25,"column":203,"offset":1474},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Protect browser endpoints","position":{"start":{"line":27,"column":5,"offset":1480},"end":{"line":27,"column":30,"offset":1505},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":1476},"end":{"line":27,"column":30,"offset":1505},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When a request is definitely automated (score of 1) or likely automated (scores 2 through 29) and is ","position":{"start":{"line":29,"column":1,"offset":1507},"end":{"line":29,"column":102,"offset":1608},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"not","position":{"start":{"line":29,"column":103,"offset":1609},"end":{"line":29,"column":106,"offset":1612},"indent":[]}}],"position":{"start":{"line":29,"column":102,"offset":1608},"end":{"line":29,"column":107,"offset":1613},"indent":[]}},{"type":"text","value":" on the list of known good bots, Cloudflare ","position":{"start":{"line":29,"column":107,"offset":1613},"end":{"line":29,"column":151,"offset":1657},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"blocks","position":{"start":{"line":29,"column":153,"offset":1659},"end":{"line":29,"column":159,"offset":1665},"indent":[]}}],"position":{"start":{"line":29,"column":151,"offset":1657},"end":{"line":29,"column":161,"offset":1667},"indent":[]}},{"type":"text","value":" the request.","position":{"start":{"line":29,"column":161,"offset":1667},"end":{"line":29,"column":174,"offset":1680},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1507},"end":{"line":29,"column":174,"offset":1680},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(cf.bot_management.score lt 30) and not (cf.bot_management.verified_bot)</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":31,"column":1,"offset":1682},"end":{"line":44,"column":9,"offset":2006},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Exempt API traffic","position":{"start":{"line":46,"column":5,"offset":2012},"end":{"line":46,"column":23,"offset":2030},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2008},"end":{"line":46,"column":23,"offset":2030},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Since Bot Management detects automated users, you need to explicitly allow your ","position":{"start":{"line":48,"column":1,"offset":2032},"end":{"line":48,"column":81,"offset":2112},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"good","position":{"start":{"line":48,"column":83,"offset":2114},"end":{"line":48,"column":87,"offset":2118},"indent":[]}}],"position":{"start":{"line":48,"column":81,"offset":2112},"end":{"line":48,"column":89,"offset":2120},"indent":[]}},{"type":"text","value":" automated traffic⁠ — this includes your APIs and partner APIs.","position":{"start":{"line":48,"column":89,"offset":2120},"end":{"line":48,"column":152,"offset":2183},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2032},"end":{"line":48,"column":152,"offset":2183},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example offers the same protection as the browser-only rule, but allows automated traffic to your API.","position":{"start":{"line":50,"column":1,"offset":2185},"end":{"line":50,"column":108,"offset":2292},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2185},"end":{"line":50,"column":108,"offset":2292},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(cf.bot_management.score lt 30) and not (cf.bot_management.verified_bot) and not (http.request.uri.path contains \"/api\")</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":52,"column":1,"offset":2294},"end":{"line":65,"column":9,"offset":2666},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Adjust for mobile traffic","position":{"start":{"line":68,"column":5,"offset":2673},"end":{"line":68,"column":30,"offset":2698},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":2669},"end":{"line":68,"column":30,"offset":2698},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Since Bot Management can be more sensitive to mobile traffic, you may want to add in additional logic to avoid blocking legitimate requests.","position":{"start":{"line":70,"column":1,"offset":2700},"end":{"line":70,"column":141,"offset":2840},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":2700},"end":{"line":70,"column":141,"offset":2840},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you are handling requests from your own mobile application, you could potentially allow it based on its specific ","position":{"start":{"line":72,"column":1,"offset":2842},"end":{"line":72,"column":117,"offset":2958},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/concepts/ja3-fingerprint","children":[{"type":"text","value":"JA3 fingerprint","position":{"start":{"line":72,"column":118,"offset":2959},"end":{"line":72,"column":133,"offset":2974},"indent":[]}}],"position":{"start":{"line":72,"column":117,"offset":2958},"end":{"line":72,"column":199,"offset":3040},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":72,"column":199,"offset":3040},"end":{"line":72,"column":200,"offset":3041},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":2842},"end":{"line":72,"column":200,"offset":3041},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n  <tr>\n      <td><code>(cf.bot_management.ja3_hash eq df669e7ea913f1ac0c0cce9a201a2ec1)</code></td>\n      <td><em>Allow</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":74,"column":1,"offset":3043},"end":{"line":87,"column":9,"offset":3357},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Otherwise, you could set lower thresholds for mobile traffic. The following rules would block definitely automated mobile traffic and challenge likely automated traffic.","position":{"start":{"line":89,"column":1,"offset":3359},"end":{"line":89,"column":170,"offset":3528},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":3359},"end":{"line":89,"column":170,"offset":3528},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(cf.bot_management.score lt 2) and (http.user_agent contains \"App_Name 2.0\")</code></td>\n      <td><em>Block</em></td>\n    </tr>\n    <tr>\n      <td><code>(cf.bot_management.score lt 30) and (http.user_agent contains \"App_Name 2.0\")</code></td>\n      <td><em>Challenge</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":91,"column":1,"offset":3530},"end":{"line":108,"column":9,"offset":4017},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Layer rules","position":{"start":{"line":110,"column":5,"offset":4023},"end":{"line":110,"column":16,"offset":4034},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":4019},"end":{"line":110,"column":16,"offset":4034},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If your domain saw mobile, browser, and API traffic, you would want to arrange these example rules in the following order:","position":{"start":{"line":112,"column":1,"offset":4036},"end":{"line":112,"column":123,"offset":4158},"indent":[]}}],"position":{"start":{"line":112,"column":1,"offset":4036},"end":{"line":112,"column":123,"offset":4158},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"API","position":{"start":{"line":113,"column":3,"offset":4161},"end":{"line":113,"column":6,"offset":4164},"indent":[]}}],"position":{"start":{"line":113,"column":3,"offset":4161},"end":{"line":113,"column":6,"offset":4164},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":4159},"end":{"line":113,"column":6,"offset":4164},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Mobile:","position":{"start":{"line":114,"column":3,"offset":4167},"end":{"line":114,"column":10,"offset":4174},"indent":[]}}],"position":{"start":{"line":114,"column":3,"offset":4167},"end":{"line":114,"column":10,"offset":4174},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If consistent JA3 fingerprint, set ","position":{"start":{"line":115,"column":5,"offset":4179},"end":{"line":115,"column":40,"offset":4214},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Allow","position":{"start":{"line":115,"column":41,"offset":4215},"end":{"line":115,"column":46,"offset":4220},"indent":[]}}],"position":{"start":{"line":115,"column":40,"offset":4214},"end":{"line":115,"column":47,"offset":4221},"indent":[]}},{"type":"text","value":" rule.","position":{"start":{"line":115,"column":47,"offset":4221},"end":{"line":115,"column":53,"offset":4227},"indent":[]}}],"position":{"start":{"line":115,"column":5,"offset":4179},"end":{"line":115,"column":53,"offset":4227},"indent":[]}}],"position":{"start":{"line":115,"column":3,"offset":4177},"end":{"line":115,"column":53,"offset":4227},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If not, put the ","position":{"start":{"line":116,"column":5,"offset":4232},"end":{"line":116,"column":21,"offset":4248},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":116,"column":22,"offset":4249},"end":{"line":116,"column":27,"offset":4254},"indent":[]}}],"position":{"start":{"line":116,"column":21,"offset":4248},"end":{"line":116,"column":28,"offset":4255},"indent":[]}},{"type":"text","value":" rule first and then the ","position":{"start":{"line":116,"column":28,"offset":4255},"end":{"line":116,"column":53,"offset":4280},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Challenge","position":{"start":{"line":116,"column":54,"offset":4281},"end":{"line":116,"column":63,"offset":4290},"indent":[]}}],"position":{"start":{"line":116,"column":53,"offset":4280},"end":{"line":116,"column":64,"offset":4291},"indent":[]}},{"type":"text","value":" rule.","position":{"start":{"line":116,"column":64,"offset":4291},"end":{"line":116,"column":70,"offset":4297},"indent":[]}}],"position":{"start":{"line":116,"column":5,"offset":4232},"end":{"line":116,"column":70,"offset":4297},"indent":[]}}],"position":{"start":{"line":116,"column":3,"offset":4230},"end":{"line":116,"column":70,"offset":4297},"indent":[]}}],"position":{"start":{"line":115,"column":3,"offset":4177},"end":{"line":116,"column":70,"offset":4297},"indent":[3]}}],"position":{"start":{"line":114,"column":1,"offset":4165},"end":{"line":116,"column":70,"offset":4297},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Browser - Block","position":{"start":{"line":117,"column":3,"offset":4300},"end":{"line":117,"column":18,"offset":4315},"indent":[]}}],"position":{"start":{"line":117,"column":3,"offset":4300},"end":{"line":117,"column":18,"offset":4315},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":4298},"end":{"line":117,"column":18,"offset":4315},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":4159},"end":{"line":117,"column":18,"offset":4315},"indent":[1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Static resource protection","position":{"start":{"line":119,"column":5,"offset":4321},"end":{"line":119,"column":31,"offset":4347},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":4317},"end":{"line":119,"column":31,"offset":4347},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Static resources are protected by default when you create ","position":{"start":{"line":121,"column":1,"offset":4349},"end":{"line":121,"column":59,"offset":4407},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":121,"column":61,"offset":4409},"end":{"line":121,"column":75,"offset":4423},"indent":[]}}],"position":{"start":{"line":121,"column":59,"offset":4407},"end":{"line":121,"column":77,"offset":4425},"indent":[]}},{"type":"text","value":" using ","position":{"start":{"line":121,"column":77,"offset":4425},"end":{"line":121,"column":84,"offset":4432},"indent":[]}},{"type":"inlineCode","value":"cf.bot_management.score","position":{"start":{"line":121,"column":84,"offset":4432},"end":{"line":121,"column":109,"offset":4457},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":121,"column":109,"offset":4457},"end":{"line":121,"column":110,"offset":4458},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":4349},"end":{"line":121,"column":110,"offset":4458},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To exclude static resources, include ","position":{"start":{"line":123,"column":1,"offset":4460},"end":{"line":123,"column":38,"offset":4497},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":123,"column":38,"offset":4497},"end":{"line":123,"column":63,"offset":4522},"indent":[]}},{"type":"text","value":"not (cf.botManagement.staticResource)","position":{"start":{"line":123,"column":63,"offset":4522},"end":{"line":123,"column":100,"offset":4559},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":123,"column":100,"offset":4559},"end":{"line":123,"column":107,"offset":4566},"indent":[]}},{"type":"text","value":" as part of your Firewall Rule. For more details, refer to ","position":{"start":{"line":123,"column":107,"offset":4566},"end":{"line":123,"column":166,"offset":4625},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/about/static-resources","children":[{"type":"text","value":"Static resource protection","position":{"start":{"line":123,"column":167,"offset":4626},"end":{"line":123,"column":193,"offset":4652},"indent":[]}}],"position":{"start":{"line":123,"column":166,"offset":4625},"end":{"line":123,"column":257,"offset":4716},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":123,"column":257,"offset":4716},"end":{"line":123,"column":258,"offset":4717},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":4460},"end":{"line":123,"column":258,"offset":4717},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Additional considerations","position":{"start":{"line":125,"column":5,"offset":4723},"end":{"line":125,"column":30,"offset":4748},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":4719},"end":{"line":125,"column":30,"offset":4748},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"From there, you could customize your Firewall Rules based on specific request paths (","position":{"start":{"line":127,"column":1,"offset":4750},"end":{"line":127,"column":86,"offset":4835},"indent":[]}},{"type":"inlineCode","value":"/login","position":{"start":{"line":127,"column":86,"offset":4835},"end":{"line":127,"column":94,"offset":4843},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":127,"column":94,"offset":4843},"end":{"line":127,"column":98,"offset":4847},"indent":[]}},{"type":"inlineCode","value":"/signup","position":{"start":{"line":127,"column":98,"offset":4847},"end":{"line":127,"column":107,"offset":4856},"indent":[]}},{"type":"text","value":"), common traffic patterns, or many other characteristics.","position":{"start":{"line":127,"column":107,"offset":4856},"end":{"line":127,"column":165,"offset":4914},"indent":[]}}],"position":{"start":{"line":127,"column":1,"offset":4750},"end":{"line":127,"column":165,"offset":4914},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Just make sure to set aside time to review ","position":{"start":{"line":129,"column":1,"offset":4916},"end":{"line":129,"column":44,"offset":4959},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/bot-analytics/bm-subscription","children":[{"type":"text","value":"Bot Analytics","position":{"start":{"line":129,"column":45,"offset":4960},"end":{"line":129,"column":58,"offset":4973},"indent":[]}}],"position":{"start":{"line":129,"column":44,"offset":4959},"end":{"line":129,"column":129,"offset":5044},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":129,"column":129,"offset":5044},"end":{"line":129,"column":134,"offset":5049},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/waf/analytics","children":[{"type":"text","value":"Firewall Events","position":{"start":{"line":129,"column":135,"offset":5050},"end":{"line":129,"column":150,"offset":5065},"indent":[]}}],"position":{"start":{"line":129,"column":134,"offset":5049},"end":{"line":129,"column":200,"offset":5115},"indent":[]}},{"type":"text","value":" to check if your rules need additional tuning.","position":{"start":{"line":129,"column":200,"offset":5115},"end":{"line":129,"column":247,"offset":5162},"indent":[]}}],"position":{"start":{"line":129,"column":1,"offset":4916},"end":{"line":129,"column":247,"offset":5162},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":131,"column":65,"offset":5228}}}}},{"node":{"fields":{"slug":"/recipes"},"frontmatter":{"order":500,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Common use cases"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Common use cases","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":19,"offset":19},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":19,"offset":19},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The following common use cases illustrate how to secure web traffic to your sites and applications with Firewall Rules:","position":{"start":{"line":4,"column":1,"offset":21},"end":{"line":4,"column":120,"offset":140},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":21},"end":{"line":4,"column":120,"offset":140},"indent":[]}},{"type":"html","value":"<DirectoryListing path=\"/recipes\"/>","position":{"start":{"line":6,"column":1,"offset":142},"end":{"line":6,"column":36,"offset":177},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":9,"column":74,"offset":253}}}}},{"node":{"fields":{"slug":"/recipes/require-specific-cookie"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Require a specific cookie"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Require a specific cookie","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":28,"offset":28},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":28,"offset":28},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To secure a sensitive area such as a development area, you can share a cookie with trusted individuals and then filter requests so that only users with that cookie can access your site.","position":{"start":{"line":4,"column":1,"offset":30},"end":{"line":4,"column":186,"offset":215},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":30},"end":{"line":4,"column":186,"offset":215},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":6,"column":1,"offset":217},"end":{"line":6,"column":5,"offset":221},"indent":[]}},{"type":"inlineCode","value":"http.cookie","position":{"start":{"line":6,"column":5,"offset":221},"end":{"line":6,"column":18,"offset":234},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":6,"column":18,"offset":234},"end":{"line":6,"column":19,"offset":235},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields#standard-fields","children":[{"type":"text","value":"field","position":{"start":{"line":6,"column":20,"offset":236},"end":{"line":6,"column":25,"offset":241},"indent":[]}}],"position":{"start":{"line":6,"column":19,"offset":235},"end":{"line":6,"column":114,"offset":330},"indent":[]}},{"type":"text","value":" to target requests based on the presence of a specific cookie.","position":{"start":{"line":6,"column":114,"offset":330},"end":{"line":6,"column":177,"offset":393},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":217},"end":{"line":6,"column":177,"offset":393},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example comprises two rules:","position":{"start":{"line":8,"column":1,"offset":395},"end":{"line":8,"column":34,"offset":428},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":395},"end":{"line":8,"column":34,"offset":428},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The first rule targets requests to dev.www.foo that have a specific cookie key, ","position":{"start":{"line":10,"column":3,"offset":432},"end":{"line":10,"column":83,"offset":512},"indent":[]}},{"type":"inlineCode","value":"devaccess","position":{"start":{"line":10,"column":83,"offset":512},"end":{"line":10,"column":94,"offset":523},"indent":[]}},{"type":"text","value":". As long as the value of the cookie key contains one of three authorized users, ","position":{"start":{"line":10,"column":94,"offset":523},"end":{"line":10,"column":175,"offset":604},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"james","position":{"start":{"line":10,"column":176,"offset":605},"end":{"line":10,"column":181,"offset":610},"indent":[]}}],"position":{"start":{"line":10,"column":175,"offset":604},"end":{"line":10,"column":182,"offset":611},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":10,"column":182,"offset":611},"end":{"line":10,"column":184,"offset":613},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"matt","position":{"start":{"line":10,"column":185,"offset":614},"end":{"line":10,"column":189,"offset":618},"indent":[]}}],"position":{"start":{"line":10,"column":184,"offset":613},"end":{"line":10,"column":190,"offset":619},"indent":[]}},{"type":"text","value":", or ","position":{"start":{"line":10,"column":190,"offset":619},"end":{"line":10,"column":195,"offset":624},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"michael","position":{"start":{"line":10,"column":196,"offset":625},"end":{"line":10,"column":203,"offset":632},"indent":[]}}],"position":{"start":{"line":10,"column":195,"offset":624},"end":{"line":10,"column":204,"offset":633},"indent":[]}},{"type":"text","value":", the expression matches and the request is allowed.","position":{"start":{"line":10,"column":204,"offset":633},"end":{"line":10,"column":256,"offset":685},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":432},"end":{"line":10,"column":256,"offset":685},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":430},"end":{"line":10,"column":256,"offset":685},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The second rule blocks all access to ","position":{"start":{"line":11,"column":3,"offset":688},"end":{"line":11,"column":40,"offset":725},"indent":[]}},{"type":"inlineCode","value":"dev.www.example.com","position":{"start":{"line":11,"column":40,"offset":725},"end":{"line":11,"column":61,"offset":746},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":11,"column":61,"offset":746},"end":{"line":11,"column":62,"offset":747},"indent":[]}}],"position":{"start":{"line":11,"column":3,"offset":688},"end":{"line":11,"column":62,"offset":747},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":686},"end":{"line":11,"column":62,"offset":747},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":430},"end":{"line":11,"column":62,"offset":747},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Since the ","position":{"start":{"line":13,"column":1,"offset":749},"end":{"line":13,"column":11,"offset":759},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Allow","position":{"start":{"line":13,"column":12,"offset":760},"end":{"line":13,"column":17,"offset":765},"indent":[]}}],"position":{"start":{"line":13,"column":11,"offset":759},"end":{"line":13,"column":18,"offset":766},"indent":[]}},{"type":"text","value":" action has precedence over ","position":{"start":{"line":13,"column":18,"offset":766},"end":{"line":13,"column":46,"offset":794},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":13,"column":47,"offset":795},"end":{"line":13,"column":52,"offset":800},"indent":[]}}],"position":{"start":{"line":13,"column":46,"offset":794},"end":{"line":13,"column":53,"offset":801},"indent":[]}},{"type":"text","value":", Cloudflare grants access to requests that satisfy Rule 1 and blocks all other requests to ","position":{"start":{"line":13,"column":53,"offset":801},"end":{"line":13,"column":145,"offset":893},"indent":[]}},{"type":"inlineCode","value":"dev.www.example.com","position":{"start":{"line":13,"column":145,"offset":893},"end":{"line":13,"column":166,"offset":914},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":13,"column":166,"offset":914},"end":{"line":13,"column":167,"offset":915},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":749},"end":{"line":13,"column":167,"offset":915},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Execution order</th>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>1</td>\n      <td><code>(http.cookie contains \"devaccess=james\" or http.cookie contains \"devaccess=matt\" or http.cookie contains \"devaccess=michael\") and http.host eq \"dev.www.example.com\")</code></td>\n      <td><em>Allow</em></td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td><code>http.host eq \"dev.www.example.com\"</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":15,"column":1,"offset":917},"end":{"line":35,"column":9,"offset":1452},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":38,"column":65,"offset":1519}}}}},{"node":{"fields":{"slug":"/recipes/require-valid-client-certificate"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Require a valid client certificate"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Require a valid client certificate","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":37,"offset":37},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":37,"offset":37},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use Cloudflare ","position":{"start":{"line":4,"column":1,"offset":39},"end":{"line":4,"column":16,"offset":54},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-rules/api-shield","children":[{"type":"text","value":"API Shield™","position":{"start":{"line":4,"column":17,"offset":55},"end":{"line":4,"column":28,"offset":66},"indent":[]}}],"position":{"start":{"line":4,"column":16,"offset":54},"end":{"line":4,"column":102,"offset":140},"indent":[]}},{"type":"text","value":" to protect your API or web application with client-certificate-based encryption.","position":{"start":{"line":4,"column":102,"offset":140},"end":{"line":4,"column":183,"offset":221},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":39},"end":{"line":4,"column":183,"offset":221},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Before you can use API Shield to protect your API or web application, you must do the following:","position":{"start":{"line":6,"column":1,"offset":223},"end":{"line":6,"column":97,"offset":319},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":223},"end":{"line":6,"column":97,"offset":319},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/ssl/client-certificates/create-a-client-certificate","children":[{"type":"text","value":"Create a client certificate","position":{"start":{"line":8,"column":4,"offset":324},"end":{"line":8,"column":31,"offset":351},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":323},"end":{"line":8,"column":119,"offset":439},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":8,"column":119,"offset":439},"end":{"line":8,"column":120,"offset":440},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":323},"end":{"line":8,"column":120,"offset":440},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":321},"end":{"line":8,"column":120,"offset":440},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/ssl/client-certificates/configure-your-mobile-app-or-iot-device","children":[{"type":"text","value":"Configure your mobile app or Internet-of-things device","position":{"start":{"line":9,"column":4,"offset":444},"end":{"line":9,"column":58,"offset":498},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":443},"end":{"line":9,"column":158,"offset":598},"indent":[]}},{"type":"text","value":" to use the client certificate.","position":{"start":{"line":9,"column":158,"offset":598},"end":{"line":9,"column":189,"offset":629},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":443},"end":{"line":9,"column":189,"offset":629},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":441},"end":{"line":9,"column":189,"offset":629},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/ssl/client-certificates/enable-mtls","children":[{"type":"text","value":"Enable mutual Transport Layer Security (mTLS) for a host","position":{"start":{"line":10,"column":4,"offset":633},"end":{"line":10,"column":60,"offset":689},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":632},"end":{"line":10,"column":132,"offset":761},"indent":[]}},{"type":"text","value":" in your zone.","position":{"start":{"line":10,"column":132,"offset":761},"end":{"line":10,"column":146,"offset":775},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":632},"end":{"line":10,"column":146,"offset":775},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":630},"end":{"line":10,"column":146,"offset":775},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":321},"end":{"line":10,"column":146,"offset":775},"indent":[1,1]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":12,"column":1,"offset":777},"end":{"line":12,"column":42,"offset":818},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can only use API Shield with a certificate authority (CA) that is fully managed by Cloudflare. Cloudflare generates a unique CA for each zone.","position":{"start":{"line":14,"column":1,"offset":820},"end":{"line":14,"column":147,"offset":966},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":820},"end":{"line":14,"column":147,"offset":966},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you need to use a different CA, contact a Cloudflare Customer Success Manager.","position":{"start":{"line":16,"column":1,"offset":968},"end":{"line":16,"column":82,"offset":1049},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":968},"end":{"line":16,"column":82,"offset":1049},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":18,"column":1,"offset":1051},"end":{"line":18,"column":9,"offset":1059},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example creates a firewall rule that requires API calls to present a valid client certificate. When the client certificate cannot be verified, the rule triggers the ","position":{"start":{"line":20,"column":1,"offset":1061},"end":{"line":20,"column":171,"offset":1231},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":20,"column":172,"offset":1232},"end":{"line":20,"column":177,"offset":1237},"indent":[]}}],"position":{"start":{"line":20,"column":171,"offset":1231},"end":{"line":20,"column":178,"offset":1238},"indent":[]}},{"type":"text","value":" action.","position":{"start":{"line":20,"column":178,"offset":1238},"end":{"line":20,"column":186,"offset":1246},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1061},"end":{"line":20,"column":186,"offset":1246},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The rule includes a compound expression that comprises two ","position":{"start":{"line":22,"column":1,"offset":1248},"end":{"line":22,"column":60,"offset":1307},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/fields-and-expressions#simple-expressions","children":[{"type":"text","value":"simple expressions","position":{"start":{"line":22,"column":61,"offset":1308},"end":{"line":22,"column":79,"offset":1326},"indent":[]}}],"position":{"start":{"line":22,"column":60,"offset":1307},"end":{"line":22,"column":142,"offset":1389},"indent":[]}},{"type":"text","value":" joined by the ","position":{"start":{"line":22,"column":142,"offset":1389},"end":{"line":22,"column":157,"offset":1404},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":22,"column":157,"offset":1404},"end":{"line":22,"column":162,"offset":1409},"indent":[]}},{"type":"text","value":" operator.","position":{"start":{"line":22,"column":162,"offset":1409},"end":{"line":22,"column":172,"offset":1419},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1248},"end":{"line":22,"column":172,"offset":1419},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The first expression uses the ","position":{"start":{"line":24,"column":1,"offset":1421},"end":{"line":24,"column":31,"offset":1451},"indent":[]}},{"type":"inlineCode","value":"http.host","position":{"start":{"line":24,"column":31,"offset":1451},"end":{"line":24,"column":42,"offset":1462},"indent":[]}},{"type":"text","value":" field and the ","position":{"start":{"line":24,"column":42,"offset":1462},"end":{"line":24,"column":57,"offset":1477},"indent":[]}},{"type":"inlineCode","value":"in","position":{"start":{"line":24,"column":57,"offset":1477},"end":{"line":24,"column":61,"offset":1481},"indent":[]}},{"type":"text","value":" operator to capture the hosts that should be protected — ","position":{"start":{"line":24,"column":61,"offset":1481},"end":{"line":24,"column":119,"offset":1539},"indent":[]}},{"type":"inlineCode","value":"orangeclouded.com","position":{"start":{"line":24,"column":119,"offset":1539},"end":{"line":24,"column":138,"offset":1558},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":24,"column":138,"offset":1558},"end":{"line":24,"column":143,"offset":1563},"indent":[]}},{"type":"inlineCode","value":"api.orangeclouded.com","position":{"start":{"line":24,"column":143,"offset":1563},"end":{"line":24,"column":166,"offset":1586},"indent":[]}},{"type":"text","value":" in this example.","position":{"start":{"line":24,"column":166,"offset":1586},"end":{"line":24,"column":183,"offset":1603},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1421},"end":{"line":24,"column":183,"offset":1603},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The second expression — ","position":{"start":{"line":26,"column":1,"offset":1605},"end":{"line":26,"column":25,"offset":1629},"indent":[]}},{"type":"inlineCode","value":"not cf.tls_client_auth.cert_verified","position":{"start":{"line":26,"column":25,"offset":1629},"end":{"line":26,"column":63,"offset":1667},"indent":[]}},{"type":"text","value":" — returns ","position":{"start":{"line":26,"column":63,"offset":1667},"end":{"line":26,"column":74,"offset":1678},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":26,"column":74,"offset":1678},"end":{"line":26,"column":80,"offset":1684},"indent":[]}},{"type":"text","value":" when a request to access the API or web application does ","position":{"start":{"line":26,"column":80,"offset":1684},"end":{"line":26,"column":138,"offset":1742},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"not","position":{"start":{"line":26,"column":139,"offset":1743},"end":{"line":26,"column":142,"offset":1746},"indent":[]}}],"position":{"start":{"line":26,"column":138,"offset":1742},"end":{"line":26,"column":143,"offset":1747},"indent":[]}},{"type":"text","value":" present a valid client certificate.","position":{"start":{"line":26,"column":143,"offset":1747},"end":{"line":26,"column":179,"offset":1783},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1605},"end":{"line":26,"column":179,"offset":1783},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Because the ","position":{"start":{"line":28,"column":1,"offset":1785},"end":{"line":28,"column":13,"offset":1797},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/actions","children":[{"type":"text","value":"action","position":{"start":{"line":28,"column":14,"offset":1798},"end":{"line":28,"column":20,"offset":1804},"indent":[]}}],"position":{"start":{"line":28,"column":13,"offset":1797},"end":{"line":28,"column":49,"offset":1833},"indent":[]}},{"type":"text","value":" is ","position":{"start":{"line":28,"column":49,"offset":1833},"end":{"line":28,"column":53,"offset":1837},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":28,"column":54,"offset":1838},"end":{"line":28,"column":59,"offset":1843},"indent":[]}}],"position":{"start":{"line":28,"column":53,"offset":1837},"end":{"line":28,"column":60,"offset":1844},"indent":[]}},{"type":"text","value":", only requests that present a valid client certificate can access the specified hosts:","position":{"start":{"line":28,"column":60,"offset":1844},"end":{"line":28,"column":147,"offset":1931},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1785},"end":{"line":28,"column":147,"offset":1931},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(http.host in {'{'}\"orangeclouded.com\" \"api.orangeclouded.com\"{'}'} and not cf.tls_client_auth.cert_verified)</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":30,"column":1,"offset":1933},"end":{"line":43,"column":9,"offset":2237},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"To create a mTLS rule that requires a valid client certificate in the Cloudflare dashboard, ","position":{"start":{"line":45,"column":1,"offset":2239},"end":{"line":45,"column":93,"offset":2331},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/create-mtls-rule#use-the-mutual-tls-rule-interface","children":[{"type":"text","value":"use the Mutual TLS Rule interface","position":{"start":{"line":45,"column":94,"offset":2332},"end":{"line":45,"column":127,"offset":2365},"indent":[]}}],"position":{"start":{"line":45,"column":93,"offset":2331},"end":{"line":45,"column":194,"offset":2432},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":45,"column":194,"offset":2432},"end":{"line":45,"column":202,"offset":2440},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":45,"column":204,"offset":2442},"end":{"line":45,"column":212,"offset":2450},"indent":[]}}],"position":{"start":{"line":45,"column":202,"offset":2440},"end":{"line":45,"column":214,"offset":2452},"indent":[]}},{"type":"text","value":" app.","position":{"start":{"line":45,"column":214,"offset":2452},"end":{"line":45,"column":219,"offset":2457},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":2239},"end":{"line":45,"column":219,"offset":2457},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":48,"column":65,"offset":2524}}}}},{"node":{"fields":{"slug":"/recipes/require-specific-http-ports"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Require specific HTTP ports"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Require specific HTTP ports","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":30,"offset":30},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":30,"offset":30},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"By default, Cloudflare allows requests on a number of different HTTP ports (refer to ","position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":86,"offset":117},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/fundamentals/get-started/network-ports","children":[{"type":"text","value":"Network ports","position":{"start":{"line":4,"column":87,"offset":118},"end":{"line":4,"column":100,"offset":131},"indent":[]}}],"position":{"start":{"line":4,"column":86,"offset":117},"end":{"line":4,"column":175,"offset":206},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":4,"column":175,"offset":206},"end":{"line":4,"column":176,"offset":207},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":176,"offset":207},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can target requests based on their HTTP port with the ","position":{"start":{"line":6,"column":1,"offset":209},"end":{"line":6,"column":59,"offset":267},"indent":[]}},{"type":"inlineCode","value":"cf.edge.server_port","position":{"start":{"line":6,"column":59,"offset":267},"end":{"line":6,"column":80,"offset":288},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":6,"column":80,"offset":288},"end":{"line":6,"column":81,"offset":289},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#dynamic-fields","children":[{"type":"text","value":"dynamic field","position":{"start":{"line":6,"column":82,"offset":290},"end":{"line":6,"column":95,"offset":303},"indent":[]}}],"position":{"start":{"line":6,"column":81,"offset":289},"end":{"line":6,"column":184,"offset":392},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":184,"offset":392},"end":{"line":6,"column":185,"offset":393},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":209},"end":{"line":6,"column":185,"offset":393},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":8,"column":1,"offset":395},"end":{"line":8,"column":9,"offset":403},"indent":[]}},{"type":"inlineCode","value":"in","position":{"start":{"line":8,"column":9,"offset":403},"end":{"line":8,"column":13,"offset":407},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":8,"column":13,"offset":407},"end":{"line":8,"column":14,"offset":408},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":8,"column":15,"offset":409},"end":{"line":8,"column":34,"offset":428},"indent":[]}}],"position":{"start":{"line":8,"column":14,"offset":408},"end":{"line":8,"column":132,"offset":526},"indent":[]}},{"type":"text","value":" to target a set of ports.","position":{"start":{"line":8,"column":132,"offset":526},"end":{"line":8,"column":158,"offset":552},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":395},"end":{"line":8,"column":158,"offset":552},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example blocks requests to ","position":{"start":{"line":10,"column":1,"offset":554},"end":{"line":10,"column":33,"offset":586},"indent":[]}},{"type":"inlineCode","value":"www.example.com","position":{"start":{"line":10,"column":33,"offset":586},"end":{"line":10,"column":50,"offset":603},"indent":[]}},{"type":"text","value":" that are not on ports 80 or 443:","position":{"start":{"line":10,"column":50,"offset":603},"end":{"line":10,"column":83,"offset":636},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":554},"end":{"line":10,"column":83,"offset":636},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>http.host eq \"www.example.com\" and not cf.edge.server_port in {'{80 443}'}</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":12,"column":1,"offset":638},"end":{"line":25,"column":9,"offset":907},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":28,"column":65,"offset":974}}}}},{"node":{"fields":{"slug":"/recipes/require-valid-hmac-token"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Require a valid HMAC token"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Require a valid HMAC token","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":29,"offset":29},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":29,"offset":29},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":4,"column":1,"offset":31},"end":{"line":4,"column":42,"offset":72},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to the HMAC validation function requires a Cloudflare Pro, Business, or Enterprise plan.","position":{"start":{"line":6,"column":1,"offset":74},"end":{"line":6,"column":96,"offset":169},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":74},"end":{"line":6,"column":96,"offset":169},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":8,"column":1,"offset":171},"end":{"line":8,"column":9,"offset":179},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"HMAC token validation","position":{"start":{"line":10,"column":4,"offset":184},"end":{"line":10,"column":25,"offset":205},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":181},"end":{"line":10,"column":25,"offset":205},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the Rules language ","position":{"start":{"line":12,"column":1,"offset":207},"end":{"line":12,"column":24,"offset":230},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/functions#hmac-validation","children":[{"type":"text","value":"HMAC validation function","position":{"start":{"line":12,"column":25,"offset":231},"end":{"line":12,"column":49,"offset":255},"indent":[]}}],"position":{"start":{"line":12,"column":24,"offset":230},"end":{"line":12,"column":141,"offset":347},"indent":[]}},{"type":"text","value":" to validate hash-based message authentication code (HMAC) tokens in a Firewall Rules expression.","position":{"start":{"line":12,"column":141,"offset":347},"end":{"line":12,"column":238,"offset":444},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":207},"end":{"line":12,"column":238,"offset":444},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example uses HMAC token authentication to protect a static private asset hosted by ","position":{"start":{"line":14,"column":1,"offset":446},"end":{"line":14,"column":89,"offset":534},"indent":[]}},{"type":"inlineCode","value":"example.com","position":{"start":{"line":14,"column":89,"offset":534},"end":{"line":14,"column":102,"offset":547},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":14,"column":102,"offset":547},"end":{"line":14,"column":103,"offset":548},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":446},"end":{"line":14,"column":103,"offset":548},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":16,"column":1,"offset":550},"end":{"line":16,"column":5,"offset":554},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":16,"column":5,"offset":554},"end":{"line":16,"column":23,"offset":572},"indent":[]}},{"type":"text","value":" for this example is","position":{"start":{"line":16,"column":23,"offset":572},"end":{"line":16,"column":43,"offset":592},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":550},"end":{"line":16,"column":43,"offset":592},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"/download/cat.jpg?verify=1484063787-9JQB8vP1z0yc5DEBnH6JGWM3mBmvIeMrnnxFi3WtJLE%3D","position":{"start":{"line":18,"column":1,"offset":594},"end":{"line":20,"column":4,"offset":687},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"where","position":{"start":{"line":22,"column":1,"offset":689},"end":{"line":22,"column":6,"offset":694},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":689},"end":{"line":22,"column":6,"offset":694},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"/download/cat.jpg?","position":{"start":{"line":24,"column":3,"offset":698},"end":{"line":24,"column":23,"offset":718},"indent":[]}},{"type":"text","value":" represents the path to the asset—the HMAC ","position":{"start":{"line":24,"column":23,"offset":718},"end":{"line":24,"column":66,"offset":761},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"message","position":{"start":{"line":24,"column":68,"offset":763},"end":{"line":24,"column":75,"offset":770},"indent":[]}}],"position":{"start":{"line":24,"column":66,"offset":761},"end":{"line":24,"column":77,"offset":772},"indent":[]}},{"type":"text","value":" to authenticate","position":{"start":{"line":24,"column":77,"offset":772},"end":{"line":24,"column":93,"offset":788},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":698},"end":{"line":24,"column":93,"offset":788},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":696},"end":{"line":25,"column":1,"offset":789},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"?verify=","position":{"start":{"line":26,"column":3,"offset":792},"end":{"line":26,"column":13,"offset":802},"indent":[]}},{"type":"text","value":" is the ","position":{"start":{"line":26,"column":13,"offset":802},"end":{"line":26,"column":21,"offset":810},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"separator","position":{"start":{"line":26,"column":23,"offset":812},"end":{"line":26,"column":32,"offset":821},"indent":[]}}],"position":{"start":{"line":26,"column":21,"offset":810},"end":{"line":26,"column":34,"offset":823},"indent":[]}},{"type":"text","value":" between the path to the asset and the timestamp when the HMAC token was issued","position":{"start":{"line":26,"column":34,"offset":823},"end":{"line":26,"column":113,"offset":902},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":792},"end":{"line":26,"column":113,"offset":902},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":790},"end":{"line":27,"column":1,"offset":903},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"1484063787","position":{"start":{"line":28,"column":3,"offset":906},"end":{"line":28,"column":15,"offset":918},"indent":[]}},{"type":"text","value":" represents the ","position":{"start":{"line":28,"column":15,"offset":918},"end":{"line":28,"column":31,"offset":934},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"timestamp when the token was issued","position":{"start":{"line":28,"column":33,"offset":936},"end":{"line":28,"column":68,"offset":971},"indent":[]}}],"position":{"start":{"line":28,"column":31,"offset":934},"end":{"line":28,"column":70,"offset":973},"indent":[]}},{"type":"text","value":", expressed as Unix time in seconds","position":{"start":{"line":28,"column":70,"offset":973},"end":{"line":28,"column":105,"offset":1008},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":906},"end":{"line":28,"column":105,"offset":1008},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":904},"end":{"line":29,"column":1,"offset":1009},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"9JQB8vP1z0yc5DEBnH6JGWM3mBmvIeMrnnxFi3WtJLE%3D","position":{"start":{"line":30,"column":3,"offset":1012},"end":{"line":30,"column":51,"offset":1060},"indent":[]}},{"type":"text","value":" is a base64-encoded ","position":{"start":{"line":30,"column":51,"offset":1060},"end":{"line":30,"column":72,"offset":1081},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"MAC","position":{"start":{"line":30,"column":74,"offset":1083},"end":{"line":30,"column":77,"offset":1086},"indent":[]}}],"position":{"start":{"line":30,"column":72,"offset":1081},"end":{"line":30,"column":79,"offset":1088},"indent":[]}}],"position":{"start":{"line":30,"column":3,"offset":1012},"end":{"line":30,"column":79,"offset":1088},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1010},"end":{"line":30,"column":79,"offset":1088},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":696},"end":{"line":30,"column":79,"offset":1088},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rule below blocks requests to ","position":{"start":{"line":32,"column":1,"offset":1090},"end":{"line":32,"column":44,"offset":1133},"indent":[]}},{"type":"inlineCode","value":"example.com","position":{"start":{"line":32,"column":44,"offset":1133},"end":{"line":32,"column":57,"offset":1146},"indent":[]}},{"type":"text","value":" that do not include a valid HMAC.","position":{"start":{"line":32,"column":57,"offset":1146},"end":{"line":32,"column":91,"offset":1180},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1090},"end":{"line":32,"column":91,"offset":1180},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The rule supplies the value of the secret key shared between the website and Cloudflare as the first argument to the ","position":{"start":{"line":34,"column":1,"offset":1182},"end":{"line":34,"column":118,"offset":1299},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/functions#hmac-validation","children":[{"type":"text","value":"HMAC validation function","position":{"start":{"line":34,"column":119,"offset":1300},"end":{"line":34,"column":143,"offset":1324},"indent":[]}}],"position":{"start":{"line":34,"column":118,"offset":1299},"end":{"line":34,"column":235,"offset":1416},"indent":[]}},{"type":"text","value":", and it uses the value of ","position":{"start":{"line":34,"column":235,"offset":1416},"end":{"line":34,"column":262,"offset":1443},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":34,"column":262,"offset":1443},"end":{"line":34,"column":280,"offset":1461},"indent":[]}},{"type":"text","value":" for the ","position":{"start":{"line":34,"column":280,"offset":1461},"end":{"line":34,"column":289,"offset":1470},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/functions#messagemac","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":34,"column":290,"offset":1471},"end":{"line":34,"column":300,"offset":1481},"indent":[]}}],"position":{"start":{"line":34,"column":289,"offset":1470},"end":{"line":34,"column":387,"offset":1568},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":34,"column":387,"offset":1568},"end":{"line":34,"column":388,"offset":1569},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1182},"end":{"line":34,"column":388,"offset":1569},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>http.host eq \"downloads.example.com\" and not is_timed_hmac_valid_v0(\"secretKey\", http.request.uri, 10800, http.request.timestamp.sec,8)</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":36,"column":1,"offset":1571},"end":{"line":49,"column":9,"offset":1901},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":51,"column":1,"offset":1903},"end":{"line":51,"column":5,"offset":1907},"indent":[]}},{"type":"inlineCode","value":"is_timed_hmac_valid()","position":{"start":{"line":51,"column":5,"offset":1907},"end":{"line":51,"column":28,"offset":1930},"indent":[]}},{"type":"text","value":" function compares the value of a MAC generated using ","position":{"start":{"line":51,"column":28,"offset":1930},"end":{"line":51,"column":82,"offset":1984},"indent":[]}},{"type":"inlineCode","value":"secretKey","position":{"start":{"line":51,"column":82,"offset":1984},"end":{"line":51,"column":93,"offset":1995},"indent":[]}},{"type":"text","value":" to the value encoded in ","position":{"start":{"line":51,"column":93,"offset":1995},"end":{"line":51,"column":118,"offset":2020},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":51,"column":118,"offset":2020},"end":{"line":51,"column":136,"offset":2038},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":51,"column":136,"offset":2038},"end":{"line":51,"column":137,"offset":2039},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1903},"end":{"line":51,"column":137,"offset":2039},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If the MAC values match and","position":{"start":{"line":53,"column":1,"offset":2041},"end":{"line":53,"column":28,"offset":2068},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":2041},"end":{"line":53,"column":28,"offset":2068},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"http.request.timestamp.sec < (timestamp-issued + 10800)","position":{"start":{"line":55,"column":1,"offset":2070},"end":{"line":57,"column":4,"offset":2136},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"then the token is valid and the function returns ","position":{"start":{"line":59,"column":1,"offset":2138},"end":{"line":59,"column":50,"offset":2187},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":59,"column":50,"offset":2187},"end":{"line":59,"column":56,"offset":2193},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":59,"column":56,"offset":2193},"end":{"line":59,"column":57,"offset":2194},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":2138},"end":{"line":59,"column":57,"offset":2194},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Since the expression in this example uses the ","position":{"start":{"line":61,"column":1,"offset":2196},"end":{"line":61,"column":47,"offset":2242},"indent":[]}},{"type":"inlineCode","value":"not","position":{"start":{"line":61,"column":47,"offset":2242},"end":{"line":61,"column":52,"offset":2247},"indent":[]}},{"type":"text","value":" operator, it only matches when the HMAC token is ","position":{"start":{"line":61,"column":52,"offset":2247},"end":{"line":61,"column":102,"offset":2297},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"not","position":{"start":{"line":61,"column":103,"offset":2298},"end":{"line":61,"column":106,"offset":2301},"indent":[]}}],"position":{"start":{"line":61,"column":102,"offset":2297},"end":{"line":61,"column":107,"offset":2302},"indent":[]}},{"type":"text","value":" valid. When the token is not valid, the Cloudflare triggers the action and blocks the request.","position":{"start":{"line":61,"column":107,"offset":2302},"end":{"line":61,"column":202,"offset":2397},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":2196},"end":{"line":61,"column":202,"offset":2397},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":63,"column":1,"offset":2399},"end":{"line":63,"column":42,"offset":2440},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you do not use the optional ","position":{"start":{"line":65,"column":1,"offset":2442},"end":{"line":65,"column":34,"offset":2475},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"flags","position":{"start":{"line":65,"column":35,"offset":2476},"end":{"line":65,"column":40,"offset":2481},"indent":[]}}],"position":{"start":{"line":65,"column":34,"offset":2475},"end":{"line":65,"column":41,"offset":2482},"indent":[]}},{"type":"text","value":" argument for ","position":{"start":{"line":65,"column":41,"offset":2482},"end":{"line":65,"column":55,"offset":2496},"indent":[]}},{"type":"inlineCode","value":"_is_timed_hmac_valid()","position":{"start":{"line":65,"column":55,"offset":2496},"end":{"line":65,"column":79,"offset":2520},"indent":[]}},{"type":"text","value":", you must URL encode the base64 value for ","position":{"start":{"line":65,"column":79,"offset":2520},"end":{"line":65,"column":122,"offset":2563},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":65,"column":123,"offset":2564},"end":{"line":65,"column":126,"offset":2567},"indent":[]}}],"position":{"start":{"line":65,"column":122,"offset":2563},"end":{"line":65,"column":127,"offset":2568},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":65,"column":127,"offset":2568},"end":{"line":65,"column":135,"offset":2576},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":65,"column":136,"offset":2577},"end":{"line":65,"column":146,"offset":2587},"indent":[]}}],"position":{"start":{"line":65,"column":135,"offset":2576},"end":{"line":65,"column":147,"offset":2588},"indent":[]}},{"type":"text","value":" argument.","position":{"start":{"line":65,"column":147,"offset":2588},"end":{"line":65,"column":157,"offset":2598},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":2442},"end":{"line":65,"column":157,"offset":2598},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information, refer to ","position":{"start":{"line":67,"column":1,"offset":2600},"end":{"line":67,"column":32,"offset":2631},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/functions#hmac-validation","children":[{"type":"text","value":"Functions: HMAC Validation","position":{"start":{"line":67,"column":33,"offset":2632},"end":{"line":67,"column":59,"offset":2658},"indent":[]}}],"position":{"start":{"line":67,"column":32,"offset":2631},"end":{"line":67,"column":151,"offset":2750},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":67,"column":151,"offset":2750},"end":{"line":67,"column":152,"offset":2751},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":2600},"end":{"line":67,"column":152,"offset":2751},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":69,"column":1,"offset":2753},"end":{"line":69,"column":9,"offset":2761},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Use the same secret key to protect multiple paths","position":{"start":{"line":71,"column":4,"offset":2766},"end":{"line":71,"column":53,"offset":2815},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":2763},"end":{"line":71,"column":53,"offset":2815},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can use the same secret key to protect multiple URI paths.","position":{"start":{"line":73,"column":1,"offset":2817},"end":{"line":73,"column":63,"offset":2879},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":2817},"end":{"line":73,"column":63,"offset":2879},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This is illustrated in the example above, where ","position":{"start":{"line":75,"column":1,"offset":2881},"end":{"line":75,"column":49,"offset":2929},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":75,"column":49,"offset":2929},"end":{"line":75,"column":67,"offset":2947},"indent":[]}},{"type":"text","value":" is passed as the MessageMAC argument to the validation function.","position":{"start":{"line":75,"column":67,"offset":2947},"end":{"line":75,"column":132,"offset":3012},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":2881},"end":{"line":75,"column":132,"offset":3012},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Since ","position":{"start":{"line":77,"column":1,"offset":3014},"end":{"line":77,"column":7,"offset":3020},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":77,"column":7,"offset":3020},"end":{"line":77,"column":25,"offset":3038},"indent":[]}},{"type":"text","value":" includes the path to the asset and that value is extracted for each request, the validation function evaluates all request URIs to ","position":{"start":{"line":77,"column":25,"offset":3038},"end":{"line":77,"column":157,"offset":3170},"indent":[]}},{"type":"inlineCode","value":"downloads.example.com","position":{"start":{"line":77,"column":157,"offset":3170},"end":{"line":77,"column":180,"offset":3193},"indent":[]}},{"type":"text","value":" using the same secret key.","position":{"start":{"line":77,"column":180,"offset":3193},"end":{"line":77,"column":207,"offset":3220},"indent":[]}}],"position":{"start":{"line":77,"column":1,"offset":3014},"end":{"line":77,"column":207,"offset":3220},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Note that while you can use the same secret key to authenticate multiple paths, you must generate an HMAC token for each unique message you want to authenticate.","position":{"start":{"line":79,"column":1,"offset":3222},"end":{"line":79,"column":162,"offset":3383},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":3222},"end":{"line":79,"column":162,"offset":3383},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":82,"column":65,"offset":3450}}}}},{"node":{"fields":{"slug":"/recipes/site-admin-only-known-ips"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Site administration—Require known IP addresses"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Site administration—Require known IP addresses","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":49,"offset":49},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":49,"offset":49},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If an attack compromises the administrative area of your website, the consequences can be severe. With Firewall Rules, you can protect your site’s administrative area by blocking requests for access to administrative paths that do not come from a known IP address.","position":{"start":{"line":4,"column":1,"offset":51},"end":{"line":4,"column":265,"offset":315},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":51},"end":{"line":4,"column":265,"offset":315},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The example below limits access to the WordPress administrative area, ","position":{"start":{"line":6,"column":1,"offset":317},"end":{"line":6,"column":71,"offset":387},"indent":[]}},{"type":"inlineCode","value":"/wp-admin/","position":{"start":{"line":6,"column":71,"offset":387},"end":{"line":6,"column":83,"offset":399},"indent":[]}},{"type":"text","value":", by ","position":{"start":{"line":6,"column":83,"offset":399},"end":{"line":6,"column":88,"offset":404},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"blocking","position":{"start":{"line":6,"column":89,"offset":405},"end":{"line":6,"column":97,"offset":413},"indent":[]}}],"position":{"start":{"line":6,"column":88,"offset":404},"end":{"line":6,"column":98,"offset":414},"indent":[]}},{"type":"text","value":" requests that do not originate from a specified set of IP addresses.","position":{"start":{"line":6,"column":98,"offset":414},"end":{"line":6,"column":167,"offset":483},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":317},"end":{"line":6,"column":167,"offset":483},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To prevent attackers from successfully using a permutation of ","position":{"start":{"line":8,"column":1,"offset":485},"end":{"line":8,"column":63,"offset":547},"indent":[]}},{"type":"inlineCode","value":"/wp-admin/","position":{"start":{"line":8,"column":63,"offset":547},"end":{"line":8,"column":75,"offset":559},"indent":[]}},{"type":"text","value":" such as ","position":{"start":{"line":8,"column":75,"offset":559},"end":{"line":8,"column":84,"offset":568},"indent":[]}},{"type":"inlineCode","value":"/wP-AdMiN/","position":{"start":{"line":8,"column":84,"offset":568},"end":{"line":8,"column":96,"offset":580},"indent":[]}},{"type":"text","value":", use the ","position":{"start":{"line":8,"column":96,"offset":580},"end":{"line":8,"column":106,"offset":590},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":8,"column":106,"offset":590},"end":{"line":8,"column":115,"offset":599},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":8,"column":115,"offset":599},"end":{"line":8,"column":116,"offset":600},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/functions#transformation-functions","children":[{"type":"text","value":"transformation function","position":{"start":{"line":8,"column":117,"offset":601},"end":{"line":8,"column":140,"offset":624},"indent":[]}}],"position":{"start":{"line":8,"column":116,"offset":600},"end":{"line":8,"column":241,"offset":725},"indent":[]}},{"type":"text","value":" to convert the URI path segment to lowercase:","position":{"start":{"line":8,"column":241,"offset":725},"end":{"line":8,"column":287,"offset":771},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":485},"end":{"line":8,"column":287,"offset":771},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>not (ip.src in {'{10.20.30.40 192.168.1.0/24}'} and lower(http.request.uri.path) contains \"/wp-admin\")</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":10,"column":1,"offset":773},"end":{"line":23,"column":9,"offset":1070},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":26,"column":65,"offset":1137}}}}},{"node":{"fields":{"slug":"/recipes/update-rules-customers-partners"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Update Firewall Rules for customers or partners"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Update Firewall Rules for customers or partners","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":50,"offset":50},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":50,"offset":50},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You may want to adjust your Firewall Rules to increase access by customers or partners.","position":{"start":{"line":4,"column":1,"offset":52},"end":{"line":4,"column":88,"offset":139},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":52},"end":{"line":4,"column":88,"offset":139},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Potential examples include:","position":{"start":{"line":6,"column":1,"offset":141},"end":{"line":6,"column":28,"offset":168},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":141},"end":{"line":6,"column":28,"offset":168},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Removing rate limiting for an API","position":{"start":{"line":8,"column":3,"offset":172},"end":{"line":8,"column":36,"offset":205},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":172},"end":{"line":8,"column":36,"offset":205},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":170},"end":{"line":8,"column":36,"offset":205},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Sharing brand assets and marketing materials","position":{"start":{"line":9,"column":3,"offset":208},"end":{"line":9,"column":47,"offset":252},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":208},"end":{"line":9,"column":47,"offset":252},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":206},"end":{"line":9,"column":47,"offset":252},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":170},"end":{"line":9,"column":47,"offset":252},"indent":[1]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":11,"column":1,"offset":254},"end":{"line":11,"column":34,"offset":287},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"These rules can bypass Cloudflare's security features and are generally not recommended. Use with caution.","position":{"start":{"line":13,"column":1,"offset":289},"end":{"line":13,"column":107,"offset":395},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":289},"end":{"line":13,"column":107,"offset":395},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":15,"column":1,"offset":397},"end":{"line":15,"column":9,"offset":405},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Update Firewall Rules by ASN","position":{"start":{"line":17,"column":4,"offset":410},"end":{"line":17,"column":32,"offset":438},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":407},"end":{"line":17,"column":32,"offset":438},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If a customer or partner is large enough, you could set up a Firewall Rule based on an ","position":{"start":{"line":19,"column":1,"offset":440},"end":{"line":19,"column":88,"offset":527},"indent":[]}},{"type":"link","title":null,"url":"https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/","children":[{"type":"text","value":"autonomous system number (ASN)","position":{"start":{"line":19,"column":89,"offset":528},"end":{"line":19,"column":119,"offset":558},"indent":[]}}],"position":{"start":{"line":19,"column":88,"offset":527},"end":{"line":19,"column":201,"offset":640},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":19,"column":201,"offset":640},"end":{"line":19,"column":202,"offset":641},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":440},"end":{"line":19,"column":202,"offset":641},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Allow traffic by ASN","position":{"start":{"line":21,"column":5,"offset":647},"end":{"line":21,"column":25,"offset":667},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":643},"end":{"line":21,"column":25,"offset":667},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example uses:","position":{"start":{"line":23,"column":1,"offset":669},"end":{"line":23,"column":19,"offset":687},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":669},"end":{"line":23,"column":19,"offset":687},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"ip.geoip.asnum","position":{"start":{"line":24,"column":3,"offset":690},"end":{"line":24,"column":19,"offset":706},"indent":[]}},{"type":"text","value":" to specify the general region","position":{"start":{"line":24,"column":19,"offset":706},"end":{"line":24,"column":49,"offset":736},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":690},"end":{"line":24,"column":49,"offset":736},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":688},"end":{"line":24,"column":49,"offset":736},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":25,"column":3,"offset":739},"end":{"line":25,"column":7,"offset":743},"indent":[]}},{"type":"inlineCode","value":"cf.bot_management.score","position":{"start":{"line":25,"column":7,"offset":743},"end":{"line":25,"column":32,"offset":768},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":25,"column":32,"offset":768},"end":{"line":25,"column":33,"offset":769},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#dynamic-fields","children":[{"type":"text","value":"dynamic field","position":{"start":{"line":25,"column":34,"offset":770},"end":{"line":25,"column":47,"offset":783},"indent":[]}}],"position":{"start":{"line":25,"column":33,"offset":769},"end":{"line":25,"column":136,"offset":872},"indent":[]}},{"type":"text","value":" to ensure partner traffic does not come from bots","position":{"start":{"line":25,"column":136,"offset":872},"end":{"line":25,"column":186,"offset":922},"indent":[]}}],"position":{"start":{"line":25,"column":3,"offset":739},"end":{"line":25,"column":186,"offset":922},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":737},"end":{"line":25,"column":186,"offset":922},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":688},"end":{"line":25,"column":186,"offset":922},"indent":[1]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(ip.geoip.asnum eq 12345 and cf.bot_management.score gt 30)</code></td>\n      <td><em>Allow</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":27,"column":1,"offset":924},"end":{"line":40,"column":9,"offset":1235},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":42,"column":1,"offset":1237},"end":{"line":42,"column":42,"offset":1278},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to ","position":{"start":{"line":44,"column":1,"offset":1280},"end":{"line":44,"column":11,"offset":1290},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/get-started/bm-subscription","children":[{"type":"text","value":"Bot Management","position":{"start":{"line":44,"column":12,"offset":1291},"end":{"line":44,"column":26,"offset":1305},"indent":[]}}],"position":{"start":{"line":44,"column":11,"offset":1290},"end":{"line":44,"column":95,"offset":1374},"indent":[]}},{"type":"text","value":" requires a Cloudflare Enterprise plan with Bot Management.","position":{"start":{"line":44,"column":95,"offset":1374},"end":{"line":44,"column":154,"offset":1433},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":1280},"end":{"line":44,"column":154,"offset":1433},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":46,"column":1,"offset":1435},"end":{"line":46,"column":9,"offset":1443},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Adjust rules by ASN","position":{"start":{"line":48,"column":5,"offset":1449},"end":{"line":48,"column":24,"offset":1468},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1445},"end":{"line":48,"column":24,"offset":1468},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example uses:","position":{"start":{"line":50,"column":1,"offset":1470},"end":{"line":50,"column":19,"offset":1488},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":1470},"end":{"line":50,"column":19,"offset":1488},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":51,"column":3,"offset":1491},"end":{"line":51,"column":7,"offset":1495},"indent":[]}},{"type":"inlineCode","value":"ip.geoip.asnum","position":{"start":{"line":51,"column":7,"offset":1495},"end":{"line":51,"column":23,"offset":1511},"indent":[]}},{"type":"text","value":" field to specify the general region.","position":{"start":{"line":51,"column":23,"offset":1511},"end":{"line":51,"column":60,"offset":1548},"indent":[]}}],"position":{"start":{"line":51,"column":3,"offset":1491},"end":{"line":51,"column":60,"offset":1548},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1489},"end":{"line":51,"column":60,"offset":1548},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":52,"column":3,"offset":1551},"end":{"line":52,"column":7,"offset":1555},"indent":[]}},{"type":"inlineCode","value":"cf.threat_score","position":{"start":{"line":52,"column":7,"offset":1555},"end":{"line":52,"column":24,"offset":1572},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":52,"column":24,"offset":1572},"end":{"line":52,"column":25,"offset":1573},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#dynamic-fields","children":[{"type":"text","value":"dynamic field","position":{"start":{"line":52,"column":26,"offset":1574},"end":{"line":52,"column":39,"offset":1587},"indent":[]}}],"position":{"start":{"line":52,"column":25,"offset":1573},"end":{"line":52,"column":128,"offset":1676},"indent":[]}},{"type":"text","value":" to ensure requests are not high-risk traffic.","position":{"start":{"line":52,"column":128,"offset":1676},"end":{"line":52,"column":174,"offset":1722},"indent":[]}}],"position":{"start":{"line":52,"column":3,"offset":1551},"end":{"line":52,"column":174,"offset":1722},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":1549},"end":{"line":52,"column":174,"offset":1722},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1489},"end":{"line":52,"column":174,"offset":1722},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"If a request meets these criteria, your firewall bypasses normal ","position":{"start":{"line":54,"column":1,"offset":1724},"end":{"line":54,"column":66,"offset":1789},"indent":[]}},{"type":"inlineCode","value":"User Agent Block","position":{"start":{"line":54,"column":66,"offset":1789},"end":{"line":54,"column":84,"offset":1807},"indent":[]}},{"type":"text","value":" rules.","position":{"start":{"line":54,"column":84,"offset":1807},"end":{"line":54,"column":91,"offset":1814},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":1724},"end":{"line":54,"column":91,"offset":1814},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(ip.geoip.asnum eq 12345 and cf.threat_score lt 14)</code></td>\n      <td><em>Bypass - User Agent Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":56,"column":1,"offset":1816},"end":{"line":69,"column":9,"offset":2139},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Update Firewall Rules by IP","position":{"start":{"line":71,"column":5,"offset":2145},"end":{"line":71,"column":32,"offset":2172},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":2141},"end":{"line":71,"column":32,"offset":2172},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For smaller organizations, you could set up Firewall Rules based on IP addresses.","position":{"start":{"line":73,"column":1,"offset":2174},"end":{"line":73,"column":82,"offset":2255},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":2174},"end":{"line":73,"column":82,"offset":2255},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Allow traffic by IP address","position":{"start":{"line":75,"column":5,"offset":2261},"end":{"line":75,"column":32,"offset":2288},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":2257},"end":{"line":75,"column":32,"offset":2288},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example:","position":{"start":{"line":77,"column":1,"offset":2290},"end":{"line":77,"column":14,"offset":2303},"indent":[]}}],"position":{"start":{"line":77,"column":1,"offset":2290},"end":{"line":77,"column":14,"offset":2303},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Specifies the network and host.","position":{"start":{"line":78,"column":3,"offset":2306},"end":{"line":78,"column":34,"offset":2337},"indent":[]}}],"position":{"start":{"line":78,"column":3,"offset":2306},"end":{"line":78,"column":34,"offset":2337},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":2304},"end":{"line":78,"column":34,"offset":2337},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Uses the ","position":{"start":{"line":79,"column":3,"offset":2340},"end":{"line":79,"column":12,"offset":2349},"indent":[]}},{"type":"inlineCode","value":"cf.bot_management.score","position":{"start":{"line":79,"column":12,"offset":2349},"end":{"line":79,"column":37,"offset":2374},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":79,"column":37,"offset":2374},"end":{"line":79,"column":38,"offset":2375},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#dynamic-fields","children":[{"type":"text","value":"dynamic field","position":{"start":{"line":79,"column":39,"offset":2376},"end":{"line":79,"column":52,"offset":2389},"indent":[]}}],"position":{"start":{"line":79,"column":38,"offset":2375},"end":{"line":79,"column":141,"offset":2478},"indent":[]}},{"type":"text","value":" to ensure requests are not high-risk traffic.","position":{"start":{"line":79,"column":141,"offset":2478},"end":{"line":79,"column":187,"offset":2524},"indent":[]}}],"position":{"start":{"line":79,"column":3,"offset":2340},"end":{"line":79,"column":187,"offset":2524},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":2338},"end":{"line":79,"column":187,"offset":2524},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":2304},"end":{"line":79,"column":187,"offset":2524},"indent":[1]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(ip.src eq 1.1.1.1 and http.host eq \"example.com\" and cf.bot_management.score gt 30)</code></td>\n      <td><em>Allow</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":81,"column":1,"offset":2526},"end":{"line":94,"column":9,"offset":2862},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Adjust rules by IP address","position":{"start":{"line":96,"column":5,"offset":2868},"end":{"line":96,"column":31,"offset":2894},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":2864},"end":{"line":96,"column":31,"offset":2894},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example specifies the network and host.","position":{"start":{"line":98,"column":1,"offset":2896},"end":{"line":98,"column":45,"offset":2940},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":2896},"end":{"line":98,"column":45,"offset":2940},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If a request meets these criteria, your firewall bypasses normal ","position":{"start":{"line":100,"column":1,"offset":2942},"end":{"line":100,"column":66,"offset":3007},"indent":[]}},{"type":"inlineCode","value":"Rate Limiting","position":{"start":{"line":100,"column":66,"offset":3007},"end":{"line":100,"column":81,"offset":3022},"indent":[]}},{"type":"text","value":" rules.","position":{"start":{"line":100,"column":81,"offset":3022},"end":{"line":100,"column":88,"offset":3029},"indent":[]}}],"position":{"start":{"line":100,"column":1,"offset":2942},"end":{"line":100,"column":88,"offset":3029},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th style='width:20%'>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>(ip.src eq 1.1.1.1 and http.host eq \"example.com\")</code></td>\n      <td><em>Bypass - Rate Limiting</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":102,"column":1,"offset":3031},"end":{"line":115,"column":9,"offset":3350},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":118,"column":65,"offset":3417}}}}},{"node":{"fields":{"slug":"/recipes/require-specific-headers"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Require specific HTTP headers"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Require specific HTTP headers","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":32,"offset":32},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":32,"offset":32},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Many organizations qualify traffic based on the presence of specific HTTP request headers.","position":{"start":{"line":4,"column":1,"offset":34},"end":{"line":4,"column":91,"offset":124},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":34},"end":{"line":4,"column":91,"offset":124},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the Rules language ","position":{"start":{"line":6,"column":1,"offset":126},"end":{"line":6,"column":24,"offset":149},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields#http-request-header-fields","children":[{"type":"text","value":"HTTP request header fields","position":{"start":{"line":6,"column":25,"offset":150},"end":{"line":6,"column":51,"offset":176},"indent":[]}}],"position":{"start":{"line":6,"column":24,"offset":149},"end":{"line":6,"column":151,"offset":276},"indent":[]}},{"type":"text","value":" to target requests with specific headers.","position":{"start":{"line":6,"column":151,"offset":276},"end":{"line":6,"column":193,"offset":318},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":126},"end":{"line":6,"column":193,"offset":318},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example uses the ","position":{"start":{"line":8,"column":1,"offset":320},"end":{"line":8,"column":23,"offset":342},"indent":[]}},{"type":"inlineCode","value":"http.headers.names","position":{"start":{"line":8,"column":23,"offset":342},"end":{"line":8,"column":43,"offset":362},"indent":[]}},{"type":"text","value":" field to look for the presence of an X-CSRF-Token header. The ","position":{"start":{"line":8,"column":43,"offset":362},"end":{"line":8,"column":106,"offset":425},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":8,"column":106,"offset":425},"end":{"line":8,"column":115,"offset":434},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":8,"column":115,"offset":434},"end":{"line":8,"column":116,"offset":435},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/functions#transformation-functions","children":[{"type":"text","value":"transformation function","position":{"start":{"line":8,"column":117,"offset":436},"end":{"line":8,"column":140,"offset":459},"indent":[]}}],"position":{"start":{"line":8,"column":116,"offset":435},"end":{"line":8,"column":241,"offset":560},"indent":[]}},{"type":"text","value":" converts the value to lowercase so that the expression is case insensitive.","position":{"start":{"line":8,"column":241,"offset":560},"end":{"line":8,"column":317,"offset":636},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":320},"end":{"line":8,"column":317,"offset":636},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When the X-CSRF-Token header is missing, Cloudflare blocks the request:","position":{"start":{"line":10,"column":1,"offset":638},"end":{"line":10,"column":72,"offset":709},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":638},"end":{"line":10,"column":72,"offset":709},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>not any(lower(http.request.headers.names[*])[*] contains \"x-csrf-token\") and (http.request.full_uri eq \"https://www.example.com/somepath\")</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":12,"column":1,"offset":711},"end":{"line":25,"column":9,"offset":1044},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":28,"column":65,"offset":1111}}}}},{"node":{"fields":{"slug":"/recipes/stop-rudy-attacks"},"frontmatter":{"order":null,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Stop R-U-Dead-Yet? (R.U.D.Y.) attacks"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Stop R-U-Dead-Yet? (R.U.D.Y.) attacks","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":40,"offset":40},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":40,"offset":40},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"R-U-Dead-Yet (R.U.D.Y.) attacks accomplish denial of service (DoS) by submitting long form fields. Use Firewall Rules to stop these attacks by blocking requests that do not have a legitimate session cookie.","position":{"start":{"line":4,"column":1,"offset":42},"end":{"line":4,"column":207,"offset":248},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":42},"end":{"line":4,"column":207,"offset":248},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example combines three expressions to target HTTP POST requests that do not contain a legitimate authenticated session cookie.","position":{"start":{"line":6,"column":1,"offset":250},"end":{"line":6,"column":132,"offset":381},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":250},"end":{"line":6,"column":132,"offset":381},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The first expression uses the ","position":{"start":{"line":8,"column":1,"offset":383},"end":{"line":8,"column":31,"offset":413},"indent":[]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":8,"column":31,"offset":413},"end":{"line":8,"column":54,"offset":436},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":8,"column":54,"offset":436},"end":{"line":8,"column":55,"offset":437},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/fields#standard-fields","children":[{"type":"text","value":"field","position":{"start":{"line":8,"column":56,"offset":438},"end":{"line":8,"column":61,"offset":443},"indent":[]}}],"position":{"start":{"line":8,"column":55,"offset":437},"end":{"line":8,"column":150,"offset":532},"indent":[]}},{"type":"text","value":" to target the paths to secure from R.U.D.Y.:","position":{"start":{"line":8,"column":150,"offset":532},"end":{"line":8,"column":195,"offset":577},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":383},"end":{"line":8,"column":195,"offset":577},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"http.request.uri.path matches \"(comment|conversation|event|poll)/create\"","position":{"start":{"line":10,"column":1,"offset":579},"end":{"line":12,"column":4,"offset":663},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The second uses a regular expression to match the format of a legitimate ","position":{"start":{"line":14,"column":1,"offset":665},"end":{"line":14,"column":74,"offset":738},"indent":[]}},{"type":"inlineCode","value":"auth_session","position":{"start":{"line":14,"column":74,"offset":738},"end":{"line":14,"column":88,"offset":752},"indent":[]}},{"type":"text","value":" cookie. The ","position":{"start":{"line":14,"column":88,"offset":752},"end":{"line":14,"column":101,"offset":765},"indent":[]}},{"type":"inlineCode","value":"not","position":{"start":{"line":14,"column":101,"offset":765},"end":{"line":14,"column":106,"offset":770},"indent":[]}},{"type":"text","value":" operator targets requests where that cookie is not formatted correctly:","position":{"start":{"line":14,"column":106,"offset":770},"end":{"line":14,"column":178,"offset":842},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":665},"end":{"line":14,"column":178,"offset":842},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"not http.cookie matches \"auth_session=[0-9a-zA-Z]{32}-[0-9]{10}-[0-9a-z]{6}\"","position":{"start":{"line":16,"column":1,"offset":844},"end":{"line":18,"column":4,"offset":932},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The third expression targets HTTP POST requests:","position":{"start":{"line":20,"column":1,"offset":934},"end":{"line":20,"column":49,"offset":982},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":934},"end":{"line":20,"column":49,"offset":982},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"http.request.method eq \"POST\"","position":{"start":{"line":22,"column":1,"offset":984},"end":{"line":24,"column":4,"offset":1025},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The expressions are combined using the ","position":{"start":{"line":26,"column":1,"offset":1027},"end":{"line":26,"column":40,"offset":1066},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":26,"column":40,"offset":1066},"end":{"line":26,"column":45,"offset":1071},"indent":[]}},{"type":"text","value":" operator. When an HTTP POST request to any of the specified URIs does not contain a properly formatted ","position":{"start":{"line":26,"column":45,"offset":1071},"end":{"line":26,"column":149,"offset":1175},"indent":[]}},{"type":"inlineCode","value":"auth_session","position":{"start":{"line":26,"column":149,"offset":1175},"end":{"line":26,"column":163,"offset":1189},"indent":[]}},{"type":"text","value":" cookie, Cloudflare blocks the request:","position":{"start":{"line":26,"column":163,"offset":1189},"end":{"line":26,"column":202,"offset":1228},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1027},"end":{"line":26,"column":202,"offset":1228},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n  <tr>\n    <th>Expression</th>\n    <th>Action</th>\n  </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>http.request.method eq \"POST\" and http.request.uri.path matches \"(comment|conversation|event poll)create\" and not http.cookie matches \"auth_session=[0-9a-zA-Z]{32}-[0-9]{10}-[0-9a-z]{6}\"</code></td>\n      <td><em>Block</em></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":28,"column":1,"offset":1230},"end":{"line":41,"column":9,"offset":1611},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":44,"column":65,"offset":1678}}}}},{"node":{"fields":{"slug":"/known-issues-and-faq"},"frontmatter":{"order":null,"title":"FAQ","summary":null,"demo":null,"tags":null},"headings":[{"value":"Firewall Rules FAQ"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Firewall Rules FAQ","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":21,"offset":21},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"How many rules can I have on my site?","position":{"start":{"line":4,"column":4,"offset":26},"end":{"line":4,"column":41,"offset":63},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":41,"offset":63},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can create a large number of rules. However, the number of active rules at any given time is limited. Refer to ","position":{"start":{"line":6,"column":1,"offset":65},"end":{"line":6,"column":116,"offset":180},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/#entitlements","children":[{"type":"text","value":"Entitlements","position":{"start":{"line":6,"column":117,"offset":181},"end":{"line":6,"column":129,"offset":193},"indent":[]}}],"position":{"start":{"line":6,"column":116,"offset":180},"end":{"line":6,"column":164,"offset":228},"indent":[]}},{"type":"text","value":" for details on what is allowed per customer plan.","position":{"start":{"line":6,"column":164,"offset":228},"end":{"line":6,"column":214,"offset":278},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":65},"end":{"line":6,"column":214,"offset":278},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Can I purchase additional active rules?","position":{"start":{"line":8,"column":4,"offset":283},"end":{"line":8,"column":43,"offset":322},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":280},"end":{"line":8,"column":43,"offset":322},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"No. The number of active rules is fixed based on customer plan. Refer to ","position":{"start":{"line":10,"column":1,"offset":324},"end":{"line":10,"column":74,"offset":397},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/#entitlements","children":[{"type":"text","value":"Entitlements","position":{"start":{"line":10,"column":75,"offset":398},"end":{"line":10,"column":87,"offset":410},"indent":[]}}],"position":{"start":{"line":10,"column":74,"offset":397},"end":{"line":10,"column":122,"offset":445},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":10,"column":122,"offset":445},"end":{"line":10,"column":123,"offset":446},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":324},"end":{"line":10,"column":123,"offset":446},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"How are certain special and escaped characters handled?","position":{"start":{"line":12,"column":4,"offset":451},"end":{"line":12,"column":59,"offset":506},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":448},"end":{"line":12,"column":59,"offset":506},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When used as literals in an expression, the backslash ","position":{"start":{"line":14,"column":1,"offset":508},"end":{"line":14,"column":55,"offset":562},"indent":[]}},{"type":"inlineCode","value":"\\","position":{"start":{"line":14,"column":55,"offset":562},"end":{"line":14,"column":58,"offset":565},"indent":[]}},{"type":"text","value":" and double quote ","position":{"start":{"line":14,"column":58,"offset":565},"end":{"line":14,"column":76,"offset":583},"indent":[]}},{"type":"inlineCode","value":"\"","position":{"start":{"line":14,"column":76,"offset":583},"end":{"line":14,"column":79,"offset":586},"indent":[]}},{"type":"text","value":" characters require proper escaping.","position":{"start":{"line":14,"column":79,"offset":586},"end":{"line":14,"column":115,"offset":622},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":508},"end":{"line":14,"column":115,"offset":622},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"An expression built using the ","position":{"start":{"line":16,"column":1,"offset":624},"end":{"line":16,"column":31,"offset":654},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Visual Expression Editor","position":{"start":{"line":16,"column":33,"offset":656},"end":{"line":16,"column":57,"offset":680},"indent":[]}}],"position":{"start":{"line":16,"column":31,"offset":654},"end":{"line":16,"column":59,"offset":682},"indent":[]}},{"type":"text","value":" does not require you to manually escape those special characters. Conveniently, the ","position":{"start":{"line":16,"column":59,"offset":682},"end":{"line":16,"column":144,"offset":767},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":16,"column":146,"offset":769},"end":{"line":16,"column":164,"offset":787},"indent":[]}}],"position":{"start":{"line":16,"column":144,"offset":767},"end":{"line":16,"column":166,"offset":789},"indent":[]}},{"type":"text","value":" takes care of any necessary escaping in the final expression by automatically prepending a backslash such that ","position":{"start":{"line":16,"column":166,"offset":789},"end":{"line":16,"column":278,"offset":901},"indent":[]}},{"type":"inlineCode","value":"\\","position":{"start":{"line":16,"column":278,"offset":901},"end":{"line":16,"column":281,"offset":904},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":16,"column":281,"offset":904},"end":{"line":16,"column":286,"offset":909},"indent":[]}},{"type":"inlineCode","value":"\"","position":{"start":{"line":16,"column":286,"offset":909},"end":{"line":16,"column":289,"offset":912},"indent":[]}},{"type":"text","value":" become ","position":{"start":{"line":16,"column":289,"offset":912},"end":{"line":16,"column":297,"offset":920},"indent":[]}},{"type":"inlineCode","value":"\\\\","position":{"start":{"line":16,"column":297,"offset":920},"end":{"line":16,"column":301,"offset":924},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":16,"column":301,"offset":924},"end":{"line":16,"column":306,"offset":929},"indent":[]}},{"type":"inlineCode","value":"\\\"","position":{"start":{"line":16,"column":306,"offset":929},"end":{"line":16,"column":310,"offset":933},"indent":[]}},{"type":"text","value":", respectively.","position":{"start":{"line":16,"column":310,"offset":933},"end":{"line":16,"column":325,"offset":948},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":624},"end":{"line":16,"column":325,"offset":948},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The following image illustrates how double quotes are automatically escaped to ","position":{"start":{"line":18,"column":1,"offset":950},"end":{"line":18,"column":80,"offset":1029},"indent":[]}},{"type":"inlineCode","value":"\\\"","position":{"start":{"line":18,"column":80,"offset":1029},"end":{"line":18,"column":84,"offset":1033},"indent":[]}},{"type":"text","value":" once they appear in the plain text expression generated in the ","position":{"start":{"line":18,"column":84,"offset":1033},"end":{"line":18,"column":148,"offset":1097},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":18,"column":150,"offset":1099},"end":{"line":18,"column":167,"offset":1116},"indent":[]}}],"position":{"start":{"line":18,"column":148,"offset":1097},"end":{"line":18,"column":169,"offset":1118},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":18,"column":169,"offset":1118},"end":{"line":18,"column":170,"offset":1119},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":950},"end":{"line":18,"column":170,"offset":1119},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/cf-firewall-rules-character-escaping-ann.png","alt":"Escaped characters","position":{"start":{"line":20,"column":1,"offset":1121},"end":{"line":20,"column":78,"offset":1198},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1121},"end":{"line":20,"column":78,"offset":1198},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Why isn't my regular expression pattern matching working?","position":{"start":{"line":22,"column":4,"offset":1203},"end":{"line":22,"column":61,"offset":1260},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1200},"end":{"line":22,"column":61,"offset":1260},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you are using a regular expression, we recommend you test it against a testing tool like ","position":{"start":{"line":24,"column":1,"offset":1262},"end":{"line":24,"column":93,"offset":1354},"indent":[]}},{"type":"link","title":null,"url":"https://regex101.com/?flavor=golang","children":[{"type":"text","value":"Regular Expressions 101","position":{"start":{"line":24,"column":94,"offset":1355},"end":{"line":24,"column":117,"offset":1378},"indent":[]}}],"position":{"start":{"line":24,"column":93,"offset":1354},"end":{"line":24,"column":155,"offset":1416},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":24,"column":155,"offset":1416},"end":{"line":24,"column":159,"offset":1420},"indent":[]}},{"type":"link","title":null,"url":"https://rustexp.lpil.uk","children":[{"type":"text","value":"Rustexp","position":{"start":{"line":24,"column":160,"offset":1421},"end":{"line":24,"column":167,"offset":1428},"indent":[]}}],"position":{"start":{"line":24,"column":159,"offset":1420},"end":{"line":24,"column":193,"offset":1454},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":24,"column":193,"offset":1454},"end":{"line":24,"column":194,"offset":1455},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1262},"end":{"line":24,"column":194,"offset":1455},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Also, note that ","position":{"start":{"line":26,"column":1,"offset":1457},"end":{"line":26,"column":17,"offset":1473},"indent":[]}},{"type":"inlineCode","value":"http.request.method","position":{"start":{"line":26,"column":17,"offset":1473},"end":{"line":26,"column":38,"offset":1494},"indent":[]}},{"type":"text","value":" fields requires all-caps for method names.","position":{"start":{"line":26,"column":38,"offset":1494},"end":{"line":26,"column":81,"offset":1537},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1457},"end":{"line":26,"column":81,"offset":1537},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"How can I use the Threat Score effectively?","position":{"start":{"line":28,"column":4,"offset":1542},"end":{"line":28,"column":47,"offset":1585},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1539},"end":{"line":28,"column":47,"offset":1585},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":30,"column":1,"offset":1587},"end":{"line":30,"column":5,"offset":1591},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Cloudflare Threat Score","position":{"start":{"line":30,"column":6,"offset":1592},"end":{"line":30,"column":29,"offset":1615},"indent":[]}}],"position":{"start":{"line":30,"column":5,"offset":1591},"end":{"line":30,"column":30,"offset":1616},"indent":[]}},{"type":"text","value":" is a key item behind the ","position":{"start":{"line":30,"column":30,"offset":1616},"end":{"line":30,"column":56,"offset":1642},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Security Level","position":{"start":{"line":30,"column":58,"offset":1644},"end":{"line":30,"column":72,"offset":1658},"indent":[]}}],"position":{"start":{"line":30,"column":56,"offset":1642},"end":{"line":30,"column":74,"offset":1660},"indent":[]}},{"type":"text","value":" functionality in the Cloudflare dashboard.","position":{"start":{"line":30,"column":74,"offset":1660},"end":{"line":30,"column":117,"offset":1703},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1587},"end":{"line":30,"column":117,"offset":1703},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Threat Score","position":{"start":{"line":32,"column":2,"offset":1706},"end":{"line":32,"column":14,"offset":1718},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1705},"end":{"line":32,"column":15,"offset":1719},"indent":[]}},{"type":"text","value":" as configured by ","position":{"start":{"line":32,"column":15,"offset":1719},"end":{"line":32,"column":33,"offset":1737},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Security Level","position":{"start":{"line":32,"column":35,"offset":1739},"end":{"line":32,"column":49,"offset":1753},"indent":[]}}],"position":{"start":{"line":32,"column":33,"offset":1737},"end":{"line":32,"column":51,"offset":1755},"indent":[]}},{"type":"text","value":" is based on:","position":{"start":{"line":32,"column":51,"offset":1755},"end":{"line":32,"column":64,"offset":1768},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1705},"end":{"line":32,"column":64,"offset":1768},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"High - for scores greater than 0","position":{"start":{"line":34,"column":3,"offset":1772},"end":{"line":34,"column":35,"offset":1804},"indent":[]}}],"position":{"start":{"line":34,"column":3,"offset":1772},"end":{"line":34,"column":35,"offset":1804},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1770},"end":{"line":34,"column":35,"offset":1804},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Medium - for scores greater than 14","position":{"start":{"line":35,"column":3,"offset":1807},"end":{"line":35,"column":38,"offset":1842},"indent":[]}}],"position":{"start":{"line":35,"column":3,"offset":1807},"end":{"line":35,"column":38,"offset":1842},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1805},"end":{"line":35,"column":38,"offset":1842},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Low - for scores greater than 24","position":{"start":{"line":36,"column":3,"offset":1845},"end":{"line":36,"column":35,"offset":1877},"indent":[]}}],"position":{"start":{"line":36,"column":3,"offset":1845},"end":{"line":36,"column":35,"offset":1877},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1843},"end":{"line":36,"column":35,"offset":1877},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Essentially off - for scores greater than 49","position":{"start":{"line":37,"column":3,"offset":1880},"end":{"line":37,"column":47,"offset":1924},"indent":[]}}],"position":{"start":{"line":37,"column":3,"offset":1880},"end":{"line":37,"column":47,"offset":1924},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1878},"end":{"line":37,"column":47,"offset":1924},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1770},"end":{"line":37,"column":47,"offset":1924},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Enabling a high threat score for sensitive areas, like comment form pages or login forms, can add an effective level of protection. Integrating ","position":{"start":{"line":39,"column":1,"offset":1926},"end":{"line":39,"column":145,"offset":2070},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Threat Score","position":{"start":{"line":39,"column":146,"offset":2071},"end":{"line":39,"column":158,"offset":2083},"indent":[]}}],"position":{"start":{"line":39,"column":145,"offset":2070},"end":{"line":39,"column":159,"offset":2084},"indent":[]}},{"type":"text","value":" with Firewall Rules is advantageous because you can specify a Captcha vs. a JS Challenge, or even a block. You can also exclude IP addresses using ","position":{"start":{"line":39,"column":159,"offset":2084},"end":{"line":39,"column":307,"offset":2232},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"and not","position":{"start":{"line":39,"column":308,"offset":2233},"end":{"line":39,"column":315,"offset":2240},"indent":[]}}],"position":{"start":{"line":39,"column":307,"offset":2232},"end":{"line":39,"column":316,"offset":2241},"indent":[]}},{"type":"text","value":" logic.","position":{"start":{"line":39,"column":316,"offset":2241},"end":{"line":39,"column":323,"offset":2248},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":1926},"end":{"line":39,"column":323,"offset":2248},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"How does Firewall Rules handle traffic from known bots?","position":{"start":{"line":41,"column":4,"offset":2253},"end":{"line":41,"column":59,"offset":2308},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2250},"end":{"line":41,"column":59,"offset":2308},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Caution about potentially blocking bots","position":{"start":{"line":43,"column":5,"offset":2314},"end":{"line":43,"column":44,"offset":2353},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":2310},"end":{"line":43,"column":44,"offset":2353},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you create a Firewall rule with a ","position":{"start":{"line":45,"column":1,"offset":2355},"end":{"line":45,"column":40,"offset":2394},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":45,"column":41,"offset":2395},"end":{"line":45,"column":46,"offset":2400},"indent":[]}}],"position":{"start":{"line":45,"column":40,"offset":2394},"end":{"line":45,"column":47,"offset":2401},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":45,"column":47,"offset":2401},"end":{"line":45,"column":49,"offset":2403},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":45,"column":50,"offset":2404},"end":{"line":45,"column":64,"offset":2418},"indent":[]}}],"position":{"start":{"line":45,"column":49,"offset":2403},"end":{"line":45,"column":65,"offset":2419},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":45,"column":65,"offset":2419},"end":{"line":45,"column":67,"offset":2421},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"JS Challenge","position":{"start":{"line":45,"column":68,"offset":2422},"end":{"line":45,"column":80,"offset":2434},"indent":[]}}],"position":{"start":{"line":45,"column":67,"offset":2421},"end":{"line":45,"column":81,"offset":2435},"indent":[]}},{"type":"text","value":", or ","position":{"start":{"line":45,"column":81,"offset":2435},"end":{"line":45,"column":86,"offset":2440},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Managed Challenge (Recommended)","position":{"start":{"line":45,"column":87,"offset":2441},"end":{"line":45,"column":118,"offset":2472},"indent":[]}}],"position":{"start":{"line":45,"column":86,"offset":2440},"end":{"line":45,"column":119,"offset":2473},"indent":[]}},{"type":"text","value":" action, you might unintentionally block traffic from known bots. Specifically, this might affect search engine optimization (SEO) and website monitoring when trying to enforce a mitigation action based on URI, path, host, ASN, or country.","position":{"start":{"line":45,"column":119,"offset":2473},"end":{"line":45,"column":358,"offset":2712},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":2355},"end":{"line":45,"column":358,"offset":2712},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Refer to ","position":{"start":{"line":47,"column":1,"offset":2714},"end":{"line":47,"column":10,"offset":2723},"indent":[]}},{"type":"link","title":null,"url":"#how-do-i-create-an-exception-to-exclude-certain-requests-from-being-blocked-or-challenged","children":[{"type":"text","value":"How do I create an exception to exclude certain requests from being blocked or challenged?","position":{"start":{"line":47,"column":11,"offset":2724},"end":{"line":47,"column":101,"offset":2814},"indent":[]}}],"position":{"start":{"line":47,"column":10,"offset":2723},"end":{"line":47,"column":194,"offset":2907},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":47,"column":194,"offset":2907},"end":{"line":47,"column":195,"offset":2908},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":2714},"end":{"line":47,"column":195,"offset":2908},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Bots currently detected","position":{"start":{"line":49,"column":5,"offset":2914},"end":{"line":49,"column":28,"offset":2937},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":2910},"end":{"line":49,"column":28,"offset":2937},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The table below lists a ","position":{"start":{"line":51,"column":1,"offset":2939},"end":{"line":51,"column":25,"offset":2963},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"sample","position":{"start":{"line":51,"column":27,"offset":2965},"end":{"line":51,"column":33,"offset":2971},"indent":[]}}],"position":{"start":{"line":51,"column":25,"offset":2963},"end":{"line":51,"column":35,"offset":2973},"indent":[]}},{"type":"text","value":" of known bots that Firewall Rules currently detects. When traffic comes from these bots and others not listed, the ","position":{"start":{"line":51,"column":35,"offset":2973},"end":{"line":51,"column":151,"offset":3089},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"cf.client.bot","position":{"start":{"line":51,"column":152,"offset":3090},"end":{"line":51,"column":165,"offset":3103},"indent":[]}}],"position":{"start":{"line":51,"column":151,"offset":3089},"end":{"line":51,"column":166,"offset":3104},"indent":[]}},{"type":"text","value":" field is set to true.","position":{"start":{"line":51,"column":166,"offset":3104},"end":{"line":51,"column":188,"offset":3126},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":2939},"end":{"line":51,"column":188,"offset":3126},"indent":[]}},{"type":"html","value":"<TableWrap>\n<table style=\"width: 100%\">\n    <thead>\n        <tr>\n            <th>Bot</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>\n                <p>ahrefs</p>\n            </td>\n            <td>\n                <p>Ahrefs SEO bot</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>apple</p>\n            </td>\n            <td>\n                <p>Applebot is the web crawler for Apple, for products like Siri and Spotlight Suggestions</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>archive.org</p>\n            </td>\n            <td>\n                <p>Archive.org bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>baidu</p>\n            </td>\n            <td>\n                <p>Baidu search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>better uptime</p>\n            </td>\n            <td>\n                <p>Bot for monitoring website uptime</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>bing</p>\n            </td>\n            <td>\n                <p>Bing search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>feedbin</p>\n            </td>\n            <td>\n                <p>Feedbin.com bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>google</p>\n            </td>\n            <td>\n                <p>Google search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>grapeshot</p>\n            </td>\n            <td>\n                <p>Grapeshot (Oracle) SEO bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>linkedin</p>\n            </td>\n            <td>\n                <p>LinkedIn bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>mail.ru</p>\n            </td>\n            <td>\n                <p>Mail.ru bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>naver</p>\n            </td>\n            <td>\n                <p>Naver (South Korean) search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>pingdom</p>\n            </td>\n            <td>\n                <p>Pingdom.com monitoring bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>pinterest</p>\n            </td>\n            <td>\n                <p>Pinterest bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>seznam</p>\n            </td>\n            <td>\n                <p>Seznam search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>sogou</p>\n            </td>\n            <td>\n                <p>Sogou search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>uptimerobot</p>\n            </td>\n            <td>\n                <p>Uptime Robot monitoring bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>yahoo</p>\n            </td>\n            <td>\n                <p>Yahoo! search engine bots</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>yandex</p>\n            </td>\n            <td>\n                <p>Yandex search engine bots</p>\n            </td>\n        </tr>\n    </tbody>\n</table>\n</TableWrap>","position":{"start":{"line":53,"column":1,"offset":3128},"end":{"line":216,"column":13,"offset":6711},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"How do I create an exception to exclude certain requests from being blocked or challenged?","position":{"start":{"line":218,"column":4,"offset":6716},"end":{"line":218,"column":94,"offset":6806},"indent":[]}}],"position":{"start":{"line":218,"column":1,"offset":6713},"end":{"line":218,"column":94,"offset":6806},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"There may be situations in which you want to enforce a blocking or challenging action but make exceptions for specific types of requests.","position":{"start":{"line":220,"column":1,"offset":6808},"end":{"line":220,"column":138,"offset":6945},"indent":[]}}],"position":{"start":{"line":220,"column":1,"offset":6808},"end":{"line":220,"column":138,"offset":6945},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare supports two methods to permit requests through Firewall Rules expressions:","position":{"start":{"line":222,"column":1,"offset":6947},"end":{"line":222,"column":87,"offset":7033},"indent":[]}}],"position":{"start":{"line":222,"column":1,"offset":6947},"end":{"line":222,"column":87,"offset":7033},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Exclude a type of request from being blocked or challenged, for example based on IP address, ASN, or country","position":{"start":{"line":224,"column":4,"offset":7038},"end":{"line":224,"column":112,"offset":7146},"indent":[]}}],"position":{"start":{"line":224,"column":4,"offset":7038},"end":{"line":224,"column":112,"offset":7146},"indent":[]}}],"position":{"start":{"line":224,"column":1,"offset":7035},"end":{"line":224,"column":112,"offset":7146},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create an independent Firewall rule with an ","position":{"start":{"line":225,"column":4,"offset":7150},"end":{"line":225,"column":48,"offset":7194},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Allow","position":{"start":{"line":225,"column":49,"offset":7195},"end":{"line":225,"column":54,"offset":7200},"indent":[]}}],"position":{"start":{"line":225,"column":48,"offset":7194},"end":{"line":225,"column":55,"offset":7201},"indent":[]}},{"type":"text","value":" action","position":{"start":{"line":225,"column":55,"offset":7201},"end":{"line":225,"column":62,"offset":7208},"indent":[]}}],"position":{"start":{"line":225,"column":4,"offset":7150},"end":{"line":225,"column":62,"offset":7208},"indent":[]}}],"position":{"start":{"line":225,"column":1,"offset":7147},"end":{"line":225,"column":62,"offset":7208},"indent":[]}}],"position":{"start":{"line":224,"column":1,"offset":7035},"end":{"line":225,"column":62,"offset":7208},"indent":[1]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":227,"column":1,"offset":7210},"end":{"line":227,"column":34,"offset":7243},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Firewall Rules does not bypass security measures defined in other ","position":{"start":{"line":229,"column":1,"offset":7245},"end":{"line":229,"column":78,"offset":7322},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":229,"column":80,"offset":7324},"end":{"line":229,"column":88,"offset":7332},"indent":[]}}],"position":{"start":{"line":229,"column":78,"offset":7322},"end":{"line":229,"column":90,"offset":7334},"indent":[]}},{"type":"text","value":" app features.","position":{"start":{"line":229,"column":90,"offset":7334},"end":{"line":229,"column":104,"offset":7348},"indent":[]}}],"position":{"start":{"line":229,"column":1,"offset":7245},"end":{"line":229,"column":104,"offset":7348},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":231,"column":1,"offset":7350},"end":{"line":231,"column":9,"offset":7358},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you wish to permit certain exclusions, the examples below illustrate a few possible approaches.","position":{"start":{"line":233,"column":1,"offset":7360},"end":{"line":233,"column":99,"offset":7458},"indent":[]}}],"position":{"start":{"line":233,"column":1,"offset":7360},"end":{"line":233,"column":99,"offset":7458},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Example 1","position":{"start":{"line":235,"column":5,"offset":7464},"end":{"line":235,"column":14,"offset":7473},"indent":[]}}],"position":{"start":{"line":235,"column":1,"offset":7460},"end":{"line":235,"column":14,"offset":7473},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Exclude multiple IP addresses from a blocking/challenging rule that assesses Threat Score","position":{"start":{"line":237,"column":1,"offset":7475},"end":{"line":237,"column":90,"offset":7564},"indent":[]}}],"position":{"start":{"line":237,"column":1,"offset":7475},"end":{"line":237,"column":90,"offset":7564},"indent":[]}},{"type":"html","value":"<TableWrap>\n<table style=\"width: 100%\">\n  <tbody>\n    <tr>\n      <td colspan=\"2\">\n        <strong>Basic rule, with no <em>exclusion</em></strong>\n      </td>\n    </tr>\n    <tr>\n      <td>Action</td>\n      <td><em>block (or challenge)</em></td>\n    </tr>\n    <tr>\n      <td>Expression</td>\n      <td><em>(http.host eq \"example.com\" and cf.threat_score &gt; 5)</em></td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <strong\n          >Rule that excludes IP addresses from being blocked/challenged</strong\n        >\n      </td>\n    </tr>\n    <tr>\n      <td>Action</td>\n      <td><em>block (or challenge)</em></td>\n    </tr>\n    <tr>\n      <td>Expression</td>\n      <td>\n        <em\n          >(http.host eq \"example.com\" and cf.threat_score &gt; 5) and not\n          (ip.src in {'{192.0.2.1 198.51.100.42 203.0.113.0/24}'})</em\n        >\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <strong>Two rules to allow exceptions and block the rest</strong>\n      </td>\n    </tr>\n    <tr>\n      <td>Rule 1</td>\n      <td>\n        Action: <em>allow</em><br />\n        Expression: <em>ip.src in {'{192.0.2.1 198.51.100.42 203.0.113.0/24}'}</em>\n      </td>\n    </tr>\n    <tr>\n      <td>Rule 2</td>\n      <td>\n        Action: <em>block (or challenge)</em><br />\n        <em>(http.host eq \"example.com\" and cf.threat_score &gt; 5)</em>\n      </td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":239,"column":1,"offset":7566},"end":{"line":295,"column":9,"offset":8949},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"</TableWrap>","position":{"start":{"line":297,"column":1,"offset":8951},"end":{"line":297,"column":13,"offset":8963},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Example 2","position":{"start":{"line":299,"column":5,"offset":8969},"end":{"line":299,"column":14,"offset":8978},"indent":[]}}],"position":{"start":{"line":299,"column":1,"offset":8965},"end":{"line":299,"column":14,"offset":8978},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Block Amazon Web Services (AWS) and Google Cloud Platform (GCP) because of large volumes of undesired traffic, but allow Googlebot and other known bots that Cloudflare validates","position":{"start":{"line":301,"column":1,"offset":8980},"end":{"line":301,"column":178,"offset":9157},"indent":[]}}],"position":{"start":{"line":301,"column":1,"offset":8980},"end":{"line":301,"column":178,"offset":9157},"indent":[]}},{"type":"html","value":"<TableWrap>\n<table style=\"width: 100%\">\n  <tbody>\n    <tr>\n      <td colspan=\"2\">\n        <strong>Basic rule, with no <em>exclusion</em></strong>\n      </td>\n    </tr>\n    <tr>\n      <td>Action</td>\n      <td><em>block (or challenge)</em></td>\n    </tr>\n    <tr>\n      <td>Expression</td>\n      <td><em>(ip.geoip.asnum in {'{7224 15169}'})</em></td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <strong>Rule that excludes known bots that Cloudflare validates</strong>\n      </td>\n    </tr>\n    <tr>\n      <td>Action</td>\n      <td><em>block (or challenge)</em></td>\n    </tr>\n    <tr>\n      <td>Expression</td>\n      <td>\n        <em>(ip.geoip.asnum in {'{7224 15169}'}) and not cf.client.bot)</em>\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <strong\n          ><strong\n            >Two rules to allow exceptions and block the rest</strong\n          ></strong\n        >\n      </td>\n    </tr>\n    <tr>\n      <td>Rule 1</td>\n      <td>\n        Action: <em>allow</em><br />\n        Expression: <em>cf.client.bot</em>\n      </td>\n    </tr>\n    <tr>\n      <td>Rule 2</td>\n      <td>\n        Action: <em>block (or challenge)</em><br />\n        Expression: <em>(ip.geoip.asnum in {'{7224 15169}'})</em>\n      </td>\n    </tr>\n  </tbody>\n</table>\n</TableWrap>","position":{"start":{"line":303,"column":1,"offset":9159},"end":{"line":359,"column":13,"offset":10432},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Why does a Firewall Event display a Cloudflare IP address even though other fields match the client details?","position":{"start":{"line":361,"column":4,"offset":10437},"end":{"line":361,"column":112,"offset":10545},"indent":[]}}],"position":{"start":{"line":361,"column":1,"offset":10434},"end":{"line":361,"column":112,"offset":10545},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This happens when a request goes through a Cloudflare Worker.","position":{"start":{"line":363,"column":1,"offset":10547},"end":{"line":363,"column":62,"offset":10608},"indent":[]}}],"position":{"start":{"line":363,"column":1,"offset":10547},"end":{"line":363,"column":62,"offset":10608},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In this case, Cloudflare considers the client details, including its IP address, for triggering security settings. However, the IP displayed in the Firewall Events will be a Cloudflare IP address.","position":{"start":{"line":365,"column":1,"offset":10610},"end":{"line":365,"column":197,"offset":10806},"indent":[]}}],"position":{"start":{"line":365,"column":1,"offset":10610},"end":{"line":365,"column":197,"offset":10806},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Do the Challenge actions support content types other than HTML (for example, AJAX or XHR requests)?","position":{"start":{"line":367,"column":4,"offset":10811},"end":{"line":367,"column":103,"offset":10910},"indent":[]}}],"position":{"start":{"line":367,"column":1,"offset":10808},"end":{"line":367,"column":103,"offset":10910},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"No. The ","position":{"start":{"line":369,"column":1,"offset":10912},"end":{"line":369,"column":9,"offset":10920},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":369,"column":10,"offset":10921},"end":{"line":369,"column":24,"offset":10935},"indent":[]}}],"position":{"start":{"line":369,"column":9,"offset":10920},"end":{"line":369,"column":25,"offset":10936},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":369,"column":25,"offset":10936},"end":{"line":369,"column":30,"offset":10941},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"JS Challenge","position":{"start":{"line":369,"column":31,"offset":10942},"end":{"line":369,"column":43,"offset":10954},"indent":[]}}],"position":{"start":{"line":369,"column":30,"offset":10941},"end":{"line":369,"column":44,"offset":10955},"indent":[]}},{"type":"text","value":" actions only support HTML requests.","position":{"start":{"line":369,"column":44,"offset":10955},"end":{"line":369,"column":80,"offset":10991},"indent":[]}}],"position":{"start":{"line":369,"column":1,"offset":10912},"end":{"line":369,"column":80,"offset":10991},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Challenges presented to users display an intermediate page where they must prove they are not a bot. This concept does not work over XHR or AJAX.","position":{"start":{"line":371,"column":1,"offset":10993},"end":{"line":371,"column":146,"offset":11138},"indent":[]}}],"position":{"start":{"line":371,"column":1,"offset":10993},"end":{"line":371,"column":146,"offset":11138},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When an XHR or AJAX request triggers one of the ","position":{"start":{"line":373,"column":1,"offset":11140},"end":{"line":373,"column":49,"offset":11188},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":373,"column":50,"offset":11189},"end":{"line":373,"column":64,"offset":11203},"indent":[]}}],"position":{"start":{"line":373,"column":49,"offset":11188},"end":{"line":373,"column":65,"offset":11204},"indent":[]}},{"type":"text","value":" actions, the resulting request will have the following status code:","position":{"start":{"line":373,"column":65,"offset":11204},"end":{"line":373,"column":133,"offset":11272},"indent":[]}}],"position":{"start":{"line":373,"column":1,"offset":11140},"end":{"line":373,"column":133,"offset":11272},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"HTTP status code 403 for ","position":{"start":{"line":375,"column":3,"offset":11276},"end":{"line":375,"column":28,"offset":11301},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":375,"column":29,"offset":11302},"end":{"line":375,"column":43,"offset":11316},"indent":[]}}],"position":{"start":{"line":375,"column":28,"offset":11301},"end":{"line":375,"column":44,"offset":11317},"indent":[]}}],"position":{"start":{"line":375,"column":3,"offset":11276},"end":{"line":375,"column":44,"offset":11317},"indent":[]}}],"position":{"start":{"line":375,"column":1,"offset":11274},"end":{"line":375,"column":44,"offset":11317},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"HTTP status code 503 for ","position":{"start":{"line":376,"column":3,"offset":11320},"end":{"line":376,"column":28,"offset":11345},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"JS Challenge","position":{"start":{"line":376,"column":29,"offset":11346},"end":{"line":376,"column":41,"offset":11358},"indent":[]}}],"position":{"start":{"line":376,"column":28,"offset":11345},"end":{"line":376,"column":42,"offset":11359},"indent":[]}}],"position":{"start":{"line":376,"column":3,"offset":11320},"end":{"line":376,"column":42,"offset":11359},"indent":[]}}],"position":{"start":{"line":376,"column":1,"offset":11318},"end":{"line":376,"column":42,"offset":11359},"indent":[]}}],"position":{"start":{"line":375,"column":1,"offset":11274},"end":{"line":376,"column":42,"offset":11359},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Your application can use these status codes to handle unexpected challenges.","position":{"start":{"line":378,"column":1,"offset":11361},"end":{"line":378,"column":77,"offset":11437},"indent":[]}}],"position":{"start":{"line":378,"column":1,"offset":11361},"end":{"line":378,"column":77,"offset":11437},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Does the 'challengeFailed' action accurately represent challenges that users did not pass?","position":{"start":{"line":380,"column":4,"offset":11442},"end":{"line":380,"column":94,"offset":11532},"indent":[]}}],"position":{"start":{"line":380,"column":1,"offset":11439},"end":{"line":380,"column":94,"offset":11532},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"No. The ","position":{"start":{"line":382,"column":1,"offset":11534},"end":{"line":382,"column":9,"offset":11542},"indent":[]}},{"type":"inlineCode","value":"challengeFailed","position":{"start":{"line":382,"column":9,"offset":11542},"end":{"line":382,"column":26,"offset":11559},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":382,"column":26,"offset":11559},"end":{"line":382,"column":31,"offset":11564},"indent":[]}},{"type":"inlineCode","value":"jschallengeFailed","position":{"start":{"line":382,"column":31,"offset":11564},"end":{"line":382,"column":50,"offset":11583},"indent":[]}},{"type":"text","value":" Firewall actions account for observed requests that, under special circumstances, did not pass a challenge. However, some failed challenges cannot be traced back to a Firewall rule. Additionally, the Firewall may not have a record of every request with a failed challenge.","position":{"start":{"line":382,"column":50,"offset":11583},"end":{"line":382,"column":323,"offset":11856},"indent":[]}}],"position":{"start":{"line":382,"column":1,"offset":11534},"end":{"line":382,"column":323,"offset":11856},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Therefore, consider these actions with caution. A reliable indicator is the ","position":{"start":{"line":384,"column":1,"offset":11858},"end":{"line":384,"column":77,"offset":11934},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules#challenge-solve-rate-csr","children":[{"type":"text","value":"CSR (Challenge Solve Rate)","position":{"start":{"line":384,"column":78,"offset":11935},"end":{"line":384,"column":104,"offset":11961},"indent":[]}}],"position":{"start":{"line":384,"column":77,"offset":11934},"end":{"line":384,"column":150,"offset":12007},"indent":[]}},{"type":"text","value":" displayed in ","position":{"start":{"line":384,"column":150,"offset":12007},"end":{"line":384,"column":164,"offset":12021},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":384,"column":166,"offset":12023},"end":{"line":384,"column":180,"offset":12037},"indent":[]}}],"position":{"start":{"line":384,"column":164,"offset":12021},"end":{"line":384,"column":182,"offset":12039},"indent":[]}},{"type":"text","value":", which is calculated as follows: ","position":{"start":{"line":384,"column":182,"offset":12039},"end":{"line":384,"column":216,"offset":12073},"indent":[]}},{"type":"inlineCode","value":"number of challenges solved / number of challenges issued","position":{"start":{"line":384,"column":216,"offset":12073},"end":{"line":384,"column":275,"offset":12132},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":384,"column":275,"offset":12132},"end":{"line":384,"column":276,"offset":12133},"indent":[]}}],"position":{"start":{"line":384,"column":1,"offset":11858},"end":{"line":384,"column":276,"offset":12133},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Why would I not find any failed challenges? Why is 'ChallengeIssued' not equal to 'ChallengeSolved' plus 'ChallengeFailed'?","position":{"start":{"line":386,"column":4,"offset":12138},"end":{"line":386,"column":127,"offset":12261},"indent":[]}}],"position":{"start":{"line":386,"column":1,"offset":12135},"end":{"line":386,"column":127,"offset":12261},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Users do not complete all challenges. Cloudflare issues challenges that are never answered — only 2-3% of all served challenges are usually answered.","position":{"start":{"line":388,"column":1,"offset":12263},"end":{"line":388,"column":150,"offset":12412},"indent":[]}}],"position":{"start":{"line":388,"column":1,"offset":12263},"end":{"line":388,"column":150,"offset":12412},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"There are multiple reasons for this:","position":{"start":{"line":390,"column":1,"offset":12414},"end":{"line":390,"column":37,"offset":12450},"indent":[]}}],"position":{"start":{"line":390,"column":1,"offset":12414},"end":{"line":390,"column":37,"offset":12450},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Users give up on a challenge.","position":{"start":{"line":392,"column":3,"offset":12454},"end":{"line":392,"column":32,"offset":12483},"indent":[]}}],"position":{"start":{"line":392,"column":3,"offset":12454},"end":{"line":392,"column":32,"offset":12483},"indent":[]}}],"position":{"start":{"line":392,"column":1,"offset":12452},"end":{"line":392,"column":32,"offset":12483},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Users try to solve a challenge but cannot provide an answer.","position":{"start":{"line":393,"column":3,"offset":12486},"end":{"line":393,"column":63,"offset":12546},"indent":[]}}],"position":{"start":{"line":393,"column":3,"offset":12486},"end":{"line":393,"column":63,"offset":12546},"indent":[]}}],"position":{"start":{"line":393,"column":1,"offset":12484},"end":{"line":393,"column":63,"offset":12546},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Users keep refreshing the challenge but never submit an answer.","position":{"start":{"line":394,"column":3,"offset":12549},"end":{"line":394,"column":66,"offset":12612},"indent":[]}}],"position":{"start":{"line":394,"column":3,"offset":12549},"end":{"line":394,"column":66,"offset":12612},"indent":[]}}],"position":{"start":{"line":394,"column":1,"offset":12547},"end":{"line":394,"column":66,"offset":12612},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Users keep retrying hCaptcha (CAPTCHA failures in hCaptcha are not registered as failed and represent interim failures).","position":{"start":{"line":395,"column":3,"offset":12615},"end":{"line":395,"column":123,"offset":12735},"indent":[]}}],"position":{"start":{"line":395,"column":3,"offset":12615},"end":{"line":395,"column":123,"offset":12735},"indent":[]}}],"position":{"start":{"line":395,"column":1,"offset":12613},"end":{"line":395,"column":123,"offset":12735},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Cloudflare receives a malformed challenge answer.","position":{"start":{"line":396,"column":3,"offset":12738},"end":{"line":396,"column":52,"offset":12787},"indent":[]}}],"position":{"start":{"line":396,"column":3,"offset":12738},"end":{"line":396,"column":52,"offset":12787},"indent":[]}}],"position":{"start":{"line":396,"column":1,"offset":12736},"end":{"line":396,"column":52,"offset":12787},"indent":[]}}],"position":{"start":{"line":392,"column":1,"offset":12452},"end":{"line":396,"column":52,"offset":12787},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Why do I have matches for a Firewall Rule that was not supposed to match the request?","position":{"start":{"line":398,"column":4,"offset":12792},"end":{"line":398,"column":89,"offset":12877},"indent":[]}}],"position":{"start":{"line":398,"column":1,"offset":12789},"end":{"line":398,"column":89,"offset":12877},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Make sure you are looking at the correct request.","position":{"start":{"line":400,"column":1,"offset":12879},"end":{"line":400,"column":50,"offset":12928},"indent":[]}}],"position":{"start":{"line":400,"column":1,"offset":12879},"end":{"line":400,"column":50,"offset":12928},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Only requests that triggered a challenge will match the request parameters of the rule. Subsequent requests with a ","position":{"start":{"line":402,"column":1,"offset":12930},"end":{"line":402,"column":116,"offset":13045},"indent":[]}},{"type":"inlineCode","value":"[js]challengeSolved","position":{"start":{"line":402,"column":116,"offset":13045},"end":{"line":402,"column":137,"offset":13066},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":402,"column":137,"offset":13066},"end":{"line":402,"column":141,"offset":13070},"indent":[]}},{"type":"inlineCode","value":"[js]challengeFailed","position":{"start":{"line":402,"column":141,"offset":13070},"end":{"line":402,"column":162,"offset":13091},"indent":[]}},{"type":"text","value":" action may not match the parameters of the rule — for example, the bot score may have changed because the user solved a CAPTCHA.","position":{"start":{"line":402,"column":162,"offset":13091},"end":{"line":402,"column":291,"offset":13220},"indent":[]}}],"position":{"start":{"line":402,"column":1,"offset":12930},"end":{"line":402,"column":291,"offset":13220},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The \"solved\" and \"failed\" actions are informative actions about a previous request that matched a rule. These actions state that \"previously a rule had matched a request with the action set to ","position":{"start":{"line":404,"column":1,"offset":13222},"end":{"line":404,"column":194,"offset":13415},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":404,"column":195,"offset":13416},"end":{"line":404,"column":209,"offset":13430},"indent":[]}}],"position":{"start":{"line":404,"column":194,"offset":13415},"end":{"line":404,"column":210,"offset":13431},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":404,"column":210,"offset":13431},"end":{"line":404,"column":214,"offset":13435},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"JS Challenge","position":{"start":{"line":404,"column":215,"offset":13436},"end":{"line":404,"column":227,"offset":13448},"indent":[]}}],"position":{"start":{"line":404,"column":214,"offset":13435},"end":{"line":404,"column":228,"offset":13449},"indent":[]}},{"type":"text","value":" and now that challenge was answered\".","position":{"start":{"line":404,"column":228,"offset":13449},"end":{"line":404,"column":266,"offset":13487},"indent":[]}}],"position":{"start":{"line":404,"column":1,"offset":13222},"end":{"line":404,"column":266,"offset":13487},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":407,"column":82,"offset":13571}}}}},{"node":{"fields":{"slug":"/cf-firewall-rules/order-priority"},"frontmatter":{"order":230,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Order and priority"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Order and priority","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":21,"offset":21},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":7,"column":4,"offset":217},"end":{"line":7,"column":12,"offset":225},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":214},"end":{"line":7,"column":12,"offset":225},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Firewall Rules is part of a larger evaluation chain for HTTP requests, as illustrated in the diagram below (click the image to view a larger version). For example, Firewall Rules only evaluates requests that first clear IP Access Rules. If a request is blocked by a rule at any stage in the chain, Cloudflare does not evaluate the request further.","position":{"start":{"line":9,"column":1,"offset":227},"end":{"line":9,"column":359,"offset":585},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":227},"end":{"line":9,"column":359,"offset":585},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-order-and-priority-1.png","alt":"Firewall Rules order and priority","position":{"start":{"line":11,"column":1,"offset":587},"end":{"line":11,"column":88,"offset":674},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":587},"end":{"line":11,"column":88,"offset":674},"indent":[]}},{"type":"html","value":"<Aside type=\"warning\" header=\"Important\">","position":{"start":{"line":13,"column":1,"offset":676},"end":{"line":13,"column":42,"offset":717},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The execution order diagram does not include products powered by the ","position":{"start":{"line":15,"column":3,"offset":721},"end":{"line":15,"column":72,"offset":790},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/","children":[{"type":"text","value":"Ruleset Engine","position":{"start":{"line":15,"column":73,"offset":791},"end":{"line":15,"column":87,"offset":805},"indent":[]}}],"position":{"start":{"line":15,"column":72,"offset":790},"end":{"line":15,"column":139,"offset":857},"indent":[]}},{"type":"text","value":" like the ","position":{"start":{"line":15,"column":139,"offset":857},"end":{"line":15,"column":149,"offset":867},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/waf/","children":[{"type":"text","value":"WAF","position":{"start":{"line":15,"column":150,"offset":868},"end":{"line":15,"column":153,"offset":871},"indent":[]}}],"position":{"start":{"line":15,"column":149,"offset":867},"end":{"line":15,"column":194,"offset":912},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":15,"column":194,"offset":912},"end":{"line":15,"column":198,"offset":916},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/rules/transform","children":[{"type":"text","value":"Transform Rules","position":{"start":{"line":15,"column":199,"offset":917},"end":{"line":15,"column":214,"offset":932},"indent":[]}}],"position":{"start":{"line":15,"column":198,"offset":916},"end":{"line":15,"column":266,"offset":984},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":15,"column":266,"offset":984},"end":{"line":15,"column":267,"offset":985},"indent":[]}}],"position":{"start":{"line":15,"column":3,"offset":721},"end":{"line":15,"column":267,"offset":985},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":719},"end":{"line":16,"column":1,"offset":986},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can use ","position":{"start":{"line":17,"column":3,"offset":989},"end":{"line":17,"column":15,"offset":1001},"indent":[]}},{"type":"link","title":null,"url":"https://support.cloudflare.com/hc/articles/217074967","children":[{"type":"text","value":"IP Access Rules","position":{"start":{"line":17,"column":16,"offset":1002},"end":{"line":17,"column":31,"offset":1017},"indent":[]}}],"position":{"start":{"line":17,"column":15,"offset":1001},"end":{"line":17,"column":86,"offset":1072},"indent":[]}},{"type":"text","value":" to allowlist requests under certain conditions, effectively excluding these requests from all security checks. However, allowing a given country code will not bypass the ","position":{"start":{"line":17,"column":86,"offset":1072},"end":{"line":17,"column":257,"offset":1243},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/waf/","children":[{"type":"text","value":"Cloudflare Web Application Firewall (WAF)","position":{"start":{"line":17,"column":258,"offset":1244},"end":{"line":17,"column":299,"offset":1285},"indent":[]}}],"position":{"start":{"line":17,"column":257,"offset":1243},"end":{"line":17,"column":340,"offset":1326},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":17,"column":340,"offset":1326},"end":{"line":17,"column":341,"offset":1327},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":989},"end":{"line":17,"column":341,"offset":1327},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":987},"end":{"line":17,"column":341,"offset":1327},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":719},"end":{"line":17,"column":341,"offset":1327},"indent":[1,1]}},{"type":"html","value":"</Aside>","position":{"start":{"line":19,"column":1,"offset":1329},"end":{"line":19,"column":9,"offset":1337},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"By default, Cloudflare evaluates Firewall Rules in ","position":{"start":{"line":21,"column":1,"offset":1339},"end":{"line":21,"column":52,"offset":1390},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"list order","position":{"start":{"line":21,"column":54,"offset":1392},"end":{"line":21,"column":64,"offset":1402},"indent":[]}}],"position":{"start":{"line":21,"column":52,"offset":1390},"end":{"line":21,"column":66,"offset":1404},"indent":[]}},{"type":"text","value":", where rules are evaluated in the order they appear in the Firewall Rules ","position":{"start":{"line":21,"column":66,"offset":1404},"end":{"line":21,"column":141,"offset":1479},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":21,"column":143,"offset":1481},"end":{"line":21,"column":153,"offset":1491},"indent":[]}}],"position":{"start":{"line":21,"column":141,"offset":1479},"end":{"line":21,"column":155,"offset":1493},"indent":[]}},{"type":"text","value":". List ordering is convenient when working with small numbers of rules because you can manage their order by dragging and dropping them into position. However, as the number of rules grows, managing rules in list order becomes difficult. This is where priority order comes into play.","position":{"start":{"line":21,"column":155,"offset":1493},"end":{"line":21,"column":438,"offset":1776},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":1339},"end":{"line":21,"column":438,"offset":1776},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When ","position":{"start":{"line":23,"column":1,"offset":1778},"end":{"line":23,"column":6,"offset":1783},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"priority ordering","position":{"start":{"line":23,"column":8,"offset":1785},"end":{"line":23,"column":25,"offset":1802},"indent":[]}}],"position":{"start":{"line":23,"column":6,"offset":1783},"end":{"line":23,"column":27,"offset":1804},"indent":[]}},{"type":"text","value":" is enabled, Cloudflare evaluates Firewall Rules in order of their ","position":{"start":{"line":23,"column":27,"offset":1804},"end":{"line":23,"column":94,"offset":1871},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"priority number","position":{"start":{"line":23,"column":96,"offset":1873},"end":{"line":23,"column":111,"offset":1888},"indent":[]}}],"position":{"start":{"line":23,"column":94,"offset":1871},"end":{"line":23,"column":113,"offset":1890},"indent":[]}},{"type":"text","value":", starting with the lowest. If a request matches two rules with the same priority, action precedence is used to resolve the tie. In this case, only the action of the rule with the highest precedence is executed, unless that action is ","position":{"start":{"line":23,"column":113,"offset":1890},"end":{"line":23,"column":347,"offset":2124},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":23,"column":348,"offset":2125},"end":{"line":23,"column":351,"offset":2128},"indent":[]}}],"position":{"start":{"line":23,"column":347,"offset":2124},"end":{"line":23,"column":352,"offset":2129},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":23,"column":352,"offset":2129},"end":{"line":23,"column":356,"offset":2133},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Bypass","position":{"start":{"line":23,"column":357,"offset":2134},"end":{"line":23,"column":363,"offset":2140},"indent":[]}}],"position":{"start":{"line":23,"column":356,"offset":2133},"end":{"line":23,"column":364,"offset":2141},"indent":[]}},{"type":"text","value":" (refer to ","position":{"start":{"line":23,"column":364,"offset":2141},"end":{"line":23,"column":375,"offset":2152},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/actions#supported-actions","children":[{"type":"text","value":"Firewall Rules actions","position":{"start":{"line":23,"column":376,"offset":2153},"end":{"line":23,"column":398,"offset":2175},"indent":[]}}],"position":{"start":{"line":23,"column":375,"offset":2152},"end":{"line":23,"column":445,"offset":2222},"indent":[]}},{"type":"text","value":" for details). Priority ordering makes it a lot easier to manage large numbers of Firewall Rules, and once the number of rules passes 200, Cloudflare requires it.","position":{"start":{"line":23,"column":445,"offset":2222},"end":{"line":23,"column":607,"offset":2384},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1778},"end":{"line":23,"column":607,"offset":2384},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Managing rule evaluation by list order","position":{"start":{"line":25,"column":4,"offset":2389},"end":{"line":25,"column":42,"offset":2427},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":2386},"end":{"line":25,"column":42,"offset":2427},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Users with relatively small numbers of Firewall Rules (no more than 200) will find that list ordering is enabled by default. When list ordering is enabled, the ","position":{"start":{"line":27,"column":1,"offset":2429},"end":{"line":27,"column":161,"offset":2589},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":27,"column":163,"offset":2591},"end":{"line":27,"column":173,"offset":2601},"indent":[]}}],"position":{"start":{"line":27,"column":161,"offset":2589},"end":{"line":27,"column":175,"offset":2603},"indent":[]}},{"type":"text","value":" allows you to drag and drop Firewall Rules into position, as shown below:","position":{"start":{"line":27,"column":175,"offset":2603},"end":{"line":27,"column":249,"offset":2677},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":2429},"end":{"line":27,"column":249,"offset":2677},"indent":[]}},{"type":"html","value":"<img src={firewallRulesOrderAndPriority2} />","position":{"start":{"line":29,"column":1,"offset":2679},"end":{"line":29,"column":45,"offset":2723},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Once there are more than 200 total rules, including inactive rules, you must manage evaluation using priority ordering. When you cross this threshold, the Firewall Rules interface automatically switches to priority ordering.","position":{"start":{"line":31,"column":1,"offset":2725},"end":{"line":31,"column":225,"offset":2949},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":2725},"end":{"line":31,"column":225,"offset":2949},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Managing rule evaluation by priority order","position":{"start":{"line":33,"column":4,"offset":2954},"end":{"line":33,"column":46,"offset":2996},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2951},"end":{"line":33,"column":46,"offset":2996},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Although priority ordering is enabled automatically when the number of active and inactive Firewall Rules exceeds 200, you can manually enable priority ordering at any time from the ","position":{"start":{"line":35,"column":1,"offset":2998},"end":{"line":35,"column":183,"offset":3180},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":35,"column":185,"offset":3182},"end":{"line":35,"column":195,"offset":3192},"indent":[]}}],"position":{"start":{"line":35,"column":183,"offset":3180},"end":{"line":35,"column":197,"offset":3194},"indent":[]}},{"type":"text","value":". To manually enable priority ordering, click ","position":{"start":{"line":35,"column":197,"offset":3194},"end":{"line":35,"column":243,"offset":3240},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Ordering","position":{"start":{"line":35,"column":245,"offset":3242},"end":{"line":35,"column":253,"offset":3250},"indent":[]}}],"position":{"start":{"line":35,"column":243,"offset":3240},"end":{"line":35,"column":255,"offset":3252},"indent":[]}},{"type":"text","value":" and then select the ","position":{"start":{"line":35,"column":255,"offset":3252},"end":{"line":35,"column":276,"offset":3273},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Priority Numbers","position":{"start":{"line":35,"column":278,"offset":3275},"end":{"line":35,"column":294,"offset":3291},"indent":[]}}],"position":{"start":{"line":35,"column":276,"offset":3273},"end":{"line":35,"column":296,"offset":3293},"indent":[]}},{"type":"text","value":" radio button, as shown below:","position":{"start":{"line":35,"column":296,"offset":3293},"end":{"line":35,"column":326,"offset":3323},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":2998},"end":{"line":35,"column":326,"offset":3323},"indent":[]}},{"type":"html","value":"<img src={firewallRulesOrderAndPriority3} />","position":{"start":{"line":37,"column":1,"offset":3325},"end":{"line":37,"column":45,"offset":3369},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Once priority ordering is enabled, you can set a priority number for each Firewall Rule.","position":{"start":{"line":39,"column":1,"offset":3371},"end":{"line":39,"column":89,"offset":3459},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":3371},"end":{"line":39,"column":89,"offset":3459},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To set the priority number for a Firewall Rule, follow these steps:","position":{"start":{"line":41,"column":1,"offset":3461},"end":{"line":41,"column":68,"offset":3528},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":3461},"end":{"line":41,"column":68,"offset":3528},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Locate the desired rule in the ","position":{"start":{"line":43,"column":4,"offset":3533},"end":{"line":43,"column":35,"offset":3564},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":43,"column":37,"offset":3566},"end":{"line":43,"column":47,"offset":3576},"indent":[]}}],"position":{"start":{"line":43,"column":35,"offset":3564},"end":{"line":43,"column":49,"offset":3578},"indent":[]}},{"type":"text","value":" and click the associated ","position":{"start":{"line":43,"column":49,"offset":3578},"end":{"line":43,"column":75,"offset":3604},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":43,"column":77,"offset":3606},"end":{"line":43,"column":81,"offset":3610},"indent":[]}}],"position":{"start":{"line":43,"column":75,"offset":3604},"end":{"line":43,"column":83,"offset":3612},"indent":[]}},{"type":"text","value":" button (wrench icon).","position":{"start":{"line":43,"column":83,"offset":3612},"end":{"line":43,"column":105,"offset":3634},"indent":[]}}],"position":{"start":{"line":43,"column":4,"offset":3533},"end":{"line":43,"column":105,"offset":3634},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":45,"column":4,"offset":3639},"end":{"line":45,"column":8,"offset":3643},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit Firewall Rule","position":{"start":{"line":45,"column":10,"offset":3645},"end":{"line":45,"column":28,"offset":3663},"indent":[]}}],"position":{"start":{"line":45,"column":8,"offset":3643},"end":{"line":45,"column":30,"offset":3665},"indent":[]}},{"type":"text","value":" panel will open.","position":{"start":{"line":45,"column":30,"offset":3665},"end":{"line":45,"column":47,"offset":3682},"indent":[]}}],"position":{"start":{"line":45,"column":4,"offset":3639},"end":{"line":45,"column":47,"offset":3682},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":3530},"end":{"line":46,"column":1,"offset":3683},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Locate the ","position":{"start":{"line":47,"column":4,"offset":3687},"end":{"line":47,"column":15,"offset":3698},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Priority","position":{"start":{"line":47,"column":17,"offset":3700},"end":{"line":47,"column":25,"offset":3708},"indent":[]}}],"position":{"start":{"line":47,"column":15,"offset":3698},"end":{"line":47,"column":27,"offset":3710},"indent":[]}},{"type":"text","value":" field and enter a positive integer value.","position":{"start":{"line":47,"column":27,"offset":3710},"end":{"line":47,"column":69,"offset":3752},"indent":[]}}],"position":{"start":{"line":47,"column":4,"offset":3687},"end":{"line":47,"column":69,"offset":3752},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":3684},"end":{"line":47,"column":69,"offset":3752},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":3530},"end":{"line":47,"column":69,"offset":3752},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-order-and-priority-4.png","alt":"Edit Firewall Rule page","position":{"start":{"line":49,"column":1,"offset":3754},"end":{"line":49,"column":78,"offset":3831},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":3754},"end":{"line":49,"column":78,"offset":3831},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":51,"column":4,"offset":3836},"end":{"line":51,"column":10,"offset":3842},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Save","position":{"start":{"line":51,"column":12,"offset":3844},"end":{"line":51,"column":16,"offset":3848},"indent":[]}}],"position":{"start":{"line":51,"column":10,"offset":3842},"end":{"line":51,"column":18,"offset":3850},"indent":[]}},{"type":"text","value":" to commit your changes and return to the ","position":{"start":{"line":51,"column":18,"offset":3850},"end":{"line":51,"column":60,"offset":3892},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":51,"column":62,"offset":3894},"end":{"line":51,"column":72,"offset":3904},"indent":[]}}],"position":{"start":{"line":51,"column":60,"offset":3892},"end":{"line":51,"column":74,"offset":3906},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":51,"column":74,"offset":3906},"end":{"line":51,"column":75,"offset":3907},"indent":[]}}],"position":{"start":{"line":51,"column":4,"offset":3836},"end":{"line":51,"column":75,"offset":3907},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":3833},"end":{"line":51,"column":75,"offset":3907},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":3833},"end":{"line":51,"column":75,"offset":3907},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":53,"column":1,"offset":3909},"end":{"line":53,"column":5,"offset":3913},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Priority","position":{"start":{"line":53,"column":7,"offset":3915},"end":{"line":53,"column":15,"offset":3923},"indent":[]}}],"position":{"start":{"line":53,"column":5,"offset":3913},"end":{"line":53,"column":17,"offset":3925},"indent":[]}},{"type":"text","value":" column displays the priority value for each rule.","position":{"start":{"line":53,"column":17,"offset":3925},"end":{"line":53,"column":67,"offset":3975},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":3909},"end":{"line":53,"column":67,"offset":3975},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-order-and-priority-5.png","alt":"Firewall Rules tab","position":{"start":{"line":55,"column":1,"offset":3977},"end":{"line":55,"column":73,"offset":4049},"indent":[]}}],"position":{"start":{"line":55,"column":1,"offset":3977},"end":{"line":55,"column":73,"offset":4049},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":57,"column":1,"offset":4051},"end":{"line":57,"column":34,"offset":4084},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules does not impose default priorities, and you are not required to set a priority for every rule.","position":{"start":{"line":59,"column":1,"offset":4086},"end":{"line":59,"column":110,"offset":4195},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":4086},"end":{"line":59,"column":110,"offset":4195},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":61,"column":1,"offset":4197},"end":{"line":61,"column":9,"offset":4205},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Working with priority ordering","position":{"start":{"line":63,"column":4,"offset":4210},"end":{"line":63,"column":34,"offset":4240},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":4207},"end":{"line":63,"column":34,"offset":4240},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare has designed priority ordering to be extremely flexible. This flexibility is particularly useful for managing large rulesets programmatically via the Cloudflare API. Use the Update Firewall Rules command to set the ","position":{"start":{"line":65,"column":1,"offset":4242},"end":{"line":65,"column":227,"offset":4468},"indent":[]}},{"type":"inlineCode","value":"priority","position":{"start":{"line":65,"column":227,"offset":4468},"end":{"line":65,"column":237,"offset":4478},"indent":[]}},{"type":"text","value":" property. Refer to ","position":{"start":{"line":65,"column":237,"offset":4478},"end":{"line":65,"column":257,"offset":4498},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#firewall-rules-properties","children":[{"type":"text","value":"Cloudflare API: Firewall Rules","position":{"start":{"line":65,"column":258,"offset":4499},"end":{"line":65,"column":288,"offset":4529},"indent":[]}}],"position":{"start":{"line":65,"column":257,"offset":4498},"end":{"line":65,"column":344,"offset":4585},"indent":[]}},{"type":"text","value":" for details.","position":{"start":{"line":65,"column":344,"offset":4585},"end":{"line":65,"column":357,"offset":4598},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":4242},"end":{"line":65,"column":357,"offset":4598},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"While your priority numbering scheme can be arbitrary, keep the following in mind:","position":{"start":{"line":67,"column":1,"offset":4600},"end":{"line":67,"column":83,"offset":4682},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":4600},"end":{"line":67,"column":83,"offset":4682},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"The evaluation sequence starts from the lowest priority number","position":{"start":{"line":69,"column":5,"offset":4688},"end":{"line":69,"column":67,"offset":4750},"indent":[]}}],"position":{"start":{"line":69,"column":3,"offset":4686},"end":{"line":69,"column":69,"offset":4752},"indent":[]}},{"type":"text","value":" and goes to the highest.","position":{"start":{"line":69,"column":69,"offset":4752},"end":{"line":69,"column":94,"offset":4777},"indent":[]}}],"position":{"start":{"line":69,"column":3,"offset":4686},"end":{"line":69,"column":94,"offset":4777},"indent":[]}}],"position":{"start":{"line":69,"column":1,"offset":4684},"end":{"line":69,"column":94,"offset":4777},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Rules without a priority number are evaluated last","position":{"start":{"line":70,"column":5,"offset":4782},"end":{"line":70,"column":55,"offset":4832},"indent":[]}}],"position":{"start":{"line":70,"column":3,"offset":4780},"end":{"line":70,"column":57,"offset":4834},"indent":[]}},{"type":"text","value":", in order of their action precedence. For example, a rule with the ","position":{"start":{"line":70,"column":57,"offset":4834},"end":{"line":70,"column":125,"offset":4902},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":70,"column":126,"offset":4903},"end":{"line":70,"column":129,"offset":4906},"indent":[]}}],"position":{"start":{"line":70,"column":125,"offset":4902},"end":{"line":70,"column":130,"offset":4907},"indent":[]}},{"type":"text","value":" action is evaluated before a rule that has the ","position":{"start":{"line":70,"column":130,"offset":4907},"end":{"line":70,"column":178,"offset":4955},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":70,"column":179,"offset":4956},"end":{"line":70,"column":184,"offset":4961},"indent":[]}}],"position":{"start":{"line":70,"column":178,"offset":4955},"end":{"line":70,"column":185,"offset":4962},"indent":[]}},{"type":"text","value":" action. For more on action precedence, refer to ","position":{"start":{"line":70,"column":185,"offset":4962},"end":{"line":70,"column":234,"offset":5011},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/actions","children":[{"type":"text","value":"Firewall Rules actions","position":{"start":{"line":70,"column":235,"offset":5012},"end":{"line":70,"column":257,"offset":5034},"indent":[]}}],"position":{"start":{"line":70,"column":234,"offset":5011},"end":{"line":70,"column":286,"offset":5063},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":70,"column":286,"offset":5063},"end":{"line":70,"column":287,"offset":5064},"indent":[]}}],"position":{"start":{"line":70,"column":3,"offset":4780},"end":{"line":70,"column":287,"offset":5064},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":4778},"end":{"line":70,"column":287,"offset":5064},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Avoid using the number 1 as a priority","position":{"start":{"line":71,"column":5,"offset":5069},"end":{"line":71,"column":43,"offset":5107},"indent":[]}}],"position":{"start":{"line":71,"column":3,"offset":5067},"end":{"line":71,"column":45,"offset":5109},"indent":[]}},{"type":"text","value":" so that you can easily maintain and modify rule order.","position":{"start":{"line":71,"column":45,"offset":5109},"end":{"line":71,"column":100,"offset":5164},"indent":[]}}],"position":{"start":{"line":71,"column":3,"offset":5067},"end":{"line":71,"column":100,"offset":5164},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":5065},"end":{"line":71,"column":100,"offset":5164},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Consider grouping ranges of priority numbers into categories","position":{"start":{"line":72,"column":5,"offset":5169},"end":{"line":72,"column":65,"offset":5229},"indent":[]}}],"position":{"start":{"line":72,"column":3,"offset":5167},"end":{"line":72,"column":67,"offset":5231},"indent":[]}},{"type":"text","value":" that have some meaning for your deployment. Here are some examples:","position":{"start":{"line":72,"column":67,"offset":5231},"end":{"line":72,"column":135,"offset":5299},"indent":[]}}],"position":{"start":{"line":72,"column":3,"offset":5167},"end":{"line":72,"column":135,"offset":5299},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"5000-9999: Trusted IP addresses","position":{"start":{"line":73,"column":5,"offset":5304},"end":{"line":73,"column":36,"offset":5335},"indent":[]}}],"position":{"start":{"line":73,"column":5,"offset":5304},"end":{"line":73,"column":36,"offset":5335},"indent":[]}}],"position":{"start":{"line":73,"column":3,"offset":5302},"end":{"line":73,"column":36,"offset":5335},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"10000-19999: Blocking rules for bad crawlers","position":{"start":{"line":74,"column":5,"offset":5340},"end":{"line":74,"column":49,"offset":5384},"indent":[]}}],"position":{"start":{"line":74,"column":5,"offset":5340},"end":{"line":74,"column":49,"offset":5384},"indent":[]}}],"position":{"start":{"line":74,"column":3,"offset":5338},"end":{"line":74,"column":49,"offset":5384},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"20000-29999: Blocking rules for abusive users/spam","position":{"start":{"line":75,"column":5,"offset":5389},"end":{"line":75,"column":55,"offset":5439},"indent":[]}}],"position":{"start":{"line":75,"column":5,"offset":5389},"end":{"line":75,"column":55,"offset":5439},"indent":[]}}],"position":{"start":{"line":75,"column":3,"offset":5387},"end":{"line":75,"column":55,"offset":5439},"indent":[]}}],"position":{"start":{"line":73,"column":3,"offset":5302},"end":{"line":75,"column":55,"offset":5439},"indent":[3,3]}}],"position":{"start":{"line":72,"column":1,"offset":5165},"end":{"line":75,"column":55,"offset":5439},"indent":[1,1,1]}}],"position":{"start":{"line":69,"column":1,"offset":4684},"end":{"line":75,"column":55,"offset":5439},"indent":[1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":78,"column":71,"offset":5512}}}}},{"node":{"fields":{"slug":"/cf-firewall-rules"},"frontmatter":{"order":200,"title":"About","summary":null,"demo":null,"tags":null},"headings":[{"value":"About Cloudflare Firewall Rules"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"About Cloudflare Firewall Rules","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":34,"offset":34},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":34,"offset":34},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Flexibility and control","position":{"start":{"line":4,"column":4,"offset":39},"end":{"line":4,"column":27,"offset":62},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":36},"end":{"line":4,"column":27,"offset":62},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Cloudflare Firewall Rules","position":{"start":{"line":6,"column":3,"offset":66},"end":{"line":6,"column":28,"offset":91},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":64},"end":{"line":6,"column":30,"offset":93},"indent":[]}},{"type":"text","value":" is a flexible and intuitive framework for filtering HTTP requests. It gives you fine-grained control over which requests reach your applications.","position":{"start":{"line":6,"column":30,"offset":93},"end":{"line":6,"column":176,"offset":239},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":64},"end":{"line":6,"column":176,"offset":239},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules allows you to create rules combining several conditions. For example, you can create a single Firewall Rule that blocks traffic to a URI when the request comes from a particular IP and the user-agent matches a specific string or a pattern. Once you are satisfied with the rule, you can deploy it yourself, immediately.","position":{"start":{"line":8,"column":1,"offset":241},"end":{"line":8,"column":334,"offset":574},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":241},"end":{"line":8,"column":334,"offset":574},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Fundamentally, Firewall Rules gives you the power to proactively inspect incoming site traffic and automatically respond to threats. You define ","position":{"start":{"line":10,"column":1,"offset":576},"end":{"line":10,"column":145,"offset":720},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"expressions","position":{"start":{"line":10,"column":147,"offset":722},"end":{"line":10,"column":158,"offset":733},"indent":[]}}],"position":{"start":{"line":10,"column":145,"offset":720},"end":{"line":10,"column":160,"offset":735},"indent":[]}},{"type":"text","value":" that tell Cloudflare what to look for and specify the appropriate ","position":{"start":{"line":10,"column":160,"offset":735},"end":{"line":10,"column":227,"offset":802},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"action","position":{"start":{"line":10,"column":229,"offset":804},"end":{"line":10,"column":235,"offset":810},"indent":[]}}],"position":{"start":{"line":10,"column":227,"offset":802},"end":{"line":10,"column":237,"offset":812},"indent":[]}},{"type":"text","value":" to take when those criteria are satisfied.","position":{"start":{"line":10,"column":237,"offset":812},"end":{"line":10,"column":280,"offset":855},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":576},"end":{"line":10,"column":280,"offset":855},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To write Firewall Rule expressions, use the Rules language, a powerful expression language inspired in the Wireshark Display Filter language. Even though Cloudflare Firewall Rules is not based on the ","position":{"start":{"line":12,"column":1,"offset":857},"end":{"line":12,"column":201,"offset":1057},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/","children":[{"type":"text","value":"Ruleset Engine","position":{"start":{"line":12,"column":202,"offset":1058},"end":{"line":12,"column":216,"offset":1072},"indent":[]}}],"position":{"start":{"line":12,"column":201,"offset":1057},"end":{"line":12,"column":268,"offset":1124},"indent":[]}},{"type":"text","value":", Firewall Rules expressions use the same syntax of the Cloudflare Rules language.","position":{"start":{"line":12,"column":268,"offset":1124},"end":{"line":12,"column":350,"offset":1206},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":857},"end":{"line":12,"column":350,"offset":1206},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information on rule expressions and the available operators, fields, and functions, refer to ","position":{"start":{"line":14,"column":1,"offset":1208},"end":{"line":14,"column":103,"offset":1310},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language","children":[{"type":"text","value":"Rules language","position":{"start":{"line":14,"column":104,"offset":1311},"end":{"line":14,"column":118,"offset":1325},"indent":[]}}],"position":{"start":{"line":14,"column":103,"offset":1310},"end":{"line":14,"column":184,"offset":1391},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":14,"column":184,"offset":1391},"end":{"line":14,"column":185,"offset":1392},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":1208},"end":{"line":14,"column":185,"offset":1392},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Working with Firewall Rules","position":{"start":{"line":16,"column":4,"offset":1397},"end":{"line":16,"column":31,"offset":1424},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1394},"end":{"line":16,"column":31,"offset":1424},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To configure Firewall Rules from the Cloudflare dashboard, use the ","position":{"start":{"line":18,"column":1,"offset":1426},"end":{"line":18,"column":68,"offset":1493},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":18,"column":70,"offset":1495},"end":{"line":18,"column":84,"offset":1509},"indent":[]}}],"position":{"start":{"line":18,"column":68,"offset":1493},"end":{"line":18,"column":86,"offset":1511},"indent":[]}},{"type":"text","value":" tab in the ","position":{"start":{"line":18,"column":86,"offset":1511},"end":{"line":18,"column":98,"offset":1523},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":18,"column":100,"offset":1525},"end":{"line":18,"column":108,"offset":1533},"indent":[]}}],"position":{"start":{"line":18,"column":98,"offset":1523},"end":{"line":18,"column":110,"offset":1535},"indent":[]}},{"type":"text","value":" app. For more, refer to ","position":{"start":{"line":18,"column":110,"offset":1535},"end":{"line":18,"column":135,"offset":1560},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard","children":[{"type":"text","value":"Manage rules in the Cloudflare dashboard","position":{"start":{"line":18,"column":136,"offset":1561},"end":{"line":18,"column":176,"offset":1601},"indent":[]}}],"position":{"start":{"line":18,"column":135,"offset":1560},"end":{"line":18,"column":192,"offset":1617},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":18,"column":192,"offset":1617},"end":{"line":18,"column":193,"offset":1618},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1426},"end":{"line":18,"column":193,"offset":1618},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To configure Firewall Rules with the Cloudflare API, use the Firewall Rules API. Use the Cloudflare Filters API to manage expressions. For more information, refer to ","position":{"start":{"line":20,"column":1,"offset":1620},"end":{"line":20,"column":167,"offset":1786},"indent":[]}},{"type":"link","title":null,"url":"/api","children":[{"type":"text","value":"Manage rules via the APIs","position":{"start":{"line":20,"column":168,"offset":1787},"end":{"line":20,"column":193,"offset":1812},"indent":[]}}],"position":{"start":{"line":20,"column":167,"offset":1786},"end":{"line":20,"column":200,"offset":1819},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":20,"column":200,"offset":1819},"end":{"line":20,"column":201,"offset":1820},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1620},"end":{"line":20,"column":201,"offset":1820},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can also manage Firewall Rules through Terraform. For more, refer to ","position":{"start":{"line":22,"column":1,"offset":1822},"end":{"line":22,"column":74,"offset":1895},"indent":[]}},{"type":"link","title":null,"url":"https://blog.cloudflare.com/getting-started-with-terraform-and-cloudflare-part-1/","children":[{"type":"text","value":"Getting Started with Terraform","position":{"start":{"line":22,"column":75,"offset":1896},"end":{"line":22,"column":105,"offset":1926},"indent":[]}}],"position":{"start":{"line":22,"column":74,"offset":1895},"end":{"line":22,"column":189,"offset":2010},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":22,"column":189,"offset":2010},"end":{"line":22,"column":190,"offset":2011},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1822},"end":{"line":22,"column":190,"offset":2011},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Firewall Rules tab","position":{"start":{"line":24,"column":5,"offset":2017},"end":{"line":24,"column":23,"offset":2035},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":2013},"end":{"line":24,"column":23,"offset":2035},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":26,"column":1,"offset":2037},"end":{"line":26,"column":5,"offset":2041},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":26,"column":7,"offset":2043},"end":{"line":26,"column":17,"offset":2053},"indent":[]}}],"position":{"start":{"line":26,"column":5,"offset":2041},"end":{"line":26,"column":19,"offset":2055},"indent":[]}},{"type":"text","value":" gives you a snapshot of recent activity and allows you to manage Firewall Rules in a single convenient location.","position":{"start":{"line":26,"column":19,"offset":2055},"end":{"line":26,"column":132,"offset":2168},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":2037},"end":{"line":26,"column":132,"offset":2168},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/cf-firewall-rules-panel.png","alt":"Firewall Rules tab","position":{"start":{"line":28,"column":1,"offset":2170},"end":{"line":28,"column":61,"offset":2230},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":2170},"end":{"line":28,"column":61,"offset":2230},"indent":[]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"Challenge Solve Rate (CSR)","position":{"start":{"line":30,"column":6,"offset":2237},"end":{"line":30,"column":32,"offset":2263},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":2232},"end":{"line":30,"column":32,"offset":2263},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":32,"column":1,"offset":2265},"end":{"line":32,"column":5,"offset":2269},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":32,"column":7,"offset":2271},"end":{"line":32,"column":17,"offset":2281},"indent":[]}}],"position":{"start":{"line":32,"column":5,"offset":2269},"end":{"line":32,"column":19,"offset":2283},"indent":[]}},{"type":"text","value":" displays each rule's ","position":{"start":{"line":32,"column":19,"offset":2283},"end":{"line":32,"column":41,"offset":2305},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"CSR","position":{"start":{"line":32,"column":43,"offset":2307},"end":{"line":32,"column":46,"offset":2310},"indent":[]}}],"position":{"start":{"line":32,"column":41,"offset":2305},"end":{"line":32,"column":48,"offset":2312},"indent":[]}},{"type":"text","value":" (Challenge Solve Rate), which is the percentage of issued challenges that were solved. This metric applies to rules configured with ","position":{"start":{"line":32,"column":48,"offset":2312},"end":{"line":32,"column":181,"offset":2445},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":32,"column":182,"offset":2446},"end":{"line":32,"column":196,"offset":2460},"indent":[]}}],"position":{"start":{"line":32,"column":181,"offset":2445},"end":{"line":32,"column":197,"offset":2461},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":32,"column":197,"offset":2461},"end":{"line":32,"column":201,"offset":2465},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"JS Challenge","position":{"start":{"line":32,"column":202,"offset":2466},"end":{"line":32,"column":214,"offset":2478},"indent":[]}}],"position":{"start":{"line":32,"column":201,"offset":2465},"end":{"line":32,"column":215,"offset":2479},"indent":[]}},{"type":"text","value":" actions, and it is calculated as follows:","position":{"start":{"line":32,"column":215,"offset":2479},"end":{"line":32,"column":257,"offset":2521},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2265},"end":{"line":32,"column":257,"offset":2521},"indent":[]}},{"type":"html","value":"<p><var>CSR</var> = <var>number of challenges solved</var> / <var>number of challenges issued</var></p>","position":{"start":{"line":34,"column":1,"offset":2523},"end":{"line":34,"column":104,"offset":2626},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Hover over the CSR to reveal the number of issued and solved CAPTCHA challenges:","position":{"start":{"line":36,"column":1,"offset":2628},"end":{"line":36,"column":81,"offset":2708},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":2628},"end":{"line":36,"column":81,"offset":2708},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-csr-hover.png","alt":"Revealing the number of issued vs. solved CAPTCHA challenges","position":{"start":{"line":38,"column":1,"offset":2710},"end":{"line":38,"column":104,"offset":2813},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":2710},"end":{"line":38,"column":104,"offset":2813},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A low CSR means that Cloudflare is issuing a low number of CAPTCHA challenges to actual humans, since these are the solved challenges.","position":{"start":{"line":40,"column":1,"offset":2815},"end":{"line":40,"column":135,"offset":2949},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2815},"end":{"line":40,"column":135,"offset":2949},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You should aim for a low Challenge Solve Rate. Review the CSR of your CAPTCHA rules periodically and adjust them if necessary:","position":{"start":{"line":42,"column":1,"offset":2951},"end":{"line":42,"column":127,"offset":3077},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":2951},"end":{"line":42,"column":127,"offset":3077},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If the rate is higher than expected, for example regarding a Bot Management rule, consider relaxing the rule criteria so that you issue fewer challenges to human visitors.","position":{"start":{"line":44,"column":3,"offset":3081},"end":{"line":44,"column":174,"offset":3252},"indent":[]}}],"position":{"start":{"line":44,"column":3,"offset":3081},"end":{"line":44,"column":174,"offset":3252},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":3079},"end":{"line":44,"column":174,"offset":3252},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If the rate is 0%, no CAPTCHA challenges are being solved. This means that you have no human visitors whose requests match the rule filter. Consider changing the rule action to ","position":{"start":{"line":45,"column":3,"offset":3255},"end":{"line":45,"column":180,"offset":3432},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":45,"column":181,"offset":3433},"end":{"line":45,"column":186,"offset":3438},"indent":[]}}],"position":{"start":{"line":45,"column":180,"offset":3432},"end":{"line":45,"column":187,"offset":3439},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":45,"column":187,"offset":3439},"end":{"line":45,"column":188,"offset":3440},"indent":[]}}],"position":{"start":{"line":45,"column":3,"offset":3255},"end":{"line":45,"column":188,"offset":3440},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":3253},"end":{"line":45,"column":188,"offset":3440},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":3079},"end":{"line":45,"column":188,"offset":3440},"indent":[1]}},{"type":"html","value":"<Aside type=\"warning\" header=\"Important\">","position":{"start":{"line":47,"column":1,"offset":3442},"end":{"line":47,"column":42,"offset":3483},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Currently, Cloudflare does not calculate the CSR of Managed Challenges.","position":{"start":{"line":49,"column":1,"offset":3485},"end":{"line":49,"column":72,"offset":3556},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":3485},"end":{"line":49,"column":72,"offset":3556},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For customers on a Free plan, any rules configured with the ","position":{"start":{"line":51,"column":1,"offset":3558},"end":{"line":51,"column":61,"offset":3618},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Legacy CAPTCHA","position":{"start":{"line":51,"column":62,"offset":3619},"end":{"line":51,"column":76,"offset":3633},"indent":[]}}],"position":{"start":{"line":51,"column":61,"offset":3618},"end":{"line":51,"column":77,"offset":3634},"indent":[]}},{"type":"text","value":" action will use Managed Challenges. For more information, refer to ","position":{"start":{"line":51,"column":77,"offset":3634},"end":{"line":51,"column":145,"offset":3702},"indent":[]}},{"type":"link","title":null,"url":"https://support.cloudflare.com/hc/articles/200170136#managed-challenge","children":[{"type":"text","value":"Understanding Cloudflare Captchas and Challenge Passage","position":{"start":{"line":51,"column":146,"offset":3703},"end":{"line":51,"column":201,"offset":3758},"indent":[]}}],"position":{"start":{"line":51,"column":145,"offset":3702},"end":{"line":51,"column":274,"offset":3831},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":51,"column":274,"offset":3831},"end":{"line":51,"column":275,"offset":3832},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":3558},"end":{"line":51,"column":275,"offset":3832},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":53,"column":1,"offset":3834},"end":{"line":53,"column":9,"offset":3842},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Firewall Rules APIs","position":{"start":{"line":55,"column":5,"offset":3848},"end":{"line":55,"column":24,"offset":3867},"indent":[]}}],"position":{"start":{"line":55,"column":1,"offset":3844},"end":{"line":55,"column":24,"offset":3867},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Power users, particularly those who develop large numbers of Firewall Rules, can use the Cloudflare API to programmatically manage Firewall Rules. Refer to ","position":{"start":{"line":57,"column":1,"offset":3869},"end":{"line":57,"column":157,"offset":4025},"indent":[]}},{"type":"link","title":null,"url":"/api","children":[{"type":"text","value":"Manage rules via the API","position":{"start":{"line":57,"column":158,"offset":4026},"end":{"line":57,"column":182,"offset":4050},"indent":[]}}],"position":{"start":{"line":57,"column":157,"offset":4025},"end":{"line":57,"column":189,"offset":4057},"indent":[]}},{"type":"text","value":" for more information.","position":{"start":{"line":57,"column":189,"offset":4057},"end":{"line":57,"column":211,"offset":4079},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":3869},"end":{"line":57,"column":211,"offset":4079},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Entitlements","position":{"start":{"line":59,"column":4,"offset":4084},"end":{"line":59,"column":16,"offset":4096},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":4081},"end":{"line":59,"column":16,"offset":4096},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Firewall Rules is available to all customers. However, the number of active Firewall Rules you can have and support for the ","position":{"start":{"line":61,"column":1,"offset":4098},"end":{"line":61,"column":136,"offset":4233},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":61,"column":137,"offset":4234},"end":{"line":61,"column":140,"offset":4237},"indent":[]}}],"position":{"start":{"line":61,"column":136,"offset":4233},"end":{"line":61,"column":141,"offset":4238},"indent":[]}},{"type":"text","value":" action and regular expressions depend on your Cloudflare plan.","position":{"start":{"line":61,"column":141,"offset":4238},"end":{"line":61,"column":204,"offset":4301},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":4098},"end":{"line":61,"column":204,"offset":4301},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This table outlines the Firewall Rules features and entitlements available with each customer plan:","position":{"start":{"line":63,"column":1,"offset":4303},"end":{"line":63,"column":100,"offset":4402},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":4303},"end":{"line":63,"column":100,"offset":4402},"indent":[]}},{"type":"html","value":"<TableWrap>\n<table>\n<thead>\n<tr>\n  <td></td>\n  <td colspan=\"4\" style=\"text-align:center\"><strong>Cloudflare plan</strong></td>\n</tr>\n<tr>\n  <td><strong>Feature</strong></td>\n  <td><strong>Free</strong></td>\n  <td><strong>Pro</strong></td>\n  <td><strong>Business</strong></td>\n  <td><strong>Enterprise</strong></td>\n</tr>\n</thead>\n<tbody>\n<tr>\n  <td>Active rules</td>\n  <td>5</td>\n  <td>20</td>\n  <td>100</td>\n  <td>1000</td>\n</tr>\n<tr>\n  <td>Supported actions</td>\n  <td>All except <em>Log</em></td>\n  <td>All except <em>Log</em></td>\n  <td>All except <em>Log</em></td>\n  <td>All</td>\n</tr>\n<tr>\n  <td>Regular expression support</td>\n  <td>No</td>\n  <td>No</td>\n  <td>Yes</td>\n  <td>Yes</td>\n</tr>\n<tr>\n  <td>Number of <a href='/cf-firewall-rules/rules-lists'>IP Lists</a></td>\n  <td>1</td>\n  <td>10</td>\n  <td>10</td>\n  <td>10</td>\n</tr>\n</tbody>\n</table>\n</TableWrap>","position":{"start":{"line":65,"column":1,"offset":4404},"end":{"line":111,"column":13,"offset":5273},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Get started","position":{"start":{"line":113,"column":4,"offset":5278},"end":{"line":113,"column":15,"offset":5289},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":5275},"end":{"line":113,"column":15,"offset":5289},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Unless you are already an advanced user, refer to ","position":{"start":{"line":115,"column":1,"offset":5291},"end":{"line":115,"column":51,"offset":5341},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/expressions","children":[{"type":"text","value":"Expressions","position":{"start":{"line":115,"column":52,"offset":5342},"end":{"line":115,"column":63,"offset":5353},"indent":[]}}],"position":{"start":{"line":115,"column":51,"offset":5341},"end":{"line":115,"column":141,"offset":5431},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":115,"column":141,"offset":5431},"end":{"line":115,"column":146,"offset":5436},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/actions","children":[{"type":"text","value":"Actions","position":{"start":{"line":115,"column":147,"offset":5437},"end":{"line":115,"column":154,"offset":5444},"indent":[]}}],"position":{"start":{"line":115,"column":146,"offset":5436},"end":{"line":115,"column":183,"offset":5473},"indent":[]}},{"type":"text","value":" to learn more about the basic elements of Firewall Rules.","position":{"start":{"line":115,"column":183,"offset":5473},"end":{"line":115,"column":241,"offset":5531},"indent":[]}}],"position":{"start":{"line":115,"column":1,"offset":5291},"end":{"line":115,"column":241,"offset":5531},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To get started building your own Firewall Rules, refer to ","position":{"start":{"line":117,"column":1,"offset":5533},"end":{"line":117,"column":59,"offset":5591},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules","children":[{"type":"text","value":"Manage Firewall Rules in the dashboard","position":{"start":{"line":117,"column":60,"offset":5592},"end":{"line":117,"column":98,"offset":5630},"indent":[]}}],"position":{"start":{"line":117,"column":59,"offset":5591},"end":{"line":117,"column":139,"offset":5671},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":117,"column":139,"offset":5671},"end":{"line":117,"column":140,"offset":5672},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":5533},"end":{"line":117,"column":140,"offset":5672},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Those eager to dive straight into the technical details can refer to these topics:","position":{"start":{"line":119,"column":1,"offset":5674},"end":{"line":119,"column":83,"offset":5756},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":5674},"end":{"line":119,"column":83,"offset":5756},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/recipes","children":[{"type":"text","value":"Common use cases","position":{"start":{"line":121,"column":4,"offset":5761},"end":{"line":121,"column":20,"offset":5777},"indent":[]}}],"position":{"start":{"line":121,"column":3,"offset":5760},"end":{"line":121,"column":31,"offset":5788},"indent":[]}}],"position":{"start":{"line":121,"column":3,"offset":5760},"end":{"line":121,"column":31,"offset":5788},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":5758},"end":{"line":121,"column":31,"offset":5788},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/api","children":[{"type":"text","value":"Manage Firewall Rules via the APIs","position":{"start":{"line":122,"column":4,"offset":5792},"end":{"line":122,"column":38,"offset":5826},"indent":[]}}],"position":{"start":{"line":122,"column":3,"offset":5791},"end":{"line":122,"column":45,"offset":5833},"indent":[]}}],"position":{"start":{"line":122,"column":3,"offset":5791},"end":{"line":122,"column":45,"offset":5833},"indent":[]}}],"position":{"start":{"line":122,"column":1,"offset":5789},"end":{"line":122,"column":45,"offset":5833},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language","children":[{"type":"text","value":"Cloudflare Rules language","position":{"start":{"line":123,"column":4,"offset":5837},"end":{"line":123,"column":29,"offset":5862},"indent":[]}}],"position":{"start":{"line":123,"column":3,"offset":5836},"end":{"line":123,"column":95,"offset":5928},"indent":[]}}],"position":{"start":{"line":123,"column":3,"offset":5836},"end":{"line":123,"column":95,"offset":5928},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":5834},"end":{"line":123,"column":95,"offset":5928},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":5758},"end":{"line":123,"column":95,"offset":5928},"indent":[1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":126,"column":87,"offset":6017}}}}},{"node":{"fields":{"slug":"/cf-firewall-rules/rules-lists"},"frontmatter":{"order":240,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"IP Lists"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"IP Lists","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":11,"offset":11},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":11,"offset":11},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use IP Lists to refer to a group of IP addresses collectively, by name, in your Firewall Rule expression. You can choose to create your own custom list of IP addresses or use a list managed by Cloudflare.","position":{"start":{"line":4,"column":1,"offset":13},"end":{"line":4,"column":205,"offset":217},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":13},"end":{"line":4,"column":205,"offset":217},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, use a list of known office IP addresses in a Firewall Rule that allows requests from the addresses on the list to bypass security features. Or you may want to block requests that don't come from the known office addresses.","position":{"start":{"line":6,"column":1,"offset":219},"end":{"line":6,"column":236,"offset":454},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":219},"end":{"line":6,"column":236,"offset":454},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you update the content of a list, any rules that use the list are automatically updated, so you can make a single change to your Firewall Rules list rather than modify rules individually.","position":{"start":{"line":8,"column":1,"offset":456},"end":{"line":8,"column":193,"offset":648},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":456},"end":{"line":8,"column":193,"offset":648},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare stores your lists at the account level and sends to the edge, so you can view, manage, and incorporate them into Firewall Rules for any of your zones.","position":{"start":{"line":10,"column":1,"offset":650},"end":{"line":10,"column":162,"offset":811},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":650},"end":{"line":10,"column":162,"offset":811},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Advantages of IP Lists","position":{"start":{"line":12,"column":4,"offset":816},"end":{"line":12,"column":26,"offset":838},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":813},"end":{"line":12,"column":26,"offset":838},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Using IP Lists has these advantages:","position":{"start":{"line":14,"column":1,"offset":840},"end":{"line":14,"column":37,"offset":876},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":840},"end":{"line":14,"column":37,"offset":876},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When creating a Firewall Rule, using an IP List is easier and less error-prone than adding a long list of IP addresses to a Firewall Rules expression.","position":{"start":{"line":16,"column":3,"offset":880},"end":{"line":16,"column":153,"offset":1030},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":880},"end":{"line":16,"column":153,"offset":1030},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":878},"end":{"line":16,"column":153,"offset":1030},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When updating a set of Firewall Rules that target the same group of IP addresses, using an IP List is easier and less error prone than editing multiple Firewall Rules.","position":{"start":{"line":17,"column":3,"offset":1033},"end":{"line":17,"column":170,"offset":1200},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":1033},"end":{"line":17,"column":170,"offset":1200},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":1031},"end":{"line":17,"column":170,"offset":1200},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"IP Lists are easier to read and more informative, particularly when you use descriptive names for your lists.","position":{"start":{"line":18,"column":3,"offset":1203},"end":{"line":18,"column":112,"offset":1312},"indent":[]}}],"position":{"start":{"line":18,"column":3,"offset":1203},"end":{"line":18,"column":112,"offset":1312},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1201},"end":{"line":18,"column":112,"offset":1312},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":878},"end":{"line":18,"column":112,"offset":1312},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Managed IP Lists: Open Proxies","position":{"start":{"line":20,"column":4,"offset":1317},"end":{"line":20,"column":34,"offset":1347},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1314},"end":{"line":20,"column":34,"offset":1347},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use Managed IP Lists to access Cloudflare's IP threat intelligence.","position":{"start":{"line":22,"column":1,"offset":1349},"end":{"line":22,"column":68,"offset":1416},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1349},"end":{"line":22,"column":68,"offset":1416},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare scans public, open proxy lists for reachable, open proxies. After verifying the proxies, Cloudflare determines their exit IPs and creates a list of IPs you can use when writing rules via the dashboard or API.","position":{"start":{"line":24,"column":1,"offset":1418},"end":{"line":24,"column":220,"offset":1637},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1418},"end":{"line":24,"column":220,"offset":1637},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Entitlements","position":{"start":{"line":26,"column":4,"offset":1642},"end":{"line":26,"column":16,"offset":1654},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1639},"end":{"line":26,"column":16,"offset":1654},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The number of IP Lists you can create depends on the Cloudflare plans associated with the zones in your account. Regardless of plan, you can store up to a total of 10,000 items, spread across all of your lists.","position":{"start":{"line":28,"column":1,"offset":1656},"end":{"line":28,"column":211,"offset":1866},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1656},"end":{"line":28,"column":211,"offset":1866},"indent":[]}},{"type":"html","value":"<TableWrap><table style=\"width: 100%\">","position":{"start":{"line":30,"column":1,"offset":1868},"end":{"line":30,"column":39,"offset":1906},"indent":[]}},{"type":"html","value":"  <thead>\n    <tr>\n      <td></td>\n      <td colspan=\"4\" style=\"text-align:center\"><strong>Cloudflare plan</strong></td>\n    </tr>\n    <tr>\n      <th></th>\n      <th>Free</th>\n      <th>Pro</th>\n      <th>Business</th>\n      <th>Enterprise</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><strong>Number of IP Lists</strong></td>\n      <td>1</td>\n      <td>10</td>\n      <td>10</td>\n      <td>10</td>\n    </tr>\n  </tbody>\n</table></TableWrap>","position":{"start":{"line":32,"column":1,"offset":1908},"end":{"line":54,"column":21,"offset":2356},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"<Aside type=\"note\" header=\"Important\">","position":{"start":{"line":56,"column":1,"offset":2358},"end":{"line":56,"column":39,"offset":2396},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to the Open Proxy List in the rule builder and ","position":{"start":{"line":58,"column":1,"offset":2398},"end":{"line":58,"column":55,"offset":2452},"indent":[]}},{"type":"html","value":"<code>","position":{"start":{"line":58,"column":55,"offset":2452},"end":{"line":58,"column":61,"offset":2458},"indent":[]}},{"type":"text","value":"cf.open_proxies","position":{"start":{"line":58,"column":61,"offset":2458},"end":{"line":58,"column":76,"offset":2473},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":58,"column":76,"offset":2473},"end":{"line":58,"column":83,"offset":2480},"indent":[]}},{"type":"text","value":" requires a Cloudflare Enterprise plan.","position":{"start":{"line":58,"column":83,"offset":2480},"end":{"line":58,"column":122,"offset":2519},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":2398},"end":{"line":58,"column":122,"offset":2519},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":60,"column":1,"offset":2521},"end":{"line":60,"column":9,"offset":2529},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"User role requirements","position":{"start":{"line":62,"column":4,"offset":2534},"end":{"line":62,"column":26,"offset":2556},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":2531},"end":{"line":62,"column":26,"offset":2556},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The following user roles have access to the List management functionality:","position":{"start":{"line":64,"column":1,"offset":2558},"end":{"line":64,"column":75,"offset":2632},"indent":[]}}],"position":{"start":{"line":64,"column":1,"offset":2558},"end":{"line":64,"column":75,"offset":2632},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Super Administrator","position":{"start":{"line":66,"column":3,"offset":2636},"end":{"line":66,"column":22,"offset":2655},"indent":[]}}],"position":{"start":{"line":66,"column":3,"offset":2636},"end":{"line":66,"column":22,"offset":2655},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":2634},"end":{"line":66,"column":22,"offset":2655},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Administrator","position":{"start":{"line":67,"column":3,"offset":2658},"end":{"line":67,"column":16,"offset":2671},"indent":[]}}],"position":{"start":{"line":67,"column":3,"offset":2658},"end":{"line":67,"column":16,"offset":2671},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":2656},"end":{"line":67,"column":16,"offset":2671},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Firewall","position":{"start":{"line":68,"column":3,"offset":2674},"end":{"line":68,"column":11,"offset":2682},"indent":[]}}],"position":{"start":{"line":68,"column":3,"offset":2674},"end":{"line":68,"column":11,"offset":2682},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":2672},"end":{"line":68,"column":11,"offset":2682},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":2634},"end":{"line":68,"column":11,"offset":2682},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Managing lists","position":{"start":{"line":70,"column":4,"offset":2687},"end":{"line":70,"column":18,"offset":2701},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":2684},"end":{"line":70,"column":18,"offset":2701},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To manage and edit IP Lists from your Cloudflare account interface, refer to ","position":{"start":{"line":72,"column":3,"offset":2705},"end":{"line":72,"column":80,"offset":2782},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists","children":[{"type":"text","value":"Use IP Lists","position":{"start":{"line":72,"column":81,"offset":2783},"end":{"line":72,"column":93,"offset":2795},"indent":[]}}],"position":{"start":{"line":72,"column":80,"offset":2782},"end":{"line":72,"column":121,"offset":2823},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":72,"column":121,"offset":2823},"end":{"line":72,"column":122,"offset":2824},"indent":[]}}],"position":{"start":{"line":72,"column":3,"offset":2705},"end":{"line":72,"column":122,"offset":2824},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":2703},"end":{"line":72,"column":122,"offset":2824},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To manage and edit IP Lists using the Cloudflare API, refer to ","position":{"start":{"line":73,"column":3,"offset":2827},"end":{"line":73,"column":66,"offset":2890},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-lists/","children":[{"type":"text","value":"Lists API","position":{"start":{"line":73,"column":67,"offset":2891},"end":{"line":73,"column":76,"offset":2900},"indent":[]}}],"position":{"start":{"line":73,"column":66,"offset":2890},"end":{"line":73,"column":93,"offset":2917},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":73,"column":93,"offset":2917},"end":{"line":73,"column":94,"offset":2918},"indent":[]}}],"position":{"start":{"line":73,"column":3,"offset":2827},"end":{"line":73,"column":94,"offset":2918},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":2825},"end":{"line":73,"column":94,"offset":2918},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":2703},"end":{"line":73,"column":94,"offset":2918},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Using lists in expressions","position":{"start":{"line":75,"column":4,"offset":2923},"end":{"line":75,"column":30,"offset":2949},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":2920},"end":{"line":75,"column":30,"offset":2949},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Both the Cloudflare dashboard and the Cloudflare API support IP Lists.","position":{"start":{"line":77,"column":1,"offset":2951},"end":{"line":77,"column":71,"offset":3021},"indent":[]}}],"position":{"start":{"line":77,"column":1,"offset":2951},"end":{"line":77,"column":71,"offset":3021},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To use IP Lists in an expression from the Cloudflare dashboard, refer to ","position":{"start":{"line":79,"column":1,"offset":3023},"end":{"line":79,"column":74,"offset":3096},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/use-lists-in-expressions","children":[{"type":"text","value":"Use lists in expressions","position":{"start":{"line":79,"column":75,"offset":3097},"end":{"line":79,"column":99,"offset":3121},"indent":[]}}],"position":{"start":{"line":79,"column":74,"offset":3096},"end":{"line":79,"column":152,"offset":3174},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":79,"column":152,"offset":3174},"end":{"line":79,"column":153,"offset":3175},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":3023},"end":{"line":79,"column":153,"offset":3175},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To refer to an IP List in a Cloudflare Filters API expression, refer to ","position":{"start":{"line":81,"column":1,"offset":3177},"end":{"line":81,"column":73,"offset":3249},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/values#lists","children":[{"type":"text","value":"Values: Lists","position":{"start":{"line":81,"column":74,"offset":3250},"end":{"line":81,"column":87,"offset":3263},"indent":[]}}],"position":{"start":{"line":81,"column":73,"offset":3249},"end":{"line":81,"column":166,"offset":3342},"indent":[]}},{"type":"text","value":" in the Rules language reference.","position":{"start":{"line":81,"column":166,"offset":3342},"end":{"line":81,"column":199,"offset":3375},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":3177},"end":{"line":81,"column":199,"offset":3375},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":84,"column":71,"offset":3448}}}}},{"node":{"fields":{"slug":"/cf-firewall-rules/fields-and-expressions"},"frontmatter":{"order":210,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Fields and expressions"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Fields and expressions","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":25,"offset":25},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":25,"offset":25},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":4,"column":4,"offset":30},"end":{"line":4,"column":12,"offset":38},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":12,"offset":38},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Every Cloudflare firewall rule, no matter how complex, is really just a combination of two elements: an ","position":{"start":{"line":6,"column":1,"offset":40},"end":{"line":6,"column":105,"offset":144},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"expression","position":{"start":{"line":6,"column":107,"offset":146},"end":{"line":6,"column":117,"offset":156},"indent":[]}}],"position":{"start":{"line":6,"column":105,"offset":144},"end":{"line":6,"column":119,"offset":158},"indent":[]}},{"type":"text","value":" and an ","position":{"start":{"line":6,"column":119,"offset":158},"end":{"line":6,"column":127,"offset":166},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"action","position":{"start":{"line":6,"column":129,"offset":168},"end":{"line":6,"column":135,"offset":174},"indent":[]}}],"position":{"start":{"line":6,"column":127,"offset":166},"end":{"line":6,"column":137,"offset":176},"indent":[]}},{"type":"text","value":". Expressions define the criteria for an HTTP request to trigger an action; the action tells Cloudflare what to do with that request.","position":{"start":{"line":6,"column":137,"offset":176},"end":{"line":6,"column":270,"offset":309},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":40},"end":{"line":6,"column":270,"offset":309},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When an HTTP request reaches the firewall, Cloudflare compares values from the request to those defined in the expression. If the expression returns ","position":{"start":{"line":8,"column":1,"offset":311},"end":{"line":8,"column":150,"offset":460},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":8,"column":150,"offset":460},"end":{"line":8,"column":156,"offset":466},"indent":[]}},{"type":"text","value":", the expression matches, and Cloudflare triggers the action for that rule.","position":{"start":{"line":8,"column":156,"offset":466},"end":{"line":8,"column":231,"offset":541},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":311},"end":{"line":8,"column":231,"offset":541},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Working with expressions","position":{"start":{"line":10,"column":4,"offset":546},"end":{"line":10,"column":28,"offset":570},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":543},"end":{"line":10,"column":28,"offset":570},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"There are two interfaces in the ","position":{"start":{"line":12,"column":1,"offset":572},"end":{"line":12,"column":33,"offset":604},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":12,"column":35,"offset":606},"end":{"line":12,"column":43,"offset":614},"indent":[]}}],"position":{"start":{"line":12,"column":33,"offset":604},"end":{"line":12,"column":45,"offset":616},"indent":[]}},{"type":"text","value":" app for creating expressions: the ","position":{"start":{"line":12,"column":45,"offset":616},"end":{"line":12,"column":80,"offset":651},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":12,"column":82,"offset":653},"end":{"line":12,"column":100,"offset":671},"indent":[]}}],"position":{"start":{"line":12,"column":80,"offset":651},"end":{"line":12,"column":102,"offset":673},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":12,"column":102,"offset":673},"end":{"line":12,"column":111,"offset":682},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":12,"column":113,"offset":684},"end":{"line":12,"column":130,"offset":701},"indent":[]}}],"position":{"start":{"line":12,"column":111,"offset":682},"end":{"line":12,"column":132,"offset":703},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":12,"column":132,"offset":703},"end":{"line":12,"column":133,"offset":704},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":572},"end":{"line":12,"column":133,"offset":704},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Expression Builder’s visual interface allows you to build expressions without worrying about field names and syntax.","position":{"start":{"line":14,"column":1,"offset":706},"end":{"line":14,"column":121,"offset":826},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":706},"end":{"line":14,"column":121,"offset":826},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"By comparison, the Expression Editor is text only, but it supports advanced features not available in the builder. You can find both in the ","position":{"start":{"line":16,"column":1,"offset":828},"end":{"line":16,"column":141,"offset":968},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":16,"column":143,"offset":970},"end":{"line":16,"column":157,"offset":984},"indent":[]}}],"position":{"start":{"line":16,"column":141,"offset":968},"end":{"line":16,"column":159,"offset":986},"indent":[]}},{"type":"text","value":" tab.","position":{"start":{"line":16,"column":159,"offset":986},"end":{"line":16,"column":164,"offset":991},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":828},"end":{"line":16,"column":164,"offset":991},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":18,"column":1,"offset":993},"end":{"line":18,"column":5,"offset":997},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"emphasis","children":[{"type":"text","value":"Cloudflare Filters API","position":{"start":{"line":18,"column":7,"offset":999},"end":{"line":18,"column":29,"offset":1021},"indent":[]}}],"position":{"start":{"line":18,"column":6,"offset":998},"end":{"line":18,"column":30,"offset":1022},"indent":[]}}],"position":{"start":{"line":18,"column":5,"offset":997},"end":{"line":18,"column":48,"offset":1040},"indent":[]}},{"type":"text","value":" provides an interface for programmatically managing expressions. Use ","position":{"start":{"line":18,"column":48,"offset":1040},"end":{"line":18,"column":118,"offset":1110},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-firewall-rules","children":[{"type":"emphasis","children":[{"type":"text","value":"Firewall Rules API","position":{"start":{"line":18,"column":120,"offset":1112},"end":{"line":18,"column":138,"offset":1130},"indent":[]}}],"position":{"start":{"line":18,"column":119,"offset":1111},"end":{"line":18,"column":139,"offset":1131},"indent":[]}}],"position":{"start":{"line":18,"column":118,"offset":1110},"end":{"line":18,"column":164,"offset":1156},"indent":[]}},{"type":"text","value":" to combine a filter with an action and deploy a new firewall rule.","position":{"start":{"line":18,"column":164,"offset":1156},"end":{"line":18,"column":231,"offset":1223},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":993},"end":{"line":18,"column":231,"offset":1223},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Simple and compound expressions","position":{"start":{"line":20,"column":4,"offset":1228},"end":{"line":20,"column":35,"offset":1259},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1225},"end":{"line":20,"column":35,"offset":1259},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When working with Firewall Rules, you will encounter two kinds of expressions:","position":{"start":{"line":22,"column":1,"offset":1261},"end":{"line":22,"column":79,"offset":1339},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1261},"end":{"line":22,"column":79,"offset":1339},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Simple expressions","position":{"start":{"line":24,"column":5,"offset":1345},"end":{"line":24,"column":23,"offset":1363},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":1343},"end":{"line":24,"column":25,"offset":1365},"indent":[]}},{"type":"text","value":" compare a value from an HTTP request to a value defined in the expression. You can identify a simple expression by the presence of a ","position":{"start":{"line":24,"column":25,"offset":1365},"end":{"line":24,"column":159,"offset":1499},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":24,"column":161,"offset":1501},"end":{"line":24,"column":180,"offset":1520},"indent":[]}}],"position":{"start":{"line":24,"column":159,"offset":1499},"end":{"line":24,"column":182,"offset":1522},"indent":[]}},{"type":"text","value":" (","position":{"start":{"line":24,"column":182,"offset":1522},"end":{"line":24,"column":184,"offset":1524},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"equals, less than","position":{"start":{"line":24,"column":185,"offset":1525},"end":{"line":24,"column":202,"offset":1542},"indent":[]}}],"position":{"start":{"line":24,"column":184,"offset":1524},"end":{"line":24,"column":203,"offset":1543},"indent":[]}},{"type":"text","value":", for example).","position":{"start":{"line":24,"column":203,"offset":1543},"end":{"line":24,"column":218,"offset":1558},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":1343},"end":{"line":24,"column":218,"offset":1558},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1341},"end":{"line":25,"column":1,"offset":1559},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Compound expressions","position":{"start":{"line":26,"column":5,"offset":1564},"end":{"line":26,"column":25,"offset":1584},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1562},"end":{"line":26,"column":27,"offset":1586},"indent":[]}},{"type":"text","value":" combine two or more simple expressions into a single\nexpression. You can identify a compound expression by the presence of a ","position":{"start":{"line":26,"column":27,"offset":1586},"end":{"line":27,"column":75,"offset":1714},"indent":[3]}},{"type":"strong","children":[{"type":"text","value":"logical operator","position":{"start":{"line":27,"column":77,"offset":1716},"end":{"line":27,"column":93,"offset":1732},"indent":[]}}],"position":{"start":{"line":27,"column":75,"offset":1714},"end":{"line":27,"column":95,"offset":1734},"indent":[]}},{"type":"text","value":" (","position":{"start":{"line":27,"column":95,"offset":1734},"end":{"line":27,"column":97,"offset":1736},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"and","position":{"start":{"line":27,"column":98,"offset":1737},"end":{"line":27,"column":101,"offset":1740},"indent":[]}}],"position":{"start":{"line":27,"column":97,"offset":1736},"end":{"line":27,"column":102,"offset":1741},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":27,"column":102,"offset":1741},"end":{"line":27,"column":104,"offset":1743},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"or","position":{"start":{"line":27,"column":105,"offset":1744},"end":{"line":27,"column":107,"offset":1746},"indent":[]}}],"position":{"start":{"line":27,"column":104,"offset":1743},"end":{"line":27,"column":108,"offset":1747},"indent":[]}},{"type":"text","value":", for example). Since each firewall rule can only contain a single expression, compound expressions allow you to tailor rules to specific use cases with a high degree of accuracy and precision.","position":{"start":{"line":27,"column":108,"offset":1747},"end":{"line":27,"column":301,"offset":1940},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1562},"end":{"line":27,"column":301,"offset":1940},"indent":[3]}}],"position":{"start":{"line":26,"column":1,"offset":1560},"end":{"line":27,"column":301,"offset":1940},"indent":[1]}}],"position":{"start":{"line":24,"column":1,"offset":1341},"end":{"line":27,"column":301,"offset":1940},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Simple expressions","position":{"start":{"line":29,"column":5,"offset":1946},"end":{"line":29,"column":23,"offset":1964},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1942},"end":{"line":29,"column":23,"offset":1964},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions are composed of 3 elements:","position":{"start":{"line":31,"column":1,"offset":1966},"end":{"line":31,"column":47,"offset":2012},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1966},"end":{"line":31,"column":47,"offset":2012},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":33,"column":4,"offset":2017},"end":{"line":33,"column":6,"offset":2019},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"field","position":{"start":{"line":33,"column":8,"offset":2021},"end":{"line":33,"column":13,"offset":2026},"indent":[]}}],"position":{"start":{"line":33,"column":6,"offset":2019},"end":{"line":33,"column":15,"offset":2028},"indent":[]}},{"type":"text","value":" that represents a property of an HTTP request.","position":{"start":{"line":33,"column":15,"offset":2028},"end":{"line":33,"column":62,"offset":2075},"indent":[]}}],"position":{"start":{"line":33,"column":4,"offset":2017},"end":{"line":33,"column":62,"offset":2075},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2014},"end":{"line":33,"column":62,"offset":2075},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A representative ","position":{"start":{"line":34,"column":4,"offset":2079},"end":{"line":34,"column":21,"offset":2096},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"value","position":{"start":{"line":34,"column":23,"offset":2098},"end":{"line":34,"column":28,"offset":2103},"indent":[]}}],"position":{"start":{"line":34,"column":21,"offset":2096},"end":{"line":34,"column":30,"offset":2105},"indent":[]}},{"type":"text","value":" for that field, which Firewall Rules will compare with the actual value from the request.","position":{"start":{"line":34,"column":30,"offset":2105},"end":{"line":34,"column":120,"offset":2195},"indent":[]}}],"position":{"start":{"line":34,"column":4,"offset":2079},"end":{"line":34,"column":120,"offset":2195},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":2076},"end":{"line":34,"column":120,"offset":2195},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":35,"column":4,"offset":2199},"end":{"line":35,"column":6,"offset":2201},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":35,"column":8,"offset":2203},"end":{"line":35,"column":27,"offset":2222},"indent":[]}}],"position":{"start":{"line":35,"column":6,"offset":2201},"end":{"line":35,"column":29,"offset":2224},"indent":[]}},{"type":"text","value":", which specifies how the value defined in the expression must relate to the actual value from the request for the operator to return ","position":{"start":{"line":35,"column":29,"offset":2224},"end":{"line":35,"column":163,"offset":2358},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":35,"column":163,"offset":2358},"end":{"line":35,"column":169,"offset":2364},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":35,"column":169,"offset":2364},"end":{"line":35,"column":170,"offset":2365},"indent":[]}}],"position":{"start":{"line":35,"column":4,"offset":2199},"end":{"line":35,"column":170,"offset":2365},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":2196},"end":{"line":35,"column":170,"offset":2365},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2014},"end":{"line":35,"column":170,"offset":2365},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If the comparison operator returns ","position":{"start":{"line":37,"column":1,"offset":2367},"end":{"line":37,"column":36,"offset":2402},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":37,"column":36,"offset":2402},"end":{"line":37,"column":42,"offset":2408},"indent":[]}},{"type":"text","value":", the request matches the expression.","position":{"start":{"line":37,"column":42,"offset":2408},"end":{"line":37,"column":79,"offset":2445},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":2367},"end":{"line":37,"column":79,"offset":2445},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This Expression Builder screenshot shows an expression for matching requests that do not originate in the United Kingdom.","position":{"start":{"line":39,"column":1,"offset":2447},"end":{"line":39,"column":122,"offset":2568},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2447},"end":{"line":39,"column":122,"offset":2568},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-explained-1.png","alt":"Expression Builder","position":{"start":{"line":41,"column":1,"offset":2570},"end":{"line":41,"column":76,"offset":2645},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2570},"end":{"line":41,"column":76,"offset":2645},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Notice how the ","position":{"start":{"line":43,"column":1,"offset":2647},"end":{"line":43,"column":16,"offset":2662},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Preview","position":{"start":{"line":43,"column":18,"offset":2664},"end":{"line":43,"column":36,"offset":2682},"indent":[]}}],"position":{"start":{"line":43,"column":16,"offset":2662},"end":{"line":43,"column":38,"offset":2684},"indent":[]}},{"type":"text","value":" displays the expression in text:","position":{"start":{"line":43,"column":38,"offset":2684},"end":{"line":43,"column":71,"offset":2717},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":2647},"end":{"line":43,"column":71,"offset":2717},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(ip.geoip.country ne \"GB\")","position":{"start":{"line":45,"column":1,"offset":2719},"end":{"line":47,"column":4,"offset":2756},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In this example, ","position":{"start":{"line":49,"column":1,"offset":2758},"end":{"line":49,"column":18,"offset":2775},"indent":[]}},{"type":"inlineCode","value":"ip.geoip.country","position":{"start":{"line":49,"column":18,"offset":2775},"end":{"line":49,"column":36,"offset":2793},"indent":[]}},{"type":"text","value":" represents the country associated with the requesting client’s IP address, and the value ","position":{"start":{"line":49,"column":36,"offset":2793},"end":{"line":49,"column":126,"offset":2883},"indent":[]}},{"type":"inlineCode","value":"\"GB\"","position":{"start":{"line":49,"column":126,"offset":2883},"end":{"line":49,"column":132,"offset":2889},"indent":[]}},{"type":"text","value":" represents the country code to match. The ","position":{"start":{"line":49,"column":132,"offset":2889},"end":{"line":49,"column":175,"offset":2932},"indent":[]}},{"type":"inlineCode","value":"ne","position":{"start":{"line":49,"column":175,"offset":2932},"end":{"line":49,"column":179,"offset":2936},"indent":[]}},{"type":"text","value":" notation between them represents the ","position":{"start":{"line":49,"column":179,"offset":2936},"end":{"line":49,"column":217,"offset":2974},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"not equal","position":{"start":{"line":49,"column":218,"offset":2975},"end":{"line":49,"column":227,"offset":2984},"indent":[]}}],"position":{"start":{"line":49,"column":217,"offset":2974},"end":{"line":49,"column":228,"offset":2985},"indent":[]}},{"type":"text","value":" comparison operator. Together, the expression specifies a match for any request with a country field value other than ","position":{"start":{"line":49,"column":228,"offset":2985},"end":{"line":49,"column":347,"offset":3104},"indent":[]}},{"type":"inlineCode","value":"GB","position":{"start":{"line":49,"column":347,"offset":3104},"end":{"line":49,"column":351,"offset":3108},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":49,"column":351,"offset":3108},"end":{"line":49,"column":352,"offset":3109},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":2758},"end":{"line":49,"column":352,"offset":3109},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions use this pattern:","position":{"start":{"line":51,"column":1,"offset":3111},"end":{"line":51,"column":37,"offset":3147},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":3111},"end":{"line":51,"column":37,"offset":3147},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"<field> <comparison operator> <value>","position":{"start":{"line":53,"column":1,"offset":3149},"end":{"line":55,"column":4,"offset":3197},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For more on creating firewall rules using Cloudflare’s visual builder, see ","position":{"start":{"line":57,"column":1,"offset":3199},"end":{"line":57,"column":76,"offset":3274},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules","children":[{"type":"emphasis","children":[{"type":"text","value":"Create, edit, and delete rules","position":{"start":{"line":57,"column":78,"offset":3276},"end":{"line":57,"column":108,"offset":3306},"indent":[]}}],"position":{"start":{"line":57,"column":77,"offset":3275},"end":{"line":57,"column":109,"offset":3307},"indent":[]}}],"position":{"start":{"line":57,"column":76,"offset":3274},"end":{"line":57,"column":150,"offset":3348},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":57,"column":150,"offset":3348},"end":{"line":57,"column":151,"offset":3349},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":3199},"end":{"line":57,"column":151,"offset":3349},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For a list of supported fields and comparison operators, see ","position":{"start":{"line":59,"column":1,"offset":3351},"end":{"line":59,"column":62,"offset":3412},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/","children":[{"type":"emphasis","children":[{"type":"text","value":"Firewall Rules language","position":{"start":{"line":59,"column":64,"offset":3414},"end":{"line":59,"column":87,"offset":3437},"indent":[]}}],"position":{"start":{"line":59,"column":63,"offset":3413},"end":{"line":59,"column":88,"offset":3438},"indent":[]}}],"position":{"start":{"line":59,"column":62,"offset":3412},"end":{"line":59,"column":113,"offset":3463},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":59,"column":113,"offset":3463},"end":{"line":59,"column":114,"offset":3464},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":3351},"end":{"line":59,"column":114,"offset":3464},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Compound expressions","position":{"start":{"line":61,"column":5,"offset":3470},"end":{"line":61,"column":25,"offset":3490},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":3466},"end":{"line":61,"column":25,"offset":3490},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":63,"column":1,"offset":3492},"end":{"line":63,"column":3,"offset":3494},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"compound expression","position":{"start":{"line":63,"column":5,"offset":3496},"end":{"line":63,"column":24,"offset":3515},"indent":[]}}],"position":{"start":{"line":63,"column":3,"offset":3494},"end":{"line":63,"column":26,"offset":3517},"indent":[]}},{"type":"text","value":" uses a ","position":{"start":{"line":63,"column":26,"offset":3517},"end":{"line":63,"column":34,"offset":3525},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"logical operator","position":{"start":{"line":63,"column":36,"offset":3527},"end":{"line":63,"column":52,"offset":3543},"indent":[]}}],"position":{"start":{"line":63,"column":34,"offset":3525},"end":{"line":63,"column":54,"offset":3545},"indent":[]}},{"type":"text","value":" (","position":{"start":{"line":63,"column":54,"offset":3545},"end":{"line":63,"column":56,"offset":3547},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"and","position":{"start":{"line":63,"column":57,"offset":3548},"end":{"line":63,"column":60,"offset":3551},"indent":[]}}],"position":{"start":{"line":63,"column":56,"offset":3547},"end":{"line":63,"column":61,"offset":3552},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":63,"column":61,"offset":3552},"end":{"line":63,"column":63,"offset":3554},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"or","position":{"start":{"line":63,"column":64,"offset":3555},"end":{"line":63,"column":66,"offset":3557},"indent":[]}}],"position":{"start":{"line":63,"column":63,"offset":3554},"end":{"line":63,"column":67,"offset":3558},"indent":[]}},{"type":"text","value":", for example) to combine two or more expressions. Compound expressions are powerful because they allow you to build complex statements within a single expression.","position":{"start":{"line":63,"column":67,"offset":3558},"end":{"line":63,"column":230,"offset":3721},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":3492},"end":{"line":63,"column":230,"offset":3721},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, suppose you want to stop other sites from direct linking to your website’s content. To do that, you can build an expression that matches requests to access your content URI, as in this example:","position":{"start":{"line":65,"column":1,"offset":3723},"end":{"line":65,"column":207,"offset":3929},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":3723},"end":{"line":65,"column":207,"offset":3929},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"http.request.uri.path eq \"/content/\"","position":{"start":{"line":67,"column":1,"offset":3931},"end":{"line":69,"column":4,"offset":3978},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"While this expression will match requests for content, it does not discriminate between internal and external requests. As is, this rule will match every content request, including those referred from our own domain.","position":{"start":{"line":71,"column":1,"offset":3980},"end":{"line":71,"column":217,"offset":4196},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":3980},"end":{"line":71,"column":217,"offset":4196},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To match only external requests for content, use the ","position":{"start":{"line":73,"column":1,"offset":4198},"end":{"line":73,"column":54,"offset":4251},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":73,"column":54,"offset":4251},"end":{"line":73,"column":59,"offset":4256},"indent":[]}},{"type":"text","value":" operator, as in this example:","position":{"start":{"line":73,"column":59,"offset":4256},"end":{"line":73,"column":89,"offset":4286},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":4198},"end":{"line":73,"column":89,"offset":4286},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"http.referer ne \".example.com\" and http.request.uri.path eq \"/content/\"","position":{"start":{"line":75,"column":1,"offset":4288},"end":{"line":77,"column":4,"offset":4370},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Compound expressions only match requests that satisfy each of the simple expressions within. That is because the logical ","position":{"start":{"line":79,"column":1,"offset":4372},"end":{"line":79,"column":122,"offset":4493},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":79,"column":122,"offset":4493},"end":{"line":79,"column":127,"offset":4498},"indent":[]}},{"type":"text","value":" operator requires that both operands be true for the compound expression to return ","position":{"start":{"line":79,"column":127,"offset":4498},"end":{"line":79,"column":211,"offset":4582},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":79,"column":211,"offset":4582},"end":{"line":79,"column":217,"offset":4588},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":79,"column":217,"offset":4588},"end":{"line":79,"column":218,"offset":4589},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":4372},"end":{"line":79,"column":218,"offset":4589},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In general, compound expressions use this pattern:","position":{"start":{"line":81,"column":1,"offset":4591},"end":{"line":81,"column":51,"offset":4641},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":4591},"end":{"line":81,"column":51,"offset":4641},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"<expression> <logical operator> <expression>","position":{"start":{"line":83,"column":1,"offset":4643},"end":{"line":85,"column":4,"offset":4698},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note that a compound expression can itself be one of the operands of a logical operator. In this way, you can use multiple operators to construct a compound expression from many individual expressions.","position":{"start":{"line":87,"column":1,"offset":4700},"end":{"line":87,"column":202,"offset":4901},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":4700},"end":{"line":87,"column":202,"offset":4901},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Compound expressions are easier to scan when displayed in the Expression Builder’s visual interface, and the Expression Preview is a great reference for learning to write more advanced expressions.","position":{"start":{"line":89,"column":1,"offset":4903},"end":{"line":89,"column":198,"offset":5100},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":4903},"end":{"line":89,"column":198,"offset":5100},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-explained-2.png","alt":"Expression Builder with compound expression","position":{"start":{"line":91,"column":1,"offset":5102},"end":{"line":91,"column":101,"offset":5202},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":5102},"end":{"line":91,"column":101,"offset":5202},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For a list of supported logical operators, see ","position":{"start":{"line":93,"column":1,"offset":5204},"end":{"line":93,"column":48,"offset":5251},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators","children":[{"type":"emphasis","children":[{"type":"text","value":"Firewall Rules language: Operators","position":{"start":{"line":93,"column":50,"offset":5253},"end":{"line":93,"column":84,"offset":5287},"indent":[]}}],"position":{"start":{"line":93,"column":49,"offset":5252},"end":{"line":93,"column":85,"offset":5288},"indent":[]}}],"position":{"start":{"line":93,"column":48,"offset":5251},"end":{"line":93,"column":119,"offset":5322},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":93,"column":119,"offset":5322},"end":{"line":93,"column":120,"offset":5323},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":5204},"end":{"line":93,"column":120,"offset":5323},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":96,"column":71,"offset":5396}}}}},{"node":{"fields":{"slug":"/cf-firewall-language"},"frontmatter":{"order":600,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Firewall Rules language"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Firewall Rules language","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":26,"offset":26},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":26,"offset":26},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language is a flexible and intuitive specification for building Firewall Rules expressions. Based on the widely known ","position":{"start":{"line":4,"column":1,"offset":28},"end":{"line":4,"column":149,"offset":176},"indent":[]}},{"type":"link","title":null,"url":"https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html","children":[{"type":"text","value":"Wireshark display filters","position":{"start":{"line":4,"column":150,"offset":177},"end":{"line":4,"column":175,"offset":202},"indent":[]}}],"position":{"start":{"line":4,"column":149,"offset":176},"end":{"line":4,"column":263,"offset":290},"indent":[]}},{"type":"text","value":", the Firewall Rules language allows you to precisely target HTTP requests with a syntax and semantics familiar to security engineers.","position":{"start":{"line":4,"column":263,"offset":290},"end":{"line":4,"column":397,"offset":424},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":28},"end":{"line":4,"column":397,"offset":424},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When evaluating a firewall rule, Cloudflare compares values associated with an HTTP request to those defined in the firewall rule's ","position":{"start":{"line":6,"column":1,"offset":426},"end":{"line":6,"column":133,"offset":558},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-rules/fields-and-expressions/","children":[{"type":"text","value":"expression","position":{"start":{"line":6,"column":134,"offset":559},"end":{"line":6,"column":144,"offset":569},"indent":[]}}],"position":{"start":{"line":6,"column":133,"offset":558},"end":{"line":6,"column":231,"offset":656},"indent":[]}},{"type":"text","value":". If the expression evaluates ","position":{"start":{"line":6,"column":231,"offset":656},"end":{"line":6,"column":261,"offset":686},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":6,"column":261,"offset":686},"end":{"line":6,"column":267,"offset":692},"indent":[]}},{"type":"text","value":", Cloudflare triggers the ","position":{"start":{"line":6,"column":267,"offset":692},"end":{"line":6,"column":293,"offset":718},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-rules/actions/","children":[{"type":"text","value":"action","position":{"start":{"line":6,"column":294,"offset":719},"end":{"line":6,"column":300,"offset":725},"indent":[]}}],"position":{"start":{"line":6,"column":293,"offset":718},"end":{"line":6,"column":372,"offset":797},"indent":[]}},{"type":"text","value":" for that rule.","position":{"start":{"line":6,"column":372,"offset":797},"end":{"line":6,"column":387,"offset":812},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":426},"end":{"line":6,"column":387,"offset":812},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language supports two kinds of expression—simple and compound.","position":{"start":{"line":8,"column":1,"offset":814},"end":{"line":8,"column":82,"offset":895},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":814},"end":{"line":8,"column":82,"offset":895},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Simple expressions","position":{"start":{"line":10,"column":4,"offset":900},"end":{"line":10,"column":22,"offset":918},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":897},"end":{"line":10,"column":22,"offset":918},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Simple expressions","position":{"start":{"line":12,"column":3,"offset":922},"end":{"line":12,"column":21,"offset":940},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":920},"end":{"line":12,"column":23,"offset":942},"indent":[]}},{"type":"text","value":" compare a value from an HTTP request to a value defined in the expression. For example, this simple expression matches Microsoft Exchange Autodiscover requests:","position":{"start":{"line":12,"column":23,"offset":942},"end":{"line":12,"column":184,"offset":1103},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":920},"end":{"line":12,"column":184,"offset":1103},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"http.request.uri.path matches \"/autodiscover\\.(xml|src)$\"","position":{"start":{"line":14,"column":1,"offset":1105},"end":{"line":16,"column":4,"offset":1173},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions have the syntax","position":{"start":{"line":18,"column":1,"offset":1175},"end":{"line":18,"column":35,"offset":1209},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1175},"end":{"line":18,"column":35,"offset":1209},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"<field> <comparison-operator> <value>","position":{"start":{"line":20,"column":1,"offset":1211},"end":{"line":22,"column":4,"offset":1259},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"where","position":{"start":{"line":24,"column":1,"offset":1261},"end":{"line":24,"column":6,"offset":1266},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1261},"end":{"line":24,"column":6,"offset":1266},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-language/fields/#fields","children":[{"type":"text","value":"Fields","position":{"start":{"line":26,"column":4,"offset":1271},"end":{"line":26,"column":10,"offset":1277},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1270},"end":{"line":26,"column":91,"offset":1358},"indent":[]}},{"type":"text","value":" specify properties associated with an HTTP request.","position":{"start":{"line":26,"column":91,"offset":1358},"end":{"line":26,"column":143,"offset":1410},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1270},"end":{"line":26,"column":143,"offset":1410},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1268},"end":{"line":27,"column":1,"offset":1411},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-language/operators/#comparison-operators","children":[{"type":"text","value":"Comparison operators","position":{"start":{"line":28,"column":4,"offset":1415},"end":{"line":28,"column":24,"offset":1435},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":1414},"end":{"line":28,"column":122,"offset":1533},"indent":[]}},{"type":"text","value":" define how values must relate to actual request data for an expression to return ","position":{"start":{"line":28,"column":122,"offset":1533},"end":{"line":28,"column":204,"offset":1615},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":28,"column":204,"offset":1615},"end":{"line":28,"column":210,"offset":1621},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":28,"column":210,"offset":1621},"end":{"line":28,"column":211,"offset":1622},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":1414},"end":{"line":28,"column":211,"offset":1622},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1412},"end":{"line":29,"column":1,"offset":1623},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-language/values/#values","children":[{"type":"text","value":"Values","position":{"start":{"line":30,"column":4,"offset":1627},"end":{"line":30,"column":10,"offset":1633},"indent":[]}}],"position":{"start":{"line":30,"column":3,"offset":1626},"end":{"line":30,"column":91,"offset":1714},"indent":[]}},{"type":"text","value":" represent the data associated with fields. When evaluating a firewall rule, Cloudflare compares these values with the actual data obtained from the request.","position":{"start":{"line":30,"column":91,"offset":1714},"end":{"line":30,"column":248,"offset":1871},"indent":[]}}],"position":{"start":{"line":30,"column":3,"offset":1626},"end":{"line":30,"column":248,"offset":1871},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1624},"end":{"line":30,"column":248,"offset":1871},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1268},"end":{"line":30,"column":248,"offset":1871},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Compound expressions","position":{"start":{"line":32,"column":4,"offset":1876},"end":{"line":32,"column":24,"offset":1896},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1873},"end":{"line":32,"column":24,"offset":1896},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Compound expressions","position":{"start":{"line":34,"column":3,"offset":1900},"end":{"line":34,"column":23,"offset":1920},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1898},"end":{"line":34,"column":25,"offset":1922},"indent":[]}},{"type":"text","value":" use ","position":{"start":{"line":34,"column":25,"offset":1922},"end":{"line":34,"column":30,"offset":1927},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-language/operators/#logical-operators","children":[{"type":"text","value":"logical operators","position":{"start":{"line":34,"column":31,"offset":1928},"end":{"line":34,"column":48,"offset":1945},"indent":[]}}],"position":{"start":{"line":34,"column":30,"offset":1927},"end":{"line":34,"column":143,"offset":2040},"indent":[]}},{"type":"text","value":" such as ","position":{"start":{"line":34,"column":143,"offset":2040},"end":{"line":34,"column":152,"offset":2049},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":34,"column":152,"offset":2049},"end":{"line":34,"column":157,"offset":2054},"indent":[]}},{"type":"text","value":" to combine two or more expressions into a single expression.","position":{"start":{"line":34,"column":157,"offset":2054},"end":{"line":34,"column":218,"offset":2115},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1898},"end":{"line":34,"column":218,"offset":2115},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, this expression uses the ","position":{"start":{"line":36,"column":1,"offset":2117},"end":{"line":36,"column":39,"offset":2155},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":36,"column":39,"offset":2155},"end":{"line":36,"column":44,"offset":2160},"indent":[]}},{"type":"text","value":" operator to target requests to ","position":{"start":{"line":36,"column":44,"offset":2160},"end":{"line":36,"column":76,"offset":2192},"indent":[]}},{"type":"inlineCode","value":"www.example.com","position":{"start":{"line":36,"column":76,"offset":2192},"end":{"line":36,"column":93,"offset":2209},"indent":[]}},{"type":"text","value":" that are not on ports 80 or 443:","position":{"start":{"line":36,"column":93,"offset":2209},"end":{"line":36,"column":126,"offset":2242},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":2117},"end":{"line":36,"column":126,"offset":2242},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"host eq www.example.com and not cf.edge.server_port in {80 443}","position":{"start":{"line":38,"column":1,"offset":2244},"end":{"line":40,"column":4,"offset":2318},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Compound expressions have the following general syntax:","position":{"start":{"line":42,"column":1,"offset":2320},"end":{"line":42,"column":56,"offset":2375},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":2320},"end":{"line":42,"column":56,"offset":2375},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"<expression> <logical-operator> <expression>","position":{"start":{"line":44,"column":1,"offset":2377},"end":{"line":46,"column":4,"offset":2432},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Compound expressions allow you to generate sophisticated, highly targeted firewall rules.","position":{"start":{"line":48,"column":1,"offset":2434},"end":{"line":48,"column":90,"offset":2523},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2434},"end":{"line":48,"column":90,"offset":2523},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Grouping symbols and functions","position":{"start":{"line":50,"column":4,"offset":2528},"end":{"line":50,"column":34,"offset":2558},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2525},"end":{"line":50,"column":34,"offset":2558},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language includes support for grouping symbols and functions. Each of these expand the power and flexibility of the language:","position":{"start":{"line":52,"column":1,"offset":2560},"end":{"line":52,"column":145,"offset":2704},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2560},"end":{"line":52,"column":145,"offset":2704},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-language/operators/#grouping-symbols","children":[{"type":"text","value":"Grouping symbols","position":{"start":{"line":54,"column":4,"offset":2709},"end":{"line":54,"column":20,"offset":2725},"indent":[]}}],"position":{"start":{"line":54,"column":3,"offset":2708},"end":{"line":54,"column":114,"offset":2819},"indent":[]}},{"type":"text","value":" allow you to explicitly group expressions that should be evaluated together.","position":{"start":{"line":54,"column":114,"offset":2819},"end":{"line":54,"column":191,"offset":2896},"indent":[]}}],"position":{"start":{"line":54,"column":3,"offset":2708},"end":{"line":54,"column":191,"offset":2896},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":2706},"end":{"line":55,"column":1,"offset":2897},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-firewall-language/functions/#functions","children":[{"type":"text","value":"Functions","position":{"start":{"line":56,"column":4,"offset":2901},"end":{"line":56,"column":13,"offset":2910},"indent":[]}}],"position":{"start":{"line":56,"column":3,"offset":2900},"end":{"line":56,"column":100,"offset":2997},"indent":[]}},{"type":"text","value":" allow you to manipulate and validate values in expressions.","position":{"start":{"line":56,"column":100,"offset":2997},"end":{"line":56,"column":160,"offset":3057},"indent":[]}}],"position":{"start":{"line":56,"column":3,"offset":2900},"end":{"line":56,"column":160,"offset":3057},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":2898},"end":{"line":56,"column":160,"offset":3057},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":2706},"end":{"line":56,"column":160,"offset":3057},"indent":[1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":59,"column":73,"offset":3132}}}}},{"node":{"fields":{"slug":"/cf-firewall-language/operators"},"frontmatter":{"order":610,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Operators and grouping symbols"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Operators and grouping symbols","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":33,"offset":33},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":33,"offset":33},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports comparison and logical operators:","position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":82,"offset":116},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":82,"offset":116},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#comparison-operators","children":[{"type":"text","value":"Comparison operators","position":{"start":{"line":6,"column":4,"offset":121},"end":{"line":6,"column":24,"offset":141},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":120},"end":{"line":6,"column":48,"offset":165},"indent":[]}},{"type":"text","value":" specify how values defined in an expression must relate to the actual HTTP request value for the expression to return ","position":{"start":{"line":6,"column":48,"offset":165},"end":{"line":6,"column":167,"offset":284},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":6,"column":167,"offset":284},"end":{"line":6,"column":173,"offset":290},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":173,"offset":290},"end":{"line":6,"column":174,"offset":291},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":120},"end":{"line":6,"column":174,"offset":291},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":118},"end":{"line":6,"column":174,"offset":291},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#logical-operators","children":[{"type":"text","value":"Logical operators","position":{"start":{"line":7,"column":4,"offset":295},"end":{"line":7,"column":21,"offset":312},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":294},"end":{"line":7,"column":42,"offset":333},"indent":[]}},{"type":"text","value":" combine two expressions to form a compound expression and use order of precedence to determine how an expression is evaluated.","position":{"start":{"line":7,"column":42,"offset":333},"end":{"line":7,"column":169,"offset":460},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":294},"end":{"line":7,"column":169,"offset":460},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":292},"end":{"line":7,"column":169,"offset":460},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":118},"end":{"line":7,"column":169,"offset":460},"indent":[1]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-firewall-language/operators/#grouping-symbols","children":[{"type":"text","value":"Grouping symbols","position":{"start":{"line":9,"column":2,"offset":463},"end":{"line":9,"column":18,"offset":479},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":462},"end":{"line":9,"column":70,"offset":531},"indent":[]}},{"type":"text","value":" allow you to organize expressions, enforce precedence, and nest expressions.","position":{"start":{"line":9,"column":70,"offset":531},"end":{"line":9,"column":147,"offset":608},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":462},"end":{"line":9,"column":147,"offset":608},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Comparison operators","position":{"start":{"line":11,"column":4,"offset":613},"end":{"line":11,"column":24,"offset":633},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":610},"end":{"line":11,"column":24,"offset":633},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Comparison operators return ","position":{"start":{"line":13,"column":1,"offset":635},"end":{"line":13,"column":29,"offset":663},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":13,"column":29,"offset":663},"end":{"line":13,"column":35,"offset":669},"indent":[]}},{"type":"text","value":" when a value from an HTTP request matches a value defined in an expression.","position":{"start":{"line":13,"column":35,"offset":669},"end":{"line":13,"column":111,"offset":745},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":635},"end":{"line":13,"column":111,"offset":745},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This is the general pattern for using comparison operators:","position":{"start":{"line":15,"column":1,"offset":747},"end":{"line":15,"column":60,"offset":806},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":747},"end":{"line":15,"column":60,"offset":806},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"<field> <comparison operator> <value>","position":{"start":{"line":17,"column":1,"offset":808},"end":{"line":19,"column":4,"offset":856},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these comparison operators:","position":{"start":{"line":21,"column":1,"offset":858},"end":{"line":21,"column":76,"offset":933},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":858},"end":{"line":21,"column":76,"offset":933},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":23,"column":1,"offset":935},"end":{"line":23,"column":42,"offset":976},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to the ","position":{"start":{"line":25,"column":1,"offset":978},"end":{"line":25,"column":15,"offset":992},"indent":[]}},{"type":"inlineCode","value":"matches","position":{"start":{"line":25,"column":15,"offset":992},"end":{"line":25,"column":24,"offset":1001},"indent":[]}},{"type":"text","value":" operator requires a Cloudflare Business or Enterprise plan.","position":{"start":{"line":25,"column":24,"offset":1001},"end":{"line":25,"column":84,"offset":1061},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":978},"end":{"line":25,"column":84,"offset":1061},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":27,"column":1,"offset":1063},"end":{"line":27,"column":9,"offset":1071},"indent":[]}},{"type":"html","value":"<TableWrap style='width:100%'>\n<table style='width:100%'>\n  <thead>\n   <tr>\n      <th>Name</th>\n      <th colspan=\"2\" style=\"text-align:center\">Operator Notation</th>\n      <th colspan=\"3\" style=\"text-align:center\">Supported Data Types</th>\n      <th></th>\n   </tr>\n   <tr>\n      <td></td>\n      <th>English</th>\n      <th>C-like</th>\n      <th>String</th>\n      <th>IP</th>\n      <th>Number</th>\n      <th>Example (operator in bold)</th>\n   </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Equal</td>\n      <td><code class=\"InlineCode\">eq</code></td>\n      <td><code class=\"InlineCode\">==</code></td>\n      <td>&#x2705;</td>\n      <td>&#x2705;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">http.request.uri.path <strong>eq</strong> \"/articles/2008/\"</code>\n      </td>\n     </tr>\n    <tr>\n      <td>Not equal</td>\n      <td><code class=\"InlineCode\">ne</code></td>\n      <td><code class=\"InlineCode\">!=</code></td>\n      <td>&#x2705;</td>\n      <td>&#x2705;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">ip.src <strong>ne</strong> 93.184.216.0</code>\n      </td>\n    </tr>\n    <tr>\n      <td>Less than</td>\n      <td><code class=\"InlineCode\">lt</code></td>\n      <td><code class=\"InlineCode\">&lt;</code></td>\n      <td>&#x2705;</td>\n      <td>&#10060;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">cf.threat_score <strong>lt</strong> 10</code>\n      </td>\n   </tr>\n   <tr>\n      <td>Less than<br />or equal</td>\n      <td><code class=\"InlineCode\">le</code></td>\n      <td><code class=\"InlineCode\">&lt;=</code></td>\n      <td>&#x2705;</td>\n      <td>&#10060;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">cf.threat_score <strong>le</strong> 20</code>\n      </td>\n    </tr>\n    <tr>\n      <td>Greater than</td>\n      <td><code class=\"InlineCode\">gt</code></td>\n      <td><code class=\"InlineCode\">></code></td>\n      <td>&#x2705;</td>\n      <td>&#10060;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">cf.threat_score <strong>gt</strong> 25</code>\n      </td>\n    </tr>\n    <tr>\n      <td>Greater than<br />or equal</td>\n      <td><code class=\"InlineCode\">ge</code></td>\n      <td><code class=\"InlineCode\">&gt;=</code></td>\n      <td>&#x2705;</td>\n      <td>&#10060;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">cf.threat_score <strong>ge</strong> 60</code>\n      </td>\n    </tr>\n    <tr>\n      <td>Exactly<br />contains</td>\n      <td><code class=\"InlineCode\">contains</code></td>\n      <td></td>\n      <td>&#x2705;</td>\n      <td>&#10060;</td>\n      <td>&#10060;</td>\n      <td>\n         <code class=\"InlineCode\">http.request.uri.path <strong>contains</strong> \"/articles/\"</code>\n      </td>\n    </tr>\n    <tr>\n      <td>Matches<br />regex</td>\n      <td><code class=\"InlineCode\">matches</code></td>\n      <td><code class=\"InlineCode\">~</code></td>\n      <td>&#x2705;</td>\n      <td>&#10060;</td>\n      <td>&#10060;</td>\n      <td>\n         <code class=\"InlineCode\">http.request.uri.path <strong>matches</strong> \"^/articles/200[7-8]/$\"</code>\n      </td>\n    </tr>\n    <tr>\n      <td>Value is in <br />a set of values</td>\n      <td><code class=\"InlineCode\">in</code></td>\n      <td></td>\n      <td>&#x2705;</td>\n      <td>&#x2705;</td>\n      <td>&#x2705;</td>\n      <td>\n         <code class=\"InlineCode\">ip.src <strong>in</strong> {'{ 93.184.216.0 93.184.216.1 }'}</code>\n      </td>\n    </tr>\n  </tbody>\n</table>\n</TableWrap>","position":{"start":{"line":29,"column":1,"offset":1073},"end":{"line":150,"column":13,"offset":4566},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Logical operators","position":{"start":{"line":152,"column":4,"offset":4571},"end":{"line":152,"column":21,"offset":4588},"indent":[]}}],"position":{"start":{"line":152,"column":1,"offset":4568},"end":{"line":152,"column":21,"offset":4588},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Logical operators combine two or more expressions into a single compound expression. A compound expression has this general syntax:","position":{"start":{"line":154,"column":1,"offset":4590},"end":{"line":154,"column":132,"offset":4721},"indent":[]}}],"position":{"start":{"line":154,"column":1,"offset":4590},"end":{"line":154,"column":132,"offset":4721},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"<expression> <logical operator> <expression>","position":{"start":{"line":156,"column":1,"offset":4723},"end":{"line":158,"column":4,"offset":4778},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Supported logical operators","position":{"start":{"line":160,"column":5,"offset":4784},"end":{"line":160,"column":32,"offset":4811},"indent":[]}}],"position":{"start":{"line":160,"column":1,"offset":4780},"end":{"line":160,"column":32,"offset":4811},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Each logical operator has an ","position":{"start":{"line":162,"column":1,"offset":4813},"end":{"line":162,"column":30,"offset":4842},"indent":[]}},{"type":"link","title":null,"url":"#order-of-precedence","children":[{"type":"text","value":"order of precedence","position":{"start":{"line":162,"column":31,"offset":4843},"end":{"line":162,"column":50,"offset":4862},"indent":[]}}],"position":{"start":{"line":162,"column":30,"offset":4842},"end":{"line":162,"column":73,"offset":4885},"indent":[]}},{"type":"text","value":". The order of precedence (along with ","position":{"start":{"line":162,"column":73,"offset":4885},"end":{"line":162,"column":111,"offset":4923},"indent":[]}},{"type":"link","title":null,"url":"#grouping-symbols","children":[{"type":"text","value":"grouping symbols","position":{"start":{"line":162,"column":112,"offset":4924},"end":{"line":162,"column":128,"offset":4940},"indent":[]}}],"position":{"start":{"line":162,"column":111,"offset":4923},"end":{"line":162,"column":148,"offset":4960},"indent":[]}},{"type":"text","value":") determines the order in which Cloudflare evaluates logical operators in an expression. The ","position":{"start":{"line":162,"column":148,"offset":4960},"end":{"line":162,"column":241,"offset":5053},"indent":[]}},{"type":"inlineCode","value":"not","position":{"start":{"line":162,"column":241,"offset":5053},"end":{"line":162,"column":246,"offset":5058},"indent":[]}},{"type":"text","value":" operator ranks first in order of precedence.","position":{"start":{"line":162,"column":246,"offset":5058},"end":{"line":162,"column":291,"offset":5103},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":4813},"end":{"line":162,"column":291,"offset":5103},"indent":[]}},{"type":"html","value":"<TableWrap>\n<table style='width:100%'>\n  <thead>\n   <tr>\n      <th>Name</th>\n      <th>English<br />Notation</th>\n      <th>C-like<br />Notation</th>\n      <th>Example</th>\n      <th>Order of Precedence</th>\n   </tr>\n  </thead>\n  <tbody>\n   <tr>\n      <td>Logical NOT</td>\n      <td><code class=\"InlineCode\">not</code></td>\n      <td><code class=\"InlineCode\">!</code></td>\n      <td>\n         <code class=\"InlineCode\"><strong>not</strong> ( http.host eq \"www.cloudflare.com\" and ip.src in 93.184.216.0/24 )</code>\n      </td>\n      <td>1</td>\n   </tr>\n   <tr>\n      <td>Logical AND</td>\n      <td><code class=\"InlineCode\">and</code></td>\n      <td><code class=\"InlineCode\">&amp;&amp;</code></td>\n      <td>\n         <code class=\"InlineCode\">http.host eq \"www.cloudflare.com\" <strong>and</strong> ip.src in 93.184.216.0/24</code>\n      </td>\n      <td>2</td>\n   </tr>\n   <tr>\n      <td>Logical XOR<br />\n        (exclusive OR)</td>\n      <td><code class=\"InlineCode\">xor</code></td>\n      <td><code class=\"InlineCode\">^^</code></td>\n      <td>\n         <code class=\"InlineCode\">http.host eq \"www.cloudflare.com\" <strong>xor</strong> ip.src in 93.184.216.0/24</code>\n      </td>\n      <td>3</td>\n   </tr>\n   <tr>\n      <td>Logical OR</td>\n      <td><code class=\"InlineCode\">or</code></td>\n      <td><code class=\"InlineCode\">||</code></td>\n      <td>\n         <code class=\"InlineCode\">http.host eq \"www.cloudflare.com\" <strong>or</strong> ip.src in 93.184.216.0/24</code>\n      </td>\n      <td>4</td>\n   </tr>\n  </tbody>\n</table>\n</TableWrap>","position":{"start":{"line":164,"column":1,"offset":5105},"end":{"line":215,"column":13,"offset":6644},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Order of precedence","position":{"start":{"line":217,"column":5,"offset":6650},"end":{"line":217,"column":24,"offset":6669},"indent":[]}}],"position":{"start":{"line":217,"column":1,"offset":6646},"end":{"line":217,"column":24,"offset":6669},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":219,"column":1,"offset":6671},"end":{"line":219,"column":42,"offset":6712},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To avoid ambiguity when working with logical operators, use grouping symbols so that the order of evaluation is explicit.","position":{"start":{"line":221,"column":1,"offset":6714},"end":{"line":221,"column":122,"offset":6835},"indent":[]}}],"position":{"start":{"line":221,"column":1,"offset":6714},"end":{"line":221,"column":122,"offset":6835},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":223,"column":1,"offset":6837},"end":{"line":223,"column":9,"offset":6845},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When writing compound expressions, it is important to be aware of the precedence of logical operators so that your expression is evaluated the way you expect.","position":{"start":{"line":225,"column":1,"offset":6847},"end":{"line":225,"column":159,"offset":7005},"indent":[]}}],"position":{"start":{"line":225,"column":1,"offset":6847},"end":{"line":225,"column":159,"offset":7005},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, consider the following generic expression, which uses ","position":{"start":{"line":227,"column":1,"offset":7007},"end":{"line":227,"column":68,"offset":7074},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":227,"column":68,"offset":7074},"end":{"line":227,"column":73,"offset":7079},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":227,"column":73,"offset":7079},"end":{"line":227,"column":78,"offset":7084},"indent":[]}},{"type":"inlineCode","value":"or","position":{"start":{"line":227,"column":78,"offset":7084},"end":{"line":227,"column":82,"offset":7088},"indent":[]}},{"type":"text","value":" operators:","position":{"start":{"line":227,"column":82,"offset":7088},"end":{"line":227,"column":93,"offset":7099},"indent":[]}}],"position":{"start":{"line":227,"column":1,"offset":7007},"end":{"line":227,"column":93,"offset":7099},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"Expression1 and Expression2 or Expression3","position":{"start":{"line":229,"column":1,"offset":7101},"end":{"line":231,"column":4,"offset":7155},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If these operators had no order of precedence, it would not be clear which of two interpretations is correct:","position":{"start":{"line":233,"column":1,"offset":7157},"end":{"line":233,"column":110,"offset":7266},"indent":[]}}],"position":{"start":{"line":233,"column":1,"offset":7157},"end":{"line":233,"column":110,"offset":7266},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Match when Expression 1 and Expression 2 are both true ","position":{"start":{"line":235,"column":4,"offset":7271},"end":{"line":235,"column":59,"offset":7326},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"or","position":{"start":{"line":235,"column":61,"offset":7328},"end":{"line":235,"column":63,"offset":7330},"indent":[]}}],"position":{"start":{"line":235,"column":59,"offset":7326},"end":{"line":235,"column":65,"offset":7332},"indent":[]}},{"type":"text","value":" when Expression 3 is true.","position":{"start":{"line":235,"column":65,"offset":7332},"end":{"line":235,"column":92,"offset":7359},"indent":[]}}],"position":{"start":{"line":235,"column":4,"offset":7271},"end":{"line":235,"column":92,"offset":7359},"indent":[]}}],"position":{"start":{"line":235,"column":1,"offset":7268},"end":{"line":235,"column":92,"offset":7359},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Match when Expression 1 is true ","position":{"start":{"line":236,"column":4,"offset":7363},"end":{"line":236,"column":36,"offset":7395},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"and","position":{"start":{"line":236,"column":38,"offset":7397},"end":{"line":236,"column":41,"offset":7400},"indent":[]}}],"position":{"start":{"line":236,"column":36,"offset":7395},"end":{"line":236,"column":43,"offset":7402},"indent":[]}},{"type":"text","value":" either Expression 2 or Expression 3 is true.","position":{"start":{"line":236,"column":43,"offset":7402},"end":{"line":236,"column":88,"offset":7447},"indent":[]}}],"position":{"start":{"line":236,"column":4,"offset":7363},"end":{"line":236,"column":88,"offset":7447},"indent":[]}}],"position":{"start":{"line":236,"column":1,"offset":7360},"end":{"line":236,"column":88,"offset":7447},"indent":[]}}],"position":{"start":{"line":235,"column":1,"offset":7268},"end":{"line":236,"column":88,"offset":7447},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Since the logical ","position":{"start":{"line":238,"column":1,"offset":7449},"end":{"line":238,"column":19,"offset":7467},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":238,"column":19,"offset":7467},"end":{"line":238,"column":24,"offset":7472},"indent":[]}},{"type":"text","value":" operator has precedence over logical ","position":{"start":{"line":238,"column":24,"offset":7472},"end":{"line":238,"column":62,"offset":7510},"indent":[]}},{"type":"inlineCode","value":"or","position":{"start":{"line":238,"column":62,"offset":7510},"end":{"line":238,"column":66,"offset":7514},"indent":[]}},{"type":"text","value":", the ","position":{"start":{"line":238,"column":66,"offset":7514},"end":{"line":238,"column":72,"offset":7520},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":238,"column":72,"offset":7520},"end":{"line":238,"column":77,"offset":7525},"indent":[]}},{"type":"text","value":" operator must be evaluated first. Interpretation 1 is correct.","position":{"start":{"line":238,"column":77,"offset":7525},"end":{"line":238,"column":140,"offset":7588},"indent":[]}}],"position":{"start":{"line":238,"column":1,"offset":7449},"end":{"line":238,"column":140,"offset":7588},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Grouping symbols","position":{"start":{"line":240,"column":4,"offset":7593},"end":{"line":240,"column":20,"offset":7609},"indent":[]}}],"position":{"start":{"line":240,"column":1,"offset":7590},"end":{"line":240,"column":20,"offset":7609},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":242,"column":1,"offset":7611},"end":{"line":242,"column":42,"offset":7652},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Only the ","position":{"start":{"line":244,"column":1,"offset":7654},"end":{"line":244,"column":10,"offset":7663},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/expression-preview-editor/","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":244,"column":11,"offset":7664},"end":{"line":244,"column":28,"offset":7681},"indent":[]}}],"position":{"start":{"line":244,"column":10,"offset":7663},"end":{"line":244,"column":71,"offset":7724},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":244,"column":71,"offset":7724},"end":{"line":244,"column":80,"offset":7733},"indent":[]}},{"type":"link","title":null,"url":"/api/","children":[{"type":"text","value":"Cloudflare API","position":{"start":{"line":244,"column":81,"offset":7734},"end":{"line":244,"column":95,"offset":7748},"indent":[]}}],"position":{"start":{"line":244,"column":80,"offset":7733},"end":{"line":244,"column":103,"offset":7756},"indent":[]}},{"type":"text","value":" support grouping symbols. The ","position":{"start":{"line":244,"column":103,"offset":7756},"end":{"line":244,"column":134,"offset":7787},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules/","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":244,"column":135,"offset":7788},"end":{"line":244,"column":153,"offset":7806},"indent":[]}}],"position":{"start":{"line":244,"column":134,"offset":7787},"end":{"line":244,"column":195,"offset":7848},"indent":[]}},{"type":"text","value":" does not.","position":{"start":{"line":244,"column":195,"offset":7848},"end":{"line":244,"column":205,"offset":7858},"indent":[]}}],"position":{"start":{"line":244,"column":1,"offset":7654},"end":{"line":244,"column":205,"offset":7858},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":246,"column":1,"offset":7860},"end":{"line":246,"column":9,"offset":7868},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language supports parentheses (","position":{"start":{"line":248,"column":1,"offset":7870},"end":{"line":248,"column":51,"offset":7920},"indent":[]}},{"type":"inlineCode","value":"(","position":{"start":{"line":248,"column":51,"offset":7920},"end":{"line":248,"column":54,"offset":7923},"indent":[]}},{"type":"text","value":",","position":{"start":{"line":248,"column":54,"offset":7923},"end":{"line":248,"column":55,"offset":7924},"indent":[]}},{"type":"inlineCode","value":")","position":{"start":{"line":248,"column":55,"offset":7924},"end":{"line":248,"column":58,"offset":7927},"indent":[]}},{"type":"text","value":") as grouping symbols. Grouping symbols allow you to organize expressions, enforce precedence, and nest expressions.","position":{"start":{"line":248,"column":58,"offset":7927},"end":{"line":248,"column":174,"offset":8043},"indent":[]}}],"position":{"start":{"line":248,"column":1,"offset":7870},"end":{"line":248,"column":174,"offset":8043},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Group expressions","position":{"start":{"line":250,"column":5,"offset":8049},"end":{"line":250,"column":22,"offset":8066},"indent":[]}}],"position":{"start":{"line":250,"column":1,"offset":8045},"end":{"line":250,"column":22,"offset":8066},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use parentheses to explicitly group expressions that should be evaluated together. In this example, the parentheses do not alter the evaluation of the expression, but they unambiguously call out which logical operators to evaluate first.","position":{"start":{"line":252,"column":1,"offset":8068},"end":{"line":252,"column":238,"offset":8305},"indent":[]}}],"position":{"start":{"line":252,"column":1,"offset":8068},"end":{"line":252,"column":238,"offset":8305},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"(Expression1 and Expression2) or Expression3","position":{"start":{"line":254,"column":1,"offset":8307},"end":{"line":256,"column":4,"offset":8363},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Because grouping symbols are so explicit, you are less likely to make errors when you use them to write compound expressions.","position":{"start":{"line":258,"column":1,"offset":8365},"end":{"line":258,"column":126,"offset":8490},"indent":[]}}],"position":{"start":{"line":258,"column":1,"offset":8365},"end":{"line":258,"column":126,"offset":8490},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Enforce precedence","position":{"start":{"line":260,"column":5,"offset":8496},"end":{"line":260,"column":23,"offset":8514},"indent":[]}}],"position":{"start":{"line":260,"column":1,"offset":8492},"end":{"line":260,"column":23,"offset":8514},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Grouping symbols are a powerful tool to enforce precedence for grouped elements of a compound expression. In this example, parentheses force the logical ","position":{"start":{"line":262,"column":1,"offset":8516},"end":{"line":262,"column":154,"offset":8669},"indent":[]}},{"type":"inlineCode","value":"or","position":{"start":{"line":262,"column":154,"offset":8669},"end":{"line":262,"column":158,"offset":8673},"indent":[]}},{"type":"text","value":" operator to be evaluated before the logical ","position":{"start":{"line":262,"column":158,"offset":8673},"end":{"line":262,"column":203,"offset":8718},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":262,"column":203,"offset":8718},"end":{"line":262,"column":208,"offset":8723},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":262,"column":208,"offset":8723},"end":{"line":262,"column":209,"offset":8724},"indent":[]}}],"position":{"start":{"line":262,"column":1,"offset":8516},"end":{"line":262,"column":209,"offset":8724},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"Expression1 and (Expression2 or Expression3)","position":{"start":{"line":264,"column":1,"offset":8726},"end":{"line":266,"column":4,"offset":8782},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Without parentheses, the logical ","position":{"start":{"line":268,"column":1,"offset":8784},"end":{"line":268,"column":34,"offset":8817},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":268,"column":34,"offset":8817},"end":{"line":268,"column":39,"offset":8822},"indent":[]}},{"type":"text","value":" operator would take precedence.","position":{"start":{"line":268,"column":39,"offset":8822},"end":{"line":268,"column":71,"offset":8854},"indent":[]}}],"position":{"start":{"line":268,"column":1,"offset":8784},"end":{"line":268,"column":71,"offset":8854},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Nest expressions","position":{"start":{"line":270,"column":5,"offset":8860},"end":{"line":270,"column":21,"offset":8876},"indent":[]}}],"position":{"start":{"line":270,"column":1,"offset":8856},"end":{"line":270,"column":21,"offset":8876},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can nest expressions grouped by parentheses inside other groups to create very precise, sophisticated expressions, such as this example for a rule designed to block access to a domain:","position":{"start":{"line":272,"column":1,"offset":8878},"end":{"line":272,"column":189,"offset":9066},"indent":[]}}],"position":{"start":{"line":272,"column":1,"offset":8878},"end":{"line":272,"column":189,"offset":9066},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(\n (http.host eq \"api.example.com\" and http.request.uri.path eq \"/api/v2/auth\") or\n (http.host matches \"^(www|store|blog)\\.example.com\" and http.request.uri.path contains \"wp-login.php\") or\n ip.geoip.country in {\"CN\" \"TH\" \"US\" \"ID\" \"KR\" \"MY\" \"IT\" \"SG\" \"GB\"} or ip.geoip.asnum in {12345 54321 11111}\n) and not ip.src in {11.22.33.0/24}","position":{"start":{"line":274,"column":1,"offset":9068},"end":{"line":280,"column":4,"offset":9413},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note that when evaluating the precedence of logical operators, parentheses inside strings delimited by quotes are ignored, such as those in the following regular expression, drawn from the example above:","position":{"start":{"line":282,"column":1,"offset":9415},"end":{"line":282,"column":204,"offset":9618},"indent":[]}}],"position":{"start":{"line":282,"column":1,"offset":9415},"end":{"line":282,"column":204,"offset":9618},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"\"^(www|store|blog)\\.example\\.com\"","position":{"start":{"line":284,"column":1,"offset":9620},"end":{"line":286,"column":4,"offset":9664},"indent":[1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":289,"column":88,"offset":9754}}}}},{"node":{"fields":{"slug":"/cf-dashboard/configure-schema-validation"},"frontmatter":{"order":390,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Configure Schema Validation"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Configure Schema Validation","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":30,"offset":30},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":30,"offset":30},"indent":[]}},{"type":"html","value":"<Aside type='note'>","position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":20,"offset":51},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This feature is only available for customers on an Enterprise plan. Contact your Cloudflare Customer Success Manager to get access.","position":{"start":{"line":6,"column":1,"offset":53},"end":{"line":6,"column":132,"offset":184},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":53},"end":{"line":6,"column":132,"offset":184},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":8,"column":1,"offset":186},"end":{"line":8,"column":9,"offset":194},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":10,"column":1,"offset":196},"end":{"line":10,"column":9,"offset":204},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"API Shield","position":{"start":{"line":10,"column":11,"offset":206},"end":{"line":10,"column":21,"offset":216},"indent":[]}}],"position":{"start":{"line":10,"column":9,"offset":204},"end":{"line":10,"column":23,"offset":218},"indent":[]}},{"type":"text","value":" interface to configure ","position":{"start":{"line":10,"column":23,"offset":218},"end":{"line":10,"column":47,"offset":242},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/api-shield#schema-validation","children":[{"type":"text","value":"API Schema Validation","position":{"start":{"line":10,"column":48,"offset":243},"end":{"line":10,"column":69,"offset":264},"indent":[]}}],"position":{"start":{"line":10,"column":47,"offset":242},"end":{"line":10,"column":119,"offset":314},"indent":[]}},{"type":"text","value":", which validates requests according to the API Schema you provide.","position":{"start":{"line":10,"column":119,"offset":314},"end":{"line":10,"column":186,"offset":381},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":196},"end":{"line":10,"column":186,"offset":381},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Before you can configure Schema Validation for an API, you must obtain its API Schema file. API Shield supports API Schemas using OpenAPI Specification v3. The accepted file formats are YAML (files with a ","position":{"start":{"line":12,"column":1,"offset":383},"end":{"line":12,"column":206,"offset":588},"indent":[]}},{"type":"inlineCode","value":".yml","position":{"start":{"line":12,"column":206,"offset":588},"end":{"line":12,"column":212,"offset":594},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":12,"column":212,"offset":594},"end":{"line":12,"column":216,"offset":598},"indent":[]}},{"type":"inlineCode","value":".yaml","position":{"start":{"line":12,"column":216,"offset":598},"end":{"line":12,"column":223,"offset":605},"indent":[]}},{"type":"text","value":" file extension) and JSON (files with a ","position":{"start":{"line":12,"column":223,"offset":605},"end":{"line":12,"column":263,"offset":645},"indent":[]}},{"type":"inlineCode","value":".json","position":{"start":{"line":12,"column":263,"offset":645},"end":{"line":12,"column":270,"offset":652},"indent":[]}},{"type":"text","value":" file extension).","position":{"start":{"line":12,"column":270,"offset":652},"end":{"line":12,"column":287,"offset":669},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":383},"end":{"line":12,"column":287,"offset":669},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create an API Shield with Schema Validation","position":{"start":{"line":14,"column":4,"offset":674},"end":{"line":14,"column":47,"offset":717},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":671},"end":{"line":14,"column":47,"offset":717},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To configure Schema Validation in the Cloudflare dashboard, follow these steps:","position":{"start":{"line":16,"column":1,"offset":719},"end":{"line":16,"column":80,"offset":798},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":719},"end":{"line":16,"column":80,"offset":798},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Log in to your Cloudflare account Home page and click the zone containing the host for which you want to configure Schema Validation.","position":{"start":{"line":18,"column":4,"offset":803},"end":{"line":18,"column":137,"offset":936},"indent":[]}}],"position":{"start":{"line":18,"column":4,"offset":803},"end":{"line":18,"column":137,"offset":936},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":800},"end":{"line":19,"column":1,"offset":937},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":20,"column":4,"offset":941},"end":{"line":20,"column":14,"offset":951},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":20,"column":16,"offset":953},"end":{"line":20,"column":24,"offset":961},"indent":[]}}],"position":{"start":{"line":20,"column":14,"offset":951},"end":{"line":20,"column":26,"offset":963},"indent":[]}},{"type":"text","value":" app.","position":{"start":{"line":20,"column":26,"offset":963},"end":{"line":20,"column":31,"offset":968},"indent":[]}}],"position":{"start":{"line":20,"column":4,"offset":941},"end":{"line":20,"column":31,"offset":968},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall ","position":{"start":{"line":22,"column":5,"offset":974},"end":{"line":22,"column":18,"offset":987},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Overview","position":{"start":{"line":22,"column":20,"offset":989},"end":{"line":22,"column":28,"offset":997},"indent":[]}}],"position":{"start":{"line":22,"column":18,"offset":987},"end":{"line":22,"column":30,"offset":999},"indent":[]}},{"type":"text","value":" displays.","position":{"start":{"line":22,"column":30,"offset":999},"end":{"line":22,"column":40,"offset":1009},"indent":[]}}],"position":{"start":{"line":22,"column":5,"offset":974},"end":{"line":22,"column":40,"offset":1009},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-app-overview.png","alt":"Firewall Overview tab","position":{"start":{"line":24,"column":5,"offset":1015},"end":{"line":24,"column":66,"offset":1076},"indent":[]}}],"position":{"start":{"line":24,"column":5,"offset":1015},"end":{"line":24,"column":66,"offset":1076},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":938},"end":{"line":25,"column":1,"offset":1077},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":26,"column":4,"offset":1081},"end":{"line":26,"column":14,"offset":1091},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"API Shield","position":{"start":{"line":26,"column":16,"offset":1093},"end":{"line":26,"column":26,"offset":1103},"indent":[]}}],"position":{"start":{"line":26,"column":14,"offset":1091},"end":{"line":26,"column":28,"offset":1105},"indent":[]}},{"type":"text","value":" tab.","position":{"start":{"line":26,"column":28,"offset":1105},"end":{"line":26,"column":33,"offset":1110},"indent":[]}}],"position":{"start":{"line":26,"column":4,"offset":1081},"end":{"line":26,"column":33,"offset":1110},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":28,"column":5,"offset":1116},"end":{"line":28,"column":9,"offset":1120},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"API Shield","position":{"start":{"line":28,"column":11,"offset":1122},"end":{"line":28,"column":21,"offset":1132},"indent":[]}}],"position":{"start":{"line":28,"column":9,"offset":1120},"end":{"line":28,"column":23,"offset":1134},"indent":[]}},{"type":"text","value":" card displays.","position":{"start":{"line":28,"column":23,"offset":1134},"end":{"line":28,"column":38,"offset":1149},"indent":[]}}],"position":{"start":{"line":28,"column":5,"offset":1116},"end":{"line":28,"column":38,"offset":1149},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/api-shield-card.png","alt":"API Shield card","position":{"start":{"line":30,"column":5,"offset":1155},"end":{"line":30,"column":54,"offset":1204},"indent":[]}}],"position":{"start":{"line":30,"column":5,"offset":1155},"end":{"line":30,"column":54,"offset":1204},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1078},"end":{"line":31,"column":1,"offset":1205},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":32,"column":4,"offset":1209},"end":{"line":32,"column":10,"offset":1215},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Deploy API Shield","position":{"start":{"line":32,"column":12,"offset":1217},"end":{"line":32,"column":29,"offset":1234},"indent":[]}}],"position":{"start":{"line":32,"column":10,"offset":1215},"end":{"line":32,"column":31,"offset":1236},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":32,"column":31,"offset":1236},"end":{"line":32,"column":32,"offset":1237},"indent":[]}}],"position":{"start":{"line":32,"column":4,"offset":1209},"end":{"line":32,"column":32,"offset":1237},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The API Shield creation wizard displays.","position":{"start":{"line":34,"column":5,"offset":1243},"end":{"line":34,"column":45,"offset":1283},"indent":[]}}],"position":{"start":{"line":34,"column":5,"offset":1243},"end":{"line":34,"column":45,"offset":1283},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/api-shield-properties-step.png","alt":"API Shield Properties wizard step","position":{"start":{"line":36,"column":5,"offset":1289},"end":{"line":36,"column":83,"offset":1367},"indent":[]}}],"position":{"start":{"line":36,"column":5,"offset":1289},"end":{"line":36,"column":83,"offset":1367},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1206},"end":{"line":37,"column":1,"offset":1368},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Enter a descriptive name for the API Shield in the ","position":{"start":{"line":38,"column":4,"offset":1372},"end":{"line":38,"column":55,"offset":1423},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Shield name","position":{"start":{"line":38,"column":57,"offset":1425},"end":{"line":38,"column":68,"offset":1436},"indent":[]}}],"position":{"start":{"line":38,"column":55,"offset":1423},"end":{"line":38,"column":70,"offset":1438},"indent":[]}},{"type":"text","value":" input. ","position":{"start":{"line":38,"column":70,"offset":1438},"end":{"line":38,"column":78,"offset":1446},"indent":[]}}],"position":{"start":{"line":38,"column":4,"offset":1372},"end":{"line":38,"column":78,"offset":1446},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1369},"end":{"line":39,"column":1,"offset":1447},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Configure the expression for the API Shield using the available request fields.","position":{"start":{"line":40,"column":4,"offset":1451},"end":{"line":40,"column":83,"offset":1530},"indent":[]}}],"position":{"start":{"line":40,"column":4,"offset":1451},"end":{"line":40,"column":83,"offset":1530},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, if your API is available at ","position":{"start":{"line":42,"column":5,"offset":1536},"end":{"line":42,"column":46,"offset":1577},"indent":[]}},{"type":"inlineCode","value":"http://api.example.com/v1","position":{"start":{"line":42,"column":46,"offset":1577},"end":{"line":42,"column":73,"offset":1604},"indent":[]}},{"type":"text","value":", the expression must include a check for the ","position":{"start":{"line":42,"column":73,"offset":1604},"end":{"line":42,"column":119,"offset":1650},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Hostname","position":{"start":{"line":42,"column":120,"offset":1651},"end":{"line":42,"column":128,"offset":1659},"indent":[]}}],"position":{"start":{"line":42,"column":119,"offset":1650},"end":{"line":42,"column":129,"offset":1660},"indent":[]}},{"type":"text","value":" field (which must be equal to ","position":{"start":{"line":42,"column":129,"offset":1660},"end":{"line":42,"column":160,"offset":1691},"indent":[]}},{"type":"inlineCode","value":"api.example.com","position":{"start":{"line":42,"column":160,"offset":1691},"end":{"line":42,"column":177,"offset":1708},"indent":[]}},{"type":"text","value":") and a check for the ","position":{"start":{"line":42,"column":177,"offset":1708},"end":{"line":42,"column":199,"offset":1730},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"URI Path","position":{"start":{"line":42,"column":200,"offset":1731},"end":{"line":42,"column":208,"offset":1739},"indent":[]}}],"position":{"start":{"line":42,"column":199,"offset":1730},"end":{"line":42,"column":209,"offset":1740},"indent":[]}},{"type":"text","value":" field using a regular expression (which must match the regex ","position":{"start":{"line":42,"column":209,"offset":1740},"end":{"line":42,"column":271,"offset":1802},"indent":[]}},{"type":"inlineCode","value":"^/v1","position":{"start":{"line":42,"column":271,"offset":1802},"end":{"line":42,"column":277,"offset":1808},"indent":[]}},{"type":"text","value":").","position":{"start":{"line":42,"column":277,"offset":1808},"end":{"line":42,"column":279,"offset":1810},"indent":[]}}],"position":{"start":{"line":42,"column":5,"offset":1536},"end":{"line":42,"column":279,"offset":1810},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":44,"column":5,"offset":1816},"end":{"line":44,"column":46,"offset":1857},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To validate the hostname, you must include the ","position":{"start":{"line":46,"column":5,"offset":1863},"end":{"line":46,"column":52,"offset":1910},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Hostname","position":{"start":{"line":46,"column":53,"offset":1911},"end":{"line":46,"column":61,"offset":1919},"indent":[]}}],"position":{"start":{"line":46,"column":52,"offset":1910},"end":{"line":46,"column":62,"offset":1920},"indent":[]}},{"type":"text","value":" field explicitly in the rule, even if the hostname value is in the schema file. Any hostname value present in the schema file will be ignored.","position":{"start":{"line":46,"column":62,"offset":1920},"end":{"line":46,"column":205,"offset":2063},"indent":[]}}],"position":{"start":{"line":46,"column":5,"offset":1863},"end":{"line":46,"column":205,"offset":2063},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Regular expression support is a paid add-on in the Enterprise plan.","position":{"start":{"line":48,"column":5,"offset":2069},"end":{"line":48,"column":72,"offset":2136},"indent":[]}}],"position":{"start":{"line":48,"column":5,"offset":2069},"end":{"line":48,"column":72,"offset":2136},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":50,"column":5,"offset":2142},"end":{"line":50,"column":13,"offset":2150},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":1448},"end":{"line":51,"column":1,"offset":2151},"indent":[1,1,1,1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":52,"column":4,"offset":2155},"end":{"line":52,"column":10,"offset":2161},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Next","position":{"start":{"line":52,"column":12,"offset":2163},"end":{"line":52,"column":16,"offset":2167},"indent":[]}}],"position":{"start":{"line":52,"column":10,"offset":2161},"end":{"line":52,"column":18,"offset":2169},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":52,"column":18,"offset":2169},"end":{"line":52,"column":19,"offset":2170},"indent":[]}}],"position":{"start":{"line":52,"column":4,"offset":2155},"end":{"line":52,"column":19,"offset":2170},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":54,"column":5,"offset":2176},"end":{"line":54,"column":9,"offset":2180},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Security solution","position":{"start":{"line":54,"column":11,"offset":2182},"end":{"line":54,"column":28,"offset":2199},"indent":[]}}],"position":{"start":{"line":54,"column":9,"offset":2180},"end":{"line":54,"column":30,"offset":2201},"indent":[]}},{"type":"text","value":" step displays.","position":{"start":{"line":54,"column":30,"offset":2201},"end":{"line":54,"column":45,"offset":2216},"indent":[]}}],"position":{"start":{"line":54,"column":5,"offset":2176},"end":{"line":54,"column":45,"offset":2216},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/api-shield-security-solution-step.png","alt":"API Shield Security solution wizard step","position":{"start":{"line":56,"column":5,"offset":2222},"end":{"line":56,"column":97,"offset":2314},"indent":[]}}],"position":{"start":{"line":56,"column":5,"offset":2222},"end":{"line":56,"column":97,"offset":2314},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2152},"end":{"line":57,"column":1,"offset":2315},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Enable the toggle in the ","position":{"start":{"line":58,"column":4,"offset":2319},"end":{"line":58,"column":29,"offset":2344},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Schema Validation","position":{"start":{"line":58,"column":31,"offset":2346},"end":{"line":58,"column":48,"offset":2363},"indent":[]}}],"position":{"start":{"line":58,"column":29,"offset":2344},"end":{"line":58,"column":50,"offset":2365},"indent":[]}},{"type":"text","value":" card.","position":{"start":{"line":58,"column":50,"offset":2365},"end":{"line":58,"column":56,"offset":2371},"indent":[]}}],"position":{"start":{"line":58,"column":4,"offset":2319},"end":{"line":58,"column":56,"offset":2371},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":2316},"end":{"line":59,"column":1,"offset":2372},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Upload the API Schema file in ","position":{"start":{"line":60,"column":4,"offset":2376},"end":{"line":60,"column":34,"offset":2406},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Upload API Schema","position":{"start":{"line":60,"column":36,"offset":2408},"end":{"line":60,"column":53,"offset":2425},"indent":[]}}],"position":{"start":{"line":60,"column":34,"offset":2406},"end":{"line":60,"column":55,"offset":2427},"indent":[]}},{"type":"text","value":" by selecting a file or dragging a file to the file upload area (dashed rectangle).","position":{"start":{"line":60,"column":55,"offset":2427},"end":{"line":60,"column":138,"offset":2510},"indent":[]}}],"position":{"start":{"line":60,"column":4,"offset":2376},"end":{"line":60,"column":138,"offset":2510},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2373},"end":{"line":61,"column":1,"offset":2511},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":62,"column":4,"offset":2515},"end":{"line":62,"column":10,"offset":2521},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Deploy","position":{"start":{"line":62,"column":12,"offset":2523},"end":{"line":62,"column":18,"offset":2529},"indent":[]}}],"position":{"start":{"line":62,"column":10,"offset":2521},"end":{"line":62,"column":20,"offset":2531},"indent":[]}},{"type":"text","value":" to validate the content of the schema file and deploy the Schema Validation rule.","position":{"start":{"line":62,"column":20,"offset":2531},"end":{"line":62,"column":102,"offset":2613},"indent":[]}}],"position":{"start":{"line":62,"column":4,"offset":2515},"end":{"line":62,"column":102,"offset":2613},"indent":[]}},{"type":"html","value":"<Aside type='warning'>","position":{"start":{"line":64,"column":5,"offset":2619},"end":{"line":64,"column":27,"offset":2641},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you get a validation error, make sure you are using one of the supported file formats. Also, each endpoint and method pair must have a ","position":{"start":{"line":66,"column":5,"offset":2647},"end":{"line":66,"column":143,"offset":2785},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/api-shield#operation-ids","children":[{"type":"text","value":"unique Operation ID","position":{"start":{"line":66,"column":144,"offset":2786},"end":{"line":66,"column":163,"offset":2805},"indent":[]}}],"position":{"start":{"line":66,"column":143,"offset":2785},"end":{"line":66,"column":209,"offset":2851},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":66,"column":209,"offset":2851},"end":{"line":66,"column":210,"offset":2852},"indent":[]}}],"position":{"start":{"line":66,"column":5,"offset":2647},"end":{"line":66,"column":210,"offset":2852},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":68,"column":5,"offset":2858},"end":{"line":68,"column":13,"offset":2866},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":2512},"end":{"line":69,"column":1,"offset":2867},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"After deploying your API Shield rule, Cloudflare displays a summary of all API endpoints organized by their protection level and what will be the actions taken for non-compliant and unprotected requests.","position":{"start":{"line":70,"column":4,"offset":2871},"end":{"line":70,"column":207,"offset":3074},"indent":[]}}],"position":{"start":{"line":70,"column":4,"offset":2871},"end":{"line":70,"column":207,"offset":3074},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/api-shield-review-endpoints-step.png","alt":"API Shield Review endpoints wizard step","position":{"start":{"line":72,"column":5,"offset":3080},"end":{"line":72,"column":95,"offset":3170},"indent":[]}}],"position":{"start":{"line":72,"column":5,"offset":3080},"end":{"line":72,"column":95,"offset":3170},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The API Shield rule will validate all incoming requests addressed at the endpoints listed in ","position":{"start":{"line":74,"column":5,"offset":3176},"end":{"line":74,"column":98,"offset":3269},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"API Schema endpoints","position":{"start":{"line":74,"column":100,"offset":3271},"end":{"line":74,"column":120,"offset":3291},"indent":[]}}],"position":{"start":{"line":74,"column":98,"offset":3269},"end":{"line":74,"column":122,"offset":3293},"indent":[]}},{"type":"text","value":". The several columns in the table list the validations deployed for each endpoint, according to the information described in the API Schema file.","position":{"start":{"line":74,"column":122,"offset":3293},"end":{"line":74,"column":268,"offset":3439},"indent":[]}}],"position":{"start":{"line":74,"column":5,"offset":3176},"end":{"line":74,"column":268,"offset":3439},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":2868},"end":{"line":75,"column":1,"offset":3440},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":76,"column":4,"offset":3444},"end":{"line":76,"column":11,"offset":3451},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Endpoint action","position":{"start":{"line":76,"column":13,"offset":3453},"end":{"line":76,"column":28,"offset":3468},"indent":[]}}],"position":{"start":{"line":76,"column":11,"offset":3451},"end":{"line":76,"column":30,"offset":3470},"indent":[]}},{"type":"text","value":" dropdown, select the action that API Shield will perform for every request targeting a protected endpoint that fails Schema Validation.","position":{"start":{"line":76,"column":30,"offset":3470},"end":{"line":76,"column":166,"offset":3606},"indent":[]}}],"position":{"start":{"line":76,"column":4,"offset":3444},"end":{"line":76,"column":166,"offset":3606},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":3441},"end":{"line":77,"column":1,"offset":3607},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":78,"column":4,"offset":3611},"end":{"line":78,"column":11,"offset":3618},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Fallthrough action","position":{"start":{"line":78,"column":13,"offset":3620},"end":{"line":78,"column":31,"offset":3638},"indent":[]}}],"position":{"start":{"line":78,"column":11,"offset":3618},"end":{"line":78,"column":33,"offset":3640},"indent":[]}},{"type":"text","value":" dropdown, select the action to perform for incoming requests addressed at other (non-protected) API endpoints.","position":{"start":{"line":78,"column":33,"offset":3640},"end":{"line":78,"column":144,"offset":3751},"indent":[]}}],"position":{"start":{"line":78,"column":4,"offset":3611},"end":{"line":78,"column":144,"offset":3751},"indent":[]}},{"type":"html","value":"<Aside type='warning'>","position":{"start":{"line":80,"column":5,"offset":3757},"end":{"line":80,"column":27,"offset":3779},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Currently, request body validations are not supported.","position":{"start":{"line":82,"column":5,"offset":3785},"end":{"line":82,"column":59,"offset":3839},"indent":[]}}],"position":{"start":{"line":82,"column":5,"offset":3785},"end":{"line":82,"column":59,"offset":3839},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":84,"column":5,"offset":3845},"end":{"line":84,"column":13,"offset":3853},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":3608},"end":{"line":85,"column":1,"offset":3854},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":86,"column":4,"offset":3858},"end":{"line":86,"column":10,"offset":3864},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Done","position":{"start":{"line":86,"column":12,"offset":3866},"end":{"line":86,"column":16,"offset":3870},"indent":[]}}],"position":{"start":{"line":86,"column":10,"offset":3864},"end":{"line":86,"column":18,"offset":3872},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":86,"column":18,"offset":3872},"end":{"line":86,"column":19,"offset":3873},"indent":[]}}],"position":{"start":{"line":86,"column":4,"offset":3858},"end":{"line":86,"column":19,"offset":3873},"indent":[]}}],"position":{"start":{"line":86,"column":1,"offset":3855},"end":{"line":86,"column":19,"offset":3873},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":800},"end":{"line":86,"column":19,"offset":3873},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The API Shield wizard closes and the ","position":{"start":{"line":88,"column":1,"offset":3875},"end":{"line":88,"column":38,"offset":3912},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"API Shield","position":{"start":{"line":88,"column":40,"offset":3914},"end":{"line":88,"column":50,"offset":3924},"indent":[]}}],"position":{"start":{"line":88,"column":38,"offset":3912},"end":{"line":88,"column":52,"offset":3926},"indent":[]}},{"type":"text","value":" card displays with your new API Shield in the list.","position":{"start":{"line":88,"column":52,"offset":3926},"end":{"line":88,"column":104,"offset":3978},"indent":[]}}],"position":{"start":{"line":88,"column":1,"offset":3875},"end":{"line":88,"column":104,"offset":3978},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":91,"column":88,"offset":4068}}}}},{"node":{"fields":{"slug":"/cf-firewall-language/functions"},"frontmatter":{"order":640,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Functions"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Functions","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":12,"offset":12},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language provides functions for manipulating and validating values in an expression:","position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":115,"offset":128},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":115,"offset":128},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#transformation-functions","children":[{"type":"text","value":"Transformation functions","position":{"start":{"line":6,"column":4,"offset":133},"end":{"line":6,"column":28,"offset":157},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":132},"end":{"line":6,"column":56,"offset":185},"indent":[]}},{"type":"text","value":" manipulate values extracted from an HTTP request.","position":{"start":{"line":6,"column":56,"offset":185},"end":{"line":6,"column":106,"offset":235},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":132},"end":{"line":6,"column":106,"offset":235},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":130},"end":{"line":6,"column":106,"offset":235},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":3,"offset":238},"end":{"line":7,"column":7,"offset":242},"indent":[]}},{"type":"link","title":null,"url":"#hmac-validation","children":[{"type":"text","value":"HMAC Validation function","position":{"start":{"line":7,"column":8,"offset":243},"end":{"line":7,"column":32,"offset":267},"indent":[]}}],"position":{"start":{"line":7,"column":7,"offset":242},"end":{"line":7,"column":51,"offset":286},"indent":[]}},{"type":"text","value":" tests the validity of an HMAC token. Use it to write expressions that target requests based on the presence of a valid HMAC token.","position":{"start":{"line":7,"column":51,"offset":286},"end":{"line":7,"column":182,"offset":417},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":238},"end":{"line":7,"column":182,"offset":417},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":236},"end":{"line":7,"column":182,"offset":417},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":130},"end":{"line":7,"column":182,"offset":417},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Transformation functions","position":{"start":{"line":9,"column":4,"offset":422},"end":{"line":9,"column":28,"offset":446},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":419},"end":{"line":9,"column":28,"offset":446},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports several functions that transform values extracted from HTTP requests. A common use case for transformation functions is the conversion of a string of characters to uppercase or lowercase, since by default, string evaluation is case sensitive.","position":{"start":{"line":11,"column":1,"offset":448},"end":{"line":11,"column":291,"offset":738},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":448},"end":{"line":11,"column":291,"offset":738},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, the ","position":{"start":{"line":13,"column":1,"offset":740},"end":{"line":13,"column":18,"offset":757},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":13,"column":18,"offset":757},"end":{"line":13,"column":27,"offset":766},"indent":[]}},{"type":"text","value":" function converts all uppercase characters in a string to lowercase.","position":{"start":{"line":13,"column":27,"offset":766},"end":{"line":13,"column":96,"offset":835},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":740},"end":{"line":13,"column":96,"offset":835},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In the expression below, the","position":{"start":{"line":15,"column":1,"offset":837},"end":{"line":15,"column":29,"offset":865},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":15,"column":29,"offset":865},"end":{"line":15,"column":38,"offset":874},"indent":[]}},{"type":"text","value":" function transforms ","position":{"start":{"line":15,"column":38,"offset":874},"end":{"line":15,"column":59,"offset":895},"indent":[]}},{"type":"inlineCode","value":"http.host","position":{"start":{"line":15,"column":59,"offset":895},"end":{"line":15,"column":70,"offset":906},"indent":[]}},{"type":"text","value":" values to lowercase so that they match the target value ","position":{"start":{"line":15,"column":70,"offset":906},"end":{"line":15,"column":127,"offset":963},"indent":[]}},{"type":"inlineCode","value":"\"www.cloudflare.com\"","position":{"start":{"line":15,"column":127,"offset":963},"end":{"line":15,"column":149,"offset":985},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":15,"column":149,"offset":985},"end":{"line":15,"column":150,"offset":986},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":837},"end":{"line":15,"column":150,"offset":986},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"lower(http.host) == \"www.cloudflare.com\"","position":{"start":{"line":17,"column":1,"offset":988},"end":{"line":19,"column":4,"offset":1039},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Transformation functions that do not take arrays as an argument type require the ","position":{"start":{"line":21,"column":1,"offset":1041},"end":{"line":21,"column":82,"offset":1122},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":21,"column":82,"offset":1122},"end":{"line":21,"column":87,"offset":1127},"indent":[]}},{"type":"text","value":" special index notation. Refer to ","position":{"start":{"line":21,"column":87,"offset":1127},"end":{"line":21,"column":121,"offset":1161},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/values#arrays","children":[{"type":"text","value":"Arrays","position":{"start":{"line":21,"column":122,"offset":1162},"end":{"line":21,"column":128,"offset":1168},"indent":[]}}],"position":{"start":{"line":21,"column":121,"offset":1161},"end":{"line":21,"column":166,"offset":1206},"indent":[]}},{"type":"text","value":" for more information.","position":{"start":{"line":21,"column":166,"offset":1206},"end":{"line":21,"column":188,"offset":1228},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":1041},"end":{"line":21,"column":188,"offset":1228},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these transformation functions:","position":{"start":{"line":23,"column":1,"offset":1230},"end":{"line":23,"column":80,"offset":1309},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1230},"end":{"line":23,"column":80,"offset":1309},"indent":[]}},{"type":"html","value":"<Definitions>","position":{"start":{"line":25,"column":1,"offset":1311},"end":{"line":25,"column":14,"offset":1324},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>any(<Type>Array</Type>{'<'}<ParamType>Boolean</ParamType>{'>'})</code> <Type>Boolean</Type>","position":{"start":{"line":27,"column":3,"offset":1328},"end":{"line":27,"column":100,"offset":1425},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns ","position":{"start":{"line":29,"column":5,"offset":1431},"end":{"line":29,"column":13,"offset":1439},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":29,"column":13,"offset":1439},"end":{"line":29,"column":38,"offset":1464},"indent":[]}},{"type":"text","value":"true","position":{"start":{"line":29,"column":38,"offset":1464},"end":{"line":29,"column":42,"offset":1468},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":29,"column":42,"offset":1468},"end":{"line":29,"column":49,"offset":1475},"indent":[]}},{"type":"text","value":" when the comparison operator in the argument returns ","position":{"start":{"line":29,"column":49,"offset":1475},"end":{"line":29,"column":103,"offset":1529},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":29,"column":103,"offset":1529},"end":{"line":29,"column":109,"offset":1535},"indent":[]}},{"type":"text","value":" for ","position":{"start":{"line":29,"column":109,"offset":1535},"end":{"line":29,"column":114,"offset":1540},"indent":[]}},{"type":"html","value":"<em>","position":{"start":{"line":29,"column":114,"offset":1540},"end":{"line":29,"column":118,"offset":1544},"indent":[]}},{"type":"text","value":"any","position":{"start":{"line":29,"column":118,"offset":1544},"end":{"line":29,"column":121,"offset":1547},"indent":[]}},{"type":"html","value":"</em>","position":{"start":{"line":29,"column":121,"offset":1547},"end":{"line":29,"column":126,"offset":1552},"indent":[]}},{"type":"text","value":" of the values in the argument array. Returns ","position":{"start":{"line":29,"column":126,"offset":1552},"end":{"line":29,"column":172,"offset":1598},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":29,"column":172,"offset":1598},"end":{"line":29,"column":197,"offset":1623},"indent":[]}},{"type":"text","value":"false","position":{"start":{"line":29,"column":197,"offset":1623},"end":{"line":29,"column":202,"offset":1628},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":29,"column":202,"offset":1628},"end":{"line":29,"column":209,"offset":1635},"indent":[]}},{"type":"text","value":" otherwise.","position":{"start":{"line":29,"column":209,"offset":1635},"end":{"line":29,"column":220,"offset":1646},"indent":[]}}],"position":{"start":{"line":29,"column":5,"offset":1431},"end":{"line":29,"column":220,"offset":1646},"indent":[]}}],"position":{"start":{"line":29,"column":3,"offset":1429},"end":{"line":30,"column":3,"offset":1649},"indent":[3]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":31,"column":5,"offset":1654},"end":{"line":31,"column":28,"offset":1677},"indent":[]}},{"type":"html","value":"<code class='InlineCode' style='width:100%'>\nany(url_decode(http.request.body.form.values[*])[*] contains \"an xss attack\")\n</code>","position":{"start":{"line":33,"column":5,"offset":1683},"end":{"line":35,"column":12,"offset":1821},"indent":[5,5]}}],"position":{"start":{"line":31,"column":3,"offset":1652},"end":{"line":35,"column":12,"offset":1821},"indent":[1,3,3,3]}}],"position":{"start":{"line":29,"column":3,"offset":1429},"end":{"line":35,"column":12,"offset":1821},"indent":[3,3,1,3,3,3]}}],"position":{"start":{"line":27,"column":1,"offset":1326},"end":{"line":36,"column":1,"offset":1822},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>all(<Type>Array</Type>{'<'}<ParamType>Boolean</ParamType>{'>'})</code> <Type>Boolean</Type>","position":{"start":{"line":37,"column":3,"offset":1825},"end":{"line":37,"column":100,"offset":1922},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns ","position":{"start":{"line":39,"column":5,"offset":1928},"end":{"line":39,"column":13,"offset":1936},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":39,"column":13,"offset":1936},"end":{"line":39,"column":38,"offset":1961},"indent":[]}},{"type":"text","value":"true","position":{"start":{"line":39,"column":38,"offset":1961},"end":{"line":39,"column":42,"offset":1965},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":39,"column":42,"offset":1965},"end":{"line":39,"column":49,"offset":1972},"indent":[]}},{"type":"text","value":" when the comparison operator in the argument returns ","position":{"start":{"line":39,"column":49,"offset":1972},"end":{"line":39,"column":103,"offset":2026},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":39,"column":103,"offset":2026},"end":{"line":39,"column":109,"offset":2032},"indent":[]}},{"type":"text","value":" for ","position":{"start":{"line":39,"column":109,"offset":2032},"end":{"line":39,"column":114,"offset":2037},"indent":[]}},{"type":"html","value":"<em>","position":{"start":{"line":39,"column":114,"offset":2037},"end":{"line":39,"column":118,"offset":2041},"indent":[]}},{"type":"text","value":"all","position":{"start":{"line":39,"column":118,"offset":2041},"end":{"line":39,"column":121,"offset":2044},"indent":[]}},{"type":"html","value":"</em>","position":{"start":{"line":39,"column":121,"offset":2044},"end":{"line":39,"column":126,"offset":2049},"indent":[]}},{"type":"text","value":" values in the argument array. Returns ","position":{"start":{"line":39,"column":126,"offset":2049},"end":{"line":39,"column":165,"offset":2088},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":39,"column":165,"offset":2088},"end":{"line":39,"column":190,"offset":2113},"indent":[]}},{"type":"text","value":"false","position":{"start":{"line":39,"column":190,"offset":2113},"end":{"line":39,"column":195,"offset":2118},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":39,"column":195,"offset":2118},"end":{"line":39,"column":202,"offset":2125},"indent":[]}},{"type":"text","value":" otherwise.","position":{"start":{"line":39,"column":202,"offset":2125},"end":{"line":39,"column":213,"offset":2136},"indent":[]}}],"position":{"start":{"line":39,"column":5,"offset":1928},"end":{"line":39,"column":213,"offset":2136},"indent":[]}}],"position":{"start":{"line":39,"column":3,"offset":1926},"end":{"line":40,"column":1,"offset":2137},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":41,"column":5,"offset":2142},"end":{"line":41,"column":28,"offset":2165},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">all(http.request.headers['content-type'][*] == \"application/json\")</code>","position":{"start":{"line":43,"column":5,"offset":2171},"end":{"line":43,"column":103,"offset":2269},"indent":[]}}],"position":{"start":{"line":41,"column":3,"offset":2140},"end":{"line":43,"column":103,"offset":2269},"indent":[1,3]}}],"position":{"start":{"line":39,"column":3,"offset":1926},"end":{"line":43,"column":103,"offset":2269},"indent":[1,3,1,3]}}],"position":{"start":{"line":37,"column":1,"offset":1823},"end":{"line":44,"column":1,"offset":2270},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>concat(<Type>String | Integer | bytes | Array elements</Type>)</code> <Type>String</Type>","position":{"start":{"line":45,"column":3,"offset":2273},"end":{"line":45,"column":98,"offset":2368},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Takes a comma-separated list of values. Concatenates the argument values into a single String.","position":{"start":{"line":47,"column":5,"offset":2374},"end":{"line":47,"column":99,"offset":2468},"indent":[]}}],"position":{"start":{"line":47,"column":5,"offset":2374},"end":{"line":47,"column":99,"offset":2468},"indent":[]}}],"position":{"start":{"line":47,"column":3,"offset":2372},"end":{"line":48,"column":1,"offset":2469},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":49,"column":5,"offset":2474},"end":{"line":49,"column":28,"offset":2497},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">concat(\"String1\",\" \",\"String\",2) == \"String1 String2\"</code>","position":{"start":{"line":51,"column":5,"offset":2503},"end":{"line":51,"column":90,"offset":2588},"indent":[]}}],"position":{"start":{"line":49,"column":3,"offset":2472},"end":{"line":51,"column":90,"offset":2588},"indent":[1,3]}}],"position":{"start":{"line":47,"column":3,"offset":2372},"end":{"line":51,"column":90,"offset":2588},"indent":[1,3,1,3]}}],"position":{"start":{"line":45,"column":1,"offset":2271},"end":{"line":52,"column":1,"offset":2589},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>ends_with(source<ParamType>String</ParamType>, substring<ParamType>String</ParamType>)</code> <Type>Boolean</Type>","position":{"start":{"line":53,"column":3,"offset":2592},"end":{"line":53,"column":123,"offset":2712},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns ","position":{"start":{"line":55,"column":5,"offset":2718},"end":{"line":55,"column":13,"offset":2726},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":55,"column":13,"offset":2726},"end":{"line":55,"column":19,"offset":2732},"indent":[]}},{"type":"text","value":" when the source ends with a given substring. Returns ","position":{"start":{"line":55,"column":19,"offset":2732},"end":{"line":55,"column":73,"offset":2786},"indent":[]}},{"type":"inlineCode","value":"false","position":{"start":{"line":55,"column":73,"offset":2786},"end":{"line":55,"column":80,"offset":2793},"indent":[]}},{"type":"text","value":" otherwise. The source cannot be a literal value (for example, ","position":{"start":{"line":55,"column":80,"offset":2793},"end":{"line":55,"column":143,"offset":2856},"indent":[]}},{"type":"inlineCode","value":"\"foo\"","position":{"start":{"line":55,"column":143,"offset":2856},"end":{"line":55,"column":150,"offset":2863},"indent":[]}},{"type":"text","value":").","position":{"start":{"line":55,"column":150,"offset":2863},"end":{"line":55,"column":152,"offset":2865},"indent":[]}}],"position":{"start":{"line":55,"column":5,"offset":2718},"end":{"line":55,"column":152,"offset":2865},"indent":[]}}],"position":{"start":{"line":55,"column":3,"offset":2716},"end":{"line":56,"column":1,"offset":2866},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Example:","position":{"start":{"line":57,"column":6,"offset":2872},"end":{"line":57,"column":14,"offset":2880},"indent":[]}}],"position":{"start":{"line":57,"column":5,"offset":2871},"end":{"line":57,"column":15,"offset":2881},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":57,"column":15,"offset":2881},"end":{"line":57,"column":21,"offset":2887},"indent":[]}},{"type":"text","value":"\nIf ","position":{"start":{"line":57,"column":21,"offset":2887},"end":{"line":58,"column":8,"offset":2895},"indent":[5]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":58,"column":8,"offset":2895},"end":{"line":58,"column":31,"offset":2918},"indent":[]}},{"type":"text","value":" is ","position":{"start":{"line":58,"column":31,"offset":2918},"end":{"line":58,"column":35,"offset":2922},"indent":[]}},{"type":"inlineCode","value":"\"/welcome.html\"","position":{"start":{"line":58,"column":35,"offset":2922},"end":{"line":58,"column":52,"offset":2939},"indent":[]}},{"type":"text","value":", then ","position":{"start":{"line":58,"column":52,"offset":2939},"end":{"line":58,"column":59,"offset":2946},"indent":[]}},{"type":"inlineCode","value":"ends_with(http.request.uri.path, \".html\")","position":{"start":{"line":58,"column":59,"offset":2946},"end":{"line":58,"column":102,"offset":2989},"indent":[]}},{"type":"text","value":" will return ","position":{"start":{"line":58,"column":102,"offset":2989},"end":{"line":58,"column":115,"offset":3002},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":58,"column":115,"offset":3002},"end":{"line":58,"column":121,"offset":3008},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":58,"column":121,"offset":3008},"end":{"line":58,"column":122,"offset":3009},"indent":[]}}],"position":{"start":{"line":57,"column":5,"offset":2871},"end":{"line":58,"column":122,"offset":3009},"indent":[5]}},{"type":"html","value":"<Aside type='warning'>","position":{"start":{"line":60,"column":5,"offset":3015},"end":{"line":60,"column":27,"offset":3037},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Warning:","position":{"start":{"line":62,"column":7,"offset":3045},"end":{"line":62,"column":15,"offset":3053},"indent":[]}}],"position":{"start":{"line":62,"column":5,"offset":3043},"end":{"line":62,"column":17,"offset":3055},"indent":[]}},{"type":"text","value":" You can only use the ","position":{"start":{"line":62,"column":17,"offset":3055},"end":{"line":62,"column":39,"offset":3077},"indent":[]}},{"type":"inlineCode","value":"ends_with()","position":{"start":{"line":62,"column":39,"offset":3077},"end":{"line":62,"column":52,"offset":3090},"indent":[]}},{"type":"text","value":" function in ","position":{"start":{"line":62,"column":52,"offset":3090},"end":{"line":62,"column":65,"offset":3103},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/","children":[{"type":"text","value":"rulesets","position":{"start":{"line":62,"column":66,"offset":3104},"end":{"line":62,"column":74,"offset":3112},"indent":[]}}],"position":{"start":{"line":62,"column":65,"offset":3103},"end":{"line":62,"column":126,"offset":3164},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":62,"column":126,"offset":3164},"end":{"line":62,"column":131,"offset":3169},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/rules/transform","children":[{"type":"text","value":"Transform Rules","position":{"start":{"line":62,"column":132,"offset":3170},"end":{"line":62,"column":147,"offset":3185},"indent":[]}}],"position":{"start":{"line":62,"column":131,"offset":3169},"end":{"line":62,"column":199,"offset":3237},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":62,"column":199,"offset":3237},"end":{"line":62,"column":200,"offset":3238},"indent":[]}}],"position":{"start":{"line":62,"column":5,"offset":3043},"end":{"line":62,"column":200,"offset":3238},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":64,"column":5,"offset":3244},"end":{"line":64,"column":13,"offset":3252},"indent":[]}}],"position":{"start":{"line":57,"column":3,"offset":2869},"end":{"line":64,"column":13,"offset":3252},"indent":[3,1,3,1,3,1,3]}}],"position":{"start":{"line":55,"column":3,"offset":2716},"end":{"line":64,"column":13,"offset":3252},"indent":[1,3,3,1,3,1,3,1,3]}}],"position":{"start":{"line":53,"column":1,"offset":2590},"end":{"line":65,"column":1,"offset":3253},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>len(<Type>String | bytes</Type>)</code> <Type>Integer</Type>","position":{"start":{"line":66,"column":3,"offset":3256},"end":{"line":66,"column":69,"offset":3322},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns the byte length of a String or Bytes field.","position":{"start":{"line":68,"column":5,"offset":3328},"end":{"line":68,"column":56,"offset":3379},"indent":[]}}],"position":{"start":{"line":68,"column":5,"offset":3328},"end":{"line":68,"column":56,"offset":3379},"indent":[]}}],"position":{"start":{"line":68,"column":3,"offset":3326},"end":{"line":69,"column":1,"offset":3380},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":70,"column":5,"offset":3385},"end":{"line":70,"column":28,"offset":3408},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">len(http.host)</code>","position":{"start":{"line":72,"column":5,"offset":3414},"end":{"line":72,"column":51,"offset":3460},"indent":[]}}],"position":{"start":{"line":70,"column":3,"offset":3383},"end":{"line":72,"column":51,"offset":3460},"indent":[1,3]}}],"position":{"start":{"line":68,"column":3,"offset":3326},"end":{"line":72,"column":51,"offset":3460},"indent":[1,3,1,3]}}],"position":{"start":{"line":66,"column":1,"offset":3254},"end":{"line":73,"column":1,"offset":3461},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>lower(<Type>String</Type>)</code> <Type>String</Type>","position":{"start":{"line":74,"column":3,"offset":3464},"end":{"line":74,"column":62,"offset":3523},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a string field to lowercase. Only uppercase ASCII bytes are converted. All other bytes are unaffected.","position":{"start":{"line":76,"column":5,"offset":3529},"end":{"line":76,"column":116,"offset":3640},"indent":[]}}],"position":{"start":{"line":76,"column":5,"offset":3529},"end":{"line":76,"column":116,"offset":3640},"indent":[]}}],"position":{"start":{"line":76,"column":3,"offset":3527},"end":{"line":77,"column":1,"offset":3641},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":78,"column":5,"offset":3646},"end":{"line":78,"column":28,"offset":3669},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">lower(http.host) == \"www.cloudflare.com\"</code>","position":{"start":{"line":80,"column":5,"offset":3675},"end":{"line":80,"column":77,"offset":3747},"indent":[]}}],"position":{"start":{"line":78,"column":3,"offset":3644},"end":{"line":80,"column":77,"offset":3747},"indent":[1,3]}}],"position":{"start":{"line":76,"column":3,"offset":3527},"end":{"line":80,"column":77,"offset":3747},"indent":[1,3,1,3]}}],"position":{"start":{"line":74,"column":1,"offset":3462},"end":{"line":81,"column":1,"offset":3748},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>regex_replace(source<ParamType>String</ParamType>, regular_expression<ParamType>String</ParamType>, replacement<ParamType>String</ParamType>)</code> <Type>String</Type>","position":{"start":{"line":82,"column":3,"offset":3751},"end":{"line":82,"column":177,"offset":3925},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Replaces a part of a source string matched by a regular expression with a replacement string, returning the result. The replacement string can contain references to regular expression capture groups.","position":{"start":{"line":84,"column":5,"offset":3931},"end":{"line":84,"column":204,"offset":4130},"indent":[]}}],"position":{"start":{"line":84,"column":5,"offset":3931},"end":{"line":84,"column":204,"offset":4130},"indent":[]}}],"position":{"start":{"line":84,"column":3,"offset":3929},"end":{"line":85,"column":1,"offset":4131},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Examples:","position":{"start":{"line":86,"column":6,"offset":4137},"end":{"line":86,"column":15,"offset":4146},"indent":[]}}],"position":{"start":{"line":86,"column":5,"offset":4136},"end":{"line":86,"column":16,"offset":4147},"indent":[]}}],"position":{"start":{"line":86,"column":5,"offset":4136},"end":{"line":86,"column":16,"offset":4147},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Literal match replace:","position":{"start":{"line":88,"column":5,"offset":4153},"end":{"line":88,"column":27,"offset":4175},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":88,"column":27,"offset":4175},"end":{"line":88,"column":33,"offset":4181},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":88,"column":33,"offset":4181},"end":{"line":89,"column":5,"offset":4186},"indent":[5]}},{"type":"inlineCode","value":"regex_replace(\"/foo/bar\", \"/bar$\", \"/baz\") == \"/foo/baz\"","position":{"start":{"line":89,"column":5,"offset":4186},"end":{"line":89,"column":63,"offset":4244},"indent":[]}}],"position":{"start":{"line":88,"column":5,"offset":4153},"end":{"line":89,"column":63,"offset":4244},"indent":[5]}},{"type":"paragraph","children":[{"type":"text","value":"If there is no match, the input string does not change:","position":{"start":{"line":91,"column":5,"offset":4250},"end":{"line":91,"column":60,"offset":4305},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":91,"column":60,"offset":4305},"end":{"line":91,"column":66,"offset":4311},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":91,"column":66,"offset":4311},"end":{"line":92,"column":5,"offset":4316},"indent":[5]}},{"type":"inlineCode","value":"regex_replace(\"/x\", \"^/y$\", \"/mumble\") == \"/x\"","position":{"start":{"line":92,"column":5,"offset":4316},"end":{"line":92,"column":53,"offset":4364},"indent":[]}}],"position":{"start":{"line":91,"column":5,"offset":4250},"end":{"line":92,"column":53,"offset":4364},"indent":[5]}},{"type":"paragraph","children":[{"type":"text","value":"Match is case sensitive by default:","position":{"start":{"line":94,"column":5,"offset":4370},"end":{"line":94,"column":40,"offset":4405},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":94,"column":40,"offset":4405},"end":{"line":94,"column":46,"offset":4411},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":94,"column":46,"offset":4411},"end":{"line":95,"column":5,"offset":4416},"indent":[5]}},{"type":"inlineCode","value":"regex_replace(\"/foo\", \"^/FOO$\", \"/x\") == \"/foo\"","position":{"start":{"line":95,"column":5,"offset":4416},"end":{"line":95,"column":54,"offset":4465},"indent":[]}}],"position":{"start":{"line":94,"column":5,"offset":4370},"end":{"line":95,"column":54,"offset":4465},"indent":[5]}},{"type":"paragraph","children":[{"type":"text","value":"When there are multiple matches, only one replacement occurs (the first one):","position":{"start":{"line":97,"column":5,"offset":4471},"end":{"line":97,"column":82,"offset":4548},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":97,"column":82,"offset":4548},"end":{"line":97,"column":88,"offset":4554},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":97,"column":88,"offset":4554},"end":{"line":98,"column":5,"offset":4559},"indent":[5]}},{"type":"inlineCode","value":"regex_replace(\"/a/a\", \"/a\", \"/b\") == \"/b/a\"","position":{"start":{"line":98,"column":5,"offset":4559},"end":{"line":98,"column":50,"offset":4604},"indent":[]}}],"position":{"start":{"line":97,"column":5,"offset":4471},"end":{"line":98,"column":50,"offset":4604},"indent":[5]}},{"type":"paragraph","children":[{"type":"text","value":"Escape a ","position":{"start":{"line":100,"column":5,"offset":4610},"end":{"line":100,"column":14,"offset":4619},"indent":[]}},{"type":"inlineCode","value":"$","position":{"start":{"line":100,"column":14,"offset":4619},"end":{"line":100,"column":17,"offset":4622},"indent":[]}},{"type":"text","value":" in the replacement string by prefixing it with another ","position":{"start":{"line":100,"column":17,"offset":4622},"end":{"line":100,"column":73,"offset":4678},"indent":[]}},{"type":"inlineCode","value":"$","position":{"start":{"line":100,"column":73,"offset":4678},"end":{"line":100,"column":76,"offset":4681},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":100,"column":76,"offset":4681},"end":{"line":100,"column":77,"offset":4682},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":100,"column":77,"offset":4682},"end":{"line":100,"column":83,"offset":4688},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":100,"column":83,"offset":4688},"end":{"line":101,"column":5,"offset":4693},"indent":[5]}},{"type":"inlineCode","value":"regex_replace(\"/b\", \"^/b$\", \"/b$$\") == \"/b$\"","position":{"start":{"line":101,"column":5,"offset":4693},"end":{"line":101,"column":51,"offset":4739},"indent":[]}}],"position":{"start":{"line":100,"column":5,"offset":4610},"end":{"line":101,"column":51,"offset":4739},"indent":[5]}},{"type":"paragraph","children":[{"type":"text","value":"Replace with capture groups:","position":{"start":{"line":103,"column":5,"offset":4745},"end":{"line":103,"column":33,"offset":4773},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":103,"column":33,"offset":4773},"end":{"line":103,"column":39,"offset":4779},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":103,"column":39,"offset":4779},"end":{"line":104,"column":5,"offset":4784},"indent":[5]}},{"type":"inlineCode","value":"regex_replace(\"/foo/a/path\", \"^/foo/([^/]*)/(.*)$\", \"/bar/${2}/${1}\") == \"/bar/path/a/\"","position":{"start":{"line":104,"column":5,"offset":4784},"end":{"line":104,"column":94,"offset":4873},"indent":[]}}],"position":{"start":{"line":103,"column":5,"offset":4745},"end":{"line":104,"column":94,"offset":4873},"indent":[5]}},{"type":"html","value":"<Aside type='warning'>","position":{"start":{"line":106,"column":5,"offset":4879},"end":{"line":106,"column":27,"offset":4901},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Warning:","position":{"start":{"line":108,"column":7,"offset":4909},"end":{"line":108,"column":15,"offset":4917},"indent":[]}}],"position":{"start":{"line":108,"column":5,"offset":4907},"end":{"line":108,"column":17,"offset":4919},"indent":[]}},{"type":"text","value":" You can only use the ","position":{"start":{"line":108,"column":17,"offset":4919},"end":{"line":108,"column":39,"offset":4941},"indent":[]}},{"type":"inlineCode","value":"regex_replace()","position":{"start":{"line":108,"column":39,"offset":4941},"end":{"line":108,"column":56,"offset":4958},"indent":[]}},{"type":"text","value":" function in ","position":{"start":{"line":108,"column":56,"offset":4958},"end":{"line":108,"column":69,"offset":4971},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/rules/transform","children":[{"type":"text","value":"rewrite expressions of Transform Rules","position":{"start":{"line":108,"column":70,"offset":4972},"end":{"line":108,"column":108,"offset":5010},"indent":[]}}],"position":{"start":{"line":108,"column":69,"offset":4971},"end":{"line":108,"column":160,"offset":5062},"indent":[]}},{"type":"text","value":". Additionally, the first argument must be a field under ","position":{"start":{"line":108,"column":160,"offset":5062},"end":{"line":108,"column":217,"offset":5119},"indent":[]}},{"type":"inlineCode","value":"http.request.headers","position":{"start":{"line":108,"column":217,"offset":5119},"end":{"line":108,"column":239,"offset":5141},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":108,"column":239,"offset":5141},"end":{"line":108,"column":243,"offset":5145},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":108,"column":243,"offset":5145},"end":{"line":108,"column":261,"offset":5163},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":108,"column":261,"offset":5163},"end":{"line":108,"column":262,"offset":5164},"indent":[]}}],"position":{"start":{"line":108,"column":5,"offset":4907},"end":{"line":108,"column":262,"offset":5164},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":110,"column":5,"offset":5170},"end":{"line":110,"column":13,"offset":5178},"indent":[]}}],"position":{"start":{"line":86,"column":3,"offset":4134},"end":{"line":110,"column":13,"offset":5178},"indent":[1,3,3,1,3,3,1,3,3,1,3,3,1,3,3,1,3,3,1,3,1,3,1,3]}}],"position":{"start":{"line":84,"column":3,"offset":3929},"end":{"line":110,"column":13,"offset":5178},"indent":[1,3,1,3,3,1,3,3,1,3,3,1,3,3,1,3,3,1,3,3,1,3,1,3,1,3]}}],"position":{"start":{"line":82,"column":1,"offset":3749},"end":{"line":111,"column":1,"offset":5179},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>remove_bytes(<Type>bytes</Type>)</code> <Type>bytes</Type>","position":{"start":{"line":112,"column":3,"offset":5182},"end":{"line":112,"column":67,"offset":5246},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns a new byte array with all the occurrences of the given bytes removed.","position":{"start":{"line":114,"column":5,"offset":5252},"end":{"line":114,"column":82,"offset":5329},"indent":[]}}],"position":{"start":{"line":114,"column":5,"offset":5252},"end":{"line":114,"column":82,"offset":5329},"indent":[]}}],"position":{"start":{"line":114,"column":3,"offset":5250},"end":{"line":115,"column":1,"offset":5330},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":116,"column":5,"offset":5335},"end":{"line":116,"column":28,"offset":5358},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">remove_bytes(http.host, \"\\x2e\\x77\") == \"cloudflarecom\"</code>","position":{"start":{"line":118,"column":5,"offset":5364},"end":{"line":118,"column":91,"offset":5450},"indent":[]}}],"position":{"start":{"line":116,"column":3,"offset":5333},"end":{"line":118,"column":91,"offset":5450},"indent":[1,3]}}],"position":{"start":{"line":114,"column":3,"offset":5250},"end":{"line":118,"column":91,"offset":5450},"indent":[1,3,1,3]}}],"position":{"start":{"line":112,"column":1,"offset":5180},"end":{"line":119,"column":1,"offset":5451},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>starts_with(source<ParamType>String</ParamType>, substring<ParamType>String</ParamType>)</code> <Type>Boolean</Type>","position":{"start":{"line":120,"column":3,"offset":5454},"end":{"line":120,"column":125,"offset":5576},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns ","position":{"start":{"line":122,"column":5,"offset":5582},"end":{"line":122,"column":13,"offset":5590},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":122,"column":13,"offset":5590},"end":{"line":122,"column":19,"offset":5596},"indent":[]}},{"type":"text","value":" when the source starts with a given substring. Returns ","position":{"start":{"line":122,"column":19,"offset":5596},"end":{"line":122,"column":75,"offset":5652},"indent":[]}},{"type":"inlineCode","value":"false","position":{"start":{"line":122,"column":75,"offset":5652},"end":{"line":122,"column":82,"offset":5659},"indent":[]}},{"type":"text","value":" otherwise. The source cannot be a literal value (for example, ","position":{"start":{"line":122,"column":82,"offset":5659},"end":{"line":122,"column":145,"offset":5722},"indent":[]}},{"type":"inlineCode","value":"\"foo\"","position":{"start":{"line":122,"column":145,"offset":5722},"end":{"line":122,"column":152,"offset":5729},"indent":[]}},{"type":"text","value":").","position":{"start":{"line":122,"column":152,"offset":5729},"end":{"line":122,"column":154,"offset":5731},"indent":[]}}],"position":{"start":{"line":122,"column":5,"offset":5582},"end":{"line":122,"column":154,"offset":5731},"indent":[]}}],"position":{"start":{"line":122,"column":3,"offset":5580},"end":{"line":123,"column":1,"offset":5732},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Example:","position":{"start":{"line":124,"column":6,"offset":5738},"end":{"line":124,"column":14,"offset":5746},"indent":[]}}],"position":{"start":{"line":124,"column":5,"offset":5737},"end":{"line":124,"column":15,"offset":5747},"indent":[]}},{"type":"html","value":"<br />","position":{"start":{"line":124,"column":15,"offset":5747},"end":{"line":124,"column":21,"offset":5753},"indent":[]}},{"type":"text","value":"\nIf ","position":{"start":{"line":124,"column":21,"offset":5753},"end":{"line":125,"column":8,"offset":5761},"indent":[5]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":125,"column":8,"offset":5761},"end":{"line":125,"column":31,"offset":5784},"indent":[]}},{"type":"text","value":" is ","position":{"start":{"line":125,"column":31,"offset":5784},"end":{"line":125,"column":35,"offset":5788},"indent":[]}},{"type":"inlineCode","value":"\"/blog/first-post\"","position":{"start":{"line":125,"column":35,"offset":5788},"end":{"line":125,"column":55,"offset":5808},"indent":[]}},{"type":"text","value":", then ","position":{"start":{"line":125,"column":55,"offset":5808},"end":{"line":125,"column":62,"offset":5815},"indent":[]}},{"type":"inlineCode","value":"starts_with(http.request.uri.path, \"/blog\")","position":{"start":{"line":125,"column":62,"offset":5815},"end":{"line":125,"column":107,"offset":5860},"indent":[]}},{"type":"text","value":" will return ","position":{"start":{"line":125,"column":107,"offset":5860},"end":{"line":125,"column":120,"offset":5873},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":125,"column":120,"offset":5873},"end":{"line":125,"column":126,"offset":5879},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":125,"column":126,"offset":5879},"end":{"line":125,"column":127,"offset":5880},"indent":[]}}],"position":{"start":{"line":124,"column":5,"offset":5737},"end":{"line":125,"column":127,"offset":5880},"indent":[5]}},{"type":"html","value":"<Aside type='warning'>","position":{"start":{"line":127,"column":5,"offset":5886},"end":{"line":127,"column":27,"offset":5908},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Warning:","position":{"start":{"line":129,"column":7,"offset":5916},"end":{"line":129,"column":15,"offset":5924},"indent":[]}}],"position":{"start":{"line":129,"column":5,"offset":5914},"end":{"line":129,"column":17,"offset":5926},"indent":[]}},{"type":"text","value":" You can only use the ","position":{"start":{"line":129,"column":17,"offset":5926},"end":{"line":129,"column":39,"offset":5948},"indent":[]}},{"type":"inlineCode","value":"starts_with()","position":{"start":{"line":129,"column":39,"offset":5948},"end":{"line":129,"column":54,"offset":5963},"indent":[]}},{"type":"text","value":" function in ","position":{"start":{"line":129,"column":54,"offset":5963},"end":{"line":129,"column":67,"offset":5976},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/","children":[{"type":"text","value":"rulesets","position":{"start":{"line":129,"column":68,"offset":5977},"end":{"line":129,"column":76,"offset":5985},"indent":[]}}],"position":{"start":{"line":129,"column":67,"offset":5976},"end":{"line":129,"column":128,"offset":6037},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":129,"column":128,"offset":6037},"end":{"line":129,"column":133,"offset":6042},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/rules/transform","children":[{"type":"text","value":"Transform Rules","position":{"start":{"line":129,"column":134,"offset":6043},"end":{"line":129,"column":149,"offset":6058},"indent":[]}}],"position":{"start":{"line":129,"column":133,"offset":6042},"end":{"line":129,"column":201,"offset":6110},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":129,"column":201,"offset":6110},"end":{"line":129,"column":202,"offset":6111},"indent":[]}}],"position":{"start":{"line":129,"column":5,"offset":5914},"end":{"line":129,"column":202,"offset":6111},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":131,"column":5,"offset":6117},"end":{"line":131,"column":13,"offset":6125},"indent":[]}}],"position":{"start":{"line":124,"column":3,"offset":5735},"end":{"line":131,"column":13,"offset":6125},"indent":[3,1,3,1,3,1,3]}}],"position":{"start":{"line":122,"column":3,"offset":5580},"end":{"line":131,"column":13,"offset":6125},"indent":[1,3,3,1,3,1,3,1,3]}}],"position":{"start":{"line":120,"column":1,"offset":5452},"end":{"line":132,"column":1,"offset":6126},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>to_string(<Type>Integer | Boolean | IP address</Type>)</code> <Type>String</Type>","position":{"start":{"line":133,"column":3,"offset":6129},"end":{"line":133,"column":90,"offset":6216},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns the string representation of an Integer, Boolean, or IP address value.","position":{"start":{"line":135,"column":5,"offset":6222},"end":{"line":135,"column":83,"offset":6300},"indent":[]}}],"position":{"start":{"line":135,"column":5,"offset":6222},"end":{"line":135,"column":83,"offset":6300},"indent":[]}}],"position":{"start":{"line":135,"column":3,"offset":6220},"end":{"line":136,"column":1,"offset":6301},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Examples:","position":{"start":{"line":137,"column":6,"offset":6307},"end":{"line":137,"column":15,"offset":6316},"indent":[]}}],"position":{"start":{"line":137,"column":5,"offset":6306},"end":{"line":137,"column":16,"offset":6317},"indent":[]}}],"position":{"start":{"line":137,"column":5,"offset":6306},"end":{"line":137,"column":16,"offset":6317},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"to_string(cf.bot_management.score) == '5'\nto_string(ssl) == 'true'","position":{"start":{"line":139,"column":5,"offset":6323},"end":{"line":142,"column":8,"offset":6412},"indent":[5,5,5]}},{"type":"html","value":"<Aside type='warning'>","position":{"start":{"line":144,"column":5,"offset":6418},"end":{"line":144,"column":27,"offset":6440},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Warning:","position":{"start":{"line":146,"column":7,"offset":6448},"end":{"line":146,"column":15,"offset":6456},"indent":[]}}],"position":{"start":{"line":146,"column":5,"offset":6446},"end":{"line":146,"column":17,"offset":6458},"indent":[]}},{"type":"text","value":" You can only use the ","position":{"start":{"line":146,"column":17,"offset":6458},"end":{"line":146,"column":39,"offset":6480},"indent":[]}},{"type":"inlineCode","value":"to_string()","position":{"start":{"line":146,"column":39,"offset":6480},"end":{"line":146,"column":52,"offset":6493},"indent":[]}},{"type":"text","value":" function in ","position":{"start":{"line":146,"column":52,"offset":6493},"end":{"line":146,"column":65,"offset":6506},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/rules/transform","children":[{"type":"text","value":"rewrite expressions of Transform Rules","position":{"start":{"line":146,"column":66,"offset":6507},"end":{"line":146,"column":104,"offset":6545},"indent":[]}}],"position":{"start":{"line":146,"column":65,"offset":6506},"end":{"line":146,"column":156,"offset":6597},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":146,"column":156,"offset":6597},"end":{"line":146,"column":157,"offset":6598},"indent":[]}}],"position":{"start":{"line":146,"column":5,"offset":6446},"end":{"line":146,"column":157,"offset":6598},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":148,"column":5,"offset":6604},"end":{"line":148,"column":13,"offset":6612},"indent":[]}}],"position":{"start":{"line":137,"column":3,"offset":6304},"end":{"line":148,"column":13,"offset":6612},"indent":[1,3,3,3,3,1,3,1,3,1,3]}}],"position":{"start":{"line":135,"column":3,"offset":6220},"end":{"line":148,"column":13,"offset":6612},"indent":[1,3,1,3,3,3,3,1,3,1,3,1,3]}}],"position":{"start":{"line":133,"column":1,"offset":6127},"end":{"line":149,"column":1,"offset":6613},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>upper(<Type>String</Type>)</code> <Type>String</Type>","position":{"start":{"line":150,"column":3,"offset":6616},"end":{"line":150,"column":62,"offset":6675},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a string field to uppercase. Only lowercase ASCII bytes are converted. All other bytes are unaffected.","position":{"start":{"line":152,"column":5,"offset":6681},"end":{"line":152,"column":116,"offset":6792},"indent":[]}}],"position":{"start":{"line":152,"column":5,"offset":6681},"end":{"line":152,"column":116,"offset":6792},"indent":[]}}],"position":{"start":{"line":152,"column":3,"offset":6679},"end":{"line":153,"column":1,"offset":6793},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":154,"column":5,"offset":6798},"end":{"line":154,"column":28,"offset":6821},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">upper(http.host) == \"WWW.CLOUDFLARE.COM\"</code>","position":{"start":{"line":156,"column":5,"offset":6827},"end":{"line":156,"column":77,"offset":6899},"indent":[]}}],"position":{"start":{"line":154,"column":3,"offset":6796},"end":{"line":156,"column":77,"offset":6899},"indent":[1,3]}}],"position":{"start":{"line":152,"column":3,"offset":6679},"end":{"line":156,"column":77,"offset":6899},"indent":[1,3,1,3]}}],"position":{"start":{"line":150,"column":1,"offset":6614},"end":{"line":157,"column":1,"offset":6900},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>url_decode(<Type>String</Type>)</code> <Type>String</Type>","position":{"start":{"line":158,"column":3,"offset":6903},"end":{"line":158,"column":67,"offset":6967},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Decodes a URL formatted string, as in the following:","position":{"start":{"line":160,"column":5,"offset":6973},"end":{"line":160,"column":57,"offset":7025},"indent":[]}}],"position":{"start":{"line":160,"column":5,"offset":6973},"end":{"line":160,"column":57,"offset":7025},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"html","value":"<code class=\"InlineCode\">%20</code> and <code class=\"InlineCode\">+</code> decode to space characters <code class=\"InlineCode\"> </code>","position":{"start":{"line":162,"column":7,"offset":7033},"end":{"line":162,"column":141,"offset":7167},"indent":[]}}],"position":{"start":{"line":162,"column":5,"offset":7031},"end":{"line":163,"column":1,"offset":7168},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"html","value":"<code class=\"InlineCode\">%E4%BD</code> decodes to <code class=\"InlineCode\">ä½ </code>","position":{"start":{"line":164,"column":7,"offset":7175},"end":{"line":164,"column":92,"offset":7260},"indent":[]}}],"position":{"start":{"line":164,"column":5,"offset":7173},"end":{"line":164,"column":92,"offset":7260},"indent":[]}}],"position":{"start":{"line":162,"column":5,"offset":7031},"end":{"line":164,"column":92,"offset":7260},"indent":[1,5]}}],"position":{"start":{"line":160,"column":3,"offset":6971},"end":{"line":165,"column":1,"offset":7261},"indent":[1,3,1,3,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<em>Example:</em><br />","position":{"start":{"line":166,"column":5,"offset":7266},"end":{"line":166,"column":28,"offset":7289},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">any(url_decode(http.request.body.form.values[*])[*] contains \"an xss attack\")</code>","position":{"start":{"line":168,"column":5,"offset":7295},"end":{"line":168,"column":114,"offset":7404},"indent":[]}}],"position":{"start":{"line":166,"column":3,"offset":7264},"end":{"line":168,"column":114,"offset":7404},"indent":[1,3]}}],"position":{"start":{"line":160,"column":3,"offset":6971},"end":{"line":168,"column":114,"offset":7404},"indent":[1,3,1,3,1,3,1,3]}}],"position":{"start":{"line":158,"column":1,"offset":6901},"end":{"line":168,"column":114,"offset":7404},"indent":[1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":27,"column":1,"offset":1326},"end":{"line":168,"column":114,"offset":7404},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"</Definitions>","position":{"start":{"line":170,"column":1,"offset":7406},"end":{"line":170,"column":15,"offset":7420},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Magic Firewall Functions","position":{"start":{"line":172,"column":4,"offset":7425},"end":{"line":172,"column":28,"offset":7449},"indent":[]}}],"position":{"start":{"line":172,"column":1,"offset":7422},"end":{"line":172,"column":28,"offset":7449},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"html","value":"<code>bit_slice(<Type>String</Type>, <Type>Number</Type>, <Type>Number</Type>)</code> <Type>Number</Type>","position":{"start":{"line":174,"column":3,"offset":7453},"end":{"line":174,"column":108,"offset":7558},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Select a slice of contiguous bits from a string field. This is primarily intended for use with ","position":{"start":{"line":176,"column":5,"offset":7564},"end":{"line":176,"column":100,"offset":7659},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":176,"column":100,"offset":7659},"end":{"line":176,"column":125,"offset":7684},"indent":[]}},{"type":"text","value":"ip","position":{"start":{"line":176,"column":125,"offset":7684},"end":{"line":176,"column":127,"offset":7686},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":176,"column":127,"offset":7686},"end":{"line":176,"column":134,"offset":7693},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":176,"column":134,"offset":7693},"end":{"line":176,"column":139,"offset":7698},"indent":[]}},{"type":"html","value":"<code class=\"InlineCode\">","position":{"start":{"line":176,"column":139,"offset":7698},"end":{"line":176,"column":164,"offset":7723},"indent":[]}},{"type":"text","value":"tcp","position":{"start":{"line":176,"column":164,"offset":7723},"end":{"line":176,"column":167,"offset":7726},"indent":[]}},{"type":"html","value":"</code>","position":{"start":{"line":176,"column":167,"offset":7726},"end":{"line":176,"column":174,"offset":7733},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":176,"column":174,"offset":7733},"end":{"line":176,"column":175,"offset":7734},"indent":[]}}],"position":{"start":{"line":176,"column":5,"offset":7564},"end":{"line":176,"column":175,"offset":7734},"indent":[]}}],"position":{"start":{"line":176,"column":3,"offset":7562},"end":{"line":176,"column":175,"offset":7734},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The slice can be no longer than 31 bits, but multiple calls can be joined together via a logical expression.","position":{"start":{"line":177,"column":5,"offset":7739},"end":{"line":177,"column":113,"offset":7847},"indent":[]}}],"position":{"start":{"line":177,"column":5,"offset":7739},"end":{"line":177,"column":113,"offset":7847},"indent":[]}}],"position":{"start":{"line":177,"column":3,"offset":7737},"end":{"line":177,"column":113,"offset":7847},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use of structure fields is preferred over this mechanism.","position":{"start":{"line":178,"column":5,"offset":7852},"end":{"line":178,"column":62,"offset":7909},"indent":[]}}],"position":{"start":{"line":178,"column":5,"offset":7852},"end":{"line":178,"column":62,"offset":7909},"indent":[]}}],"position":{"start":{"line":178,"column":3,"offset":7850},"end":{"line":178,"column":62,"offset":7909},"indent":[]}}],"position":{"start":{"line":176,"column":3,"offset":7562},"end":{"line":178,"column":62,"offset":7909},"indent":[3,3]}}],"position":{"start":{"line":174,"column":1,"offset":7451},"end":{"line":178,"column":62,"offset":7909},"indent":[1,1,1,1]}}],"position":{"start":{"line":174,"column":1,"offset":7451},"end":{"line":178,"column":62,"offset":7909},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"HMAC validation","position":{"start":{"line":180,"column":4,"offset":7914},"end":{"line":180,"column":19,"offset":7929},"indent":[]}}],"position":{"start":{"line":180,"column":1,"offset":7911},"end":{"line":180,"column":19,"offset":7929},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":182,"column":1,"offset":7931},"end":{"line":182,"column":42,"offset":7972},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to the HMAC validation function requires a Cloudflare Pro, Business, or Enterprise plan.","position":{"start":{"line":184,"column":1,"offset":7974},"end":{"line":184,"column":96,"offset":8069},"indent":[]}}],"position":{"start":{"line":184,"column":1,"offset":7974},"end":{"line":184,"column":96,"offset":8069},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":186,"column":1,"offset":8071},"end":{"line":186,"column":9,"offset":8079},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Overview","position":{"start":{"line":188,"column":5,"offset":8085},"end":{"line":188,"column":13,"offset":8093},"indent":[]}}],"position":{"start":{"line":188,"column":1,"offset":8081},"end":{"line":188,"column":13,"offset":8093},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can validate hash-based message authentication code (HMAC) tokens in a Firewall Rules expression by using the ","position":{"start":{"line":190,"column":1,"offset":8095},"end":{"line":190,"column":115,"offset":8209},"indent":[]}},{"type":"inlineCode","value":"is_timed_hmac_valid_v0()","position":{"start":{"line":190,"column":115,"offset":8209},"end":{"line":190,"column":141,"offset":8235},"indent":[]}},{"type":"text","value":" function, which has this signature:","position":{"start":{"line":190,"column":141,"offset":8235},"end":{"line":190,"column":177,"offset":8271},"indent":[]}}],"position":{"start":{"line":190,"column":1,"offset":8095},"end":{"line":190,"column":177,"offset":8271},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"is_timed_hmac_valid_v0(\n  <String literal as Key>,\n  <String field as MessageMAC>,\n  <Integer literal as ttl>,\n  <Integer as currentTimeStamp>,\n  <Optional Integer literal as lengthOfSeparator, default: 0>,\n  <Optional String literal as flags>\n) -> <Bool as result>","position":{"start":{"line":192,"column":1,"offset":8273},"end":{"line":201,"column":4,"offset":8550},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":203,"column":1,"offset":8552},"end":{"line":203,"column":5,"offset":8556},"indent":[]}},{"type":"inlineCode","value":"is_timed_hmac_valid_v0()","position":{"start":{"line":203,"column":5,"offset":8556},"end":{"line":203,"column":31,"offset":8582},"indent":[]}},{"type":"text","value":" function has these parameter definitions:","position":{"start":{"line":203,"column":31,"offset":8582},"end":{"line":203,"column":73,"offset":8624},"indent":[]}}],"position":{"start":{"line":203,"column":1,"offset":8552},"end":{"line":203,"column":73,"offset":8624},"indent":[]}},{"type":"html","value":"<Definitions>","position":{"start":{"line":205,"column":1,"offset":8626},"end":{"line":205,"column":14,"offset":8639},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Key","position":{"start":{"line":207,"column":4,"offset":8644},"end":{"line":207,"column":7,"offset":8647},"indent":[]}}],"position":{"start":{"line":207,"column":3,"offset":8643},"end":{"line":207,"column":8,"offset":8648},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":207,"column":8,"offset":8648},"end":{"line":207,"column":9,"offset":8649},"indent":[]}},{"type":"html","value":"<Type>","position":{"start":{"line":207,"column":9,"offset":8649},"end":{"line":207,"column":15,"offset":8655},"indent":[]}},{"type":"text","value":"String literal","position":{"start":{"line":207,"column":15,"offset":8655},"end":{"line":207,"column":29,"offset":8669},"indent":[]}},{"type":"html","value":"</Type>","position":{"start":{"line":207,"column":29,"offset":8669},"end":{"line":207,"column":36,"offset":8676},"indent":[]}}],"position":{"start":{"line":207,"column":3,"offset":8643},"end":{"line":207,"column":36,"offset":8676},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Specifies the secret cryptographic key for validating the HMAC.","position":{"start":{"line":209,"column":5,"offset":8682},"end":{"line":209,"column":68,"offset":8745},"indent":[]}}],"position":{"start":{"line":209,"column":5,"offset":8682},"end":{"line":209,"column":68,"offset":8745},"indent":[]}}],"position":{"start":{"line":209,"column":3,"offset":8680},"end":{"line":209,"column":68,"offset":8745},"indent":[]}}],"position":{"start":{"line":209,"column":3,"offset":8680},"end":{"line":209,"column":68,"offset":8745},"indent":[]}}],"position":{"start":{"line":207,"column":1,"offset":8641},"end":{"line":210,"column":1,"offset":8746},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":211,"column":4,"offset":8750},"end":{"line":211,"column":14,"offset":8760},"indent":[]}}],"position":{"start":{"line":211,"column":3,"offset":8749},"end":{"line":211,"column":15,"offset":8761},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":211,"column":15,"offset":8761},"end":{"line":211,"column":16,"offset":8762},"indent":[]}},{"type":"html","value":"<Type>","position":{"start":{"line":211,"column":16,"offset":8762},"end":{"line":211,"column":22,"offset":8768},"indent":[]}},{"type":"text","value":"String","position":{"start":{"line":211,"column":22,"offset":8768},"end":{"line":211,"column":28,"offset":8774},"indent":[]}},{"type":"html","value":"</Type>","position":{"start":{"line":211,"column":28,"offset":8774},"end":{"line":211,"column":35,"offset":8781},"indent":[]}}],"position":{"start":{"line":211,"column":3,"offset":8749},"end":{"line":211,"column":35,"offset":8781},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Contains a concatenation of these HMAC elements: ","position":{"start":{"line":213,"column":5,"offset":8787},"end":{"line":213,"column":54,"offset":8836},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"message","position":{"start":{"line":213,"column":55,"offset":8837},"end":{"line":213,"column":62,"offset":8844},"indent":[]}}],"position":{"start":{"line":213,"column":54,"offset":8836},"end":{"line":213,"column":63,"offset":8845},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":213,"column":63,"offset":8845},"end":{"line":213,"column":65,"offset":8847},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"separator","position":{"start":{"line":213,"column":66,"offset":8848},"end":{"line":213,"column":75,"offset":8857},"indent":[]}}],"position":{"start":{"line":213,"column":65,"offset":8847},"end":{"line":213,"column":76,"offset":8858},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":213,"column":76,"offset":8858},"end":{"line":213,"column":78,"offset":8860},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"timestamp","position":{"start":{"line":213,"column":79,"offset":8861},"end":{"line":213,"column":88,"offset":8870},"indent":[]}}],"position":{"start":{"line":213,"column":78,"offset":8860},"end":{"line":213,"column":89,"offset":8871},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":213,"column":89,"offset":8871},"end":{"line":213,"column":91,"offset":8873},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":213,"column":92,"offset":8874},"end":{"line":213,"column":95,"offset":8877},"indent":[]}}],"position":{"start":{"line":213,"column":91,"offset":8873},"end":{"line":213,"column":96,"offset":8878},"indent":[]}},{"type":"text","value":". For a definition and an example, see ","position":{"start":{"line":213,"column":96,"offset":8878},"end":{"line":213,"column":135,"offset":8917},"indent":[]}},{"type":"link","title":null,"url":"#messagemac","children":[{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":213,"column":137,"offset":8919},"end":{"line":213,"column":147,"offset":8929},"indent":[]}}],"position":{"start":{"line":213,"column":136,"offset":8918},"end":{"line":213,"column":148,"offset":8930},"indent":[]}}],"position":{"start":{"line":213,"column":135,"offset":8917},"end":{"line":213,"column":162,"offset":8944},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":213,"column":162,"offset":8944},"end":{"line":213,"column":163,"offset":8945},"indent":[]}}],"position":{"start":{"line":213,"column":5,"offset":8787},"end":{"line":213,"column":163,"offset":8945},"indent":[]}}],"position":{"start":{"line":213,"column":3,"offset":8785},"end":{"line":213,"column":163,"offset":8945},"indent":[]}}],"position":{"start":{"line":213,"column":3,"offset":8785},"end":{"line":213,"column":163,"offset":8945},"indent":[]}}],"position":{"start":{"line":211,"column":1,"offset":8747},"end":{"line":214,"column":1,"offset":8946},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"ttl","position":{"start":{"line":215,"column":4,"offset":8950},"end":{"line":215,"column":7,"offset":8953},"indent":[]}}],"position":{"start":{"line":215,"column":3,"offset":8949},"end":{"line":215,"column":8,"offset":8954},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":215,"column":8,"offset":8954},"end":{"line":215,"column":9,"offset":8955},"indent":[]}},{"type":"html","value":"<Type>","position":{"start":{"line":215,"column":9,"offset":8955},"end":{"line":215,"column":15,"offset":8961},"indent":[]}},{"type":"text","value":"Integer literal","position":{"start":{"line":215,"column":15,"offset":8961},"end":{"line":215,"column":30,"offset":8976},"indent":[]}},{"type":"html","value":"</Type>","position":{"start":{"line":215,"column":30,"offset":8976},"end":{"line":215,"column":37,"offset":8983},"indent":[]}}],"position":{"start":{"line":215,"column":3,"offset":8949},"end":{"line":215,"column":37,"offset":8983},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Defines the time-to-live for the HMAC token, expressed in seconds. Determines how long the token is valid, relative to the time it was issued.","position":{"start":{"line":217,"column":5,"offset":8989},"end":{"line":217,"column":147,"offset":9131},"indent":[]}}],"position":{"start":{"line":217,"column":5,"offset":8989},"end":{"line":217,"column":147,"offset":9131},"indent":[]}}],"position":{"start":{"line":217,"column":3,"offset":8987},"end":{"line":217,"column":147,"offset":9131},"indent":[]}}],"position":{"start":{"line":217,"column":3,"offset":8987},"end":{"line":217,"column":147,"offset":9131},"indent":[]}}],"position":{"start":{"line":215,"column":1,"offset":8947},"end":{"line":218,"column":1,"offset":9132},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"currentTimeStamp","position":{"start":{"line":219,"column":4,"offset":9136},"end":{"line":219,"column":20,"offset":9152},"indent":[]}}],"position":{"start":{"line":219,"column":3,"offset":9135},"end":{"line":219,"column":21,"offset":9153},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":219,"column":21,"offset":9153},"end":{"line":219,"column":22,"offset":9154},"indent":[]}},{"type":"html","value":"<Type>","position":{"start":{"line":219,"column":22,"offset":9154},"end":{"line":219,"column":28,"offset":9160},"indent":[]}},{"type":"text","value":"Integer","position":{"start":{"line":219,"column":28,"offset":9160},"end":{"line":219,"column":35,"offset":9167},"indent":[]}},{"type":"html","value":"</Type>","position":{"start":{"line":219,"column":35,"offset":9167},"end":{"line":219,"column":42,"offset":9174},"indent":[]}}],"position":{"start":{"line":219,"column":3,"offset":9135},"end":{"line":219,"column":42,"offset":9174},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Represents the Unix timestamp when Cloudflare received the request, expressed in seconds. Pass the ","position":{"start":{"line":221,"column":5,"offset":9180},"end":{"line":221,"column":104,"offset":9279},"indent":[]}},{"type":"inlineCode","value":"http.request.timestamp.sec","position":{"start":{"line":221,"column":104,"offset":9279},"end":{"line":221,"column":132,"offset":9307},"indent":[]}},{"type":"text","value":" field as an approximate value to this argument.","position":{"start":{"line":221,"column":132,"offset":9307},"end":{"line":221,"column":180,"offset":9355},"indent":[]}}],"position":{"start":{"line":221,"column":5,"offset":9180},"end":{"line":221,"column":180,"offset":9355},"indent":[]}}],"position":{"start":{"line":221,"column":3,"offset":9178},"end":{"line":221,"column":180,"offset":9355},"indent":[]}}],"position":{"start":{"line":221,"column":3,"offset":9178},"end":{"line":221,"column":180,"offset":9355},"indent":[]}}],"position":{"start":{"line":219,"column":1,"offset":9133},"end":{"line":222,"column":1,"offset":9356},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"lengthOfSeparator","position":{"start":{"line":223,"column":4,"offset":9360},"end":{"line":223,"column":21,"offset":9377},"indent":[]}}],"position":{"start":{"line":223,"column":3,"offset":9359},"end":{"line":223,"column":22,"offset":9378},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":223,"column":22,"offset":9378},"end":{"line":223,"column":23,"offset":9379},"indent":[]}},{"type":"html","value":"<Type>","position":{"start":{"line":223,"column":23,"offset":9379},"end":{"line":223,"column":29,"offset":9385},"indent":[]}},{"type":"text","value":"Integer literal","position":{"start":{"line":223,"column":29,"offset":9385},"end":{"line":223,"column":44,"offset":9400},"indent":[]}},{"type":"html","value":"</Type>","position":{"start":{"line":223,"column":44,"offset":9400},"end":{"line":223,"column":51,"offset":9407},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":223,"column":51,"offset":9407},"end":{"line":223,"column":52,"offset":9408},"indent":[]}},{"type":"html","value":"<PropMeta>","position":{"start":{"line":223,"column":52,"offset":9408},"end":{"line":223,"column":62,"offset":9418},"indent":[]}},{"type":"text","value":"optional","position":{"start":{"line":223,"column":62,"offset":9418},"end":{"line":223,"column":70,"offset":9426},"indent":[]}},{"type":"html","value":"</PropMeta>","position":{"start":{"line":223,"column":70,"offset":9426},"end":{"line":223,"column":81,"offset":9437},"indent":[]}}],"position":{"start":{"line":223,"column":3,"offset":9359},"end":{"line":223,"column":81,"offset":9437},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Specifies the length of the ","position":{"start":{"line":225,"column":5,"offset":9443},"end":{"line":225,"column":33,"offset":9471},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"separator","position":{"start":{"line":225,"column":34,"offset":9472},"end":{"line":225,"column":43,"offset":9481},"indent":[]}}],"position":{"start":{"line":225,"column":33,"offset":9471},"end":{"line":225,"column":44,"offset":9482},"indent":[]}},{"type":"text","value":" between the ","position":{"start":{"line":225,"column":44,"offset":9482},"end":{"line":225,"column":57,"offset":9495},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"timestamp","position":{"start":{"line":225,"column":58,"offset":9496},"end":{"line":225,"column":67,"offset":9505},"indent":[]}}],"position":{"start":{"line":225,"column":57,"offset":9495},"end":{"line":225,"column":68,"offset":9506},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":225,"column":68,"offset":9506},"end":{"line":225,"column":77,"offset":9515},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"message","position":{"start":{"line":225,"column":78,"offset":9516},"end":{"line":225,"column":85,"offset":9523},"indent":[]}}],"position":{"start":{"line":225,"column":77,"offset":9515},"end":{"line":225,"column":86,"offset":9524},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":225,"column":86,"offset":9524},"end":{"line":225,"column":94,"offset":9532},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":225,"column":95,"offset":9533},"end":{"line":225,"column":105,"offset":9543},"indent":[]}}],"position":{"start":{"line":225,"column":94,"offset":9532},"end":{"line":225,"column":106,"offset":9544},"indent":[]}},{"type":"text","value":". Expressed in bytes, with a default value of 0.","position":{"start":{"line":225,"column":106,"offset":9544},"end":{"line":225,"column":154,"offset":9592},"indent":[]}}],"position":{"start":{"line":225,"column":5,"offset":9443},"end":{"line":225,"column":154,"offset":9592},"indent":[]}}],"position":{"start":{"line":225,"column":3,"offset":9441},"end":{"line":225,"column":154,"offset":9592},"indent":[]}}],"position":{"start":{"line":225,"column":3,"offset":9441},"end":{"line":225,"column":154,"offset":9592},"indent":[]}}],"position":{"start":{"line":223,"column":1,"offset":9357},"end":{"line":226,"column":1,"offset":9593},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"flags","position":{"start":{"line":227,"column":4,"offset":9597},"end":{"line":227,"column":9,"offset":9602},"indent":[]}}],"position":{"start":{"line":227,"column":3,"offset":9596},"end":{"line":227,"column":10,"offset":9603},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":227,"column":10,"offset":9603},"end":{"line":227,"column":11,"offset":9604},"indent":[]}},{"type":"html","value":"<Type>","position":{"start":{"line":227,"column":11,"offset":9604},"end":{"line":227,"column":17,"offset":9610},"indent":[]}},{"type":"text","value":"String literal","position":{"start":{"line":227,"column":17,"offset":9610},"end":{"line":227,"column":31,"offset":9624},"indent":[]}},{"type":"html","value":"</Type>","position":{"start":{"line":227,"column":31,"offset":9624},"end":{"line":227,"column":38,"offset":9631},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":227,"column":38,"offset":9631},"end":{"line":227,"column":39,"offset":9632},"indent":[]}},{"type":"html","value":"<PropMeta>","position":{"start":{"line":227,"column":39,"offset":9632},"end":{"line":227,"column":49,"offset":9642},"indent":[]}},{"type":"text","value":"optional","position":{"start":{"line":227,"column":49,"offset":9642},"end":{"line":227,"column":57,"offset":9650},"indent":[]}},{"type":"html","value":"</PropMeta>","position":{"start":{"line":227,"column":57,"offset":9650},"end":{"line":227,"column":68,"offset":9661},"indent":[]}}],"position":{"start":{"line":227,"column":3,"offset":9596},"end":{"line":227,"column":68,"offset":9661},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When you set this optional argument to ","position":{"start":{"line":229,"column":5,"offset":9667},"end":{"line":229,"column":44,"offset":9706},"indent":[]}},{"type":"inlineCode","value":"'s'","position":{"start":{"line":229,"column":44,"offset":9706},"end":{"line":229,"column":49,"offset":9711},"indent":[]}},{"type":"text","value":", the function expects the value of the base64-encoded ","position":{"start":{"line":229,"column":49,"offset":9711},"end":{"line":229,"column":104,"offset":9766},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":229,"column":105,"offset":9767},"end":{"line":229,"column":108,"offset":9770},"indent":[]}}],"position":{"start":{"line":229,"column":104,"offset":9766},"end":{"line":229,"column":109,"offset":9771},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":229,"column":109,"offset":9771},"end":{"line":229,"column":117,"offset":9779},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":229,"column":118,"offset":9780},"end":{"line":229,"column":128,"offset":9790},"indent":[]}}],"position":{"start":{"line":229,"column":117,"offset":9779},"end":{"line":229,"column":129,"offset":9791},"indent":[]}},{"type":"text","value":" argument to use the URL-safe character set with no padding.","position":{"start":{"line":229,"column":129,"offset":9791},"end":{"line":229,"column":189,"offset":9851},"indent":[]}}],"position":{"start":{"line":229,"column":5,"offset":9667},"end":{"line":229,"column":189,"offset":9851},"indent":[]}}],"position":{"start":{"line":229,"column":3,"offset":9665},"end":{"line":230,"column":1,"offset":9852},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When you do ","position":{"start":{"line":231,"column":5,"offset":9857},"end":{"line":231,"column":17,"offset":9869},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"not","position":{"start":{"line":231,"column":19,"offset":9871},"end":{"line":231,"column":22,"offset":9874},"indent":[]}}],"position":{"start":{"line":231,"column":17,"offset":9869},"end":{"line":231,"column":24,"offset":9876},"indent":[]}},{"type":"text","value":" set the value of ","position":{"start":{"line":231,"column":24,"offset":9876},"end":{"line":231,"column":42,"offset":9894},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"flags","position":{"start":{"line":231,"column":43,"offset":9895},"end":{"line":231,"column":48,"offset":9900},"indent":[]}}],"position":{"start":{"line":231,"column":42,"offset":9894},"end":{"line":231,"column":49,"offset":9901},"indent":[]}},{"type":"text","value":" to ","position":{"start":{"line":231,"column":49,"offset":9901},"end":{"line":231,"column":53,"offset":9905},"indent":[]}},{"type":"inlineCode","value":"'s'","position":{"start":{"line":231,"column":53,"offset":9905},"end":{"line":231,"column":58,"offset":9910},"indent":[]}},{"type":"text","value":", you must URL encode the base64 value for ","position":{"start":{"line":231,"column":58,"offset":9910},"end":{"line":231,"column":101,"offset":9953},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":231,"column":102,"offset":9954},"end":{"line":231,"column":105,"offset":9957},"indent":[]}}],"position":{"start":{"line":231,"column":101,"offset":9953},"end":{"line":231,"column":106,"offset":9958},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":231,"column":106,"offset":9958},"end":{"line":231,"column":114,"offset":9966},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":231,"column":115,"offset":9967},"end":{"line":231,"column":125,"offset":9977},"indent":[]}}],"position":{"start":{"line":231,"column":114,"offset":9966},"end":{"line":231,"column":126,"offset":9978},"indent":[]}},{"type":"text","value":" argument.","position":{"start":{"line":231,"column":126,"offset":9978},"end":{"line":231,"column":136,"offset":9988},"indent":[]}}],"position":{"start":{"line":231,"column":5,"offset":9857},"end":{"line":231,"column":136,"offset":9988},"indent":[]}}],"position":{"start":{"line":231,"column":3,"offset":9855},"end":{"line":231,"column":136,"offset":9988},"indent":[]}}],"position":{"start":{"line":229,"column":3,"offset":9665},"end":{"line":231,"column":136,"offset":9988},"indent":[1,3]}}],"position":{"start":{"line":227,"column":1,"offset":9594},"end":{"line":231,"column":136,"offset":9988},"indent":[1,1,1,1]}}],"position":{"start":{"line":207,"column":1,"offset":8641},"end":{"line":231,"column":136,"offset":9988},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"</Definitions>","position":{"start":{"line":233,"column":1,"offset":9990},"end":{"line":233,"column":15,"offset":10004},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Usage","position":{"start":{"line":235,"column":5,"offset":10010},"end":{"line":235,"column":10,"offset":10015},"indent":[]}}],"position":{"start":{"line":235,"column":1,"offset":10006},"end":{"line":235,"column":10,"offset":10015},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":237,"column":1,"offset":10017},"end":{"line":237,"column":5,"offset":10021},"indent":[]}},{"type":"inlineCode","value":"is_timed_hmac_valid_v0()","position":{"start":{"line":237,"column":5,"offset":10021},"end":{"line":237,"column":31,"offset":10047},"indent":[]}},{"type":"text","value":" function uses the supplied ","position":{"start":{"line":237,"column":31,"offset":10047},"end":{"line":237,"column":59,"offset":10075},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Key","position":{"start":{"line":237,"column":60,"offset":10076},"end":{"line":237,"column":63,"offset":10079},"indent":[]}}],"position":{"start":{"line":237,"column":59,"offset":10075},"end":{"line":237,"column":64,"offset":10080},"indent":[]}},{"type":"text","value":" to generate a message authentication code (MAC) from the ","position":{"start":{"line":237,"column":64,"offset":10080},"end":{"line":237,"column":122,"offset":10138},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"message","position":{"start":{"line":237,"column":123,"offset":10139},"end":{"line":237,"column":130,"offset":10146},"indent":[]}}],"position":{"start":{"line":237,"column":122,"offset":10138},"end":{"line":237,"column":131,"offset":10147},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":237,"column":131,"offset":10147},"end":{"line":237,"column":140,"offset":10156},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"timestamp","position":{"start":{"line":237,"column":141,"offset":10157},"end":{"line":237,"column":150,"offset":10166},"indent":[]}}],"position":{"start":{"line":237,"column":140,"offset":10156},"end":{"line":237,"column":151,"offset":10167},"indent":[]}},{"type":"text","value":" regions of the MessageMAC. When the generated MAC matches the ","position":{"start":{"line":237,"column":151,"offset":10167},"end":{"line":237,"column":214,"offset":10230},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":237,"column":215,"offset":10231},"end":{"line":237,"column":218,"offset":10234},"indent":[]}}],"position":{"start":{"line":237,"column":214,"offset":10230},"end":{"line":237,"column":219,"offset":10235},"indent":[]}},{"type":"text","value":" region of the MessageMAC and the token has not expired, the HMAC is valid and the function returns ","position":{"start":{"line":237,"column":219,"offset":10235},"end":{"line":237,"column":319,"offset":10335},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":237,"column":319,"offset":10335},"end":{"line":237,"column":325,"offset":10341},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":237,"column":325,"offset":10341},"end":{"line":237,"column":326,"offset":10342},"indent":[]}}],"position":{"start":{"line":237,"column":1,"offset":10017},"end":{"line":237,"column":326,"offset":10342},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, the following expression matches requests to ","position":{"start":{"line":239,"column":1,"offset":10344},"end":{"line":239,"column":59,"offset":10402},"indent":[]}},{"type":"inlineCode","value":"download.example.com","position":{"start":{"line":239,"column":59,"offset":10402},"end":{"line":239,"column":81,"offset":10424},"indent":[]}},{"type":"text","value":" that do not include valid HMAC tokens:","position":{"start":{"line":239,"column":81,"offset":10424},"end":{"line":239,"column":120,"offset":10463},"indent":[]}}],"position":{"start":{"line":239,"column":1,"offset":10344},"end":{"line":239,"column":120,"offset":10463},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"http.host == \"download.example.com\"\nand not is_timed_hmac_valid_v0(\"mysecretkey\", http.request.uri, 100000, http.request.timestamp.sec, 8)","position":{"start":{"line":241,"column":1,"offset":10465},"end":{"line":244,"column":4,"offset":10615},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"To review examples of firewall rules that use HMAC validation, see ","position":{"start":{"line":246,"column":1,"offset":10617},"end":{"line":246,"column":68,"offset":10684},"indent":[]}},{"type":"link","title":null,"url":"/recipes/","children":[{"type":"emphasis","children":[{"type":"text","value":"Common use cases","position":{"start":{"line":246,"column":70,"offset":10686},"end":{"line":246,"column":86,"offset":10702},"indent":[]}}],"position":{"start":{"line":246,"column":69,"offset":10685},"end":{"line":246,"column":87,"offset":10703},"indent":[]}}],"position":{"start":{"line":246,"column":68,"offset":10684},"end":{"line":246,"column":99,"offset":10715},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":246,"column":99,"offset":10715},"end":{"line":246,"column":100,"offset":10716},"indent":[]}}],"position":{"start":{"line":246,"column":1,"offset":10617},"end":{"line":246,"column":100,"offset":10716},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":248,"column":5,"offset":10722},"end":{"line":248,"column":15,"offset":10732},"indent":[]}}],"position":{"start":{"line":248,"column":1,"offset":10718},"end":{"line":248,"column":15,"offset":10732},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A valid MessageMAC satisfies the regular expression","position":{"start":{"line":250,"column":1,"offset":10734},"end":{"line":250,"column":52,"offset":10785},"indent":[]}}],"position":{"start":{"line":250,"column":1,"offset":10734},"end":{"line":250,"column":52,"offset":10785},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"(.+)(.*)(\\d{10})-(.{43,})","position":{"start":{"line":252,"column":1,"offset":10787},"end":{"line":254,"column":4,"offset":10824},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"and is composed of these parentheses-delimited expressions:","position":{"start":{"line":256,"column":1,"offset":10826},"end":{"line":256,"column":60,"offset":10885},"indent":[]}}],"position":{"start":{"line":256,"column":1,"offset":10826},"end":{"line":256,"column":60,"offset":10885},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n    <tr>\n      <th>Expression</th>\n      <th style=\"width:50%\">Description</th>\n      <th>Example</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td valign=\"top\"><code>(.+)</code></td>\n      <td>The <em>message</em> to validate</td>\n      <td valign=\"top\"><code class=\"InlineCode\">/download/cat.jpg</code></td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>(.*)</code></td>\n      <td>The <em>separator</em> between message and timestamp, commonly a parameter name</td>\n      <td valign=\"top\"><code class=\"InlineCode\">&verify=</code></td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>(\\d{'{10}'})</code></td>\n      <td>The 10-digit Unix <em>timestamp</em> when the MAC was issued, expressed in seconds</td>\n      <td valign=\"top\"><code class=\"InlineCode\">1484063137</code></td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>(.{'{43,}'})</code></td>\n      <td><p>A base64-encoded version of the <em>MAC</em>. When you do not set the value of the <em>urlSafe</em> argument in the HMAC validation function to <code class=\"InlineCode\">'s'</code>, you must URL encode the base64 value for <em>mac</em>.</p>\n      <p>When the base64 MAC encoding is URL-safe, the value for <em>mac</em> contains 43 bytes. Otherwise, the value will be 44 bytes or more, because of URL encoding.</p></td>\n      <td valign=\"top\"><code class=\"InlineCode\">IaLGSmELTvlhfd0ItdN6PhhHTFhzx<br />73EX8uy%2FcSDiIU%3D</code></td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":258,"column":1,"offset":10887},"end":{"line":289,"column":9,"offset":12339},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For details on generating a MessageMAC, see ","position":{"start":{"line":291,"column":1,"offset":12341},"end":{"line":291,"column":45,"offset":12385},"indent":[]}},{"type":"link","title":null,"url":"https://support.cloudflare.com/hc/articles/115001376488#6P9Gz7kmyxQrpL6r6iPKQR","children":[{"type":"emphasis","children":[{"type":"text","value":"Implement token creation","position":{"start":{"line":291,"column":47,"offset":12387},"end":{"line":291,"column":71,"offset":12411},"indent":[]}}],"position":{"start":{"line":291,"column":46,"offset":12386},"end":{"line":291,"column":72,"offset":12412},"indent":[]}}],"position":{"start":{"line":291,"column":45,"offset":12385},"end":{"line":291,"column":153,"offset":12493},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":291,"column":153,"offset":12493},"end":{"line":291,"column":154,"offset":12494},"indent":[]}}],"position":{"start":{"line":291,"column":1,"offset":12341},"end":{"line":291,"column":154,"offset":12494},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"HMAC validation examples","position":{"start":{"line":293,"column":4,"offset":12499},"end":{"line":293,"column":28,"offset":12523},"indent":[]}}],"position":{"start":{"line":293,"column":1,"offset":12496},"end":{"line":293,"column":28,"offset":12523},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":295,"column":1,"offset":12525},"end":{"line":295,"column":42,"offset":12566},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you do not use the optional ","position":{"start":{"line":297,"column":1,"offset":12568},"end":{"line":297,"column":34,"offset":12601},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"flags","position":{"start":{"line":297,"column":35,"offset":12602},"end":{"line":297,"column":40,"offset":12607},"indent":[]}}],"position":{"start":{"line":297,"column":34,"offset":12601},"end":{"line":297,"column":41,"offset":12608},"indent":[]}},{"type":"text","value":" argument for ","position":{"start":{"line":297,"column":41,"offset":12608},"end":{"line":297,"column":55,"offset":12622},"indent":[]}},{"type":"inlineCode","value":"is_timed_hmac_valid_v0()","position":{"start":{"line":297,"column":55,"offset":12622},"end":{"line":297,"column":81,"offset":12648},"indent":[]}},{"type":"text","value":", you must URL encode the base64 value for ","position":{"start":{"line":297,"column":81,"offset":12648},"end":{"line":297,"column":124,"offset":12691},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":297,"column":125,"offset":12692},"end":{"line":297,"column":128,"offset":12695},"indent":[]}}],"position":{"start":{"line":297,"column":124,"offset":12691},"end":{"line":297,"column":129,"offset":12696},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":297,"column":129,"offset":12696},"end":{"line":297,"column":137,"offset":12704},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":297,"column":138,"offset":12705},"end":{"line":297,"column":148,"offset":12715},"indent":[]}}],"position":{"start":{"line":297,"column":137,"offset":12704},"end":{"line":297,"column":149,"offset":12716},"indent":[]}},{"type":"text","value":" argument.","position":{"start":{"line":297,"column":149,"offset":12716},"end":{"line":297,"column":159,"offset":12726},"indent":[]}}],"position":{"start":{"line":297,"column":1,"offset":12568},"end":{"line":297,"column":159,"offset":12726},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information, see ","position":{"start":{"line":299,"column":1,"offset":12728},"end":{"line":299,"column":27,"offset":12754},"indent":[]}},{"type":"link","title":null,"url":"#overview","children":[{"type":"text","value":"HMAC Validation: Overview","position":{"start":{"line":299,"column":28,"offset":12755},"end":{"line":299,"column":53,"offset":12780},"indent":[]}}],"position":{"start":{"line":299,"column":27,"offset":12754},"end":{"line":299,"column":65,"offset":12792},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":299,"column":65,"offset":12792},"end":{"line":299,"column":66,"offset":12793},"indent":[]}}],"position":{"start":{"line":299,"column":1,"offset":12728},"end":{"line":299,"column":66,"offset":12793},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":301,"column":1,"offset":12795},"end":{"line":301,"column":9,"offset":12803},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Simple case","position":{"start":{"line":303,"column":5,"offset":12809},"end":{"line":303,"column":16,"offset":12820},"indent":[]}}],"position":{"start":{"line":303,"column":1,"offset":12805},"end":{"line":303,"column":16,"offset":12820},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Consider the case where the MessageMAC is contained entirely within a single field, as in this example URI path:","position":{"start":{"line":305,"column":1,"offset":12822},"end":{"line":305,"column":113,"offset":12934},"indent":[]}}],"position":{"start":{"line":305,"column":1,"offset":12822},"end":{"line":305,"column":113,"offset":12934},"indent":[]}},{"type":"code","lang":"http","meta":null,"value":"/download/cat.jpg?verify=1484063787-IaLGSmELTvlhfd0ItdN6PhhHTFhzx73EX8uy%2FcSDiIU%3D","position":{"start":{"line":307,"column":1,"offset":12936},"end":{"line":309,"column":4,"offset":13032},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note how the URI maps to the elements of the MessageMAC:","position":{"start":{"line":311,"column":1,"offset":13034},"end":{"line":311,"column":57,"offset":13090},"indent":[]}}],"position":{"start":{"line":311,"column":1,"offset":13034},"end":{"line":311,"column":57,"offset":13090},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"message","position":{"start":{"line":313,"column":4,"offset":13095},"end":{"line":313,"column":11,"offset":13102},"indent":[]}}],"position":{"start":{"line":313,"column":3,"offset":13094},"end":{"line":313,"column":12,"offset":13103},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":313,"column":12,"offset":13103},"end":{"line":313,"column":14,"offset":13105},"indent":[]}},{"type":"inlineCode","value":"/download/cat.jpg","position":{"start":{"line":313,"column":14,"offset":13105},"end":{"line":313,"column":33,"offset":13124},"indent":[]}}],"position":{"start":{"line":313,"column":3,"offset":13094},"end":{"line":313,"column":33,"offset":13124},"indent":[]}}],"position":{"start":{"line":313,"column":1,"offset":13092},"end":{"line":313,"column":33,"offset":13124},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"separator","position":{"start":{"line":314,"column":4,"offset":13128},"end":{"line":314,"column":13,"offset":13137},"indent":[]}}],"position":{"start":{"line":314,"column":3,"offset":13127},"end":{"line":314,"column":14,"offset":13138},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":314,"column":14,"offset":13138},"end":{"line":314,"column":16,"offset":13140},"indent":[]}},{"type":"inlineCode","value":"?verify=","position":{"start":{"line":314,"column":16,"offset":13140},"end":{"line":314,"column":26,"offset":13150},"indent":[]}}],"position":{"start":{"line":314,"column":3,"offset":13127},"end":{"line":314,"column":26,"offset":13150},"indent":[]}}],"position":{"start":{"line":314,"column":1,"offset":13125},"end":{"line":314,"column":26,"offset":13150},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"timestamp","position":{"start":{"line":315,"column":4,"offset":13154},"end":{"line":315,"column":13,"offset":13163},"indent":[]}}],"position":{"start":{"line":315,"column":3,"offset":13153},"end":{"line":315,"column":14,"offset":13164},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":315,"column":14,"offset":13164},"end":{"line":315,"column":16,"offset":13166},"indent":[]}},{"type":"inlineCode","value":"1484063787","position":{"start":{"line":315,"column":16,"offset":13166},"end":{"line":315,"column":28,"offset":13178},"indent":[]}}],"position":{"start":{"line":315,"column":3,"offset":13153},"end":{"line":315,"column":28,"offset":13178},"indent":[]}}],"position":{"start":{"line":315,"column":1,"offset":13151},"end":{"line":315,"column":28,"offset":13178},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"mac","position":{"start":{"line":316,"column":4,"offset":13182},"end":{"line":316,"column":7,"offset":13185},"indent":[]}}],"position":{"start":{"line":316,"column":3,"offset":13181},"end":{"line":316,"column":8,"offset":13186},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":316,"column":8,"offset":13186},"end":{"line":316,"column":10,"offset":13188},"indent":[]}},{"type":"inlineCode","value":"IaLGSmELTvlhfd0ItdN6PhhHTFhzx73EX8uy%2FcSDiIU%3D","position":{"start":{"line":316,"column":10,"offset":13188},"end":{"line":316,"column":60,"offset":13238},"indent":[]}}],"position":{"start":{"line":316,"column":3,"offset":13181},"end":{"line":316,"column":60,"offset":13238},"indent":[]}}],"position":{"start":{"line":316,"column":1,"offset":13179},"end":{"line":316,"column":60,"offset":13238},"indent":[]}}],"position":{"start":{"line":313,"column":1,"offset":13092},"end":{"line":316,"column":60,"offset":13238},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"When the MessageMAC is contained entirely within a single field such as ","position":{"start":{"line":318,"column":1,"offset":13240},"end":{"line":318,"column":73,"offset":13312},"indent":[]}},{"type":"inlineCode","value":"http.request.uri","position":{"start":{"line":318,"column":73,"offset":13312},"end":{"line":318,"column":91,"offset":13330},"indent":[]}},{"type":"text","value":", using the validation function is straightforward. Pass the name of the field to the ","position":{"start":{"line":318,"column":91,"offset":13330},"end":{"line":318,"column":177,"offset":13416},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"MessageMAC","position":{"start":{"line":318,"column":178,"offset":13417},"end":{"line":318,"column":188,"offset":13427},"indent":[]}}],"position":{"start":{"line":318,"column":177,"offset":13416},"end":{"line":318,"column":189,"offset":13428},"indent":[]}},{"type":"text","value":" argument:","position":{"start":{"line":318,"column":189,"offset":13428},"end":{"line":318,"column":199,"offset":13438},"indent":[]}}],"position":{"start":{"line":318,"column":1,"offset":13240},"end":{"line":318,"column":199,"offset":13438},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"is_timed_hmac_valid_v0(\n  \"mysecretkey\",\n  http.request.uri,\n  100000,\n  http.request.timestamp.sec,\n  8\n)","position":{"start":{"line":320,"column":1,"offset":13440},"end":{"line":328,"column":4,"offset":13558},"indent":[1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Concatenated MessageMAC argument","position":{"start":{"line":330,"column":5,"offset":13564},"end":{"line":330,"column":37,"offset":13596},"indent":[]}}],"position":{"start":{"line":330,"column":1,"offset":13560},"end":{"line":330,"column":37,"offset":13596},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To compose a MessageMAC from more than one field, use the ","position":{"start":{"line":332,"column":1,"offset":13598},"end":{"line":332,"column":59,"offset":13656},"indent":[]}},{"type":"inlineCode","value":"concat()","position":{"start":{"line":332,"column":59,"offset":13656},"end":{"line":332,"column":69,"offset":13666},"indent":[]}},{"type":"text","value":" function.","position":{"start":{"line":332,"column":69,"offset":13666},"end":{"line":332,"column":79,"offset":13676},"indent":[]}}],"position":{"start":{"line":332,"column":1,"offset":13598},"end":{"line":332,"column":79,"offset":13676},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example constructs the MessageMAC by concatenating the request URI and two header fields:","position":{"start":{"line":334,"column":1,"offset":13678},"end":{"line":334,"column":95,"offset":13772},"indent":[]}}],"position":{"start":{"line":334,"column":1,"offset":13678},"end":{"line":334,"column":95,"offset":13772},"indent":[]}},{"type":"code","lang":"java","meta":null,"value":"is_timed_hmac_valid_v0(\n  \"mysecretkey\",\n  concat(\n    http.request.uri,\n    http.request.headers[\"timestamp\"][0],\n    \"-\",\n    http.request.headers[\"mac\"][0]),\n  100000,\n  http.request.timestamp.sec,\n  0\n)","position":{"start":{"line":336,"column":1,"offset":13774},"end":{"line":348,"column":4,"offset":13992},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For more on ","position":{"start":{"line":350,"column":1,"offset":13994},"end":{"line":350,"column":13,"offset":14006},"indent":[]}},{"type":"inlineCode","value":"concat()","position":{"start":{"line":350,"column":13,"offset":14006},"end":{"line":350,"column":23,"offset":14016},"indent":[]}},{"type":"text","value":" usage, see ","position":{"start":{"line":350,"column":23,"offset":14016},"end":{"line":350,"column":35,"offset":14028},"indent":[]}},{"type":"link","title":null,"url":"#transformation-functions","children":[{"type":"emphasis","children":[{"type":"text","value":"Transformation functions","position":{"start":{"line":350,"column":37,"offset":14030},"end":{"line":350,"column":61,"offset":14054},"indent":[]}}],"position":{"start":{"line":350,"column":36,"offset":14029},"end":{"line":350,"column":62,"offset":14055},"indent":[]}}],"position":{"start":{"line":350,"column":35,"offset":14028},"end":{"line":350,"column":90,"offset":14083},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":350,"column":90,"offset":14083},"end":{"line":350,"column":91,"offset":14084},"indent":[]}}],"position":{"start":{"line":350,"column":1,"offset":13994},"end":{"line":350,"column":91,"offset":14084},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":353,"column":73,"offset":14159}}}}},{"node":{"fields":{"slug":"/cf-dashboard/create-edit-delete-rules"},"frontmatter":{"order":310,"title":"Create, edit, and delete rules","summary":null,"demo":null,"tags":null},"headings":[{"value":"Create, edit, and delete rules"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Create, edit, and delete rules","position":{"start":{"line":4,"column":3,"offset":102},"end":{"line":4,"column":33,"offset":132},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":100},"end":{"line":4,"column":33,"offset":132},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":6,"column":1,"offset":134},"end":{"line":6,"column":5,"offset":138},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":6,"column":7,"offset":140},"end":{"line":6,"column":27,"offset":160},"indent":[]}}],"position":{"start":{"line":6,"column":5,"offset":138},"end":{"line":6,"column":29,"offset":162},"indent":[]}},{"type":"text","value":" page in the Firewall app is a good guide to the parts of a Firewall Rule. When an incoming HTTP request matches the ","position":{"start":{"line":6,"column":29,"offset":162},"end":{"line":6,"column":146,"offset":279},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"expression","position":{"start":{"line":6,"column":148,"offset":281},"end":{"line":6,"column":158,"offset":291},"indent":[]}}],"position":{"start":{"line":6,"column":146,"offset":279},"end":{"line":6,"column":160,"offset":293},"indent":[]}},{"type":"text","value":" in a Firewall Rule, the specified ","position":{"start":{"line":6,"column":160,"offset":293},"end":{"line":6,"column":195,"offset":328},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"action","position":{"start":{"line":6,"column":197,"offset":330},"end":{"line":6,"column":203,"offset":336},"indent":[]}}],"position":{"start":{"line":6,"column":195,"offset":328},"end":{"line":6,"column":205,"offset":338},"indent":[]}},{"type":"text","value":" is triggered:","position":{"start":{"line":6,"column":205,"offset":338},"end":{"line":6,"column":219,"offset":352},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":134},"end":{"line":6,"column":219,"offset":352},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-1.png","alt":"Create Firewall Rule page","position":{"start":{"line":8,"column":1,"offset":354},"end":{"line":8,"column":80,"offset":433},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":354},"end":{"line":8,"column":80,"offset":433},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Note that a simple expression has the following syntax:","position":{"start":{"line":10,"column":1,"offset":435},"end":{"line":10,"column":56,"offset":490},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":435},"end":{"line":10,"column":56,"offset":490},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"<field> <comparison operator> <value>","position":{"start":{"line":12,"column":1,"offset":492},"end":{"line":12,"column":42,"offset":533},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information, refer to ","position":{"start":{"line":14,"column":1,"offset":535},"end":{"line":14,"column":32,"offset":566},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/expressions","children":[{"type":"text","value":"Expressions","position":{"start":{"line":14,"column":33,"offset":567},"end":{"line":14,"column":44,"offset":578},"indent":[]}}],"position":{"start":{"line":14,"column":32,"offset":566},"end":{"line":14,"column":122,"offset":656},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":14,"column":122,"offset":656},"end":{"line":14,"column":127,"offset":661},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/actions/","children":[{"type":"text","value":"Actions","position":{"start":{"line":14,"column":128,"offset":662},"end":{"line":14,"column":135,"offset":669},"indent":[]}}],"position":{"start":{"line":14,"column":127,"offset":661},"end":{"line":14,"column":165,"offset":699},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":14,"column":165,"offset":699},"end":{"line":14,"column":166,"offset":700},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":535},"end":{"line":14,"column":166,"offset":700},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Expression Builder and Editor","position":{"start":{"line":16,"column":4,"offset":705},"end":{"line":16,"column":33,"offset":734},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":702},"end":{"line":16,"column":33,"offset":734},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":18,"column":1,"offset":736},"end":{"line":18,"column":42,"offset":777},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules expressions have a 4 KB limit (approximately 4,000 text characters).","position":{"start":{"line":20,"column":1,"offset":779},"end":{"line":20,"column":84,"offset":862},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":779},"end":{"line":20,"column":84,"offset":862},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":22,"column":1,"offset":864},"end":{"line":22,"column":9,"offset":872},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall app in the Cloudflare dashboard offers two options for editing expressions.","position":{"start":{"line":24,"column":1,"offset":874},"end":{"line":24,"column":89,"offset":962},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":874},"end":{"line":24,"column":89,"offset":962},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":26,"column":1,"offset":964},"end":{"line":26,"column":5,"offset":968},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":26,"column":7,"offset":970},"end":{"line":26,"column":25,"offset":988},"indent":[]}}],"position":{"start":{"line":26,"column":5,"offset":968},"end":{"line":26,"column":27,"offset":990},"indent":[]}},{"type":"text","value":" allows you to create expressions using drop-down lists and emphasizes an intuitive visual approach to creating Firewall Rules:","position":{"start":{"line":26,"column":27,"offset":990},"end":{"line":26,"column":154,"offset":1117},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":964},"end":{"line":26,"column":154,"offset":1117},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-0.png","alt":"Expression Builder","position":{"start":{"line":28,"column":1,"offset":1119},"end":{"line":28,"column":73,"offset":1191},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1119},"end":{"line":28,"column":73,"offset":1191},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":30,"column":1,"offset":1193},"end":{"line":30,"column":5,"offset":1197},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":30,"column":7,"offset":1199},"end":{"line":30,"column":24,"offset":1216},"indent":[]}}],"position":{"start":{"line":30,"column":5,"offset":1197},"end":{"line":30,"column":26,"offset":1218},"indent":[]}},{"type":"text","value":" is a text-only interface that supports advanced features, such as grouping symbols and functions for transforming and validating values:","position":{"start":{"line":30,"column":26,"offset":1218},"end":{"line":30,"column":163,"offset":1355},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1193},"end":{"line":30,"column":163,"offset":1355},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-editor-0.png","alt":"Expression Editor","position":{"start":{"line":32,"column":1,"offset":1357},"end":{"line":32,"column":71,"offset":1427},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1357},"end":{"line":32,"column":71,"offset":1427},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Both interfaces are available in the ","position":{"start":{"line":34,"column":1,"offset":1429},"end":{"line":34,"column":38,"offset":1466},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":34,"column":40,"offset":1468},"end":{"line":34,"column":60,"offset":1488},"indent":[]}}],"position":{"start":{"line":34,"column":38,"offset":1466},"end":{"line":34,"column":62,"offset":1490},"indent":[]}},{"type":"text","value":" page. This article focuses on using the Expression Builder. For more on using the advanced Expression Editor, refer to ","position":{"start":{"line":34,"column":62,"offset":1490},"end":{"line":34,"column":182,"offset":1610},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/expression-preview-editor/","children":[{"type":"text","value":"Edit rule expressions","position":{"start":{"line":34,"column":183,"offset":1611},"end":{"line":34,"column":204,"offset":1632},"indent":[]}}],"position":{"start":{"line":34,"column":182,"offset":1610},"end":{"line":34,"column":247,"offset":1675},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":34,"column":247,"offset":1675},"end":{"line":34,"column":248,"offset":1676},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1429},"end":{"line":34,"column":248,"offset":1676},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create a Firewall Rule","position":{"start":{"line":36,"column":4,"offset":1681},"end":{"line":36,"column":26,"offset":1703},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1678},"end":{"line":36,"column":26,"offset":1703},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":38,"column":1,"offset":1705},"end":{"line":38,"column":34,"offset":1738},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Create a Firewall Rule based on the filters and exclusions you select within Firewall Analytics by clicking ","position":{"start":{"line":40,"column":1,"offset":1740},"end":{"line":40,"column":109,"offset":1848},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create firewall rule","position":{"start":{"line":40,"column":111,"offset":1850},"end":{"line":40,"column":131,"offset":1870},"indent":[]}}],"position":{"start":{"line":40,"column":109,"offset":1848},"end":{"line":40,"column":133,"offset":1872},"indent":[]}},{"type":"text","value":" in ","position":{"start":{"line":40,"column":133,"offset":1872},"end":{"line":40,"column":137,"offset":1876},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":40,"column":139,"offset":1878},"end":{"line":40,"column":147,"offset":1886},"indent":[]}}],"position":{"start":{"line":40,"column":137,"offset":1876},"end":{"line":40,"column":149,"offset":1888},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":40,"column":149,"offset":1888},"end":{"line":40,"column":152,"offset":1891},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Overview","position":{"start":{"line":40,"column":154,"offset":1893},"end":{"line":40,"column":162,"offset":1901},"indent":[]}}],"position":{"start":{"line":40,"column":152,"offset":1891},"end":{"line":40,"column":164,"offset":1903},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":40,"column":164,"offset":1903},"end":{"line":40,"column":165,"offset":1904},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":1740},"end":{"line":40,"column":165,"offset":1904},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":42,"column":1,"offset":1906},"end":{"line":42,"column":9,"offset":1914},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To create a new Firewall Rule:","position":{"start":{"line":44,"column":1,"offset":1916},"end":{"line":44,"column":31,"offset":1946},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":1916},"end":{"line":44,"column":31,"offset":1946},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Log in to the ","position":{"start":{"line":46,"column":4,"offset":1951},"end":{"line":46,"column":18,"offset":1965},"indent":[]}},{"type":"link","title":null,"url":"https://dash.cloudflare.com/","children":[{"type":"text","value":"Cloudflare dashboard","position":{"start":{"line":46,"column":19,"offset":1966},"end":{"line":46,"column":39,"offset":1986},"indent":[]}}],"position":{"start":{"line":46,"column":18,"offset":1965},"end":{"line":46,"column":70,"offset":2017},"indent":[]}},{"type":"text","value":", and select your account and website.","position":{"start":{"line":46,"column":70,"offset":2017},"end":{"line":46,"column":108,"offset":2055},"indent":[]}}],"position":{"start":{"line":46,"column":4,"offset":1951},"end":{"line":46,"column":108,"offset":2055},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":1948},"end":{"line":46,"column":108,"offset":2055},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Navigate to ","position":{"start":{"line":47,"column":4,"offset":2059},"end":{"line":47,"column":16,"offset":2071},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":47,"column":18,"offset":2073},"end":{"line":47,"column":26,"offset":2081},"indent":[]}}],"position":{"start":{"line":47,"column":16,"offset":2071},"end":{"line":47,"column":28,"offset":2083},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":47,"column":28,"offset":2083},"end":{"line":47,"column":31,"offset":2086},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":47,"column":33,"offset":2088},"end":{"line":47,"column":47,"offset":2102},"indent":[]}}],"position":{"start":{"line":47,"column":31,"offset":2086},"end":{"line":47,"column":49,"offset":2104},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":47,"column":49,"offset":2104},"end":{"line":47,"column":50,"offset":2105},"indent":[]}}],"position":{"start":{"line":47,"column":4,"offset":2059},"end":{"line":47,"column":50,"offset":2105},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":2056},"end":{"line":47,"column":50,"offset":2105},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":48,"column":4,"offset":2109},"end":{"line":48,"column":10,"offset":2115},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create a Firewall Rule","position":{"start":{"line":48,"column":12,"offset":2117},"end":{"line":48,"column":34,"offset":2139},"indent":[]}}],"position":{"start":{"line":48,"column":10,"offset":2115},"end":{"line":48,"column":36,"offset":2141},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":48,"column":36,"offset":2141},"end":{"line":48,"column":37,"offset":2142},"indent":[]}}],"position":{"start":{"line":48,"column":4,"offset":2109},"end":{"line":48,"column":37,"offset":2142},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2106},"end":{"line":48,"column":37,"offset":2142},"indent":[]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":49,"column":4,"offset":2146},"end":{"line":49,"column":11,"offset":2153},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":49,"column":13,"offset":2155},"end":{"line":49,"column":33,"offset":2175},"indent":[]}}],"position":{"start":{"line":49,"column":11,"offset":2153},"end":{"line":49,"column":35,"offset":2177},"indent":[]}},{"type":"text","value":" page that displays, use the ","position":{"start":{"line":49,"column":35,"offset":2177},"end":{"line":49,"column":64,"offset":2206},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rule name","position":{"start":{"line":49,"column":66,"offset":2208},"end":{"line":49,"column":75,"offset":2217},"indent":[]}}],"position":{"start":{"line":49,"column":64,"offset":2206},"end":{"line":49,"column":77,"offset":2219},"indent":[]}},{"type":"text","value":" input to supply a descriptive name. The rule name in this example is \"Does not originate in UK.\"","position":{"start":{"line":49,"column":77,"offset":2219},"end":{"line":49,"column":174,"offset":2316},"indent":[]}}],"position":{"start":{"line":49,"column":4,"offset":2146},"end":{"line":49,"column":174,"offset":2316},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/create-firewall-rule-1.png","alt":"Create Firewall Rule","position":{"start":{"line":51,"column":4,"offset":2321},"end":{"line":51,"column":65,"offset":2382},"indent":[]}}],"position":{"start":{"line":51,"column":4,"offset":2321},"end":{"line":51,"column":65,"offset":2382},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":2143},"end":{"line":52,"column":1,"offset":2383},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Under ","position":{"start":{"line":53,"column":4,"offset":2387},"end":{"line":53,"column":10,"offset":2393},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"When incoming requests match…","position":{"start":{"line":53,"column":12,"offset":2395},"end":{"line":53,"column":41,"offset":2424},"indent":[]}}],"position":{"start":{"line":53,"column":10,"offset":2393},"end":{"line":53,"column":43,"offset":2426},"indent":[]}},{"type":"text","value":", use the ","position":{"start":{"line":53,"column":43,"offset":2426},"end":{"line":53,"column":53,"offset":2436},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Field","position":{"start":{"line":53,"column":55,"offset":2438},"end":{"line":53,"column":60,"offset":2443},"indent":[]}}],"position":{"start":{"line":53,"column":53,"offset":2436},"end":{"line":53,"column":62,"offset":2445},"indent":[]}},{"type":"text","value":" drop-down list to choose an HTTP property. For each request, the value of the property you choose for ","position":{"start":{"line":53,"column":62,"offset":2445},"end":{"line":53,"column":165,"offset":2548},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Field","position":{"start":{"line":53,"column":167,"offset":2550},"end":{"line":53,"column":172,"offset":2555},"indent":[]}}],"position":{"start":{"line":53,"column":165,"offset":2548},"end":{"line":53,"column":174,"offset":2557},"indent":[]}},{"type":"text","value":" is compared to the value you specify for ","position":{"start":{"line":53,"column":174,"offset":2557},"end":{"line":53,"column":216,"offset":2599},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Value","position":{"start":{"line":53,"column":218,"offset":2601},"end":{"line":53,"column":223,"offset":2606},"indent":[]}}],"position":{"start":{"line":53,"column":216,"offset":2599},"end":{"line":53,"column":225,"offset":2608},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":53,"column":225,"offset":2608},"end":{"line":53,"column":226,"offset":2609},"indent":[]}}],"position":{"start":{"line":53,"column":4,"offset":2387},"end":{"line":53,"column":226,"offset":2609},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-3.png","alt":"Select field","position":{"start":{"line":55,"column":4,"offset":2614},"end":{"line":55,"column":70,"offset":2680},"indent":[]}}],"position":{"start":{"line":55,"column":4,"offset":2614},"end":{"line":55,"column":70,"offset":2680},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":2384},"end":{"line":56,"column":1,"offset":2681},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":57,"column":4,"offset":2685},"end":{"line":57,"column":12,"offset":2693},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Operator","position":{"start":{"line":57,"column":14,"offset":2695},"end":{"line":57,"column":22,"offset":2703},"indent":[]}}],"position":{"start":{"line":57,"column":12,"offset":2693},"end":{"line":57,"column":24,"offset":2705},"indent":[]}},{"type":"text","value":" drop-down list to choose a comparison operator. For an expression to match, the value of the request ","position":{"start":{"line":57,"column":24,"offset":2705},"end":{"line":57,"column":126,"offset":2807},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Field","position":{"start":{"line":57,"column":128,"offset":2809},"end":{"line":57,"column":133,"offset":2814},"indent":[]}}],"position":{"start":{"line":57,"column":126,"offset":2807},"end":{"line":57,"column":135,"offset":2816},"indent":[]}},{"type":"text","value":" and the value specified in the ","position":{"start":{"line":57,"column":135,"offset":2816},"end":{"line":57,"column":167,"offset":2848},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Value","position":{"start":{"line":57,"column":169,"offset":2850},"end":{"line":57,"column":174,"offset":2855},"indent":[]}}],"position":{"start":{"line":57,"column":167,"offset":2848},"end":{"line":57,"column":176,"offset":2857},"indent":[]}},{"type":"text","value":" input must satisfy the comparison operator.","position":{"start":{"line":57,"column":176,"offset":2857},"end":{"line":57,"column":220,"offset":2901},"indent":[]}}],"position":{"start":{"line":57,"column":4,"offset":2685},"end":{"line":57,"column":220,"offset":2901},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-4.png","alt":"Select operator","position":{"start":{"line":59,"column":4,"offset":2906},"end":{"line":59,"column":73,"offset":2975},"indent":[]}}],"position":{"start":{"line":59,"column":4,"offset":2906},"end":{"line":59,"column":73,"offset":2975},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In the screenshot above, note that the ","position":{"start":{"line":61,"column":4,"offset":2980},"end":{"line":61,"column":43,"offset":3019},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":61,"column":45,"offset":3021},"end":{"line":61,"column":62,"offset":3038},"indent":[]}}],"position":{"start":{"line":61,"column":43,"offset":3019},"end":{"line":61,"column":64,"offset":3040},"indent":[]}},{"type":"text","value":" area displays a text-only version of your expression. For more on Expression Editor and the Expression Editor, refer to ","position":{"start":{"line":61,"column":64,"offset":3040},"end":{"line":61,"column":185,"offset":3161},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/expression-preview-editor/","children":[{"type":"text","value":"Edit rule expressions","position":{"start":{"line":61,"column":186,"offset":3162},"end":{"line":61,"column":207,"offset":3183},"indent":[]}}],"position":{"start":{"line":61,"column":185,"offset":3161},"end":{"line":61,"column":250,"offset":3226},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":61,"column":250,"offset":3226},"end":{"line":61,"column":251,"offset":3227},"indent":[]}}],"position":{"start":{"line":61,"column":4,"offset":2980},"end":{"line":61,"column":251,"offset":3227},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":2682},"end":{"line":62,"column":1,"offset":3228},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Now specify the value to match. If the value is an enumeration, then the ","position":{"start":{"line":63,"column":4,"offset":3232},"end":{"line":63,"column":77,"offset":3305},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Value","position":{"start":{"line":63,"column":79,"offset":3307},"end":{"line":63,"column":84,"offset":3312},"indent":[]}}],"position":{"start":{"line":63,"column":77,"offset":3305},"end":{"line":63,"column":86,"offset":3314},"indent":[]}},{"type":"text","value":" control will be a drop-down list. Otherwise, it will be a text input. In this example the value ","position":{"start":{"line":63,"column":86,"offset":3314},"end":{"line":63,"column":183,"offset":3411},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"United Kingdom","position":{"start":{"line":63,"column":184,"offset":3412},"end":{"line":63,"column":198,"offset":3426},"indent":[]}}],"position":{"start":{"line":63,"column":183,"offset":3411},"end":{"line":63,"column":199,"offset":3427},"indent":[]}},{"type":"text","value":" is set using the ","position":{"start":{"line":63,"column":199,"offset":3427},"end":{"line":63,"column":217,"offset":3445},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Country","position":{"start":{"line":63,"column":219,"offset":3447},"end":{"line":63,"column":226,"offset":3454},"indent":[]}}],"position":{"start":{"line":63,"column":217,"offset":3445},"end":{"line":63,"column":228,"offset":3456},"indent":[]}},{"type":"text","value":" drop-down list.","position":{"start":{"line":63,"column":228,"offset":3456},"end":{"line":63,"column":244,"offset":3472},"indent":[]}}],"position":{"start":{"line":63,"column":4,"offset":3232},"end":{"line":63,"column":244,"offset":3472},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-value.png","alt":"Select value","position":{"start":{"line":65,"column":4,"offset":3477},"end":{"line":65,"column":74,"offset":3547},"indent":[]}}],"position":{"start":{"line":65,"column":4,"offset":3477},"end":{"line":65,"column":74,"offset":3547},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":3229},"end":{"line":66,"column":1,"offset":3548},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To set an action for your rule, use the ","position":{"start":{"line":67,"column":4,"offset":3552},"end":{"line":67,"column":44,"offset":3592},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Action","position":{"start":{"line":67,"column":46,"offset":3594},"end":{"line":67,"column":52,"offset":3600},"indent":[]}}],"position":{"start":{"line":67,"column":44,"offset":3592},"end":{"line":67,"column":54,"offset":3602},"indent":[]}},{"type":"text","value":" drop-down list. In this example the ","position":{"start":{"line":67,"column":54,"offset":3602},"end":{"line":67,"column":91,"offset":3639},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":67,"column":92,"offset":3640},"end":{"line":67,"column":97,"offset":3645},"indent":[]}}],"position":{"start":{"line":67,"column":91,"offset":3639},"end":{"line":67,"column":98,"offset":3646},"indent":[]}},{"type":"text","value":" action tells Cloudflare to refuse requests that originate from countries other than the United Kingdom.","position":{"start":{"line":67,"column":98,"offset":3646},"end":{"line":67,"column":202,"offset":3750},"indent":[]}}],"position":{"start":{"line":67,"column":4,"offset":3552},"end":{"line":67,"column":202,"offset":3750},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-5.png","alt":"Select action","position":{"start":{"line":69,"column":4,"offset":3755},"end":{"line":69,"column":71,"offset":3822},"indent":[]}}],"position":{"start":{"line":69,"column":4,"offset":3755},"end":{"line":69,"column":71,"offset":3822},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":3549},"end":{"line":70,"column":1,"offset":3823},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To save and deploy your rule, click ","position":{"start":{"line":71,"column":4,"offset":3827},"end":{"line":71,"column":40,"offset":3863},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Deploy","position":{"start":{"line":71,"column":42,"offset":3865},"end":{"line":71,"column":48,"offset":3871},"indent":[]}}],"position":{"start":{"line":71,"column":40,"offset":3863},"end":{"line":71,"column":50,"offset":3873},"indent":[]}},{"type":"text","value":". If you are not ready to deploy your rule, click ","position":{"start":{"line":71,"column":50,"offset":3873},"end":{"line":71,"column":100,"offset":3923},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Save as draft","position":{"start":{"line":71,"column":102,"offset":3925},"end":{"line":71,"column":115,"offset":3938},"indent":[]}}],"position":{"start":{"line":71,"column":100,"offset":3923},"end":{"line":71,"column":117,"offset":3940},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":71,"column":117,"offset":3940},"end":{"line":71,"column":118,"offset":3941},"indent":[]}}],"position":{"start":{"line":71,"column":4,"offset":3827},"end":{"line":71,"column":118,"offset":3941},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":3824},"end":{"line":71,"column":118,"offset":3941},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":1948},"end":{"line":71,"column":118,"offset":3941},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"After you choose an option, you are returned to the ","position":{"start":{"line":73,"column":1,"offset":3943},"end":{"line":73,"column":53,"offset":3995},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":73,"column":55,"offset":3997},"end":{"line":73,"column":65,"offset":4007},"indent":[]}}],"position":{"start":{"line":73,"column":53,"offset":3995},"end":{"line":73,"column":67,"offset":4009},"indent":[]}},{"type":"text","value":", which displays your new rule:","position":{"start":{"line":73,"column":67,"offset":4009},"end":{"line":73,"column":98,"offset":4040},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":3943},"end":{"line":73,"column":98,"offset":4040},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-11.png","alt":"Rules List","position":{"start":{"line":75,"column":1,"offset":4042},"end":{"line":75,"column":66,"offset":4107},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":4042},"end":{"line":75,"column":66,"offset":4107},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you choose to deploy your new rule, the toggle switch associated with the rule will be ","position":{"start":{"line":77,"column":1,"offset":4109},"end":{"line":77,"column":91,"offset":4199},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"On","position":{"start":{"line":77,"column":92,"offset":4200},"end":{"line":77,"column":94,"offset":4202},"indent":[]}}],"position":{"start":{"line":77,"column":91,"offset":4199},"end":{"line":77,"column":95,"offset":4203},"indent":[]}},{"type":"text","value":". If you save the rule as a draft, the toggle will be ","position":{"start":{"line":77,"column":95,"offset":4203},"end":{"line":77,"column":149,"offset":4257},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Off","position":{"start":{"line":77,"column":150,"offset":4258},"end":{"line":77,"column":153,"offset":4261},"indent":[]}}],"position":{"start":{"line":77,"column":149,"offset":4257},"end":{"line":77,"column":154,"offset":4262},"indent":[]}},{"type":"text","value":". Use the toggle to enable or disable your Firewall Rule.","position":{"start":{"line":77,"column":154,"offset":4262},"end":{"line":77,"column":211,"offset":4319},"indent":[]}}],"position":{"start":{"line":77,"column":1,"offset":4109},"end":{"line":77,"column":211,"offset":4319},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Manage rules","position":{"start":{"line":79,"column":4,"offset":4324},"end":{"line":79,"column":16,"offset":4336},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":4321},"end":{"line":79,"column":16,"offset":4336},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Edit rules","position":{"start":{"line":81,"column":5,"offset":4342},"end":{"line":81,"column":15,"offset":4352},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":4338},"end":{"line":81,"column":15,"offset":4352},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can modify your existing Firewall Rules at any time. Click the ","position":{"start":{"line":83,"column":1,"offset":4354},"end":{"line":83,"column":68,"offset":4421},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":83,"column":70,"offset":4423},"end":{"line":83,"column":74,"offset":4427},"indent":[]}}],"position":{"start":{"line":83,"column":68,"offset":4421},"end":{"line":83,"column":76,"offset":4429},"indent":[]}},{"type":"text","value":" button (wrench icon) located on the right of your rules in the ","position":{"start":{"line":83,"column":76,"offset":4429},"end":{"line":83,"column":140,"offset":4493},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":83,"column":142,"offset":4495},"end":{"line":83,"column":152,"offset":4505},"indent":[]}}],"position":{"start":{"line":83,"column":140,"offset":4493},"end":{"line":83,"column":154,"offset":4507},"indent":[]}},{"type":"text","value":" to open the ","position":{"start":{"line":83,"column":154,"offset":4507},"end":{"line":83,"column":167,"offset":4520},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit Firewall Rule","position":{"start":{"line":83,"column":169,"offset":4522},"end":{"line":83,"column":187,"offset":4540},"indent":[]}}],"position":{"start":{"line":83,"column":167,"offset":4520},"end":{"line":83,"column":189,"offset":4542},"indent":[]}},{"type":"text","value":" panel and make the changes you want.","position":{"start":{"line":83,"column":189,"offset":4542},"end":{"line":83,"column":226,"offset":4579},"indent":[]}}],"position":{"start":{"line":83,"column":1,"offset":4354},"end":{"line":83,"column":226,"offset":4579},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-7.png","alt":"Edit rule","position":{"start":{"line":85,"column":1,"offset":4581},"end":{"line":85,"column":64,"offset":4644},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":4581},"end":{"line":85,"column":64,"offset":4644},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Delete rules","position":{"start":{"line":87,"column":5,"offset":4650},"end":{"line":87,"column":17,"offset":4662},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":4646},"end":{"line":87,"column":17,"offset":4662},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To delete an existing rule from the ","position":{"start":{"line":89,"column":1,"offset":4664},"end":{"line":89,"column":37,"offset":4700},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":89,"column":39,"offset":4702},"end":{"line":89,"column":53,"offset":4716},"indent":[]}}],"position":{"start":{"line":89,"column":37,"offset":4700},"end":{"line":89,"column":55,"offset":4718},"indent":[]}},{"type":"text","value":" panel, use the ","position":{"start":{"line":89,"column":55,"offset":4718},"end":{"line":89,"column":71,"offset":4734},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Delete","position":{"start":{"line":89,"column":73,"offset":4736},"end":{"line":89,"column":79,"offset":4742},"indent":[]}}],"position":{"start":{"line":89,"column":71,"offset":4734},"end":{"line":89,"column":81,"offset":4744},"indent":[]}},{"type":"text","value":" button (","position":{"start":{"line":89,"column":81,"offset":4744},"end":{"line":89,"column":90,"offset":4753},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"X","position":{"start":{"line":89,"column":92,"offset":4755},"end":{"line":89,"column":93,"offset":4756},"indent":[]}}],"position":{"start":{"line":89,"column":90,"offset":4753},"end":{"line":89,"column":95,"offset":4758},"indent":[]}},{"type":"text","value":" icon) associated with the rule you want to remove.","position":{"start":{"line":89,"column":95,"offset":4758},"end":{"line":89,"column":146,"offset":4809},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":4664},"end":{"line":89,"column":146,"offset":4809},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-8.png","alt":"Delete rule","position":{"start":{"line":91,"column":1,"offset":4811},"end":{"line":91,"column":66,"offset":4876},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":4811},"end":{"line":91,"column":66,"offset":4876},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In the confirmation dialog that appears, click ","position":{"start":{"line":93,"column":1,"offset":4878},"end":{"line":93,"column":48,"offset":4925},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Delete","position":{"start":{"line":93,"column":50,"offset":4927},"end":{"line":93,"column":56,"offset":4933},"indent":[]}}],"position":{"start":{"line":93,"column":48,"offset":4925},"end":{"line":93,"column":58,"offset":4935},"indent":[]}},{"type":"text","value":" to confirm and complete the operation.","position":{"start":{"line":93,"column":58,"offset":4935},"end":{"line":93,"column":97,"offset":4974},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":4878},"end":{"line":93,"column":97,"offset":4974},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Order rules","position":{"start":{"line":95,"column":5,"offset":4980},"end":{"line":95,"column":16,"offset":4991},"indent":[]}}],"position":{"start":{"line":95,"column":1,"offset":4976},"end":{"line":95,"column":16,"offset":4991},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"By default, Cloudflare evaluates Firewall Rules in ","position":{"start":{"line":97,"column":1,"offset":4993},"end":{"line":97,"column":52,"offset":5044},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"list order","position":{"start":{"line":97,"column":54,"offset":5046},"end":{"line":97,"column":64,"offset":5056},"indent":[]}}],"position":{"start":{"line":97,"column":52,"offset":5044},"end":{"line":97,"column":66,"offset":5058},"indent":[]}},{"type":"text","value":", where rules are evaluated in the order they appear in the ","position":{"start":{"line":97,"column":66,"offset":5058},"end":{"line":97,"column":126,"offset":5118},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":97,"column":128,"offset":5120},"end":{"line":97,"column":138,"offset":5130},"indent":[]}}],"position":{"start":{"line":97,"column":126,"offset":5118},"end":{"line":97,"column":140,"offset":5132},"indent":[]}},{"type":"text","value":". When list ordering is enabled, the Rules List allows you to drag and drop Firewall Rules into position, as shown below.","position":{"start":{"line":97,"column":140,"offset":5132},"end":{"line":97,"column":261,"offset":5253},"indent":[]}}],"position":{"start":{"line":97,"column":1,"offset":4993},"end":{"line":97,"column":261,"offset":5253},"indent":[]}},{"type":"html","value":"<img src={firewallRulesExpressionBuilder10} alt=\"Order Firewall Rules\" />","position":{"start":{"line":99,"column":1,"offset":5255},"end":{"line":99,"column":74,"offset":5328},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Once there are more than 200 total rules (including inactive rules), you must manage evaluation using ","position":{"start":{"line":101,"column":1,"offset":5330},"end":{"line":101,"column":103,"offset":5432},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"priority ordering","position":{"start":{"line":101,"column":105,"offset":5434},"end":{"line":101,"column":122,"offset":5451},"indent":[]}}],"position":{"start":{"line":101,"column":103,"offset":5432},"end":{"line":101,"column":124,"offset":5453},"indent":[]}},{"type":"text","value":", in which Cloudflare evaluates Firewall Rules in order of their ","position":{"start":{"line":101,"column":124,"offset":5453},"end":{"line":101,"column":189,"offset":5518},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"priority number","position":{"start":{"line":101,"column":191,"offset":5520},"end":{"line":101,"column":206,"offset":5535},"indent":[]}}],"position":{"start":{"line":101,"column":189,"offset":5518},"end":{"line":101,"column":208,"offset":5537},"indent":[]}},{"type":"text","value":", starting with the lowest. When you cross this threshold, the Firewall Rules interface automatically switches to priority ordering. For more on working with priority ordering, refer to ","position":{"start":{"line":101,"column":208,"offset":5537},"end":{"line":101,"column":394,"offset":5723},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/order-priority","children":[{"type":"text","value":"Order and Priority","position":{"start":{"line":101,"column":395,"offset":5724},"end":{"line":101,"column":413,"offset":5742},"indent":[]}}],"position":{"start":{"line":101,"column":394,"offset":5723},"end":{"line":101,"column":449,"offset":5778},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":101,"column":449,"offset":5778},"end":{"line":101,"column":450,"offset":5779},"indent":[]}}],"position":{"start":{"line":101,"column":1,"offset":5330},"end":{"line":101,"column":450,"offset":5779},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Enable and disable rules","position":{"start":{"line":103,"column":5,"offset":5785},"end":{"line":103,"column":29,"offset":5809},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":5781},"end":{"line":103,"column":29,"offset":5809},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the toggle switch associated with a Firewall Rule to enable or disable it.","position":{"start":{"line":105,"column":1,"offset":5811},"end":{"line":105,"column":79,"offset":5889},"indent":[]}}],"position":{"start":{"line":105,"column":1,"offset":5811},"end":{"line":105,"column":79,"offset":5889},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expression-builder-9.png","alt":"Enable/disable rules","position":{"start":{"line":107,"column":1,"offset":5891},"end":{"line":107,"column":75,"offset":5965},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":5891},"end":{"line":107,"column":75,"offset":5965},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Test Firewall Rules with Rule Preview","position":{"start":{"line":109,"column":4,"offset":5970},"end":{"line":109,"column":41,"offset":6007},"indent":[]}}],"position":{"start":{"line":109,"column":1,"offset":5967},"end":{"line":109,"column":41,"offset":6007},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To help customers on an Enterprise plan understand the potential impact of a new Firewall Rule, Cloudflare built ","position":{"start":{"line":111,"column":1,"offset":6009},"end":{"line":111,"column":114,"offset":6122},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rule Preview","position":{"start":{"line":111,"column":116,"offset":6124},"end":{"line":111,"column":128,"offset":6136},"indent":[]}}],"position":{"start":{"line":111,"column":114,"offset":6122},"end":{"line":111,"column":130,"offset":6138},"indent":[]}},{"type":"text","value":". With the click of a button, Rule Preview allows you to test a Firewall Rule against a sample of requests drawn from the last 72 hours of traffic. Rule Preview is built into the ","position":{"start":{"line":111,"column":130,"offset":6138},"end":{"line":111,"column":309,"offset":6317},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":111,"column":311,"offset":6319},"end":{"line":111,"column":331,"offset":6339},"indent":[]}}],"position":{"start":{"line":111,"column":309,"offset":6317},"end":{"line":111,"column":333,"offset":6341},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":111,"column":333,"offset":6341},"end":{"line":111,"column":338,"offset":6346},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit Firewall Rule","position":{"start":{"line":111,"column":340,"offset":6348},"end":{"line":111,"column":358,"offset":6366},"indent":[]}}],"position":{"start":{"line":111,"column":338,"offset":6346},"end":{"line":111,"column":360,"offset":6368},"indent":[]}},{"type":"text","value":" panels so that you can test a rule as you edit it. For more information, refer to ","position":{"start":{"line":111,"column":360,"offset":6368},"end":{"line":111,"column":443,"offset":6451},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rule-preview/","children":[{"type":"text","value":"Preview rules","position":{"start":{"line":111,"column":444,"offset":6452},"end":{"line":111,"column":457,"offset":6465},"indent":[]}}],"position":{"start":{"line":111,"column":443,"offset":6451},"end":{"line":111,"column":487,"offset":6495},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":111,"column":487,"offset":6495},"end":{"line":111,"column":488,"offset":6496},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":6009},"end":{"line":111,"column":488,"offset":6496},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":114,"column":111,"offset":6609}}}}},{"node":{"fields":{"slug":"/cf-dashboard/create-mtls-rule"},"frontmatter":{"order":380,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Create a mTLS rule"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Create a mTLS rule","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":21,"offset":21},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":9,"offset":31},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/api-shield/products/mtls/configure","children":[{"type":"text","value":"Mutual TLS","position":{"start":{"line":4,"column":10,"offset":32},"end":{"line":4,"column":20,"offset":42},"indent":[]}}],"position":{"start":{"line":4,"column":9,"offset":31},"end":{"line":4,"column":91,"offset":113},"indent":[]}},{"type":"text","value":" Rule interface in the Cloudflare dashboard to create an mTLS rule that requires requests to your API or web application to present a valid client certificate.","position":{"start":{"line":4,"column":91,"offset":113},"end":{"line":4,"column":250,"offset":272},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":250,"offset":272},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":7,"column":70,"offset":344}}}}},{"node":{"fields":{"slug":"/cf-dashboard/expression-preview-editor"},"frontmatter":{"order":320,"title":"Edit rule expressions","summary":null,"demo":null,"tags":null},"headings":[{"value":"Edit Firewall Rule expressions"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Edit Firewall Rule expressions","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":33,"offset":33},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":33,"offset":33},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":4,"column":4,"offset":38},"end":{"line":4,"column":12,"offset":46},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":12,"offset":46},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":6,"column":1,"offset":48},"end":{"line":6,"column":5,"offset":52},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":6,"column":7,"offset":54},"end":{"line":6,"column":24,"offset":71},"indent":[]}}],"position":{"start":{"line":6,"column":5,"offset":52},"end":{"line":6,"column":26,"offset":73},"indent":[]}},{"type":"text","value":" is a text-only interface for creating Firewall Rule expressions. Although it lacks the visual simplicity of the Expression Builder, the Expression Editor supports the entire specification of Cloudflare's ","position":{"start":{"line":6,"column":26,"offset":73},"end":{"line":6,"column":231,"offset":278},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language","children":[{"type":"text","value":"Rules language","position":{"start":{"line":6,"column":232,"offset":279},"end":{"line":6,"column":246,"offset":293},"indent":[]}}],"position":{"start":{"line":6,"column":231,"offset":278},"end":{"line":6,"column":312,"offset":359},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":312,"offset":359},"end":{"line":6,"column":313,"offset":360},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":48},"end":{"line":6,"column":313,"offset":360},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, only the Expression Editor supports grouping symbols. Cloudflare designed the Rules language with ","position":{"start":{"line":8,"column":1,"offset":362},"end":{"line":8,"column":112,"offset":473},"indent":[]}},{"type":"link","title":null,"url":"https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html","children":[{"type":"text","value":"Wireshark Display Filters®","position":{"start":{"line":8,"column":113,"offset":474},"end":{"line":8,"column":139,"offset":500},"indent":[]}}],"position":{"start":{"line":8,"column":112,"offset":473},"end":{"line":8,"column":227,"offset":588},"indent":[]}},{"type":"text","value":" in mind, so although there are some subtle differences, Wireshark users should feel right at home with Cloudflare rules and be able to easily port their existing rules to Cloudflare.","position":{"start":{"line":8,"column":227,"offset":588},"end":{"line":8,"column":410,"offset":771},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":362},"end":{"line":8,"column":410,"offset":771},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":10,"column":1,"offset":773},"end":{"line":10,"column":42,"offset":814},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules expressions have a 4 KB limit. This is approximately 4,000 text characters. This limit applies whether you use the visual ","position":{"start":{"line":12,"column":1,"offset":816},"end":{"line":12,"column":138,"offset":953},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":12,"column":140,"offset":955},"end":{"line":12,"column":158,"offset":973},"indent":[]}}],"position":{"start":{"line":12,"column":138,"offset":953},"end":{"line":12,"column":160,"offset":975},"indent":[]}},{"type":"text","value":" or edit your expression manually in the ","position":{"start":{"line":12,"column":160,"offset":975},"end":{"line":12,"column":201,"offset":1016},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":12,"column":203,"offset":1018},"end":{"line":12,"column":220,"offset":1035},"indent":[]}}],"position":{"start":{"line":12,"column":201,"offset":1016},"end":{"line":12,"column":222,"offset":1037},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":12,"column":222,"offset":1037},"end":{"line":12,"column":223,"offset":1038},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":816},"end":{"line":12,"column":223,"offset":1038},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":14,"column":1,"offset":1040},"end":{"line":14,"column":9,"offset":1048},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Use the Expression Editor","position":{"start":{"line":16,"column":4,"offset":1053},"end":{"line":16,"column":29,"offset":1078},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1050},"end":{"line":16,"column":29,"offset":1078},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Expression Editor is located in the ","position":{"start":{"line":18,"column":1,"offset":1080},"end":{"line":18,"column":41,"offset":1120},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":18,"column":43,"offset":1122},"end":{"line":18,"column":63,"offset":1142},"indent":[]}}],"position":{"start":{"line":18,"column":41,"offset":1120},"end":{"line":18,"column":65,"offset":1144},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":18,"column":65,"offset":1144},"end":{"line":18,"column":70,"offset":1149},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit Firewall Rule","position":{"start":{"line":18,"column":72,"offset":1151},"end":{"line":18,"column":90,"offset":1169},"indent":[]}}],"position":{"start":{"line":18,"column":70,"offset":1149},"end":{"line":18,"column":92,"offset":1171},"indent":[]}},{"type":"text","value":" panels. The editor supports all available Rules language fields, operators, and transformation functions. It also supports parentheses as grouping symbols.","position":{"start":{"line":18,"column":92,"offset":1171},"end":{"line":18,"column":248,"offset":1327},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1080},"end":{"line":18,"column":248,"offset":1327},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To edit an expression in the editor:","position":{"start":{"line":20,"column":1,"offset":1329},"end":{"line":20,"column":37,"offset":1365},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1329},"end":{"line":20,"column":37,"offset":1365},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":22,"column":4,"offset":1370},"end":{"line":22,"column":11,"offset":1377},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":22,"column":13,"offset":1379},"end":{"line":22,"column":27,"offset":1393},"indent":[]}}],"position":{"start":{"line":22,"column":11,"offset":1377},"end":{"line":22,"column":29,"offset":1395},"indent":[]}},{"type":"text","value":" tab, use the ","position":{"start":{"line":22,"column":29,"offset":1395},"end":{"line":22,"column":43,"offset":1409},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create a Firewall rule","position":{"start":{"line":22,"column":45,"offset":1411},"end":{"line":22,"column":67,"offset":1433},"indent":[]}}],"position":{"start":{"line":22,"column":43,"offset":1409},"end":{"line":22,"column":69,"offset":1435},"indent":[]}},{"type":"text","value":" button to create a new rule, or click the ","position":{"start":{"line":22,"column":69,"offset":1435},"end":{"line":22,"column":112,"offset":1478},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"wrench","position":{"start":{"line":22,"column":114,"offset":1480},"end":{"line":22,"column":120,"offset":1486},"indent":[]}}],"position":{"start":{"line":22,"column":112,"offset":1478},"end":{"line":22,"column":122,"offset":1488},"indent":[]}},{"type":"text","value":" icon to edit an existing rule.","position":{"start":{"line":22,"column":122,"offset":1488},"end":{"line":22,"column":153,"offset":1519},"indent":[]}}],"position":{"start":{"line":22,"column":4,"offset":1370},"end":{"line":22,"column":153,"offset":1519},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-editor-1.png","alt":"Firewall Rules tab","position":{"start":{"line":24,"column":4,"offset":1524},"end":{"line":24,"column":76,"offset":1596},"indent":[]}}],"position":{"start":{"line":24,"column":4,"offset":1524},"end":{"line":24,"column":76,"offset":1596},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":26,"column":4,"offset":1601},"end":{"line":26,"column":8,"offset":1605},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":26,"column":10,"offset":1607},"end":{"line":26,"column":30,"offset":1627},"indent":[]}}],"position":{"start":{"line":26,"column":8,"offset":1605},"end":{"line":26,"column":32,"offset":1629},"indent":[]}},{"type":"text","value":" page displays.","position":{"start":{"line":26,"column":32,"offset":1629},"end":{"line":26,"column":47,"offset":1644},"indent":[]}}],"position":{"start":{"line":26,"column":4,"offset":1601},"end":{"line":26,"column":47,"offset":1644},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1367},"end":{"line":27,"column":1,"offset":1645},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To switch to the Expression Editor in the ","position":{"start":{"line":28,"column":4,"offset":1649},"end":{"line":28,"column":46,"offset":1691},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create Firewall Rule","position":{"start":{"line":28,"column":48,"offset":1693},"end":{"line":28,"column":68,"offset":1713},"indent":[]}}],"position":{"start":{"line":28,"column":46,"offset":1691},"end":{"line":28,"column":70,"offset":1715},"indent":[]}},{"type":"text","value":" page, click ","position":{"start":{"line":28,"column":70,"offset":1715},"end":{"line":28,"column":83,"offset":1728},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit expression","position":{"start":{"line":28,"column":85,"offset":1730},"end":{"line":28,"column":100,"offset":1745},"indent":[]}}],"position":{"start":{"line":28,"column":83,"offset":1728},"end":{"line":28,"column":102,"offset":1747},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":28,"column":102,"offset":1747},"end":{"line":28,"column":103,"offset":1748},"indent":[]}}],"position":{"start":{"line":28,"column":4,"offset":1649},"end":{"line":28,"column":103,"offset":1748},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-editor-2.png","alt":"Edit Expression link in Create Firewall Rule page","position":{"start":{"line":30,"column":4,"offset":1753},"end":{"line":30,"column":107,"offset":1856},"indent":[]}}],"position":{"start":{"line":30,"column":4,"offset":1753},"end":{"line":30,"column":107,"offset":1856},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1646},"end":{"line":31,"column":1,"offset":1857},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the text input to edit your expression. To commit your changes, click ","position":{"start":{"line":32,"column":4,"offset":1861},"end":{"line":32,"column":78,"offset":1935},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Deploy","position":{"start":{"line":32,"column":80,"offset":1937},"end":{"line":32,"column":86,"offset":1943},"indent":[]}}],"position":{"start":{"line":32,"column":78,"offset":1935},"end":{"line":32,"column":88,"offset":1945},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":32,"column":88,"offset":1945},"end":{"line":32,"column":92,"offset":1949},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Save as draft","position":{"start":{"line":32,"column":94,"offset":1951},"end":{"line":32,"column":107,"offset":1964},"indent":[]}}],"position":{"start":{"line":32,"column":92,"offset":1949},"end":{"line":32,"column":109,"offset":1966},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":32,"column":109,"offset":1966},"end":{"line":32,"column":110,"offset":1967},"indent":[]}}],"position":{"start":{"line":32,"column":4,"offset":1861},"end":{"line":32,"column":110,"offset":1967},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1858},"end":{"line":32,"column":110,"offset":1967},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1367},"end":{"line":32,"column":110,"offset":1967},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"To switch from the editor to the Expression Builder, click ","position":{"start":{"line":34,"column":1,"offset":1969},"end":{"line":34,"column":60,"offset":2028},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Use expression builder","position":{"start":{"line":34,"column":62,"offset":2030},"end":{"line":34,"column":84,"offset":2052},"indent":[]}}],"position":{"start":{"line":34,"column":60,"offset":2028},"end":{"line":34,"column":86,"offset":2054},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":34,"column":86,"offset":2054},"end":{"line":34,"column":87,"offset":2055},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1969},"end":{"line":34,"column":87,"offset":2055},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"   ","position":{"start":{"line":36,"column":1,"offset":2057},"end":{"line":36,"column":4,"offset":2060},"indent":[]}},{"type":"image","title":null,"url":"../images/firewall-rules-expressions-editor-3.png","alt":"Expression Editor","position":{"start":{"line":36,"column":4,"offset":2060},"end":{"line":36,"column":75,"offset":2131},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":2057},"end":{"line":36,"column":75,"offset":2131},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In general, you can switch back and forth between the Expression Builder and the Expression Editor. However, if you use parentheses to nest expressions in the editor, you will not be able to switch to the Expression Builder, because the builder does not support nested expressions.","position":{"start":{"line":38,"column":1,"offset":2133},"end":{"line":38,"column":282,"offset":2414},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":2133},"end":{"line":38,"column":282,"offset":2414},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create nested expressions","position":{"start":{"line":40,"column":4,"offset":2419},"end":{"line":40,"column":29,"offset":2444},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2416},"end":{"line":40,"column":29,"offset":2444},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A key advantage of the Expression Editor is support for parentheses as ","position":{"start":{"line":42,"column":1,"offset":2446},"end":{"line":42,"column":72,"offset":2517},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#grouping-symbols","children":[{"type":"text","value":"grouping symbols","position":{"start":{"line":42,"column":73,"offset":2518},"end":{"line":42,"column":89,"offset":2534},"indent":[]}}],"position":{"start":{"line":42,"column":72,"offset":2517},"end":{"line":42,"column":183,"offset":2628},"indent":[]}},{"type":"text","value":", which allow you to explicitly group and nest expressions and, in turn, create highly targeted expressions.","position":{"start":{"line":42,"column":183,"offset":2628},"end":{"line":42,"column":291,"offset":2736},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":2446},"end":{"line":42,"column":291,"offset":2736},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example a rule that challenges any visitor who is not from Malaysia and tries to access WordPress URI paths.","position":{"start":{"line":44,"column":1,"offset":2738},"end":{"line":44,"column":114,"offset":2851},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":2738},"end":{"line":44,"column":114,"offset":2851},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-editor-4.png","alt":"Expression editor example","position":{"start":{"line":46,"column":1,"offset":2853},"end":{"line":46,"column":80,"offset":2932},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2853},"end":{"line":46,"column":80,"offset":2932},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Only the Expression Editor supports nested expressions such as the one above. If you create a rule with nested expressions in the Expression Editor and try to switch to the Expression Builder, a dialog will warn you that the expression is not supported in the builder. You will be prompted to ","position":{"start":{"line":48,"column":1,"offset":2934},"end":{"line":48,"column":294,"offset":3227},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Discard changes","position":{"start":{"line":48,"column":296,"offset":3229},"end":{"line":48,"column":311,"offset":3244},"indent":[]}}],"position":{"start":{"line":48,"column":294,"offset":3227},"end":{"line":48,"column":313,"offset":3246},"indent":[]}},{"type":"text","value":" and switch to the Expression Builder or ","position":{"start":{"line":48,"column":313,"offset":3246},"end":{"line":48,"column":354,"offset":3287},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Cancel","position":{"start":{"line":48,"column":356,"offset":3289},"end":{"line":48,"column":362,"offset":3295},"indent":[]}}],"position":{"start":{"line":48,"column":354,"offset":3287},"end":{"line":48,"column":364,"offset":3297},"indent":[]}},{"type":"text","value":" and continue working in the editor.","position":{"start":{"line":48,"column":364,"offset":3297},"end":{"line":48,"column":400,"offset":3333},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2934},"end":{"line":48,"column":400,"offset":3333},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-editor-5.png","alt":"Warning dialog","position":{"start":{"line":50,"column":1,"offset":3335},"end":{"line":50,"column":69,"offset":3403},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":3335},"end":{"line":50,"column":69,"offset":3403},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare validates all expressions before saving them, so if your expression is malformed, you will receive an error message, as shown in this screenshot:","position":{"start":{"line":52,"column":1,"offset":3405},"end":{"line":52,"column":157,"offset":3561},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":3405},"end":{"line":52,"column":157,"offset":3561},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-editor-6.png","alt":"Error message","position":{"start":{"line":54,"column":1,"offset":3563},"end":{"line":54,"column":68,"offset":3630},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":3563},"end":{"line":54,"column":68,"offset":3630},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Expression Editor supports the entire Cloudflare Rules language. For a complete listing of supported fields and operators, as well as guidance on using grouping symbols, refer to ","position":{"start":{"line":56,"column":1,"offset":3632},"end":{"line":56,"column":184,"offset":3815},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language","children":[{"type":"text","value":"Rules language","position":{"start":{"line":56,"column":185,"offset":3816},"end":{"line":56,"column":199,"offset":3830},"indent":[]}}],"position":{"start":{"line":56,"column":184,"offset":3815},"end":{"line":56,"column":265,"offset":3896},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":56,"column":265,"offset":3896},"end":{"line":56,"column":266,"offset":3897},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":3632},"end":{"line":56,"column":266,"offset":3897},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":59,"column":102,"offset":4001}}}}},{"node":{"fields":{"slug":"/cf-dashboard"},"frontmatter":{"order":300,"title":"Manage rules in the dashboard","summary":null,"demo":null,"tags":null},"headings":[{"value":"Manage Firewall Rules in the Cloudflare dashboard"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Manage Firewall Rules in the Cloudflare dashboard","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":52,"offset":52},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":52,"offset":52},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Firewall Rules is a feature of the ","position":{"start":{"line":4,"column":1,"offset":54},"end":{"line":4,"column":36,"offset":89},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":4,"column":38,"offset":91},"end":{"line":4,"column":46,"offset":99},"indent":[]}}],"position":{"start":{"line":4,"column":36,"offset":89},"end":{"line":4,"column":48,"offset":101},"indent":[]}},{"type":"text","value":" app in the Cloudflare UI (dashboard).","position":{"start":{"line":4,"column":48,"offset":101},"end":{"line":4,"column":86,"offset":139},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":54},"end":{"line":4,"column":86,"offset":139},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"As depicted in the image below, the ","position":{"start":{"line":6,"column":1,"offset":141},"end":{"line":6,"column":37,"offset":177},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":6,"column":39,"offset":179},"end":{"line":6,"column":53,"offset":193},"indent":[]}}],"position":{"start":{"line":6,"column":37,"offset":177},"end":{"line":6,"column":55,"offset":195},"indent":[]}},{"type":"text","value":" dashboard interface lets you:","position":{"start":{"line":6,"column":55,"offset":195},"end":{"line":6,"column":85,"offset":225},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":141},"end":{"line":6,"column":85,"offset":225},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules/#create-a-firewall-rule","children":[{"type":"text","value":"Create","position":{"start":{"line":8,"column":4,"offset":230},"end":{"line":8,"column":10,"offset":236},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":229},"end":{"line":8,"column":75,"offset":301},"indent":[]}},{"type":"text","value":" new rules.","position":{"start":{"line":8,"column":75,"offset":301},"end":{"line":8,"column":86,"offset":312},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":229},"end":{"line":8,"column":86,"offset":312},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":227},"end":{"line":8,"column":86,"offset":312},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Search and filter the list of existing rules.","position":{"start":{"line":9,"column":3,"offset":315},"end":{"line":9,"column":48,"offset":360},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":315},"end":{"line":9,"column":48,"offset":360},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":313},"end":{"line":9,"column":48,"offset":360},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"See a list of existing rules (both active and paused).","position":{"start":{"line":10,"column":3,"offset":363},"end":{"line":10,"column":57,"offset":417},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":363},"end":{"line":10,"column":57,"offset":417},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":361},"end":{"line":10,"column":57,"offset":417},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Activate or pause rules (turn on or off).","position":{"start":{"line":11,"column":3,"offset":420},"end":{"line":11,"column":44,"offset":461},"indent":[]}}],"position":{"start":{"line":11,"column":3,"offset":420},"end":{"line":11,"column":44,"offset":461},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":418},"end":{"line":11,"column":44,"offset":461},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules/#edit-rules","children":[{"type":"text","value":"Edit","position":{"start":{"line":12,"column":4,"offset":465},"end":{"line":12,"column":8,"offset":469},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":464},"end":{"line":12,"column":61,"offset":522},"indent":[]}},{"type":"text","value":" rules.","position":{"start":{"line":12,"column":61,"offset":522},"end":{"line":12,"column":68,"offset":529},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":464},"end":{"line":12,"column":68,"offset":529},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":462},"end":{"line":12,"column":68,"offset":529},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules/#delete-rules","children":[{"type":"text","value":"Delete","position":{"start":{"line":13,"column":4,"offset":533},"end":{"line":13,"column":10,"offset":539},"indent":[]}}],"position":{"start":{"line":13,"column":3,"offset":532},"end":{"line":13,"column":65,"offset":594},"indent":[]}},{"type":"text","value":" rules.","position":{"start":{"line":13,"column":65,"offset":594},"end":{"line":13,"column":72,"offset":601},"indent":[]}}],"position":{"start":{"line":13,"column":3,"offset":532},"end":{"line":13,"column":72,"offset":601},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":530},"end":{"line":13,"column":72,"offset":601},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":227},"end":{"line":13,"column":72,"offset":601},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/cf-firewall-rules-panel-ann.png","alt":"Firewall Rules panel","position":{"start":{"line":15,"column":1,"offset":603},"end":{"line":15,"column":67,"offset":669},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":603},"end":{"line":15,"column":67,"offset":669},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":18,"column":114,"offset":785}}}}},{"node":{"fields":{"slug":"/cf-dashboard/rule-preview"},"frontmatter":{"order":330,"title":"Preview rules","summary":null,"demo":null,"tags":null},"headings":[{"value":"Preview Firewall Rules"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Preview Firewall Rules","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":25,"offset":25},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":25,"offset":25},"indent":[]}},{"type":"html","value":"<ContentColumn>","position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":16,"offset":42},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":6,"column":4,"offset":47},"end":{"line":6,"column":12,"offset":55},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":44},"end":{"line":6,"column":12,"offset":55},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Firewall Rules provides a powerful and flexible platform for filtering HTTP requests and protecting your site amid an evolving threat landscape. However, the same power and flexibility that allows you to tailor Firewall Rules to your specific application and environment can also introduce complexity. In these cases, it is critical that you have a way to test a Firewall Rule before deploying it so that you can ensure the rule will behave the way you expect.","position":{"start":{"line":8,"column":1,"offset":57},"end":{"line":8,"column":472,"offset":528},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":57},"end":{"line":8,"column":472,"offset":528},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To help customers understand the potential impact of a rule, Cloudflare has built ","position":{"start":{"line":10,"column":1,"offset":530},"end":{"line":10,"column":83,"offset":612},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rule Preview","position":{"start":{"line":10,"column":85,"offset":614},"end":{"line":10,"column":97,"offset":626},"indent":[]}}],"position":{"start":{"line":10,"column":83,"offset":612},"end":{"line":10,"column":99,"offset":628},"indent":[]}},{"type":"text","value":". With the click of a button, Rule Preview allows you to test a Firewall Rule against a sample drawn from the last 72 hours of traffic. Rule Preview is built into the ","position":{"start":{"line":10,"column":99,"offset":628},"end":{"line":10,"column":266,"offset":795},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules Expression Editor","position":{"start":{"line":10,"column":268,"offset":797},"end":{"line":10,"column":300,"offset":829},"indent":[]}}],"position":{"start":{"line":10,"column":266,"offset":795},"end":{"line":10,"column":302,"offset":831},"indent":[]}},{"type":"text","value":" so that you can test a rule as you edit it.","position":{"start":{"line":10,"column":302,"offset":831},"end":{"line":10,"column":346,"offset":875},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":530},"end":{"line":10,"column":346,"offset":875},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":12,"column":1,"offset":877},"end":{"line":12,"column":42,"offset":918},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Rule Preview requires access to a Cloudflare Enterprise plan.","position":{"start":{"line":14,"column":1,"offset":920},"end":{"line":14,"column":62,"offset":981},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":920},"end":{"line":14,"column":62,"offset":981},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":16,"column":1,"offset":983},"end":{"line":16,"column":9,"offset":991},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Use Rule Preview","position":{"start":{"line":18,"column":4,"offset":996},"end":{"line":18,"column":20,"offset":1012},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":993},"end":{"line":18,"column":20,"offset":1012},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To test a Firewall Rule with Rule Preview:","position":{"start":{"line":20,"column":1,"offset":1014},"end":{"line":20,"column":43,"offset":1056},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1014},"end":{"line":20,"column":43,"offset":1056},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Locate the desired rule in the ","position":{"start":{"line":22,"column":4,"offset":1061},"end":{"line":22,"column":35,"offset":1092},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":22,"column":37,"offset":1094},"end":{"line":22,"column":47,"offset":1104},"indent":[]}}],"position":{"start":{"line":22,"column":35,"offset":1092},"end":{"line":22,"column":49,"offset":1106},"indent":[]}},{"type":"text","value":" and click the associated ","position":{"start":{"line":22,"column":49,"offset":1106},"end":{"line":22,"column":75,"offset":1132},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":22,"column":77,"offset":1134},"end":{"line":22,"column":81,"offset":1138},"indent":[]}}],"position":{"start":{"line":22,"column":75,"offset":1132},"end":{"line":22,"column":83,"offset":1140},"indent":[]}},{"type":"text","value":" button (wrench icon). The ","position":{"start":{"line":22,"column":83,"offset":1140},"end":{"line":22,"column":110,"offset":1167},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit Firewall Rule","position":{"start":{"line":22,"column":112,"offset":1169},"end":{"line":22,"column":130,"offset":1187},"indent":[]}}],"position":{"start":{"line":22,"column":110,"offset":1167},"end":{"line":22,"column":132,"offset":1189},"indent":[]}},{"type":"text","value":" panel will open.","position":{"start":{"line":22,"column":132,"offset":1189},"end":{"line":22,"column":149,"offset":1206},"indent":[]}}],"position":{"start":{"line":22,"column":4,"offset":1061},"end":{"line":22,"column":149,"offset":1206},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1058},"end":{"line":22,"column":149,"offset":1206},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":23,"column":4,"offset":1210},"end":{"line":23,"column":10,"offset":1216},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Test rule","position":{"start":{"line":23,"column":12,"offset":1218},"end":{"line":23,"column":21,"offset":1227},"indent":[]}}],"position":{"start":{"line":23,"column":10,"offset":1216},"end":{"line":23,"column":23,"offset":1229},"indent":[]}},{"type":"text","value":" to trigger the test.","position":{"start":{"line":23,"column":23,"offset":1229},"end":{"line":23,"column":44,"offset":1250},"indent":[]}}],"position":{"start":{"line":23,"column":4,"offset":1210},"end":{"line":23,"column":44,"offset":1250},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1207},"end":{"line":23,"column":44,"offset":1250},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1058},"end":{"line":23,"column":44,"offset":1250},"indent":[1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-preview-1.png","alt":"Expression Builder Test Rule button","position":{"start":{"line":25,"column":1,"offset":1252},"end":{"line":25,"column":79,"offset":1330},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1252},"end":{"line":25,"column":79,"offset":1330},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The results of the test are displayed in a plot that simulates how many of the total requests in the last 72 hours would have matched the tested expression.","position":{"start":{"line":27,"column":1,"offset":1332},"end":{"line":27,"column":157,"offset":1488},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":1332},"end":{"line":27,"column":157,"offset":1488},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In this screenshot, a rule that matches all User-Agents that contain the string ","position":{"start":{"line":29,"column":1,"offset":1490},"end":{"line":29,"column":81,"offset":1570},"indent":[]}},{"type":"inlineCode","value":"Mozilla","position":{"start":{"line":29,"column":81,"offset":1570},"end":{"line":29,"column":90,"offset":1579},"indent":[]}},{"type":"text","value":" would block about 8% of requests to the zone:","position":{"start":{"line":29,"column":90,"offset":1579},"end":{"line":29,"column":136,"offset":1625},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1490},"end":{"line":29,"column":136,"offset":1625},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/cf-firewall-rules-preview-rule-plot-chart.png","alt":"Example rule preview results chart","position":{"start":{"line":31,"column":1,"offset":1627},"end":{"line":31,"column":95,"offset":1721},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1627},"end":{"line":31,"column":95,"offset":1721},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Important Notes","position":{"start":{"line":33,"column":4,"offset":1726},"end":{"line":33,"column":19,"offset":1741},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":1723},"end":{"line":33,"column":19,"offset":1741},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Consider the results of Firewall Preview an ","position":{"start":{"line":35,"column":3,"offset":1745},"end":{"line":35,"column":47,"offset":1789},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"indication","position":{"start":{"line":35,"column":48,"offset":1790},"end":{"line":35,"column":58,"offset":1800},"indent":[]}}],"position":{"start":{"line":35,"column":47,"offset":1789},"end":{"line":35,"column":59,"offset":1801},"indent":[]}},{"type":"text","value":" of traffic levels","position":{"start":{"line":35,"column":59,"offset":1801},"end":{"line":35,"column":77,"offset":1819},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1743},"end":{"line":35,"column":79,"offset":1821},"indent":[]}},{"type":"text","value":", not an exact calculation. The sample rate can be as little as 1% of your total traffic.","position":{"start":{"line":35,"column":79,"offset":1821},"end":{"line":35,"column":168,"offset":1910},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1743},"end":{"line":35,"column":168,"offset":1910},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Rule Preview does not take into account other Cloudflare Firewall Rules","position":{"start":{"line":37,"column":3,"offset":1914},"end":{"line":37,"column":74,"offset":1985},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1912},"end":{"line":37,"column":76,"offset":1987},"indent":[]}},{"type":"text","value":" that you have already configured. In effect, Rule Preview tests a single Firewall Rule in isolation. Firewall Events or any other rules with a higher priority that may have blocked or challenged a request are ignored.","position":{"start":{"line":37,"column":76,"offset":1987},"end":{"line":37,"column":294,"offset":2205},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1912},"end":{"line":37,"column":294,"offset":2205},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"You cannot test Firewall Rules that reference ","position":{"start":{"line":39,"column":3,"offset":2209},"end":{"line":39,"column":49,"offset":2255},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists","children":[{"type":"text","value":"IP Lists","position":{"start":{"line":39,"column":50,"offset":2256},"end":{"line":39,"column":58,"offset":2264},"indent":[]}}],"position":{"start":{"line":39,"column":49,"offset":2255},"end":{"line":39,"column":86,"offset":2292},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2207},"end":{"line":39,"column":88,"offset":2294},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":39,"column":88,"offset":2294},"end":{"line":39,"column":89,"offset":2295},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2207},"end":{"line":39,"column":89,"offset":2295},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Cloudflare does not store the entirety of requests, so only a limited number of fields are available to Rule Preview","position":{"start":{"line":41,"column":3,"offset":2299},"end":{"line":41,"column":119,"offset":2415},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2297},"end":{"line":41,"column":121,"offset":2417},"indent":[]}},{"type":"text","value":". The table below lists the fields that Rule Preview supports (green cells), broken down by operator. Fields and operators that are not supported are not included in this table.","position":{"start":{"line":41,"column":121,"offset":2417},"end":{"line":41,"column":298,"offset":2594},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2297},"end":{"line":41,"column":298,"offset":2594},"indent":[]}},{"type":"html","value":"</ContentColumn>","position":{"start":{"line":43,"column":1,"offset":2596},"end":{"line":43,"column":17,"offset":2612},"indent":[]}},{"type":"html","value":"<TableWrap style=\"width:100%\">\n<table style=\"width: 100%\">\n   <thead>\n      <tr>\n        <td></td>\n        <td><strong>Equal</strong></td>\n        <td><strong>Not equal</strong></td>\n        <td><strong>Greater than</strong></td>\n        <td><strong>Less than</strong></td>\n        <td><strong>Greater than or equal</strong></td>\n        <td><strong>Less than or equal</strong></td>\n        <td><strong>In</strong></td>\n        <td><strong>Contains</strong></td>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>\n          <strong>AS Number</strong>\n          <p />\n          <strong><code class=\"InlineCode\">ip.geoip.asnum</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Country\n            <p />\n            <code class=\"InlineCode\">ip.geoip.country</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Hostname\n            <p />\n            <code class=\"InlineCode\">http.host</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >IP Address\n            <p />\n            <code class=\"InlineCode\">ip.src</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Referer\n            <p />\n            <code class=\"InlineCode\">http.referer</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Request method\n            <p />\n            <code class=\"InlineCode\">http.request.method</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >SSL\n            <p />\n            <code class=\"InlineCode\">ssl</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >URI\n            <p />\n            <code class=\"InlineCode\">http.request.uri</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >URI path\n            <p />\n            <code class=\"InlineCode\">http.request.uri.path</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >URI query string\n            <p />\n            <code class=\"InlineCode\">http.request.uri.query</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >User agent\n            <p />\n            <code class=\"InlineCode\">http.user_agent</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":45,"column":1,"offset":2614},"end":{"line":248,"column":13,"offset":7126},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":250,"column":110,"offset":7237}}}}},{"node":{"fields":{"slug":"/cf-dashboard/rules-lists"},"frontmatter":{"order":340,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Use IP Lists"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Use IP Lists","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"IP Lists allow you to create a group of IP addresses and refer to them collectively, by name, in your Firewall Rule expressions. For an introduction, refer to ","position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":160,"offset":176},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/rules-lists","children":[{"type":"text","value":"IP Lists","position":{"start":{"line":4,"column":161,"offset":177},"end":{"line":4,"column":169,"offset":185},"indent":[]}}],"position":{"start":{"line":4,"column":160,"offset":176},"end":{"line":4,"column":202,"offset":218},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":4,"column":202,"offset":218},"end":{"line":4,"column":203,"offset":219},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":203,"offset":219},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Access the Lists interface","position":{"start":{"line":6,"column":4,"offset":224},"end":{"line":6,"column":30,"offset":250},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":221},"end":{"line":6,"column":30,"offset":250},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"IP Lists are stored at the account level. To access the ","position":{"start":{"line":8,"column":1,"offset":252},"end":{"line":8,"column":57,"offset":308},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":8,"column":59,"offset":310},"end":{"line":8,"column":64,"offset":315},"indent":[]}}],"position":{"start":{"line":8,"column":57,"offset":308},"end":{"line":8,"column":66,"offset":317},"indent":[]}},{"type":"text","value":" interface, follow these steps:","position":{"start":{"line":8,"column":66,"offset":317},"end":{"line":8,"column":97,"offset":348},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":252},"end":{"line":8,"column":97,"offset":348},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Log in to the ","position":{"start":{"line":10,"column":4,"offset":353},"end":{"line":10,"column":18,"offset":367},"indent":[]}},{"type":"link","title":null,"url":"https://dash.cloudflare.com","children":[{"type":"text","value":"Cloudflare dashboard","position":{"start":{"line":10,"column":19,"offset":368},"end":{"line":10,"column":39,"offset":388},"indent":[]}}],"position":{"start":{"line":10,"column":18,"offset":367},"end":{"line":10,"column":69,"offset":418},"indent":[]}},{"type":"text","value":" and select your account.","position":{"start":{"line":10,"column":69,"offset":418},"end":{"line":10,"column":94,"offset":443},"indent":[]}}],"position":{"start":{"line":10,"column":4,"offset":353},"end":{"line":10,"column":94,"offset":443},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":350},"end":{"line":10,"column":94,"offset":443},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Go to ","position":{"start":{"line":11,"column":4,"offset":447},"end":{"line":11,"column":10,"offset":453},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Configurations","position":{"start":{"line":11,"column":12,"offset":455},"end":{"line":11,"column":26,"offset":469},"indent":[]}}],"position":{"start":{"line":11,"column":10,"offset":453},"end":{"line":11,"column":28,"offset":471},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":11,"column":28,"offset":471},"end":{"line":11,"column":31,"offset":474},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":11,"column":33,"offset":476},"end":{"line":11,"column":38,"offset":481},"indent":[]}}],"position":{"start":{"line":11,"column":31,"offset":474},"end":{"line":11,"column":40,"offset":483},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":11,"column":40,"offset":483},"end":{"line":11,"column":41,"offset":484},"indent":[]}}],"position":{"start":{"line":11,"column":4,"offset":447},"end":{"line":11,"column":41,"offset":484},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":444},"end":{"line":11,"column":41,"offset":484},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":350},"end":{"line":11,"column":41,"offset":484},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":13,"column":1,"offset":486},"end":{"line":13,"column":5,"offset":490},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":13,"column":7,"offset":492},"end":{"line":13,"column":12,"offset":497},"indent":[]}}],"position":{"start":{"line":13,"column":5,"offset":490},"end":{"line":13,"column":14,"offset":499},"indent":[]}},{"type":"text","value":" user interface displays.\n","position":{"start":{"line":13,"column":14,"offset":499},"end":{"line":14,"column":1,"offset":525},"indent":[1]}},{"type":"image","title":null,"url":"../../images/lists-ui.png","alt":"Lists UI","position":{"start":{"line":14,"column":1,"offset":525},"end":{"line":14,"column":39,"offset":563},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":486},"end":{"line":14,"column":39,"offset":563},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create your first IP List","position":{"start":{"line":16,"column":4,"offset":568},"end":{"line":16,"column":29,"offset":593},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":565},"end":{"line":16,"column":29,"offset":593},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Creating an IP List involves two steps:","position":{"start":{"line":18,"column":1,"offset":595},"end":{"line":18,"column":40,"offset":634},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":595},"end":{"line":18,"column":40,"offset":634},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/manage-lists/#create-an-ip-list","children":[{"type":"text","value":"Create an IP List","position":{"start":{"line":20,"column":5,"offset":640},"end":{"line":20,"column":22,"offset":657},"indent":[]}}],"position":{"start":{"line":20,"column":4,"offset":639},"end":{"line":20,"column":82,"offset":717},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":20,"column":82,"offset":717},"end":{"line":20,"column":83,"offset":718},"indent":[]}}],"position":{"start":{"line":20,"column":4,"offset":639},"end":{"line":20,"column":83,"offset":718},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":636},"end":{"line":20,"column":83,"offset":718},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/manage-items/#add-items-to-a-list","children":[{"type":"text","value":"Add IP addresses to the list","position":{"start":{"line":21,"column":5,"offset":723},"end":{"line":21,"column":33,"offset":751},"indent":[]}}],"position":{"start":{"line":21,"column":4,"offset":722},"end":{"line":21,"column":95,"offset":813},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":21,"column":95,"offset":813},"end":{"line":21,"column":96,"offset":814},"indent":[]}}],"position":{"start":{"line":21,"column":4,"offset":722},"end":{"line":21,"column":96,"offset":814},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":719},"end":{"line":21,"column":96,"offset":814},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":636},"end":{"line":21,"column":96,"offset":814},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Use IP Lists in expressions","position":{"start":{"line":23,"column":4,"offset":819},"end":{"line":23,"column":31,"offset":846},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":816},"end":{"line":23,"column":31,"offset":846},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To use IP Lists in the Cloudflare dashboard, refer to ","position":{"start":{"line":25,"column":1,"offset":848},"end":{"line":25,"column":55,"offset":902},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/use-lists-in-expressions","children":[{"type":"text","value":"Use lists in expressions","position":{"start":{"line":25,"column":56,"offset":903},"end":{"line":25,"column":80,"offset":927},"indent":[]}}],"position":{"start":{"line":25,"column":55,"offset":902},"end":{"line":25,"column":133,"offset":980},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":25,"column":133,"offset":980},"end":{"line":25,"column":134,"offset":981},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":848},"end":{"line":25,"column":134,"offset":981},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":28,"column":70,"offset":1053}}}}},{"node":{"fields":{"slug":"/cf-dashboard/rules-lists/manage-lists"},"frontmatter":{"order":350,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Manage lists"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Manage lists","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create an IP list","position":{"start":{"line":4,"column":4,"offset":20},"end":{"line":4,"column":21,"offset":37},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":21,"offset":37},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To create an IP List, follow these steps:","position":{"start":{"line":6,"column":1,"offset":39},"end":{"line":6,"column":42,"offset":80},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":39},"end":{"line":6,"column":42,"offset":80},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":8,"column":4,"offset":85},"end":{"line":8,"column":11,"offset":92},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":8,"column":13,"offset":94},"end":{"line":8,"column":18,"offset":99},"indent":[]}}],"position":{"start":{"line":8,"column":11,"offset":92},"end":{"line":8,"column":20,"offset":101},"indent":[]}},{"type":"text","value":" interface, click ","position":{"start":{"line":8,"column":20,"offset":101},"end":{"line":8,"column":38,"offset":119},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create new list","position":{"start":{"line":8,"column":40,"offset":121},"end":{"line":8,"column":55,"offset":136},"indent":[]}}],"position":{"start":{"line":8,"column":38,"offset":119},"end":{"line":8,"column":57,"offset":138},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":8,"column":57,"offset":138},"end":{"line":8,"column":58,"offset":139},"indent":[]}}],"position":{"start":{"line":8,"column":4,"offset":85},"end":{"line":8,"column":58,"offset":139},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":10,"column":3,"offset":143},"end":{"line":10,"column":7,"offset":147},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create new list","position":{"start":{"line":10,"column":9,"offset":149},"end":{"line":10,"column":24,"offset":164},"indent":[]}}],"position":{"start":{"line":10,"column":7,"offset":147},"end":{"line":10,"column":26,"offset":166},"indent":[]}},{"type":"text","value":" page displays.","position":{"start":{"line":10,"column":26,"offset":166},"end":{"line":10,"column":41,"offset":181},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":143},"end":{"line":10,"column":41,"offset":181},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-create-new.png","alt":"Create new list","position":{"start":{"line":12,"column":3,"offset":185},"end":{"line":12,"column":56,"offset":238},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":185},"end":{"line":12,"column":56,"offset":238},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":82},"end":{"line":13,"column":1,"offset":239},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Enter a name for your list, observing the following guidelines:","position":{"start":{"line":14,"column":4,"offset":243},"end":{"line":14,"column":67,"offset":306},"indent":[]}}],"position":{"start":{"line":14,"column":4,"offset":243},"end":{"line":14,"column":67,"offset":306},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use only lowercase letters, numbers and the underscore (","position":{"start":{"line":16,"column":6,"offset":313},"end":{"line":16,"column":62,"offset":369},"indent":[]}},{"type":"inlineCode","value":"_","position":{"start":{"line":16,"column":62,"offset":369},"end":{"line":16,"column":65,"offset":372},"indent":[]}},{"type":"text","value":") character in the name. A valid name satisfies this regular expression:","position":{"start":{"line":16,"column":65,"offset":372},"end":{"line":16,"column":137,"offset":444},"indent":[]}}],"position":{"start":{"line":16,"column":6,"offset":313},"end":{"line":16,"column":137,"offset":444},"indent":[]}},{"type":"paragraph","children":[{"type":"inlineCode","value":"^[a-z0-9_]+$","position":{"start":{"line":18,"column":6,"offset":451},"end":{"line":18,"column":20,"offset":465},"indent":[]}}],"position":{"start":{"line":18,"column":6,"offset":451},"end":{"line":18,"column":20,"offset":465},"indent":[]}}],"position":{"start":{"line":16,"column":4,"offset":311},"end":{"line":19,"column":1,"offset":466},"indent":[1,4,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The maximum length for a list name is 50 characters.","position":{"start":{"line":20,"column":6,"offset":472},"end":{"line":20,"column":58,"offset":524},"indent":[]}}],"position":{"start":{"line":20,"column":6,"offset":472},"end":{"line":20,"column":58,"offset":524},"indent":[]}}],"position":{"start":{"line":20,"column":4,"offset":470},"end":{"line":20,"column":58,"offset":524},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use a descriptive name for your list so that the list is informative in the context of a Firewall Rule expression.","position":{"start":{"line":21,"column":6,"offset":530},"end":{"line":21,"column":120,"offset":644},"indent":[]}}],"position":{"start":{"line":21,"column":6,"offset":530},"end":{"line":21,"column":120,"offset":644},"indent":[]}}],"position":{"start":{"line":21,"column":4,"offset":528},"end":{"line":21,"column":120,"offset":644},"indent":[]}}],"position":{"start":{"line":16,"column":4,"offset":311},"end":{"line":21,"column":120,"offset":644},"indent":[1,4,1,4,4]}}],"position":{"start":{"line":14,"column":1,"offset":240},"end":{"line":22,"column":1,"offset":645},"indent":[1,1,1,1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Enter a description (optional). The maximum length for the description is 500 characters. There are no character constraints for the description field.","position":{"start":{"line":23,"column":4,"offset":649},"end":{"line":23,"column":155,"offset":800},"indent":[]}}],"position":{"start":{"line":23,"column":4,"offset":649},"end":{"line":23,"column":155,"offset":800},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":646},"end":{"line":24,"column":1,"offset":801},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":25,"column":4,"offset":805},"end":{"line":25,"column":10,"offset":811},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Create","position":{"start":{"line":25,"column":12,"offset":813},"end":{"line":25,"column":18,"offset":819},"indent":[]}}],"position":{"start":{"line":25,"column":10,"offset":811},"end":{"line":25,"column":20,"offset":821},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":25,"column":20,"offset":821},"end":{"line":25,"column":21,"offset":822},"indent":[]}}],"position":{"start":{"line":25,"column":4,"offset":805},"end":{"line":25,"column":21,"offset":822},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":802},"end":{"line":25,"column":21,"offset":822},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":82},"end":{"line":25,"column":21,"offset":822},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":27,"column":1,"offset":824},"end":{"line":27,"column":5,"offset":828},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add items to list","position":{"start":{"line":27,"column":7,"offset":830},"end":{"line":27,"column":24,"offset":847},"indent":[]}}],"position":{"start":{"line":27,"column":5,"offset":828},"end":{"line":27,"column":26,"offset":849},"indent":[]}},{"type":"text","value":" page displays.\n","position":{"start":{"line":27,"column":26,"offset":849},"end":{"line":28,"column":1,"offset":865},"indent":[1]}},{"type":"image","title":null,"url":"../../images/lists-add-items-page.png","alt":"Add items to list","position":{"start":{"line":28,"column":1,"offset":865},"end":{"line":28,"column":60,"offset":924},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":824},"end":{"line":28,"column":60,"offset":924},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"To populate your list, refer to ","position":{"start":{"line":30,"column":1,"offset":926},"end":{"line":30,"column":33,"offset":958},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/manage-items/#add-items-to-a-list","children":[{"type":"text","value":"Use IP Lists: Add items to a list","position":{"start":{"line":30,"column":34,"offset":959},"end":{"line":30,"column":67,"offset":992},"indent":[]}}],"position":{"start":{"line":30,"column":33,"offset":958},"end":{"line":30,"column":129,"offset":1054},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":30,"column":129,"offset":1054},"end":{"line":30,"column":130,"offset":1055},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":926},"end":{"line":30,"column":130,"offset":1055},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Delete a list","position":{"start":{"line":32,"column":4,"offset":1060},"end":{"line":32,"column":17,"offset":1073},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1057},"end":{"line":32,"column":17,"offset":1073},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":34,"column":1,"offset":1075},"end":{"line":34,"column":34,"offset":1108},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can only delete a list when there are no Firewall Rules (enabled or disabled) that reference the list.","position":{"start":{"line":36,"column":1,"offset":1110},"end":{"line":36,"column":107,"offset":1216},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1110},"end":{"line":36,"column":107,"offset":1216},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":38,"column":1,"offset":1218},"end":{"line":38,"column":9,"offset":1226},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To delete an IP List, follow these steps:","position":{"start":{"line":40,"column":1,"offset":1228},"end":{"line":40,"column":42,"offset":1269},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":1228},"end":{"line":40,"column":42,"offset":1269},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the Cloudflare dashboard, navigate to ","position":{"start":{"line":42,"column":4,"offset":1274},"end":{"line":42,"column":45,"offset":1315},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Configurations","position":{"start":{"line":42,"column":47,"offset":1317},"end":{"line":42,"column":61,"offset":1331},"indent":[]}}],"position":{"start":{"line":42,"column":45,"offset":1315},"end":{"line":42,"column":63,"offset":1333},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":42,"column":63,"offset":1333},"end":{"line":42,"column":66,"offset":1336},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":42,"column":68,"offset":1338},"end":{"line":42,"column":73,"offset":1343},"indent":[]}}],"position":{"start":{"line":42,"column":66,"offset":1336},"end":{"line":42,"column":75,"offset":1345},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":42,"column":75,"offset":1345},"end":{"line":42,"column":76,"offset":1346},"indent":[]}}],"position":{"start":{"line":42,"column":4,"offset":1274},"end":{"line":42,"column":76,"offset":1346},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1271},"end":{"line":43,"column":1,"offset":1347},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Hover your pointer over the ","position":{"start":{"line":44,"column":4,"offset":1351},"end":{"line":44,"column":32,"offset":1379},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Delete","position":{"start":{"line":44,"column":34,"offset":1381},"end":{"line":44,"column":40,"offset":1387},"indent":[]}}],"position":{"start":{"line":44,"column":32,"offset":1379},"end":{"line":44,"column":42,"offset":1389},"indent":[]}},{"type":"text","value":" button associated with the list you want to delete.","position":{"start":{"line":44,"column":42,"offset":1389},"end":{"line":44,"column":94,"offset":1441},"indent":[]}}],"position":{"start":{"line":44,"column":4,"offset":1351},"end":{"line":44,"column":94,"offset":1441},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When the list is used in a Firewall Rule, a tooltip displays with notification that you cannot delete the list:","position":{"start":{"line":46,"column":6,"offset":1448},"end":{"line":46,"column":117,"offset":1559},"indent":[]}}],"position":{"start":{"line":46,"column":6,"offset":1448},"end":{"line":46,"column":117,"offset":1559},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-cannot-delete.png","alt":"Cannot Delete lists","position":{"start":{"line":48,"column":6,"offset":1566},"end":{"line":48,"column":66,"offset":1626},"indent":[]}}],"position":{"start":{"line":48,"column":6,"offset":1566},"end":{"line":48,"column":66,"offset":1626},"indent":[]}}],"position":{"start":{"line":46,"column":4,"offset":1446},"end":{"line":49,"column":1,"offset":1627},"indent":[1,4,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When the list is not used in a Firewall Rule, ","position":{"start":{"line":50,"column":6,"offset":1633},"end":{"line":50,"column":52,"offset":1679},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Delete","position":{"start":{"line":50,"column":54,"offset":1681},"end":{"line":50,"column":60,"offset":1687},"indent":[]}}],"position":{"start":{"line":50,"column":52,"offset":1679},"end":{"line":50,"column":62,"offset":1689},"indent":[]}},{"type":"text","value":" link highlights, indicating you can delete the list.","position":{"start":{"line":50,"column":62,"offset":1689},"end":{"line":50,"column":115,"offset":1742},"indent":[]}}],"position":{"start":{"line":50,"column":6,"offset":1633},"end":{"line":50,"column":115,"offset":1742},"indent":[]}}],"position":{"start":{"line":50,"column":4,"offset":1631},"end":{"line":50,"column":115,"offset":1742},"indent":[]}}],"position":{"start":{"line":46,"column":4,"offset":1446},"end":{"line":50,"column":115,"offset":1742},"indent":[1,4,1,4]}}],"position":{"start":{"line":44,"column":1,"offset":1348},"end":{"line":51,"column":1,"offset":1743},"indent":[1,1,1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":52,"column":4,"offset":1747},"end":{"line":52,"column":10,"offset":1753},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Delete","position":{"start":{"line":52,"column":12,"offset":1755},"end":{"line":52,"column":18,"offset":1761},"indent":[]}}],"position":{"start":{"line":52,"column":10,"offset":1753},"end":{"line":52,"column":20,"offset":1763},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":52,"column":20,"offset":1763},"end":{"line":52,"column":21,"offset":1764},"indent":[]}}],"position":{"start":{"line":52,"column":4,"offset":1747},"end":{"line":52,"column":21,"offset":1764},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":1744},"end":{"line":53,"column":1,"offset":1765},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the confirmation dialog, click ","position":{"start":{"line":54,"column":4,"offset":1769},"end":{"line":54,"column":38,"offset":1803},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Delete","position":{"start":{"line":54,"column":40,"offset":1805},"end":{"line":54,"column":46,"offset":1811},"indent":[]}}],"position":{"start":{"line":54,"column":38,"offset":1803},"end":{"line":54,"column":48,"offset":1813},"indent":[]}},{"type":"text","value":" to confirm the operation.","position":{"start":{"line":54,"column":48,"offset":1813},"end":{"line":54,"column":74,"offset":1839},"indent":[]}}],"position":{"start":{"line":54,"column":4,"offset":1769},"end":{"line":54,"column":74,"offset":1839},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":1766},"end":{"line":54,"column":74,"offset":1839},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1271},"end":{"line":54,"column":74,"offset":1839},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":56,"column":1,"offset":1841},"end":{"line":56,"column":5,"offset":1845},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":56,"column":7,"offset":1847},"end":{"line":56,"column":12,"offset":1852},"indent":[]}}],"position":{"start":{"line":56,"column":5,"offset":1845},"end":{"line":56,"column":14,"offset":1854},"indent":[]}},{"type":"text","value":" card displays the updated collection of lists.","position":{"start":{"line":56,"column":14,"offset":1854},"end":{"line":56,"column":61,"offset":1901},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":1841},"end":{"line":56,"column":61,"offset":1901},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Edit a list","position":{"start":{"line":58,"column":4,"offset":1906},"end":{"line":58,"column":15,"offset":1917},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":1903},"end":{"line":58,"column":15,"offset":1917},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can add and remove items from a list, but you cannot change the list name or type.","position":{"start":{"line":60,"column":1,"offset":1919},"end":{"line":60,"column":87,"offset":2005},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":1919},"end":{"line":60,"column":87,"offset":2005},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information, refer to ","position":{"start":{"line":62,"column":1,"offset":2007},"end":{"line":62,"column":32,"offset":2038},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/manage-items","children":[{"type":"text","value":"Use IP Lists: Manage IP List items","position":{"start":{"line":62,"column":33,"offset":2039},"end":{"line":62,"column":67,"offset":2073},"indent":[]}}],"position":{"start":{"line":62,"column":32,"offset":2038},"end":{"line":62,"column":108,"offset":2114},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":62,"column":108,"offset":2114},"end":{"line":62,"column":109,"offset":2115},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":2007},"end":{"line":62,"column":109,"offset":2115},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":65,"column":70,"offset":2187}}}}},{"node":{"fields":{"slug":"/cf-dashboard/rules-lists/manage-items"},"frontmatter":{"order":360,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Manage IP List items"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Manage IP List items","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":23,"offset":23},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":23,"offset":23},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"View items in an IP List","position":{"start":{"line":4,"column":4,"offset":28},"end":{"line":4,"column":28,"offset":52},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":25},"end":{"line":4,"column":28,"offset":52},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/","children":[{"type":"text","value":"Access the Lists interface","position":{"start":{"line":6,"column":5,"offset":58},"end":{"line":6,"column":31,"offset":84},"indent":[]}}],"position":{"start":{"line":6,"column":4,"offset":57},"end":{"line":6,"column":60,"offset":113},"indent":[]}},{"type":"text","value":" available at ","position":{"start":{"line":6,"column":60,"offset":113},"end":{"line":6,"column":74,"offset":127},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Configurations","position":{"start":{"line":6,"column":76,"offset":129},"end":{"line":6,"column":90,"offset":143},"indent":[]}}],"position":{"start":{"line":6,"column":74,"offset":127},"end":{"line":6,"column":92,"offset":145},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":6,"column":92,"offset":145},"end":{"line":6,"column":95,"offset":148},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":6,"column":97,"offset":150},"end":{"line":6,"column":102,"offset":155},"indent":[]}}],"position":{"start":{"line":6,"column":95,"offset":148},"end":{"line":6,"column":104,"offset":157},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":104,"offset":157},"end":{"line":6,"column":105,"offset":158},"indent":[]}}],"position":{"start":{"line":6,"column":4,"offset":57},"end":{"line":6,"column":105,"offset":158},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":54},"end":{"line":7,"column":1,"offset":159},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To view items in a list, click the ","position":{"start":{"line":8,"column":4,"offset":163},"end":{"line":8,"column":39,"offset":198},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":8,"column":41,"offset":200},"end":{"line":8,"column":45,"offset":204},"indent":[]}}],"position":{"start":{"line":8,"column":39,"offset":198},"end":{"line":8,"column":47,"offset":206},"indent":[]}},{"type":"text","value":" link associated with the list you want to view.","position":{"start":{"line":8,"column":47,"offset":206},"end":{"line":8,"column":95,"offset":254},"indent":[]}}],"position":{"start":{"line":8,"column":4,"offset":163},"end":{"line":8,"column":95,"offset":254},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":160},"end":{"line":8,"column":95,"offset":254},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":54},"end":{"line":8,"column":95,"offset":254},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The list of items displays sorted by IP address, ascending:","position":{"start":{"line":10,"column":1,"offset":256},"end":{"line":10,"column":60,"offset":315},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":256},"end":{"line":10,"column":60,"offset":315},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-view-items-in-list.png","alt":"View items in a list","position":{"start":{"line":12,"column":1,"offset":317},"end":{"line":12,"column":67,"offset":383},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":317},"end":{"line":12,"column":67,"offset":383},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":14,"column":1,"offset":385},"end":{"line":14,"column":34,"offset":418},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You cannot download a list in CSV format from the dashboard. If you need to download the contents of a list to your device, use the ","position":{"start":{"line":16,"column":1,"offset":420},"end":{"line":16,"column":133,"offset":552},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#rules-lists-list-lists","children":[{"type":"text","value":"Get Lists","position":{"start":{"line":16,"column":134,"offset":553},"end":{"line":16,"column":143,"offset":562},"indent":[]}}],"position":{"start":{"line":16,"column":133,"offset":552},"end":{"line":16,"column":196,"offset":615},"indent":[]}},{"type":"text","value":" operation to fetch them.","position":{"start":{"line":16,"column":196,"offset":615},"end":{"line":16,"column":221,"offset":640},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":420},"end":{"line":16,"column":221,"offset":640},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":18,"column":1,"offset":642},"end":{"line":18,"column":9,"offset":650},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Add items to a list","position":{"start":{"line":20,"column":4,"offset":655},"end":{"line":20,"column":23,"offset":674},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":652},"end":{"line":20,"column":23,"offset":674},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"IP Lists support:","position":{"start":{"line":22,"column":1,"offset":676},"end":{"line":22,"column":18,"offset":693},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":676},"end":{"line":22,"column":18,"offset":693},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Individual IPv4 addresses","position":{"start":{"line":24,"column":3,"offset":697},"end":{"line":24,"column":28,"offset":722},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":697},"end":{"line":24,"column":28,"offset":722},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":695},"end":{"line":24,"column":28,"offset":722},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"IPv4 CIDR ranges with a prefix from ","position":{"start":{"line":25,"column":3,"offset":725},"end":{"line":25,"column":39,"offset":761},"indent":[]}},{"type":"inlineCode","value":"/8","position":{"start":{"line":25,"column":39,"offset":761},"end":{"line":25,"column":43,"offset":765},"indent":[]}},{"type":"text","value":" to ","position":{"start":{"line":25,"column":43,"offset":765},"end":{"line":25,"column":47,"offset":769},"indent":[]}},{"type":"inlineCode","value":"/32","position":{"start":{"line":25,"column":47,"offset":769},"end":{"line":25,"column":52,"offset":774},"indent":[]}}],"position":{"start":{"line":25,"column":3,"offset":725},"end":{"line":25,"column":52,"offset":774},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":723},"end":{"line":25,"column":52,"offset":774},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"IPv6 CIDR ranges with a prefix from ","position":{"start":{"line":26,"column":3,"offset":777},"end":{"line":26,"column":39,"offset":813},"indent":[]}},{"type":"inlineCode","value":"/4","position":{"start":{"line":26,"column":39,"offset":813},"end":{"line":26,"column":43,"offset":817},"indent":[]}},{"type":"text","value":" to ","position":{"start":{"line":26,"column":43,"offset":817},"end":{"line":26,"column":47,"offset":821},"indent":[]}},{"type":"inlineCode","value":"/64","position":{"start":{"line":26,"column":47,"offset":821},"end":{"line":26,"column":52,"offset":826},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":777},"end":{"line":26,"column":52,"offset":826},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":775},"end":{"line":26,"column":52,"offset":826},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":695},"end":{"line":26,"column":52,"offset":826},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"You can combine individual addresses and CIDR ranges in the same list.","position":{"start":{"line":28,"column":1,"offset":828},"end":{"line":28,"column":71,"offset":898},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":828},"end":{"line":28,"column":71,"offset":898},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":30,"column":1,"offset":900},"end":{"line":30,"column":34,"offset":933},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To specify an IPv6 address, enter it as a CIDR range with a ","position":{"start":{"line":32,"column":1,"offset":935},"end":{"line":32,"column":61,"offset":995},"indent":[]}},{"type":"inlineCode","value":"/64","position":{"start":{"line":32,"column":61,"offset":995},"end":{"line":32,"column":66,"offset":1000},"indent":[]}},{"type":"text","value":" prefix, the largest supported prefix for IPv6 CIDR ranges.","position":{"start":{"line":32,"column":66,"offset":1000},"end":{"line":32,"column":125,"offset":1059},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":935},"end":{"line":32,"column":125,"offset":1059},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, instead of ","position":{"start":{"line":34,"column":1,"offset":1061},"end":{"line":34,"column":25,"offset":1085},"indent":[]}},{"type":"inlineCode","value":"2001:db8:6a0b:1a01:d423:43b9:13c5:2e8f","position":{"start":{"line":34,"column":25,"offset":1085},"end":{"line":34,"column":65,"offset":1125},"indent":[]}},{"type":"text","value":", enter one of the following:","position":{"start":{"line":34,"column":65,"offset":1125},"end":{"line":34,"column":94,"offset":1154},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1061},"end":{"line":34,"column":94,"offset":1154},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"2001:db8:6a0b:1a01:0000:0000:0000:0000/64","position":{"start":{"line":36,"column":3,"offset":1158},"end":{"line":36,"column":46,"offset":1201},"indent":[]}}],"position":{"start":{"line":36,"column":3,"offset":1158},"end":{"line":36,"column":46,"offset":1201},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1156},"end":{"line":36,"column":46,"offset":1201},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"2001:db8:6a0b:1a01::/64","position":{"start":{"line":37,"column":3,"offset":1204},"end":{"line":37,"column":28,"offset":1229},"indent":[]}},{"type":"text","value":" (using the ","position":{"start":{"line":37,"column":28,"offset":1229},"end":{"line":37,"column":40,"offset":1241},"indent":[]}},{"type":"link","title":null,"url":"https://tools.ietf.org/html/rfc5952#section-4.2","children":[{"type":"text","value":"double colon notation","position":{"start":{"line":37,"column":41,"offset":1242},"end":{"line":37,"column":62,"offset":1263},"indent":[]}}],"position":{"start":{"line":37,"column":40,"offset":1241},"end":{"line":37,"column":112,"offset":1313},"indent":[]}},{"type":"text","value":")","position":{"start":{"line":37,"column":112,"offset":1313},"end":{"line":37,"column":113,"offset":1314},"indent":[]}}],"position":{"start":{"line":37,"column":3,"offset":1204},"end":{"line":37,"column":113,"offset":1314},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1202},"end":{"line":37,"column":113,"offset":1314},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1156},"end":{"line":37,"column":113,"offset":1314},"indent":[1]}},{"type":"html","value":"</Aside>","position":{"start":{"line":39,"column":1,"offset":1316},"end":{"line":39,"column":9,"offset":1324},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can use uppercase or lowercase characters for IPv6 addresses in lists. However, when you save the list, uppercase characters are converted to lowercase.","position":{"start":{"line":41,"column":1,"offset":1326},"end":{"line":41,"column":157,"offset":1482},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1326},"end":{"line":41,"column":157,"offset":1482},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To add items to an IP List:","position":{"start":{"line":43,"column":1,"offset":1484},"end":{"line":43,"column":28,"offset":1511},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":1484},"end":{"line":43,"column":28,"offset":1511},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/rules-lists","children":[{"type":"text","value":"Access the Lists interface","position":{"start":{"line":45,"column":5,"offset":1517},"end":{"line":45,"column":31,"offset":1543},"indent":[]}}],"position":{"start":{"line":45,"column":4,"offset":1516},"end":{"line":45,"column":59,"offset":1571},"indent":[]}},{"type":"text","value":" available at ","position":{"start":{"line":45,"column":59,"offset":1571},"end":{"line":45,"column":73,"offset":1585},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Configurations","position":{"start":{"line":45,"column":75,"offset":1587},"end":{"line":45,"column":89,"offset":1601},"indent":[]}}],"position":{"start":{"line":45,"column":73,"offset":1585},"end":{"line":45,"column":91,"offset":1603},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":45,"column":91,"offset":1603},"end":{"line":45,"column":94,"offset":1606},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":45,"column":96,"offset":1608},"end":{"line":45,"column":101,"offset":1613},"indent":[]}}],"position":{"start":{"line":45,"column":94,"offset":1606},"end":{"line":45,"column":103,"offset":1615},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":45,"column":103,"offset":1615},"end":{"line":45,"column":104,"offset":1616},"indent":[]}}],"position":{"start":{"line":45,"column":4,"offset":1516},"end":{"line":45,"column":104,"offset":1616},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":1513},"end":{"line":46,"column":1,"offset":1617},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":47,"column":4,"offset":1621},"end":{"line":47,"column":14,"offset":1631},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":47,"column":16,"offset":1633},"end":{"line":47,"column":20,"offset":1637},"indent":[]}}],"position":{"start":{"line":47,"column":14,"offset":1631},"end":{"line":47,"column":22,"offset":1639},"indent":[]}},{"type":"text","value":" button associated with the list that you want to edit.","position":{"start":{"line":47,"column":22,"offset":1639},"end":{"line":47,"column":77,"offset":1694},"indent":[]}}],"position":{"start":{"line":47,"column":4,"offset":1621},"end":{"line":47,"column":77,"offset":1694},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The list of IP items displays.","position":{"start":{"line":49,"column":3,"offset":1698},"end":{"line":49,"column":33,"offset":1728},"indent":[]}}],"position":{"start":{"line":49,"column":3,"offset":1698},"end":{"line":49,"column":33,"offset":1728},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":1618},"end":{"line":50,"column":1,"offset":1729},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":51,"column":4,"offset":1733},"end":{"line":51,"column":10,"offset":1739},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add items","position":{"start":{"line":51,"column":12,"offset":1741},"end":{"line":51,"column":21,"offset":1750},"indent":[]}}],"position":{"start":{"line":51,"column":10,"offset":1739},"end":{"line":51,"column":23,"offset":1752},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":51,"column":23,"offset":1752},"end":{"line":51,"column":24,"offset":1753},"indent":[]}}],"position":{"start":{"line":51,"column":4,"offset":1733},"end":{"line":51,"column":24,"offset":1753},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":53,"column":3,"offset":1757},"end":{"line":53,"column":7,"offset":1761},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add items to list","position":{"start":{"line":53,"column":9,"offset":1763},"end":{"line":53,"column":26,"offset":1780},"indent":[]}}],"position":{"start":{"line":53,"column":7,"offset":1761},"end":{"line":53,"column":28,"offset":1782},"indent":[]}},{"type":"text","value":" page displays:","position":{"start":{"line":53,"column":28,"offset":1782},"end":{"line":53,"column":43,"offset":1797},"indent":[]}}],"position":{"start":{"line":53,"column":3,"offset":1757},"end":{"line":53,"column":43,"offset":1797},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-add-items-to-list-page.png","alt":"Add items to list page","position":{"start":{"line":55,"column":3,"offset":1801},"end":{"line":55,"column":75,"offset":1873},"indent":[]}}],"position":{"start":{"line":55,"column":3,"offset":1801},"end":{"line":55,"column":75,"offset":1873},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1730},"end":{"line":56,"column":1,"offset":1874},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To ","position":{"start":{"line":57,"column":4,"offset":1878},"end":{"line":57,"column":7,"offset":1881},"indent":[]}},{"type":"link","title":null,"url":"#add-items-to-a-list-manually","children":[{"type":"text","value":"add items to the list manually","position":{"start":{"line":57,"column":8,"offset":1882},"end":{"line":57,"column":38,"offset":1912},"indent":[]}}],"position":{"start":{"line":57,"column":7,"offset":1881},"end":{"line":57,"column":70,"offset":1944},"indent":[]}},{"type":"text","value":", use the text inputs in the Lists interface.","position":{"start":{"line":57,"column":70,"offset":1944},"end":{"line":57,"column":115,"offset":1989},"indent":[]}}],"position":{"start":{"line":57,"column":4,"offset":1878},"end":{"line":57,"column":115,"offset":1989},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":1875},"end":{"line":58,"column":1,"offset":1990},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To ","position":{"start":{"line":59,"column":4,"offset":1994},"end":{"line":59,"column":7,"offset":1997},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/manage-items/#add-items-in-csv-format","children":[{"type":"text","value":"add items in CSV format","position":{"start":{"line":59,"column":8,"offset":1998},"end":{"line":59,"column":31,"offset":2021},"indent":[]}}],"position":{"start":{"line":59,"column":7,"offset":1997},"end":{"line":59,"column":97,"offset":2087},"indent":[]}},{"type":"text","value":", click ","position":{"start":{"line":59,"column":97,"offset":2087},"end":{"line":59,"column":105,"offset":2095},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Upload CSV","position":{"start":{"line":59,"column":107,"offset":2097},"end":{"line":59,"column":117,"offset":2107},"indent":[]}}],"position":{"start":{"line":59,"column":105,"offset":2095},"end":{"line":59,"column":119,"offset":2109},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":59,"column":119,"offset":2109},"end":{"line":59,"column":120,"offset":2110},"indent":[]}}],"position":{"start":{"line":59,"column":4,"offset":1994},"end":{"line":59,"column":120,"offset":2110},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":1991},"end":{"line":59,"column":120,"offset":2110},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":1513},"end":{"line":59,"column":120,"offset":2110},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Add items to a list manually","position":{"start":{"line":61,"column":5,"offset":2116},"end":{"line":61,"column":33,"offset":2144},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":2112},"end":{"line":61,"column":33,"offset":2144},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":63,"column":4,"offset":2149},"end":{"line":63,"column":11,"offset":2156},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add items to list","position":{"start":{"line":63,"column":13,"offset":2158},"end":{"line":63,"column":30,"offset":2175},"indent":[]}}],"position":{"start":{"line":63,"column":11,"offset":2156},"end":{"line":63,"column":32,"offset":2177},"indent":[]}},{"type":"text","value":" page, add an IP Address and an optional description in the text inputs.","position":{"start":{"line":63,"column":32,"offset":2177},"end":{"line":63,"column":104,"offset":2249},"indent":[]}}],"position":{"start":{"line":63,"column":4,"offset":2149},"end":{"line":63,"column":104,"offset":2249},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-add-items-manually.png","alt":"Enter list items manually","position":{"start":{"line":65,"column":3,"offset":2253},"end":{"line":65,"column":74,"offset":2324},"indent":[]}}],"position":{"start":{"line":65,"column":3,"offset":2253},"end":{"line":65,"column":74,"offset":2324},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":2146},"end":{"line":66,"column":1,"offset":2325},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"As you enter information into a text input, a new row of inputs displays below the current one.","position":{"start":{"line":67,"column":4,"offset":2329},"end":{"line":67,"column":99,"offset":2424},"indent":[]}}],"position":{"start":{"line":67,"column":4,"offset":2329},"end":{"line":67,"column":99,"offset":2424},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To delete any of the IP addresses that you have entered, click ","position":{"start":{"line":69,"column":3,"offset":2428},"end":{"line":69,"column":66,"offset":2491},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"X","position":{"start":{"line":69,"column":68,"offset":2493},"end":{"line":69,"column":69,"offset":2494},"indent":[]}}],"position":{"start":{"line":69,"column":66,"offset":2491},"end":{"line":69,"column":71,"offset":2496},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":69,"column":71,"offset":2496},"end":{"line":69,"column":72,"offset":2497},"indent":[]}}],"position":{"start":{"line":69,"column":3,"offset":2428},"end":{"line":69,"column":72,"offset":2497},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":2326},"end":{"line":70,"column":1,"offset":2498},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":71,"column":4,"offset":2502},"end":{"line":71,"column":10,"offset":2508},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add to list","position":{"start":{"line":71,"column":12,"offset":2510},"end":{"line":71,"column":23,"offset":2521},"indent":[]}}],"position":{"start":{"line":71,"column":10,"offset":2508},"end":{"line":71,"column":25,"offset":2523},"indent":[]}},{"type":"text","value":" to add the new items.","position":{"start":{"line":71,"column":25,"offset":2523},"end":{"line":71,"column":47,"offset":2545},"indent":[]}}],"position":{"start":{"line":71,"column":4,"offset":2502},"end":{"line":71,"column":47,"offset":2545},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":2499},"end":{"line":71,"column":47,"offset":2545},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":2146},"end":{"line":71,"column":47,"offset":2545},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The updated list displays.","position":{"start":{"line":73,"column":1,"offset":2547},"end":{"line":73,"column":27,"offset":2573},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":2547},"end":{"line":73,"column":27,"offset":2573},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Add items in CSV format","position":{"start":{"line":75,"column":5,"offset":2579},"end":{"line":75,"column":28,"offset":2602},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":2575},"end":{"line":75,"column":28,"offset":2602},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":77,"column":1,"offset":2604},"end":{"line":77,"column":42,"offset":2645},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Importing a CSV file to a list only updates descriptions or adds items to the list. It does not delete items from a list.","position":{"start":{"line":79,"column":1,"offset":2647},"end":{"line":79,"column":122,"offset":2768},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":2647},"end":{"line":79,"column":122,"offset":2768},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you need to replace the entire contents of a list, format the data as an array and use the Update Lists operation in the ","position":{"start":{"line":81,"column":1,"offset":2770},"end":{"line":81,"column":125,"offset":2894},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-lists/endpoints","children":[{"type":"text","value":"Lists API","position":{"start":{"line":81,"column":126,"offset":2895},"end":{"line":81,"column":135,"offset":2904},"indent":[]}}],"position":{"start":{"line":81,"column":125,"offset":2894},"end":{"line":81,"column":161,"offset":2930},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":81,"column":161,"offset":2930},"end":{"line":81,"column":162,"offset":2931},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":2770},"end":{"line":81,"column":162,"offset":2931},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":83,"column":1,"offset":2933},"end":{"line":83,"column":9,"offset":2941},"indent":[]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"Use valid CSV file format","position":{"start":{"line":85,"column":6,"offset":2948},"end":{"line":85,"column":31,"offset":2973},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":2943},"end":{"line":85,"column":31,"offset":2973},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When uploading a CSV file containing a list of IP addresses and optional descriptions, be sure that each item is on its own line, as in this example:","position":{"start":{"line":87,"column":1,"offset":2975},"end":{"line":87,"column":150,"offset":3124},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":2975},"end":{"line":87,"column":150,"offset":3124},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"IP-address,description\nIP-address","position":{"start":{"line":89,"column":1,"offset":3126},"end":{"line":92,"column":4,"offset":3170},"indent":[1,1,1]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"Upload a CSV file","position":{"start":{"line":94,"column":6,"offset":3177},"end":{"line":94,"column":23,"offset":3194},"indent":[]}}],"position":{"start":{"line":94,"column":1,"offset":3172},"end":{"line":94,"column":23,"offset":3194},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To add items to an IP List by uploading a CSV file:","position":{"start":{"line":96,"column":1,"offset":3196},"end":{"line":96,"column":52,"offset":3247},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":3196},"end":{"line":96,"column":52,"offset":3247},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":98,"column":4,"offset":3252},"end":{"line":98,"column":11,"offset":3259},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add items to list","position":{"start":{"line":98,"column":13,"offset":3261},"end":{"line":98,"column":30,"offset":3278},"indent":[]}}],"position":{"start":{"line":98,"column":11,"offset":3259},"end":{"line":98,"column":32,"offset":3280},"indent":[]}},{"type":"text","value":" page, click ","position":{"start":{"line":98,"column":32,"offset":3280},"end":{"line":98,"column":45,"offset":3293},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Upload CSV","position":{"start":{"line":98,"column":47,"offset":3295},"end":{"line":98,"column":57,"offset":3305},"indent":[]}}],"position":{"start":{"line":98,"column":45,"offset":3293},"end":{"line":98,"column":59,"offset":3307},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":98,"column":59,"offset":3307},"end":{"line":98,"column":60,"offset":3308},"indent":[]}}],"position":{"start":{"line":98,"column":4,"offset":3252},"end":{"line":98,"column":60,"offset":3308},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Your operating system's file browser dialog displays.","position":{"start":{"line":100,"column":3,"offset":3312},"end":{"line":100,"column":56,"offset":3365},"indent":[]}}],"position":{"start":{"line":100,"column":3,"offset":3312},"end":{"line":100,"column":56,"offset":3365},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":3249},"end":{"line":101,"column":1,"offset":3366},"indent":[1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Browse to the location of the CSV file, select it, and click ","position":{"start":{"line":102,"column":4,"offset":3370},"end":{"line":102,"column":65,"offset":3431},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Open","position":{"start":{"line":102,"column":67,"offset":3433},"end":{"line":102,"column":71,"offset":3437},"indent":[]}}],"position":{"start":{"line":102,"column":65,"offset":3431},"end":{"line":102,"column":73,"offset":3439},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":102,"column":73,"offset":3439},"end":{"line":102,"column":74,"offset":3440},"indent":[]}}],"position":{"start":{"line":102,"column":4,"offset":3370},"end":{"line":102,"column":74,"offset":3440},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":104,"column":3,"offset":3444},"end":{"line":104,"column":7,"offset":3448},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add items to list","position":{"start":{"line":104,"column":9,"offset":3450},"end":{"line":104,"column":26,"offset":3467},"indent":[]}}],"position":{"start":{"line":104,"column":7,"offset":3448},"end":{"line":104,"column":28,"offset":3469},"indent":[]}},{"type":"text","value":" page updates to include the items from the CSV file:","position":{"start":{"line":104,"column":28,"offset":3469},"end":{"line":104,"column":81,"offset":3522},"indent":[]}}],"position":{"start":{"line":104,"column":3,"offset":3444},"end":{"line":104,"column":81,"offset":3522},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-add-items-csv.png","alt":"CSV items shown in Add items page","position":{"start":{"line":106,"column":3,"offset":3526},"end":{"line":106,"column":77,"offset":3600},"indent":[]}}],"position":{"start":{"line":106,"column":3,"offset":3526},"end":{"line":106,"column":77,"offset":3600},"indent":[]}}],"position":{"start":{"line":102,"column":1,"offset":3367},"end":{"line":107,"column":1,"offset":3601},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can continue to edit the items in the list before adding them:","position":{"start":{"line":108,"column":4,"offset":3605},"end":{"line":108,"column":70,"offset":3671},"indent":[]}}],"position":{"start":{"line":108,"column":4,"offset":3605},"end":{"line":108,"column":70,"offset":3671},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3602},"end":{"line":108,"column":70,"offset":3671},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":3249},"end":{"line":108,"column":70,"offset":3671},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To delete any of the IP addresses that you have entered, click ","position":{"start":{"line":110,"column":5,"offset":3677},"end":{"line":110,"column":68,"offset":3740},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"X","position":{"start":{"line":110,"column":70,"offset":3742},"end":{"line":110,"column":71,"offset":3743},"indent":[]}}],"position":{"start":{"line":110,"column":68,"offset":3740},"end":{"line":110,"column":73,"offset":3745},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":110,"column":73,"offset":3745},"end":{"line":110,"column":74,"offset":3746},"indent":[]}}],"position":{"start":{"line":110,"column":5,"offset":3677},"end":{"line":110,"column":74,"offset":3746},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":3673},"end":{"line":110,"column":74,"offset":3746},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To add extra IP addresses manually, enter the information in the text inputs.","position":{"start":{"line":111,"column":5,"offset":3751},"end":{"line":111,"column":82,"offset":3828},"indent":[]}}],"position":{"start":{"line":111,"column":5,"offset":3751},"end":{"line":111,"column":82,"offset":3828},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":3747},"end":{"line":111,"column":82,"offset":3828},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":3673},"end":{"line":111,"column":82,"offset":3828},"indent":[1]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":113,"column":4,"offset":3833},"end":{"line":113,"column":10,"offset":3839},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Add to list","position":{"start":{"line":113,"column":12,"offset":3841},"end":{"line":113,"column":23,"offset":3852},"indent":[]}}],"position":{"start":{"line":113,"column":10,"offset":3839},"end":{"line":113,"column":25,"offset":3854},"indent":[]}},{"type":"text","value":" to add the new items to your list.","position":{"start":{"line":113,"column":25,"offset":3854},"end":{"line":113,"column":60,"offset":3889},"indent":[]}}],"position":{"start":{"line":113,"column":4,"offset":3833},"end":{"line":113,"column":60,"offset":3889},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":3830},"end":{"line":113,"column":60,"offset":3889},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":3830},"end":{"line":113,"column":60,"offset":3889},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The updated list displays.","position":{"start":{"line":115,"column":1,"offset":3891},"end":{"line":115,"column":27,"offset":3917},"indent":[]}}],"position":{"start":{"line":115,"column":1,"offset":3891},"end":{"line":115,"column":27,"offset":3917},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":117,"column":1,"offset":3919},"end":{"line":117,"column":42,"offset":3960},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When uploading CSV data, keep in mind that duplicate data is treated as follows:","position":{"start":{"line":119,"column":1,"offset":3962},"end":{"line":119,"column":81,"offset":4042},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":3962},"end":{"line":119,"column":81,"offset":4042},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"IP addresses that were already in the list are updated with the description from the CSV file.","position":{"start":{"line":121,"column":3,"offset":4046},"end":{"line":121,"column":97,"offset":4140},"indent":[]}}],"position":{"start":{"line":121,"column":3,"offset":4046},"end":{"line":121,"column":97,"offset":4140},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":4044},"end":{"line":121,"column":97,"offset":4140},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"IP addresses in the CSV file that were not already in the list are added to the list.","position":{"start":{"line":122,"column":3,"offset":4143},"end":{"line":122,"column":88,"offset":4228},"indent":[]}}],"position":{"start":{"line":122,"column":3,"offset":4143},"end":{"line":122,"column":88,"offset":4228},"indent":[]}}],"position":{"start":{"line":122,"column":1,"offset":4141},"end":{"line":122,"column":88,"offset":4228},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":4044},"end":{"line":122,"column":88,"offset":4228},"indent":[1]}},{"type":"html","value":"</Aside>","position":{"start":{"line":124,"column":1,"offset":4230},"end":{"line":124,"column":9,"offset":4238},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Delete items from a list","position":{"start":{"line":126,"column":4,"offset":4243},"end":{"line":126,"column":28,"offset":4267},"indent":[]}}],"position":{"start":{"line":126,"column":1,"offset":4240},"end":{"line":126,"column":28,"offset":4267},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/","children":[{"type":"text","value":"Access the Lists interface","position":{"start":{"line":128,"column":5,"offset":4273},"end":{"line":128,"column":31,"offset":4299},"indent":[]}}],"position":{"start":{"line":128,"column":4,"offset":4272},"end":{"line":128,"column":60,"offset":4328},"indent":[]}},{"type":"text","value":" available at ","position":{"start":{"line":128,"column":60,"offset":4328},"end":{"line":128,"column":74,"offset":4342},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Configurations","position":{"start":{"line":128,"column":76,"offset":4344},"end":{"line":128,"column":90,"offset":4358},"indent":[]}}],"position":{"start":{"line":128,"column":74,"offset":4342},"end":{"line":128,"column":92,"offset":4360},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":128,"column":92,"offset":4360},"end":{"line":128,"column":95,"offset":4363},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Lists","position":{"start":{"line":128,"column":97,"offset":4365},"end":{"line":128,"column":102,"offset":4370},"indent":[]}}],"position":{"start":{"line":128,"column":95,"offset":4363},"end":{"line":128,"column":104,"offset":4372},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":128,"column":104,"offset":4372},"end":{"line":128,"column":105,"offset":4373},"indent":[]}}],"position":{"start":{"line":128,"column":4,"offset":4272},"end":{"line":128,"column":105,"offset":4373},"indent":[]}}],"position":{"start":{"line":128,"column":1,"offset":4269},"end":{"line":129,"column":1,"offset":4374},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":130,"column":4,"offset":4378},"end":{"line":130,"column":14,"offset":4388},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":130,"column":16,"offset":4390},"end":{"line":130,"column":20,"offset":4394},"indent":[]}}],"position":{"start":{"line":130,"column":14,"offset":4388},"end":{"line":130,"column":22,"offset":4396},"indent":[]}},{"type":"text","value":" link associated with list from which you want to delete.","position":{"start":{"line":130,"column":22,"offset":4396},"end":{"line":130,"column":79,"offset":4453},"indent":[]}}],"position":{"start":{"line":130,"column":4,"offset":4378},"end":{"line":130,"column":79,"offset":4453},"indent":[]}}],"position":{"start":{"line":130,"column":1,"offset":4375},"end":{"line":131,"column":1,"offset":4454},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Select the checkboxes next to the items that you want to delete. To select all the items, use the checkbox in the column header:","position":{"start":{"line":132,"column":4,"offset":4458},"end":{"line":132,"column":132,"offset":4586},"indent":[]}}],"position":{"start":{"line":132,"column":4,"offset":4458},"end":{"line":132,"column":132,"offset":4586},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/lists-delete-items.png","alt":"Delete items from list","position":{"start":{"line":134,"column":3,"offset":4590},"end":{"line":134,"column":65,"offset":4652},"indent":[]}}],"position":{"start":{"line":134,"column":3,"offset":4590},"end":{"line":134,"column":65,"offset":4652},"indent":[]}}],"position":{"start":{"line":132,"column":1,"offset":4455},"end":{"line":135,"column":1,"offset":4653},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":136,"column":4,"offset":4657},"end":{"line":136,"column":10,"offset":4663},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Remove","position":{"start":{"line":136,"column":12,"offset":4665},"end":{"line":136,"column":18,"offset":4671},"indent":[]}}],"position":{"start":{"line":136,"column":10,"offset":4663},"end":{"line":136,"column":20,"offset":4673},"indent":[]}},{"type":"text","value":" to delete the selected items from the list.","position":{"start":{"line":136,"column":20,"offset":4673},"end":{"line":136,"column":64,"offset":4717},"indent":[]}}],"position":{"start":{"line":136,"column":4,"offset":4657},"end":{"line":136,"column":64,"offset":4717},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":4654},"end":{"line":137,"column":1,"offset":4718},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":138,"column":4,"offset":4722},"end":{"line":138,"column":10,"offset":4728},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Remove","position":{"start":{"line":138,"column":12,"offset":4730},"end":{"line":138,"column":18,"offset":4736},"indent":[]}}],"position":{"start":{"line":138,"column":10,"offset":4728},"end":{"line":138,"column":20,"offset":4738},"indent":[]}},{"type":"text","value":" in the confirmation dialog.","position":{"start":{"line":138,"column":20,"offset":4738},"end":{"line":138,"column":48,"offset":4766},"indent":[]}}],"position":{"start":{"line":138,"column":4,"offset":4722},"end":{"line":138,"column":48,"offset":4766},"indent":[]}}],"position":{"start":{"line":138,"column":1,"offset":4719},"end":{"line":138,"column":48,"offset":4766},"indent":[]}}],"position":{"start":{"line":128,"column":1,"offset":4269},"end":{"line":138,"column":48,"offset":4766},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The updated list displays.","position":{"start":{"line":140,"column":1,"offset":4768},"end":{"line":140,"column":27,"offset":4794},"indent":[]}}],"position":{"start":{"line":140,"column":1,"offset":4768},"end":{"line":140,"column":27,"offset":4794},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":143,"column":70,"offset":4866}}}}},{"node":{"fields":{"slug":"/cf-dashboard/rules-lists/use-lists-in-expressions"},"frontmatter":{"order":370,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Use lists in expressions"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Use lists in expressions","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":27,"offset":27},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":27,"offset":27},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":4,"column":4,"offset":32},"end":{"line":4,"column":22,"offset":50},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":29},"end":{"line":4,"column":22,"offset":50},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To use an IP List in the ","position":{"start":{"line":6,"column":1,"offset":52},"end":{"line":6,"column":26,"offset":77},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules/","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":6,"column":27,"offset":78},"end":{"line":6,"column":45,"offset":96},"indent":[]}}],"position":{"start":{"line":6,"column":26,"offset":77},"end":{"line":6,"column":87,"offset":138},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":6,"column":87,"offset":138},"end":{"line":6,"column":88,"offset":139},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":52},"end":{"line":6,"column":88,"offset":139},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Select ","position":{"start":{"line":8,"column":4,"offset":144},"end":{"line":8,"column":11,"offset":151},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"is in list","position":{"start":{"line":8,"column":12,"offset":152},"end":{"line":8,"column":22,"offset":162},"indent":[]}}],"position":{"start":{"line":8,"column":11,"offset":151},"end":{"line":8,"column":23,"offset":163},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":8,"column":23,"offset":163},"end":{"line":8,"column":27,"offset":167},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"is not in list","position":{"start":{"line":8,"column":28,"offset":168},"end":{"line":8,"column":42,"offset":182},"indent":[]}}],"position":{"start":{"line":8,"column":27,"offset":167},"end":{"line":8,"column":43,"offset":183},"indent":[]}},{"type":"text","value":" from the ","position":{"start":{"line":8,"column":43,"offset":183},"end":{"line":8,"column":53,"offset":193},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Operator","position":{"start":{"line":8,"column":55,"offset":195},"end":{"line":8,"column":63,"offset":203},"indent":[]}}],"position":{"start":{"line":8,"column":53,"offset":193},"end":{"line":8,"column":65,"offset":205},"indent":[]}},{"type":"text","value":" drop-down list.","position":{"start":{"line":8,"column":65,"offset":205},"end":{"line":8,"column":81,"offset":221},"indent":[]}}],"position":{"start":{"line":8,"column":4,"offset":144},"end":{"line":8,"column":81,"offset":221},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../images/cf-open-proxies-list.png","alt":"Managed open proxies list","position":{"start":{"line":10,"column":4,"offset":226},"end":{"line":10,"column":71,"offset":293},"indent":[]}}],"position":{"start":{"line":10,"column":4,"offset":226},"end":{"line":10,"column":71,"offset":293},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":141},"end":{"line":11,"column":1,"offset":294},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Select an IP List from the ","position":{"start":{"line":12,"column":4,"offset":298},"end":{"line":12,"column":31,"offset":325},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Value","position":{"start":{"line":12,"column":33,"offset":327},"end":{"line":12,"column":38,"offset":332},"indent":[]}}],"position":{"start":{"line":12,"column":31,"offset":325},"end":{"line":12,"column":40,"offset":334},"indent":[]}},{"type":"text","value":" drop-down list.","position":{"start":{"line":12,"column":40,"offset":334},"end":{"line":12,"column":56,"offset":350},"indent":[]}}],"position":{"start":{"line":12,"column":4,"offset":298},"end":{"line":12,"column":56,"offset":350},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":295},"end":{"line":13,"column":1,"offset":351},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When you are done composing your rule, click ","position":{"start":{"line":14,"column":4,"offset":355},"end":{"line":14,"column":49,"offset":400},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Deploy","position":{"start":{"line":14,"column":51,"offset":402},"end":{"line":14,"column":57,"offset":408},"indent":[]}}],"position":{"start":{"line":14,"column":49,"offset":400},"end":{"line":14,"column":59,"offset":410},"indent":[]}},{"type":"text","value":" to commit your changes and enable your rule. Click ","position":{"start":{"line":14,"column":59,"offset":410},"end":{"line":14,"column":111,"offset":462},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Save as draft","position":{"start":{"line":14,"column":113,"offset":464},"end":{"line":14,"column":126,"offset":477},"indent":[]}}],"position":{"start":{"line":14,"column":111,"offset":462},"end":{"line":14,"column":128,"offset":479},"indent":[]}},{"type":"text","value":" if you are not ready to enable the rule.","position":{"start":{"line":14,"column":128,"offset":479},"end":{"line":14,"column":169,"offset":520},"indent":[]}}],"position":{"start":{"line":14,"column":4,"offset":355},"end":{"line":14,"column":169,"offset":520},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":352},"end":{"line":14,"column":169,"offset":520},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":141},"end":{"line":14,"column":169,"offset":520},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":16,"column":4,"offset":525},"end":{"line":16,"column":21,"offset":542},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":522},"end":{"line":16,"column":21,"offset":542},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To use an IP List in the ","position":{"start":{"line":18,"column":1,"offset":544},"end":{"line":18,"column":26,"offset":569},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/expression-preview-editor","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":18,"column":27,"offset":570},"end":{"line":18,"column":44,"offset":587},"indent":[]}}],"position":{"start":{"line":18,"column":26,"offset":569},"end":{"line":18,"column":86,"offset":629},"indent":[]}},{"type":"text","value":" specify the ","position":{"start":{"line":18,"column":86,"offset":629},"end":{"line":18,"column":99,"offset":642},"indent":[]}},{"type":"inlineCode","value":"in","position":{"start":{"line":18,"column":99,"offset":642},"end":{"line":18,"column":103,"offset":646},"indent":[]}},{"type":"text","value":" operator and use ","position":{"start":{"line":18,"column":103,"offset":646},"end":{"line":18,"column":121,"offset":664},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"\\$<list_name>","position":{"start":{"line":18,"column":122,"offset":665},"end":{"line":18,"column":135,"offset":678},"indent":[]}}],"position":{"start":{"line":18,"column":121,"offset":664},"end":{"line":18,"column":136,"offset":679},"indent":[]}},{"type":"text","value":" to specify the name of the list.","position":{"start":{"line":18,"column":136,"offset":679},"end":{"line":18,"column":169,"offset":712},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":544},"end":{"line":18,"column":169,"offset":712},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This expression filters requests from IP addresses that are in an IP List named ","position":{"start":{"line":20,"column":1,"offset":714},"end":{"line":20,"column":81,"offset":794},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"office_network","position":{"start":{"line":20,"column":82,"offset":795},"end":{"line":20,"column":96,"offset":809},"indent":[]}}],"position":{"start":{"line":20,"column":81,"offset":794},"end":{"line":20,"column":97,"offset":810},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":20,"column":97,"offset":810},"end":{"line":20,"column":98,"offset":811},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":714},"end":{"line":20,"column":98,"offset":811},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(ip.src in $office_network)","position":{"start":{"line":22,"column":1,"offset":813},"end":{"line":24,"column":4,"offset":851},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note that names for IP Lists can only include lowercase letters, numbers, and the underscore (","position":{"start":{"line":26,"column":1,"offset":853},"end":{"line":26,"column":95,"offset":947},"indent":[]}},{"type":"inlineCode","value":"_","position":{"start":{"line":26,"column":95,"offset":947},"end":{"line":26,"column":98,"offset":950},"indent":[]}},{"type":"text","value":") character.","position":{"start":{"line":26,"column":98,"offset":950},"end":{"line":26,"column":110,"offset":962},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":853},"end":{"line":26,"column":110,"offset":962},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more on creating lists, refer to ","position":{"start":{"line":28,"column":1,"offset":964},"end":{"line":28,"column":38,"offset":1001},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists/manage-lists","children":[{"type":"text","value":"Use IP Lists: Manage lists","position":{"start":{"line":28,"column":39,"offset":1002},"end":{"line":28,"column":65,"offset":1028},"indent":[]}}],"position":{"start":{"line":28,"column":38,"offset":1001},"end":{"line":28,"column":106,"offset":1069},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":28,"column":106,"offset":1069},"end":{"line":28,"column":107,"offset":1070},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":964},"end":{"line":28,"column":107,"offset":1070},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To create a new rule via API using the Cloudflare Open Proxies Managed List, use the following expression:","position":{"start":{"line":30,"column":1,"offset":1072},"end":{"line":30,"column":107,"offset":1178},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1072},"end":{"line":30,"column":107,"offset":1178},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"(ip.src in $cf.open_proxies)","position":{"start":{"line":32,"column":1,"offset":1180},"end":{"line":34,"column":4,"offset":1219},"indent":[1,1]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":36,"column":1,"offset":1221},"end":{"line":36,"column":42,"offset":1262},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to the Open Proxy List requires a Cloudflare Enterprise plan.","position":{"start":{"line":38,"column":1,"offset":1264},"end":{"line":38,"column":69,"offset":1332},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1264},"end":{"line":38,"column":69,"offset":1332},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":40,"column":1,"offset":1334},"end":{"line":40,"column":9,"offset":1342},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":43,"column":70,"offset":1414}}}}},{"node":{"fields":{"slug":"/api/call-sequence"},"frontmatter":{"order":497,"title":"Call sequence","summary":null,"demo":null,"tags":null},"headings":[{"value":"Call sequence"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Call sequence","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":16,"offset":16},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":16,"offset":16},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The API call examples in this site illustrate the ","position":{"start":{"line":4,"column":1,"offset":18},"end":{"line":4,"column":51,"offset":68},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"recommended sequence","position":{"start":{"line":4,"column":53,"offset":70},"end":{"line":4,"column":73,"offset":90},"indent":[]}}],"position":{"start":{"line":4,"column":51,"offset":68},"end":{"line":4,"column":75,"offset":92},"indent":[]}},{"type":"text","value":" of calling the two APIs (","position":{"start":{"line":4,"column":75,"offset":92},"end":{"line":4,"column":101,"offset":118},"indent":[]}},{"type":"inlineCode","value":"/filters","position":{"start":{"line":4,"column":101,"offset":118},"end":{"line":4,"column":111,"offset":128},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":4,"column":111,"offset":128},"end":{"line":4,"column":116,"offset":133},"indent":[]}},{"type":"inlineCode","value":"/firewall/rules","position":{"start":{"line":4,"column":116,"offset":133},"end":{"line":4,"column":133,"offset":150},"indent":[]}},{"type":"text","value":").","position":{"start":{"line":4,"column":133,"offset":150},"end":{"line":4,"column":135,"offset":152},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":18},"end":{"line":4,"column":135,"offset":152},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The image below depicts this sequence, which can be applied for creating and editing rules. The reverse would apply for delete operations.","position":{"start":{"line":6,"column":1,"offset":154},"end":{"line":6,"column":139,"offset":292},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":154},"end":{"line":6,"column":139,"offset":292},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/recommended-flow.png","alt":"Recommended flow","position":{"start":{"line":8,"column":1,"offset":294},"end":{"line":8,"column":52,"offset":345},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":294},"end":{"line":8,"column":52,"offset":345},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare recommends this sequence because it facilitates filter reusability and allows working with either API independently. Thanks to the standalone nature of Cloudflare Filters, the same filter can be shared in multiple Firewall Rules as well as in other future Cloudflare products and features.","position":{"start":{"line":10,"column":1,"offset":347},"end":{"line":10,"column":301,"offset":647},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":347},"end":{"line":10,"column":301,"offset":647},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, a filter that matches all traffic for your API (that is, ","position":{"start":{"line":12,"column":1,"offset":649},"end":{"line":12,"column":71,"offset":719},"indent":[]}},{"type":"inlineCode","value":"http.request.uri.path matches \"^/api/.*$\"","position":{"start":{"line":12,"column":71,"offset":719},"end":{"line":12,"column":114,"offset":762},"indent":[]}},{"type":"text","value":") may disable caching, disable human CAPTCHAs, configure JSON custom errors, and appear in a Firewall Rule. With the recommended sequence above, you would just repeat steps 3-6 for every Cloudflare feature to configure against the same filter created in steps 1-2.","position":{"start":{"line":12,"column":114,"offset":762},"end":{"line":12,"column":378,"offset":1026},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":649},"end":{"line":12,"column":378,"offset":1026},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"However, for a ","position":{"start":{"line":14,"column":1,"offset":1028},"end":{"line":14,"column":16,"offset":1043},"indent":[]}},{"type":"inlineCode","value":"POST","position":{"start":{"line":14,"column":16,"offset":1043},"end":{"line":14,"column":22,"offset":1049},"indent":[]}},{"type":"text","value":" operation, the ","position":{"start":{"line":14,"column":22,"offset":1049},"end":{"line":14,"column":38,"offset":1065},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"simplified sequence","position":{"start":{"line":14,"column":40,"offset":1067},"end":{"line":14,"column":59,"offset":1086},"indent":[]}}],"position":{"start":{"line":14,"column":38,"offset":1065},"end":{"line":14,"column":61,"offset":1088},"indent":[]}},{"type":"text","value":" — shown below — allows you to create both a filter and rule in the same call. In this case, the filter and rule only refer to each other.","position":{"start":{"line":14,"column":61,"offset":1088},"end":{"line":14,"column":199,"offset":1226},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":1028},"end":{"line":14,"column":199,"offset":1226},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/simple-flow.png","alt":"Simple flow","position":{"start":{"line":16,"column":1,"offset":1228},"end":{"line":16,"column":42,"offset":1269},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1228},"end":{"line":16,"column":42,"offset":1269},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In this sequence, a single ","position":{"start":{"line":18,"column":1,"offset":1271},"end":{"line":18,"column":28,"offset":1298},"indent":[]}},{"type":"inlineCode","value":"POST","position":{"start":{"line":18,"column":28,"offset":1298},"end":{"line":18,"column":34,"offset":1304},"indent":[]}},{"type":"text","value":" request to the ","position":{"start":{"line":18,"column":34,"offset":1304},"end":{"line":18,"column":50,"offset":1320},"indent":[]}},{"type":"inlineCode","value":"/firewall/rules","position":{"start":{"line":18,"column":50,"offset":1320},"end":{"line":18,"column":67,"offset":1337},"indent":[]}},{"type":"text","value":" endpoint takes the filter object in the JSON to create the filter in the Filters API (also via a ","position":{"start":{"line":18,"column":67,"offset":1337},"end":{"line":18,"column":165,"offset":1435},"indent":[]}},{"type":"inlineCode","value":"POST","position":{"start":{"line":18,"column":165,"offset":1435},"end":{"line":18,"column":171,"offset":1441},"indent":[]}},{"type":"text","value":" request). If successful, the Firewall Rule is created.","position":{"start":{"line":18,"column":171,"offset":1441},"end":{"line":18,"column":226,"offset":1496},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1271},"end":{"line":18,"column":226,"offset":1496},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Below is an example call and response using this method:","position":{"start":{"line":20,"column":1,"offset":1498},"end":{"line":20,"column":57,"offset":1554},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1498},"end":{"line":20,"column":57,"offset":1554},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X POST \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '[\n  {\n    \"filter\": {\n      \"expression\": \"http.request.uri.path contains \\\"/api/\\\" and ip.src eq 93.184.216.34\"\n    },\n    \"action\": \"block\"\n  }\n]' ","position":{"start":{"line":22,"column":1,"offset":1556},"end":{"line":39,"column":4,"offset":1928},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID>\",\n      \"paused\": false,\n      \"action\": \"block\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID>\",\n        \"expression\": \"http.request.uri.path contains \\\"/api/\\\" and ip.src eq 93.184.216.34\",\n        \"paused\": false\n      }\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":41,"column":1,"offset":1930},"end":{"line":63,"column":4,"offset":2323},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"However, this approach has some disadvantages:","position":{"start":{"line":65,"column":1,"offset":2325},"end":{"line":65,"column":47,"offset":2371},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":2325},"end":{"line":65,"column":47,"offset":2371},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules client has to implement error and exception handling for every potential failure occurring in both the Firewall Rules and the filters APIs.","position":{"start":{"line":67,"column":3,"offset":2375},"end":{"line":67,"column":161,"offset":2533},"indent":[]}}],"position":{"start":{"line":67,"column":3,"offset":2375},"end":{"line":67,"column":161,"offset":2533},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":2373},"end":{"line":67,"column":161,"offset":2533},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To protect against accidentally modifying or deleting filters used by other Cloudflare features, the ","position":{"start":{"line":68,"column":3,"offset":2536},"end":{"line":68,"column":104,"offset":2637},"indent":[]}},{"type":"inlineCode","value":"PUT","position":{"start":{"line":68,"column":104,"offset":2637},"end":{"line":68,"column":109,"offset":2642},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":68,"column":109,"offset":2642},"end":{"line":68,"column":113,"offset":2646},"indent":[]}},{"type":"inlineCode","value":"DELETE","position":{"start":{"line":68,"column":113,"offset":2646},"end":{"line":68,"column":121,"offset":2654},"indent":[]}},{"type":"text","value":" operations are not allowed.","position":{"start":{"line":68,"column":121,"offset":2654},"end":{"line":68,"column":149,"offset":2682},"indent":[]}}],"position":{"start":{"line":68,"column":3,"offset":2536},"end":{"line":68,"column":149,"offset":2682},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":2534},"end":{"line":68,"column":149,"offset":2682},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":2373},"end":{"line":68,"column":149,"offset":2682},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"By default, if either the filter or rule is invalid, neither will be created.","position":{"start":{"line":70,"column":1,"offset":2684},"end":{"line":70,"column":78,"offset":2761},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":2684},"end":{"line":70,"column":78,"offset":2761},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"However, one exception applies. If you have exceeded your rule quota, the filter could be created while creating the rule may fail. This is because the rule is created after the filter in the sequence diagram and so, we learn of the quota being exceeded after the filter was created.","position":{"start":{"line":72,"column":1,"offset":2763},"end":{"line":72,"column":284,"offset":3046},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":2763},"end":{"line":72,"column":284,"offset":3046},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"After you resolve the issue of exceeding your quota or requesting a feature that is unavailable to your zone, return to the recommended flow to create a rule that references the filter.","position":{"start":{"line":74,"column":1,"offset":3048},"end":{"line":74,"column":186,"offset":3233},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":3048},"end":{"line":74,"column":186,"offset":3233},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In summary, we strongly recommend the sequence with the two API calls. Limit your rule and filter creation using the simplified sequence for emergency situations, and only via ","position":{"start":{"line":76,"column":1,"offset":3235},"end":{"line":76,"column":177,"offset":3411},"indent":[]}},{"type":"inlineCode","value":"curl","position":{"start":{"line":76,"column":177,"offset":3411},"end":{"line":76,"column":183,"offset":3417},"indent":[]}},{"type":"text","value":" requests.","position":{"start":{"line":76,"column":183,"offset":3417},"end":{"line":76,"column":193,"offset":3427},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":3235},"end":{"line":76,"column":193,"offset":3427},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":79,"column":97,"offset":3526}}}}},{"node":{"fields":{"slug":"/cf-firewall-language/fields"},"frontmatter":{"order":610,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Fields"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Fields","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":9,"offset":9},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":9,"offset":9},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports a range of field types:","position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":72,"offset":82},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":72,"offset":82},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#standard-fields","children":[{"type":"text","value":"Standard fields","position":{"start":{"line":6,"column":4,"offset":87},"end":{"line":6,"column":19,"offset":102},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":86},"end":{"line":6,"column":38,"offset":121},"indent":[]}},{"type":"text","value":" represent common, typically static properties of an HTTP request.","position":{"start":{"line":6,"column":38,"offset":121},"end":{"line":6,"column":104,"offset":187},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":86},"end":{"line":6,"column":104,"offset":187},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":84},"end":{"line":6,"column":104,"offset":187},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#dynamic-fields","children":[{"type":"text","value":"Dynamic fields","position":{"start":{"line":7,"column":4,"offset":191},"end":{"line":7,"column":18,"offset":205},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":190},"end":{"line":7,"column":36,"offset":223},"indent":[]}},{"type":"text","value":" represent computed or derived values, typically related to Cloudflare threat intelligence about the request.","position":{"start":{"line":7,"column":36,"offset":223},"end":{"line":7,"column":145,"offset":332},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":190},"end":{"line":7,"column":145,"offset":332},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":188},"end":{"line":7,"column":145,"offset":332},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#uri-argument-and-value-fields","children":[{"type":"text","value":"URI argument and value fields","position":{"start":{"line":8,"column":4,"offset":336},"end":{"line":8,"column":33,"offset":365},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":335},"end":{"line":8,"column":66,"offset":398},"indent":[]}},{"type":"text","value":" are extracted from the request.","position":{"start":{"line":8,"column":66,"offset":398},"end":{"line":8,"column":98,"offset":430},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":335},"end":{"line":8,"column":98,"offset":430},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":333},"end":{"line":8,"column":98,"offset":430},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#http-header-fields","children":[{"type":"text","value":"HTTP header fields","position":{"start":{"line":9,"column":4,"offset":434},"end":{"line":9,"column":22,"offset":452},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":433},"end":{"line":9,"column":44,"offset":474},"indent":[]}},{"type":"text","value":" represent the names and values associated with HTTP request headers.","position":{"start":{"line":9,"column":44,"offset":474},"end":{"line":9,"column":113,"offset":543},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":433},"end":{"line":9,"column":113,"offset":543},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":431},"end":{"line":9,"column":113,"offset":543},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"#http-body-fields","children":[{"type":"text","value":"HTTP body fields","position":{"start":{"line":10,"column":4,"offset":547},"end":{"line":10,"column":20,"offset":563},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":546},"end":{"line":10,"column":40,"offset":583},"indent":[]}},{"type":"text","value":" represent the properties of an HTTP request body, including forms, for example.","position":{"start":{"line":10,"column":40,"offset":583},"end":{"line":10,"column":120,"offset":663},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":546},"end":{"line":10,"column":120,"offset":663},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":544},"end":{"line":10,"column":120,"offset":663},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":84},"end":{"line":10,"column":120,"offset":663},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Standard fields","position":{"start":{"line":12,"column":4,"offset":668},"end":{"line":12,"column":19,"offset":683},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":665},"end":{"line":12,"column":19,"offset":683},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Most standard fields use the same naming conventions as ","position":{"start":{"line":14,"column":1,"offset":685},"end":{"line":14,"column":57,"offset":741},"indent":[]}},{"type":"link","title":null,"url":"https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html","children":[{"type":"text","value":"Wireshark display fields","position":{"start":{"line":14,"column":58,"offset":742},"end":{"line":14,"column":82,"offset":766},"indent":[]}}],"position":{"start":{"line":14,"column":57,"offset":741},"end":{"line":14,"column":170,"offset":854},"indent":[]}},{"type":"text","value":". However, there are some subtle differences between Cloudflare and Wireshark:","position":{"start":{"line":14,"column":170,"offset":854},"end":{"line":14,"column":248,"offset":932},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":685},"end":{"line":14,"column":248,"offset":932},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Wireshark supports ","position":{"start":{"line":16,"column":3,"offset":936},"end":{"line":16,"column":22,"offset":955},"indent":[]}},{"type":"link","title":null,"url":"https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing","children":[{"type":"text","value":"CIDR (Classless Inter-Domain Routing) notation","position":{"start":{"line":16,"column":23,"offset":956},"end":{"line":16,"column":69,"offset":1002},"indent":[]}}],"position":{"start":{"line":16,"column":22,"offset":955},"end":{"line":16,"column":132,"offset":1065},"indent":[]}},{"type":"text","value":" for expressing IP address ranges in equality comparisons (","position":{"start":{"line":16,"column":132,"offset":1065},"end":{"line":16,"column":191,"offset":1124},"indent":[]}},{"type":"inlineCode","value":"ip.src == 1.2.3.0/24","position":{"start":{"line":16,"column":191,"offset":1124},"end":{"line":16,"column":213,"offset":1146},"indent":[]}},{"type":"text","value":", for example). Cloudflare does not.","position":{"start":{"line":16,"column":213,"offset":1146},"end":{"line":16,"column":249,"offset":1182},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":936},"end":{"line":16,"column":249,"offset":1182},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To evaluate a range of addresses using CIDR notation, use the ","position":{"start":{"line":18,"column":3,"offset":1186},"end":{"line":18,"column":65,"offset":1248},"indent":[]}},{"type":"inlineCode","value":"in","position":{"start":{"line":18,"column":65,"offset":1248},"end":{"line":18,"column":69,"offset":1252},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":18,"column":69,"offset":1252},"end":{"line":18,"column":70,"offset":1253},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators/#comparison-operators","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":18,"column":71,"offset":1254},"end":{"line":18,"column":90,"offset":1273},"indent":[]}}],"position":{"start":{"line":18,"column":70,"offset":1253},"end":{"line":18,"column":146,"offset":1329},"indent":[]}},{"type":"text","value":" as in this example: ","position":{"start":{"line":18,"column":146,"offset":1329},"end":{"line":18,"column":167,"offset":1350},"indent":[]}},{"type":"inlineCode","value":"ip.src in {1.2.3.0/24 4.5.6.0/24}","position":{"start":{"line":18,"column":167,"offset":1350},"end":{"line":18,"column":202,"offset":1385},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":18,"column":202,"offset":1385},"end":{"line":18,"column":203,"offset":1386},"indent":[]}}],"position":{"start":{"line":18,"column":3,"offset":1186},"end":{"line":18,"column":203,"offset":1386},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":934},"end":{"line":19,"column":1,"offset":1387},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In Wireshark, ","position":{"start":{"line":20,"column":3,"offset":1390},"end":{"line":20,"column":17,"offset":1404},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":20,"column":17,"offset":1404},"end":{"line":20,"column":22,"offset":1409},"indent":[]}},{"type":"text","value":" is a protocol field containing hundreds of other fields of various types that are available for comparison in multiple ways. However, in Firewall Rules ","position":{"start":{"line":20,"column":22,"offset":1409},"end":{"line":20,"column":175,"offset":1562},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":20,"column":175,"offset":1562},"end":{"line":20,"column":180,"offset":1567},"indent":[]}},{"type":"text","value":" is a single Boolean field that indicates whether the connection from the client to Cloudflare is encrypted.","position":{"start":{"line":20,"column":180,"offset":1567},"end":{"line":20,"column":288,"offset":1675},"indent":[]}}],"position":{"start":{"line":20,"column":3,"offset":1390},"end":{"line":20,"column":288,"offset":1675},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1388},"end":{"line":21,"column":1,"offset":1676},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language does not support the ","position":{"start":{"line":22,"column":3,"offset":1679},"end":{"line":22,"column":63,"offset":1739},"indent":[]}},{"type":"inlineCode","value":"slice","position":{"start":{"line":22,"column":63,"offset":1739},"end":{"line":22,"column":70,"offset":1746},"indent":[]}},{"type":"text","value":" operator.","position":{"start":{"line":22,"column":70,"offset":1746},"end":{"line":22,"column":80,"offset":1756},"indent":[]}}],"position":{"start":{"line":22,"column":3,"offset":1679},"end":{"line":22,"column":80,"offset":1756},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1677},"end":{"line":22,"column":80,"offset":1756},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":934},"end":{"line":22,"column":80,"offset":1756},"indent":[1,1,1,1,1,1]}},{"type":"html","value":"<Aside type='note' header=\"Availability notes\">","position":{"start":{"line":24,"column":1,"offset":1758},"end":{"line":24,"column":48,"offset":1805},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Access to ","position":{"start":{"line":26,"column":3,"offset":1809},"end":{"line":26,"column":13,"offset":1819},"indent":[]}},{"type":"inlineCode","value":"ip.geoip.is_in_european_union","position":{"start":{"line":26,"column":13,"offset":1819},"end":{"line":26,"column":44,"offset":1850},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":26,"column":44,"offset":1850},"end":{"line":26,"column":46,"offset":1852},"indent":[]}},{"type":"inlineCode","value":"ip.geoip.subdivision_1_iso_code","position":{"start":{"line":26,"column":46,"offset":1852},"end":{"line":26,"column":79,"offset":1885},"indent":[]}},{"type":"text","value":", and ","position":{"start":{"line":26,"column":79,"offset":1885},"end":{"line":26,"column":85,"offset":1891},"indent":[]}},{"type":"inlineCode","value":"ip.geoip.subdivision_2_iso_code","position":{"start":{"line":26,"column":85,"offset":1891},"end":{"line":26,"column":118,"offset":1924},"indent":[]}},{"type":"text","value":" fields requires a Cloudflare Business or Enterprise plan.","position":{"start":{"line":26,"column":118,"offset":1924},"end":{"line":26,"column":176,"offset":1982},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1809},"end":{"line":26,"column":176,"offset":1982},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1807},"end":{"line":27,"column":1,"offset":1983},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Access to ","position":{"start":{"line":28,"column":3,"offset":1986},"end":{"line":28,"column":13,"offset":1996},"indent":[]}},{"type":"inlineCode","value":"http.request.cookies","position":{"start":{"line":28,"column":13,"offset":1996},"end":{"line":28,"column":35,"offset":2018},"indent":[]}},{"type":"text","value":" field requires a Cloudflare Pro, Business, or Enterprise plan.","position":{"start":{"line":28,"column":35,"offset":2018},"end":{"line":28,"column":98,"offset":2081},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":1986},"end":{"line":28,"column":98,"offset":2081},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1984},"end":{"line":28,"column":98,"offset":2081},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1807},"end":{"line":28,"column":98,"offset":2081},"indent":[1,1]}},{"type":"html","value":"</Aside>","position":{"start":{"line":30,"column":1,"offset":2083},"end":{"line":30,"column":9,"offset":2091},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these standard fields:","position":{"start":{"line":32,"column":1,"offset":2093},"end":{"line":32,"column":71,"offset":2163},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2093},"end":{"line":32,"column":71,"offset":2163},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n    <tr>\n      <th style=\"width:50%\">Field</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n   <tr>\n      <td valign=\"top\"><code>http.cookie</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the entire cookie as a string.</p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">session=8521F670545D7865F79C3D7BEDC29CCE;-background=light</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.host</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the host name used in the full request URI.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">www.example.org</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.referer</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the HTTP Referer request header, which contains the address of the web page that linked to the currently requested page.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">Referer: htt&shy;ps://developer.example.org/en-US/docs/Web/JavaScript</code>\n         </p>\n      </td>\n   </tr>\n   <tr id=\"field-http-request-full-uri\">\n      <td valign=\"top\"><code>http.request.full_uri</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the full URI as received by the web server (does not include <code class=\"InlineCode\">#fragment</code>, which is not sent to web servers).\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">htt­ps://www.example.org/articles/index?section=539061&expand=comments</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.method</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the HTTP method, returned as a string of uppercase characters.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">GET</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.cookies</code><br /><Type>Map&lt;String&gt;&lt;Array&gt;</Type></td>\n      <td>\n         <p>Represents the <code class=\"InlineCode\">Cookie</code> HTTP header associated with a request as a Map (associative array).\n         </p>\n         <p>Cookie values are not pre-processed and retain the case used in the request.</p>\n         <p><em>Decoding:</em> Cookie names are URL decoded. If two cookies have the same name after decoding, their value arrays are merged.\n         </p>\n         <p>Example:\n         <br /><code class=\"InlineCode\">any(http.request.cookies[\"app\"][*] == \"test\")</code>\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">{'{\"app\": [\"test\"]}'}</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.timestamp.sec</code><br /><Type>Integer</Type></td>\n      <td>\n         <p>Represents the timestamp when Cloudflare received the request, expressed as Unix time in seconds. This value is 10 digits long.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">1484063137</code>\n         </p>\n         <p>When validating HMAC tokens in an expression, pass this field as the <em>currentTimestamp</em> argument to the <code class=\"InlineCode\">is_timed_hmac_valid_v0()</code> <a href=\"/cf-firewall-language/functions/#hmac-validation\">validation function</a>.\n         </p>\n      </td>\n   </tr>\n   <tr id=\"field-http-request-uri\">\n      <td valign=\"top\"><code>http.request.uri</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the URI path and query string of the request.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">/articles/index?section=539061&expand=comments</code>\n         </p>\n      </td>\n   </tr>\n   <tr id=\"field-http-request-uri-path\">\n      <td valign=\"top\"><code>http.request.uri.path</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the URI path of the request.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">/articles/index</code>\n         </p>\n      </td>\n   </tr>\n   <tr id=\"field-http-request-uri-query\">\n      <td valign=\"top\"><code class>http.request.uri.query</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the entire query string, without the <code class=\"InlineCode\">?</code> delimiter.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">section=539061&expand=comments</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.user_agent</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the HTTP user agent, a request header that contains a characteristic string to allow identification of the client operating system and web browser.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.version</code><br /><Type>Number</Type></td>\n      <td>\n         <p>Represents the version of the HTTP protocol used. Use this field when you require different checks for different versions.\n         </p>\n         <p>Example Values:\n            <ul>\n               <li><code class=\"InlineCode\">HTTP/1.1</code></li>\n               <li><code class=\"InlineCode\">HTTP/3</code></li>\n            </ul>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.x_forwarded_for</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the full <code class=\"InlineCode\">X-Forwarded-For</code> HTTP header.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">203.0.113.195, 70.41.3.18</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.src</code><br /><Type>IP&nbsp;address</Type></td>\n      <td>\n         <p> Represents the client TCP IP address, which may be adjusted to reflect the actual address of the client by using, for example, HTTP headers such as\n         <code class=\"InlineCode\">X-Forwarded-For</code> or <code class=\"InlineCode\">X-Real-IP</code>.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">93.184.216.34</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.src.lat</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the latitude associated with the client IP address.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">37.78044</code>\n         </p>\n         <p><strong>Note:</strong> This field is only available in <a href=\"https://developers.cloudflare.com/rules/transform\">Transform Rules</a>.</p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.src.lon</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the longitude associated with the client IP address.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">-122.39055</code>\n         </p>\n         <p><strong>Note:</strong> This field is only available in <a href=\"https://developers.cloudflare.com/rules/transform\">Transform Rules</a>.</p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.src.city</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the city associated with the client IP address.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">San Francisco</code>\n         </p>\n         <p><strong>Note:</strong> This field is only available in <a href=\"https://developers.cloudflare.com/rules/transform\">Transform Rules</a>.</p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.geoip.asnum</code><br /><Type>Number</Type></td>\n      <td>\n         <p>Represents the 16- or 32-bit integer representing the Autonomous System (AS) number associated with client IP address.\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.geoip.continent</code><br /><Type>String</Type></td>\n      <td>\n         Represents the continent code associated with client IP address:\n          <ul>\n              <li>AF &#8211; Africa</li>\n              <li>AN &#8211; Antarctica</li>\n              <li>AS &#8211; Asia</li>\n              <li>EU &#8211; Europe</li>\n              <li>NA &#8211; North America</li>\n              <li>OC &#8211; Oceania</li>\n              <li>SA &#8211; South America</li>\n              <li>T1 &#8211; Tor network</li>\n          </ul>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.geoip.country</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the 2-letter country code in <a href=\"https://www.iso.org/obp/ui/#search/code/\">ISO 3166-1 Alpha 2</a> format.\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">GB</code>\n         </p>\n         <p>For more information on the ISO 3166-1 Alpha 2 format, see <a href=\"https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2\">ISO 3166-1 Alpha 2</a> on Wikipedia.</p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.geoip.subdivision_1_iso_code</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the ISO 3166-2 code for the first level region associated with the IP address. When the actual value is not available, this field contains an empty string.</p>\n         <p>Example value:\n         <br />\n         <code class=\"InlineCode\">GB-ENG</code></p>\n         <p>For more information on the ISO 3166-2 standard and the available regions, see <a href=\"https://en.wikipedia.org/wiki/ISO_3166-2\">ISO 3166-2</a> on Wikipedia.</p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.geoip.subdivision_2_iso_code</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the ISO 3166-2 code for the second level region associated with the IP address. When the actual value is not available, this field contains an empty string.\n         </p>\n         <p>Example value:\n         <br />\n         <code class=\"InlineCode\">GB-SWK</code>\n         </p>\n         <p>For more information on the ISO 3166-2 standard and the available regions, see <a href=\"https://en.wikipedia.org/wiki/ISO_3166-2\">ISO 3166-2</a> on Wikipedia.</p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>ip.geoip.is_in_european_union</code><br /><Type>Boolean</Type></td>\n      <td>\n         <p>Returns <code class=\"InlineCode\">true</code> when the request originates from an EU country.\n         </p>\n      </td>\n  </tr>\n  <tr id=\"field-raw-http-request-full-uri\">\n    <td valign=\"top\"><code>raw.http.request.full_uri</code><br /><Type>String</Type></td>\n    <td>\n      <p>Similar to the <a href=\"#field-http-request-full-uri\"><code>http.request.full_uri</code></a> non-raw field. Represents the full URI as received by the web server without the URI fragment (if any) and without any transformation.\n      </p>\n      <p>Note: This raw field may include some basic normalization done by Cloudflare's HTTP server. However, this can change in the future.\n      </p>\n  </td>\n  </tr>\n  <tr id=\"field-raw-http-request-uri\">\n    <td valign=\"top\"><code>raw.http.request.uri</code><br /><Type>String</Type></td>\n    <td>\n      <p>Similar to the <a href=\"#field-http-request-uri\"><code>http.request.uri</code></a> non-raw field. Represents the URI path and query string of the request without any transformation.\n      </p>\n      <p>Note: This raw field may include some basic normalization done by Cloudflare's HTTP server. However, this can change in the future.\n      </p>\n    </td>\n  </tr>\n  <tr id=\"field-raw-http-request-uri-path\">\n    <td valign=\"top\"><code>raw.http.request.uri.path</code><br /><Type>String</Type></td>\n    <td>\n      <p>Similar to the <a href=\"#field-http-request-uri-path\"><code>http.request.uri.path</code></a> non-raw field. Represents the URI path of the request without any transformation.\n      </p>\n      <p>Note: This raw field may include some basic normalization done by Cloudflare's HTTP server. However, this can change in the future.\n      </p>\n    </td>\n  </tr>\n  <tr id=\"field-raw-http-request-uri-query\">\n    <td valign=\"top\"><code>raw.http.request.uri.query</code><br /><Type>String</Type></td>\n    <td>\n      <p>Similar to the <a href=\"#field-http-request-uri-query\"><code>http.request.uri.query</code></a> non-raw field. Represents the entire query string without the <code class=\"InlineCode\">?</code> delimiter and without any transformation.\n      </p>\n      <p>Note: This raw field may include some basic normalization done by Cloudflare's HTTP server. However, this can change in the future.\n      </p>\n    </td>\n  </tr>\n  <tr>\n      <td valign=\"top\"><code>ssl</code><br /><Type>Boolean</Type></td>\n      <td>\n         <p>Returns<code class=\"InlineCode\">true</code> when the HTTP connection to the client is encrypted.\n         </p>\n      </td>\n   </tr>\n  </tbody>\n</table>","position":{"start":{"line":34,"column":1,"offset":2165},"end":{"line":333,"column":9,"offset":15151},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Dynamic fields","position":{"start":{"line":335,"column":4,"offset":15156},"end":{"line":335,"column":18,"offset":15170},"indent":[]}}],"position":{"start":{"line":335,"column":1,"offset":15153},"end":{"line":335,"column":18,"offset":15170},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Dynamic fields represent computed or derived values, typically related to threat intelligence about an HTTP request.","position":{"start":{"line":337,"column":1,"offset":15172},"end":{"line":337,"column":117,"offset":15288},"indent":[]}}],"position":{"start":{"line":337,"column":1,"offset":15172},"end":{"line":337,"column":117,"offset":15288},"indent":[]}},{"type":"html","value":"<Aside type='note'>","position":{"start":{"line":339,"column":1,"offset":15290},"end":{"line":339,"column":20,"offset":15309},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to any fields containing ","position":{"start":{"line":341,"column":1,"offset":15311},"end":{"line":341,"column":33,"offset":15343},"indent":[]}},{"type":"inlineCode","value":"cf.bot_management","position":{"start":{"line":341,"column":33,"offset":15343},"end":{"line":341,"column":52,"offset":15362},"indent":[]}},{"type":"text","value":" requires a Cloudflare Enterprise plan with ","position":{"start":{"line":341,"column":52,"offset":15362},"end":{"line":341,"column":96,"offset":15406},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/bots/plans/bm-subscription","children":[{"type":"text","value":"Bot Management","position":{"start":{"line":341,"column":97,"offset":15407},"end":{"line":341,"column":111,"offset":15421},"indent":[]}}],"position":{"start":{"line":341,"column":96,"offset":15406},"end":{"line":341,"column":174,"offset":15484},"indent":[]}},{"type":"text","value":" enabled.","position":{"start":{"line":341,"column":174,"offset":15484},"end":{"line":341,"column":183,"offset":15493},"indent":[]}}],"position":{"start":{"line":341,"column":1,"offset":15311},"end":{"line":341,"column":183,"offset":15493},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":343,"column":1,"offset":15495},"end":{"line":343,"column":9,"offset":15503},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these dynamic fields:","position":{"start":{"line":345,"column":1,"offset":15505},"end":{"line":345,"column":70,"offset":15574},"indent":[]}}],"position":{"start":{"line":345,"column":1,"offset":15505},"end":{"line":345,"column":70,"offset":15574},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n   <tr>\n      <th style=\"width: 50%;\">Field Name</th>\n      <th>Description</th>\n   </tr>\n  </thead>\n  <tbody style='vertical-align:top'>\n    <tr>\n        <td><p><code>cf.bot_management.verified_bot</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n          <p>When <code class=\"InlineCode\">true</code>, this field indicates the request originated from a known good bot or crawler. Provides the same information as <code class=\"InlineCode\">cf.client.bot</code>.\n          </p>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>cf.bot_management.score</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n          <p>Represents the likelihood that a request originates from a bot using a score from 1&#8211;99.\n          </p>\n          <p>A low score indicates that the request comes from a bot or an automated agent. A high score indicates that a human issued the request.\n          </p>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>cf.bot_management.ja3_hash</code><br /><Type>string</Type></p>\n        </td>\n        <td>\n          <p>Provides an SSL/TLS fingerprint to help you identify potential bot requests.\n          </p>\n          <p>For more details, refer to <a href=\"https://developers.cloudflare.com/bots/concepts/ja3-fingerprint\">JA3 Fingerprints</a>.\n          </p>\n        </td>\n    </tr>\n    <tr>\n        <td><code>cf.client.bot</code><br /><Type>Boolean</Type></td>\n        <td>\n          <p>When <code class=\"InlineCode\">true</code>, this field indicates the request originated from a known good bot or crawler. Provides the same information as <code class=\"InlineCode\">cf.bot_management.verified_bot</code>.</p>\n        </td>\n    </tr>\n    <tr>\n        <td><code>cf.edge.server_ip</code><br /><Type>IP Address</Type></td>\n        <td>\n          <p>Represents the edge IP address to which the HTTP request has resolved to.\n          </p>\n          <p>This field is only meaningful for <a href=\"https://developers.cloudflare.com/byoip/\">BYOIP customers</a>.\n          </p>\n        </td>\n    </tr>\n    <tr>\n        <td><code>cf.edge.server_port</code><br /><Type>Number</Type></td>\n        <td>\n          <p>Represents the port number at which Cloudflare's network received the request.\n          </p>\n          <p>Use this field to filter traffic on a specific port. The value is a port number in the range 1–65535.</p>\n        </td>\n    </tr>\n    <tr>\n        <td><code>cf.threat_score</code><br /><Type>Number</Type></td>\n        <td>\n          <p>Represents a Cloudflare threat score from 0&#8211;100, where 0 indicates low risk. Values above 10 may represent spammers or bots, and values above 40 identify bad actors on the internet.\n          </p>\n          <p>It is rare to see values above 60. A common recommendation is to challenge requests with a score above 10 and to block those above 50.\n          </p>\n        </td>\n    </tr>\n    <tr>\n      <td><code>cf.tls_client_auth.cert_revoked</code><br /><Type>Boolean</Type></td>\n      <td>\n      <p>\n      Returns <code class=\"InlineCode\">true</code> when a request presents a valid but revoked client certificate.\n      </p>\n      <p>When <code class=\"InlineCode\">true</code>, the <code class=\"InlineCode\">cf.tls_client_auth.cert_verified</code> field is also <code class=\"InlineCode\">true</code>.\n      </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>cf.tls_client_auth.cert_verified</code><br /><Type>Boolean</Type></td>\n      <td>\n      <p>Returns <code class=\"InlineCode\">true</code> when a request presents a valid client certificate.\n      </p>\n      <p> Also returns <code class=\"InlineCode\">true</code> when a request includes a valid certificate that was revoked (see <code>cf.tls_client_auth.cert_revoked</code>).\n      </p></td>\n    </tr>\n    <tr>\n      <td><code>cf.worker.upstream_zone</code> <br /><Type>String</Type></td>\n      <td>\n        <p>Identifies whether a request comes from a worker or not.</p>\n        <p>When a request comes from a worker, this field will hold the name of the zone for that worker. Otherwise <code class=\"InlineCode\">cf.worker.upstream_zone</code> is empty</p>\n      </td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":347,"column":1,"offset":15576},"end":{"line":441,"column":9,"offset":19756},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Magic Firewall Fields","position":{"start":{"line":443,"column":4,"offset":19761},"end":{"line":443,"column":25,"offset":19782},"indent":[]}}],"position":{"start":{"line":443,"column":1,"offset":19758},"end":{"line":443,"column":25,"offset":19782},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n   <tr>\n      <th style=\"width: 50%;\">Field Name</th>\n      <th>Description</th>\n   </tr>\n  </thead>\n  <tbody style='vertical-align:top'>\n    <tr>\n        <td><p><code>cf.colo.name</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        The data center that is handling this traffic.  <br />\n        Example value: <code class=\"InlineCode\"> sfo06 </code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>cf.colo.region</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        Region of the data center that is handling this traffic. <br />\n        Example value: <code class=\"InlineCode\"> WNAM </code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>icmp</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        The raw ICMP packet as a list of bytes. It should be used in conjunction with the bit_slice function when other structured fields are lacking.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>icmp.type</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n         The <a href=\"https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol#header_type\">ICMP type</a>. Only applies to ICMP packets. <br />\n         Example value:\n         <code class=\"InlineCode\">8</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>icmp.code</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n         The <a href=\"https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol#header_code\">ICMP code</a>. Only applies to ICMP packets. <br />\n         Example value:\n         <code class=\"InlineCode\">2</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        The raw IP packet as a list of bytes. It should be used in conjunction with the bit_slice function when other structured fields are lacking.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.dst</code><br /><Type>IP Address</Type></p>\n        </td>\n        <td>\n         The destination address as specified in the IP packet. <br />\n         Example value:\n         <code class=\"InlineCode\">192.0.2.2</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.geoip.country</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n         Represents the 2-letter country code associated with the client IP address in <a href=\"https://www.iso.org/obp/ui/#search/code/\">ISO 3166-1 Alpha 2</a> format.<br />\n         Example value:\n         <code class=\"InlineCode\">GB</code>\n         <p>For more information on the ISO 3166-1 Alpha 2 format, see <a href=\"https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2\">ISO 3166-1 Alpha 2</a> on Wikipedia.</p>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.hdr_len</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n         The length of the IPv4 header in bytes. <br />\n         Example value:\n         <code class=\"InlineCode\">5</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.len</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n         The length of the packet including the header. <br />\n         Example value:\n         <code class=\"InlineCode\">60</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.opt.type</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n         The first byte of <a href=\"https://en.wikipedia.org/wiki/IPv4#Options\">IP options field</a>, if the options field is set. <br />\n         Example value:\n         <code class=\"InlineCode\">25</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.proto</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        The transport layer for the packet, if it can be determined. <br />\n        Example values: <code class=\"InlineCode\">icmp</code>, <code class=\"InlineCode\">tcp</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.src</code><br /><Type>IP Address</Type></p>\n        </td>\n        <td>\n        The source address of the IP Packet.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>ip.ttl</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n        The time-to-live of the IP Packet. <br />\n        Example values: <code class=\"InlineCode\">54</code>\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        The raw TCP packet as a list of bytes. It should be used in conjunction with the bit_slice function when other structured fields are lacking.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n        The numeric value of the TCP flags byte.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.ack</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP acknowledgment flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.cwr</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP congestion window reduced flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.ecn</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP ECN-Echo flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.fin</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP flag indicating this is the last packet from sender.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.push</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP push flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.reset</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP reset flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.syn</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP synchronize flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.flags.urg</code><br /><Type>Boolean</Type></p>\n        </td>\n        <td>\n        TCP urgent flag.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.srcport</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n        Source port number of the IP packet. Only applies to TCP packets.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>tcp.dstport</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n        Destination port number of the IP packet. Only applies to TCP packets.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>udp</code><br /><Type>String</Type></p>\n        </td>\n        <td>\n        The raw UDP packet as a list of bytes. It should be used in conjunction with the bit_slice function when other structured fields are lacking.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>udp.dstport</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n        Destination port number of the IP packet. Only applies to UDP packets.\n        </td>\n    </tr>\n    <tr>\n        <td><p><code>udp.srcport</code><br /><Type>Number</Type></p>\n        </td>\n        <td>\n        Source port number of the IP packet. Only applies to UDP packets.\n        </td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":445,"column":1,"offset":19784},"end":{"line":676,"column":9,"offset":26952},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"URI argument and value fields","position":{"start":{"line":678,"column":4,"offset":26957},"end":{"line":678,"column":33,"offset":26986},"indent":[]}}],"position":{"start":{"line":678,"column":1,"offset":26954},"end":{"line":678,"column":33,"offset":26986},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language includes URI argument and value fields associated with HTTP requests. Many of these fields return ","position":{"start":{"line":680,"column":1,"offset":26988},"end":{"line":680,"column":138,"offset":27125},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/values#arrays","children":[{"type":"text","value":"arrays","position":{"start":{"line":680,"column":139,"offset":27126},"end":{"line":680,"column":145,"offset":27132},"indent":[]}}],"position":{"start":{"line":680,"column":138,"offset":27125},"end":{"line":680,"column":183,"offset":27170},"indent":[]}},{"type":"text","value":" containing the respective values.","position":{"start":{"line":680,"column":183,"offset":27170},"end":{"line":680,"column":217,"offset":27204},"indent":[]}}],"position":{"start":{"line":680,"column":1,"offset":26988},"end":{"line":680,"column":217,"offset":27204},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these URI argument and value fields:","position":{"start":{"line":682,"column":1,"offset":27206},"end":{"line":682,"column":85,"offset":27290},"indent":[]}}],"position":{"start":{"line":682,"column":1,"offset":27206},"end":{"line":682,"column":85,"offset":27290},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n    <tr>\n      <td style=\"width: 50%;\"><strong>Field Name</strong></td>\n      <td><strong>Description</strong></td>\n    </tr>\n  </thead>\n  <tbody>\n    <tr id=\"field-http-request-uri-args\">\n      <td valign=\"top\"><code>http.request.uri.args</code><br /><Type>Map&lt;String&gt;&lt;Array&gt;</Type></td>\n       <td>\n        <p>Represents the HTTP URI arguments associated with a request as a Map (associative array).\n        </p>\n        <p>When an argument repeats, then the array contains multiple items in the order they appear in the request.\n        </p>\n        <p>Values are not pre-processed and retain the case used in the request.</p>\n        <p><em>Decoding:</em> no decoding performed\n        <br /><em>Non-ASCII:</em> preserved\n        </p>\n        <p>Example:\n        <br /><code class=\"InlineCode\">any(http.request.uri.args[\"search\"][*] == \"red+apples\")</code>\n        </p>\n        <p>Example value:\n        <br /><code class=\"InlineCode\">{'{\"search\": [\"red+apples\"]}'}</code>\n        </p>\n      </td>\n    </tr>\n    <tr id=\"field-http-request-uri-args-names\">\n      <td valign=\"top\"><code>http.request.uri.args.names</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n        <p>Represents the names of the arguments in the HTTP URI query string. Names are not pre-processed and retain the case used in the request.\n        </p>\n        <p>When a name repeats, the array contains multiple items in the order that they appear in the request.\n        </p>\n        <p><em>Decoding:</em> no decoding performed\n        <br /><em>Non-ASCII:</em> preserved\n        </p>\n        <p>Example:\n        <br /><code class=\"InlineCode\">any(http.request.uri.args.names[*] == \"search\")</code>\n        </p>\n        <p>Example value:\n        <br /><code class=\"InlineCode\">[\"search\"]</code>\n        </p>\n      </td>\n    </tr>\n    <tr id=\"field-http-request-uri-args-values\">\n      <td valign=\"top\"><code>http.request.uri.args.values</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n        <p>Represents the values of arguments in the HTTP URI query string. Values are not pre-processed and retain the case used in the request. They are in the same order as in the request.\n        </p>\n        <p>Duplicated values are listed multiple times.\n        </p>\n        <p><em>Decoding:</em> no decoding performed\n        <br /><em>Non-ASCII:</em> preserved\n        </p>\n        <p>Example:\n        <br /><code class=\"InlineCode\">any(http.request.uri.args.values[*] == \"red+apples\")</code>\n        </p>\n        <p>Example value:\n        <br /><code class=\"InlineCode\">[\"red+apples\"]</code>\n        </p>\n      </td>\n    </tr>\n    <tr id=\"field-raw-http-request-uri-args\">\n      <td valign=\"top\"><code>raw.http.request.uri.args</code><br /><Type>Map&lt;String&gt;&lt;Array&gt;</Type></td>\n       <td>\n        <p>Contains the same field values as <a href=\"#field-http-request-uri-args\"><code>http.request.uri.args</code></a>.\n        </p>\n      </td>\n    </tr>\n    <tr id=\"field-raw-http-request-uri-args-names\">\n      <td valign=\"top\"><code>raw.http.request.uri.args.names</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n        <p>Contains the same field values as <a href=\"#field-http-request-uri-args-names\"><code>http.request.uri.args.names</code></a>.\n        </p>\n      </td>\n    </tr>\n    <tr id=\"field-raw-http-request-uri-args-values\">\n      <td valign=\"top\"><code>raw.http.request.uri.args.values</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n        <p>Contains the same field values as <a href=\"#field-http-request-uri-args-names\"><code>http.request.uri.args.values</code></a>.\n        </p>\n      </td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":684,"column":1,"offset":27292},"end":{"line":769,"column":9,"offset":30978},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"HTTP header fields","position":{"start":{"line":771,"column":4,"offset":30983},"end":{"line":771,"column":22,"offset":31001},"indent":[]}}],"position":{"start":{"line":771,"column":1,"offset":30980},"end":{"line":771,"column":22,"offset":31001},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language includes fields that represent properties of HTTP request headers. Many of these return ","position":{"start":{"line":773,"column":1,"offset":31003},"end":{"line":773,"column":117,"offset":31119},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/values#arrays","children":[{"type":"text","value":"arrays","position":{"start":{"line":773,"column":118,"offset":31120},"end":{"line":773,"column":124,"offset":31126},"indent":[]}}],"position":{"start":{"line":773,"column":117,"offset":31119},"end":{"line":773,"column":162,"offset":31164},"indent":[]}},{"type":"text","value":" containing the respective values.","position":{"start":{"line":773,"column":162,"offset":31164},"end":{"line":773,"column":196,"offset":31198},"indent":[]}}],"position":{"start":{"line":773,"column":1,"offset":31003},"end":{"line":773,"column":196,"offset":31198},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these HTTP header fields:","position":{"start":{"line":775,"column":1,"offset":31200},"end":{"line":775,"column":74,"offset":31273},"indent":[]}}],"position":{"start":{"line":775,"column":1,"offset":31200},"end":{"line":775,"column":74,"offset":31273},"indent":[]}},{"type":"html","value":"<table>\n   <tr>\n      <td><strong>Field Name</strong></td>\n      <td style=\"width: 50%;\"><strong>Description</strong></td>\n   </tr>\n   <tr id=\"field-http-request-headers\">\n      <td valign=\"top\"><code>http.request.headers</code><br /><Type>Map&lt;String&gt;&lt;Array&gt;</Type></td>\n      <td>\n         <p>Represents HTTP request headers as a Map (or associative array).\n         </p>\n         <p>When there are repeating headers, the array includes them in the order they appear in the request. The keys convert to lowercase.</p>\n         <p><em><em>Decoding:</em></em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n         <p>Example:\n         <br /><code class=\"InlineCode\">any(http.request.headers[\"content-type\"][*] == \"application/json\")</code>\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">{'{\"content-type\": [\"application/json\"]}'}</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.headers.names</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n         <p>Represents the names of the headers in the HTTP request. The names are not pre-processed and retain the case used in the request.\n         </p>\n         <p>The order of header names is not guaranteed but will match <code class=\"InlineCode\">http.request.headers.values</code>.\n         </p>\n         <p>Duplicate headers are listed multiple times.\n         </p>\n         <p><em>Decoding:</em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n         <p>Example:\n         <br /><code class=\"InlineCode\">any(http.request.headers.names[*] == \"content-type\")</code>\n         </p>\n         <p>Example value:\n         <code class=\"InlineCode\">[\"content-type\"]</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.headers.values</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n         <p>Represents the values of the headers in the HTTP request.</p>\n         <p>Values are not pre-processed and retain the case used in the request.</p>\n         <p>The order of header values is not guaranteed but will match <code class=\"InlineCode\">http.request.headers.names</code>.\n         </p>\n         <p>Duplicate headers are listed multiple times.\n         </p>\n         <p><em>Decoding:</em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n         <p>Example 1:\n         <br />\n         <code class=\"InlineCode\">any(http.request.headers.values[*] == \"application/json\")</code>\n         </p>\n         <p>Example value 1:\n         <br />\n         <code class=\"InlineCode\">[\"application/json\"]</code>\n         </p>\n         <p>Additionally used for logging requests according to the specified operator and the length/size entered for the header value.\n         </p>\n         <p>Example 2:\n         <br />\n         <code class=\"InlineCode\">any(len(http.request.headers.values[*])[*] gt 10)</code>\n         </p>\n         <p>Example value 2:\n         <br />\n         <code class=\"InlineCode\">[\"gt 10\"]</code>\n         </p>\n      </td>\n   </tr>\n   <tr>\n      <td valign=\"top\"><code>http.request.headers.truncated</code><br /><Type>Boolean</Type></td>\n      <td>\n         <p>Returns <code class=\"InlineCode\">true</code> when the HTTP request contains too many headers; otherwise, returns <code class=\"InlineCode\">false</code>.\n         </p>\n         <p>When <code class=\"InlineCode\">true,</code> <code class=\"InlineCode\">http.request.headers</code>, <code class=\"InlineCode\">http.request.headers.names</code>, and <code class=\"InlineCode\">http.request.headers.values</code> may not contain all of the headers sent in the HTTP request.\n         </p>\n      </td>\n   </tr>\n   <tr id=\"field-http-request-accepted_languages\">\n      <td valign=\"top\"><code>http.request.accepted_languages</code><br /><Type>Array&lt;String&gt;</Type></td>\n      <td>\n         <p>Represents the list of language tags provided in the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language\"><code>Accept-Language</code></a> HTTP request header, sorted by weight (<code class=\"InlineCode\">;q=&lt;weight&gt;</code>, with a default weight of <code class=\"InlineCode\">1</code>) in descending order.</p>\n         <p>If the HTTP header is not present in the request or is empty, <code class=\"InlineCode\">http.request.accepted_languages[0]</code> will return a \"<a href=\"/cf-firewall-language/values#final-notes\">missing value</a>\", which the <code class=\"InlineCode\">concat()</code> function will handle as an empty string.</p>\n         <p>If the HTTP header includes the language tag <code class=\"InlineCode\">*</code> it will not be stored in the array.</p>\n         <p>Example 1:<br/>\n         Request with header <code class=\"InlineCode\">Accept-Language: fr-CH, fr;q=0.8, en;q=0.9, de;q=0.7, *;q=0.5</code>. In this case:<br/>\n         <code class=\"InlineCode\">http.request.accepted_languages[0] == \"fr-CH\"</code><br/>\n         <code class=\"InlineCode\">http.request.accepted_languages == [\"fr-CH\", \"en\", \"fr\", \"de\"]</code>\n         </p>\n         <p>Example 2:<br/>\n         Request without an <code class=\"InlineCode\">Accept-Language</code> HTTP header and a URI of <code class=\"InlineCode\">https://www.example.com/my-path</code>. In this case:<br/>\n         <code class=\"InlineCode\">concat(\"/\", http.request.accepted_languages[0], http.request.uri.path) == \"//my-path\"</code>.</p>\n         <p><strong>Note:</strong> This field is only available in <a href=\"https://developers.cloudflare.com/rules/transform\">Transform Rules</a>.</p>\n      </td>\n   </tr>\n</table>","position":{"start":{"line":777,"column":1,"offset":31275},"end":{"line":880,"column":9,"offset":37054},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"HTTP body fields","position":{"start":{"line":882,"column":4,"offset":37059},"end":{"line":882,"column":20,"offset":37075},"indent":[]}}],"position":{"start":{"line":882,"column":1,"offset":37056},"end":{"line":882,"column":20,"offset":37075},"indent":[]}},{"type":"html","value":"<Aside type='note'>","position":{"start":{"line":884,"column":1,"offset":37077},"end":{"line":884,"column":20,"offset":37096},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Access to HTTP body is an add-on product of the Cloudflare Enterprise plan.","position":{"start":{"line":886,"column":1,"offset":37098},"end":{"line":886,"column":76,"offset":37173},"indent":[]}}],"position":{"start":{"line":886,"column":1,"offset":37098},"end":{"line":886,"column":76,"offset":37173},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":888,"column":1,"offset":37175},"end":{"line":888,"column":9,"offset":37183},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language includes fields that represent properties of an HTTP request body. Many of these return ","position":{"start":{"line":890,"column":1,"offset":37185},"end":{"line":890,"column":117,"offset":37301},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/values#arrays","children":[{"type":"text","value":"arrays","position":{"start":{"line":890,"column":118,"offset":37302},"end":{"line":890,"column":124,"offset":37308},"indent":[]}}],"position":{"start":{"line":890,"column":117,"offset":37301},"end":{"line":890,"column":162,"offset":37346},"indent":[]}},{"type":"text","value":" containing the respective values.","position":{"start":{"line":890,"column":162,"offset":37346},"end":{"line":890,"column":196,"offset":37380},"indent":[]}}],"position":{"start":{"line":890,"column":1,"offset":37185},"end":{"line":890,"column":196,"offset":37380},"indent":[]}},{"type":"html","value":"<Aside type=\"warning\">","position":{"start":{"line":892,"column":1,"offset":37382},"end":{"line":892,"column":23,"offset":37404},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The value of ","position":{"start":{"line":894,"column":1,"offset":37406},"end":{"line":894,"column":14,"offset":37419},"indent":[]}},{"type":"inlineCode","value":"http.request.body.*","position":{"start":{"line":894,"column":14,"offset":37419},"end":{"line":894,"column":35,"offset":37440},"indent":[]}},{"type":"text","value":" fields has a maximum size of 128 KB, which means that you cannot define expressions that rely on request body data beyond the first 128 KB. If the request body is larger, the body fields will contain a truncated value and the ","position":{"start":{"line":894,"column":35,"offset":37440},"end":{"line":894,"column":262,"offset":37667},"indent":[]}},{"type":"inlineCode","value":"http.request.body.truncated","position":{"start":{"line":894,"column":262,"offset":37667},"end":{"line":894,"column":291,"offset":37696},"indent":[]}},{"type":"text","value":" field will be set to ","position":{"start":{"line":894,"column":291,"offset":37696},"end":{"line":894,"column":313,"offset":37718},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":894,"column":313,"offset":37718},"end":{"line":894,"column":319,"offset":37724},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":894,"column":319,"offset":37724},"end":{"line":894,"column":320,"offset":37725},"indent":[]}}],"position":{"start":{"line":894,"column":1,"offset":37406},"end":{"line":894,"column":320,"offset":37725},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The maximum body size applies only to the values of HTTP body fields — the origin server will still receive the complete request body.","position":{"start":{"line":896,"column":1,"offset":37727},"end":{"line":896,"column":135,"offset":37861},"indent":[]}}],"position":{"start":{"line":896,"column":1,"offset":37727},"end":{"line":896,"column":135,"offset":37861},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":898,"column":1,"offset":37863},"end":{"line":898,"column":9,"offset":37871},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language supports these HTTP body fields:","position":{"start":{"line":900,"column":1,"offset":37873},"end":{"line":900,"column":72,"offset":37944},"indent":[]}}],"position":{"start":{"line":900,"column":1,"offset":37873},"end":{"line":900,"column":72,"offset":37944},"indent":[]}},{"type":"html","value":"<table>\n  <thead>\n    <tr>\n      <td style=\"width: 50%;\"><strong>Field Name</strong></td>\n      <td><strong>Description</strong>\n      </td>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td valign=\"top\"><code>http.request.body.raw</code><br /><Type>String</Type></td>\n      <td>\n         <p>Represents the unaltered HTTP request body.\n         </p>\n         <p>When the value of <code class=\"InlineCode\">http.request.body.truncated</code> is <code class=\"InlineCode\">true</code>, the return value may be truncated.\n         </p>\n         <p><em>Decoding:</em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n      </td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>http.request.body.truncated</code><br /><Type>Boolean</Type></td>\n      <td>\n         <p>Indicates whether the HTTP request body is truncated.\n         </p>\n         <p>When true, <code class=\"InlineCode\">http.request.body</code> fields may not contain all of the HTTP request body.\n         </p>\n      </td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>http.request.body.form</code><br /><Type>Map&lt;String&gt;&lt;Array&gt;</Type></td>\n      <td>\n         <p>Represents the HTTP request body of a form as a Map (or associative array). Populated when the <code class=\"InlineCode\">Content-Type</code> header is <code class=\"InlineCode\">application/x-www-form-urlencoded</code>.\n         </p>\n         <p>Values are not pre-processed and retain the case used in the request. When a field repeats, then the array contains multiple items in the order they are in the request.\n         </p>\n         <p>The return value may be truncated if <code class=\"InlineCode\">http.request.body.truncated</code> is <code class=\"InlineCode\">true</code>.\n         </p>\n         <p><em>Decoding:</em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n         <p>Example:\n         <br /><code class=\"InlineCode\">any(http.request.body.form[\"username\"][*] == \"admin\")</code>\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">{'{username\": [\"admin\"]}'}</code>\n         </p>\n      </td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>http.request.body.form.names</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n         <p>Represents the names of the form fields in an HTTP request where the content type is <code class=\"InlineCode\">application/x-www-form-urlencoded</code>.\n         </p>\n         <p>Names are not pre-processed and retain the case found in the request. They are listed in the same order as in the request. Duplicate names are listed multiple times.\n         </p>\n         <p>The return value may be truncated if <code class=\"InlineCode\">http.request.body.truncated</code> is <code class=\"InlineCode\">true</code>.\n         </p>\n         <p><em>Decoding:</em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n         <p>Example:\n         <br /><code class=\"InlineCode\">any(http.request.body.form.names[*] == \"username\")</code>\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">[\"username\"]</code>\n         </p>\n      </td>\n    </tr>\n    <tr>\n      <td valign=\"top\"><code>http.request.body.form.values</code><br /><Type>Array&lt;String></Type></td>\n      <td>\n         <p>Represents the values of the form fields in an HTTP request where the content type is <code class=\"InlineCode\">application/x-www-form-urlencoded</code>.\n         </p>\n         <p>Values are not pre-processed and retain the case used in the request. They are in the same order as in the request.\n         </p>\n         <p>Duplicated values are listed multiple times.\n         </p>\n         <p>The return value may be truncated if  <code class=\"InlineCode\">http.request.body.truncated</code> is <code class=\"InlineCode\">true</code>.\n         </p>\n         <p><em>Decoding:</em> no decoding performed\n         <br /><em>Whitespace:</em> preserved\n         <br /><em>Non-ASCII:</em> preserved\n         </p>\n         <p>Example:\n         <br /><code class=\"InlineCode\">any(http.request.body.form.values[*] == \"admin\")</code>\n         </p>\n         <p>Example value:\n         <br /><code class=\"InlineCode\">[\"admin\"]</code>\n         </p>\n      </td>\n    </tr>\n  </tbody>\n</table>","position":{"start":{"line":902,"column":1,"offset":37946},"end":{"line":999,"column":9,"offset":42363},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"thematicBreak","position":{"start":{"line":1001,"column":1,"offset":42365},"end":{"line":1001,"column":4,"offset":42368},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"GeoIP is the registered trademark of MaxMind, Inc.","position":{"start":{"line":1003,"column":2,"offset":42371},"end":{"line":1003,"column":52,"offset":42421},"indent":[]}}],"position":{"start":{"line":1003,"column":1,"offset":42370},"end":{"line":1003,"column":53,"offset":42422},"indent":[]}}],"position":{"start":{"line":1003,"column":1,"offset":42370},"end":{"line":1003,"column":53,"offset":42422},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1006,"column":73,"offset":42497}}}}},{"node":{"fields":{"slug":"/api"},"frontmatter":{"order":400,"title":"Manage rules via the APIs","summary":null,"demo":null,"tags":null},"headings":[{"value":"Manage Firewall Rules via the APIs"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Manage Firewall Rules via the APIs","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":37,"offset":37},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":37,"offset":37},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When it comes to programmatic Firewall Rule management, Cloudflare offers APIs that work together to achieve the same effect as the UI based ","position":{"start":{"line":4,"column":1,"offset":39},"end":{"line":4,"column":142,"offset":180},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":4,"column":144,"offset":182},"end":{"line":4,"column":158,"offset":196},"indent":[]}}],"position":{"start":{"line":4,"column":142,"offset":180},"end":{"line":4,"column":160,"offset":198},"indent":[]}},{"type":"text","value":" feature of the ","position":{"start":{"line":4,"column":160,"offset":198},"end":{"line":4,"column":176,"offset":214},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":4,"column":178,"offset":216},"end":{"line":4,"column":186,"offset":224},"indent":[]}}],"position":{"start":{"line":4,"column":176,"offset":214},"end":{"line":4,"column":188,"offset":226},"indent":[]}},{"type":"text","value":" app in the dashboard.","position":{"start":{"line":4,"column":188,"offset":226},"end":{"line":4,"column":210,"offset":248},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":39},"end":{"line":4,"column":210,"offset":248},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"These APIs are the following:","position":{"start":{"line":6,"column":1,"offset":250},"end":{"line":6,"column":30,"offset":279},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":250},"end":{"line":6,"column":30,"offset":279},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/api/cf-firewall-rules","children":[{"type":"strong","children":[{"type":"text","value":"Firewall Rules API","position":{"start":{"line":8,"column":6,"offset":286},"end":{"line":8,"column":24,"offset":304},"indent":[]}}],"position":{"start":{"line":8,"column":4,"offset":284},"end":{"line":8,"column":26,"offset":306},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":283},"end":{"line":8,"column":51,"offset":331},"indent":[]}},{"type":"text","value":": Manage Firewall Rules and their actions, based on criteria separately defined through filters.","position":{"start":{"line":8,"column":51,"offset":331},"end":{"line":8,"column":147,"offset":427},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":283},"end":{"line":8,"column":147,"offset":427},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":281},"end":{"line":8,"column":147,"offset":427},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"strong","children":[{"type":"text","value":"Filters API","position":{"start":{"line":9,"column":6,"offset":433},"end":{"line":9,"column":17,"offset":444},"indent":[]}}],"position":{"start":{"line":9,"column":4,"offset":431},"end":{"line":9,"column":19,"offset":446},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":430},"end":{"line":9,"column":37,"offset":464},"indent":[]}},{"type":"text","value":": Manage the filters that enable rule matching.","position":{"start":{"line":9,"column":37,"offset":464},"end":{"line":9,"column":84,"offset":511},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":430},"end":{"line":9,"column":84,"offset":511},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":428},"end":{"line":9,"column":84,"offset":511},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/api/cf-lists","children":[{"type":"strong","children":[{"type":"text","value":"Rules Lists API","position":{"start":{"line":10,"column":6,"offset":517},"end":{"line":10,"column":21,"offset":532},"indent":[]}}],"position":{"start":{"line":10,"column":4,"offset":515},"end":{"line":10,"column":23,"offset":534},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":514},"end":{"line":10,"column":39,"offset":550},"indent":[]}},{"type":"text","value":": Manage named lists of IP addresses that you can use within Firewall Rules to filter traffic.","position":{"start":{"line":10,"column":39,"offset":550},"end":{"line":10,"column":133,"offset":644},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":514},"end":{"line":10,"column":133,"offset":644},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":512},"end":{"line":10,"column":133,"offset":644},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":281},"end":{"line":10,"column":133,"offset":644},"indent":[1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":13,"column":110,"offset":756}}}}},{"node":{"fields":{"slug":"/api/cf-lists"},"frontmatter":{"order":485,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Rules Lists API"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Rules Lists API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":18,"offset":18},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":18,"offset":18},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Rules Lists API supports different types of lists:","position":{"start":{"line":4,"column":1,"offset":20},"end":{"line":4,"column":55,"offset":74},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":20},"end":{"line":4,"column":55,"offset":74},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":6,"column":3,"offset":78},"end":{"line":6,"column":7,"offset":82},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/rules-lists/","children":[{"type":"text","value":"IP Lists","position":{"start":{"line":6,"column":8,"offset":83},"end":{"line":6,"column":16,"offset":91},"indent":[]}}],"position":{"start":{"line":6,"column":7,"offset":82},"end":{"line":6,"column":50,"offset":125},"indent":[]}},{"type":"text","value":" to create a group of IP addresses and refer to them collectively, by name, in your Firewall Rule expressions.","position":{"start":{"line":6,"column":50,"offset":125},"end":{"line":6,"column":160,"offset":235},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":78},"end":{"line":6,"column":160,"offset":235},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":76},"end":{"line":7,"column":1,"offset":236},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":8,"column":3,"offset":239},"end":{"line":8,"column":7,"offset":243},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/rules/bulk-redirects","children":[{"type":"text","value":"Bulk Redirect Lists","position":{"start":{"line":8,"column":8,"offset":244},"end":{"line":8,"column":27,"offset":263},"indent":[]}}],"position":{"start":{"line":8,"column":7,"offset":243},"end":{"line":8,"column":84,"offset":320},"indent":[]}},{"type":"text","value":" to define lists of redirects that you enable by creating a Bulk Redirect Rule.","position":{"start":{"line":8,"column":84,"offset":320},"end":{"line":8,"column":163,"offset":399},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":239},"end":{"line":8,"column":163,"offset":399},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":237},"end":{"line":8,"column":163,"offset":399},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":76},"end":{"line":8,"column":163,"offset":399},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":10,"column":1,"offset":401},"end":{"line":10,"column":5,"offset":405},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#rules-lists-properties","children":[{"type":"text","value":"Rules Lists API","position":{"start":{"line":10,"column":6,"offset":406},"end":{"line":10,"column":21,"offset":421},"indent":[]}}],"position":{"start":{"line":10,"column":5,"offset":405},"end":{"line":10,"column":74,"offset":474},"indent":[]}},{"type":"text","value":" provides an interface for programmatically managing these types of lists.","position":{"start":{"line":10,"column":74,"offset":474},"end":{"line":10,"column":148,"offset":548},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":401},"end":{"line":10,"column":148,"offset":548},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To use an IP List in a rule expression, refer to ","position":{"start":{"line":12,"column":1,"offset":550},"end":{"line":12,"column":50,"offset":599},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/values/#lists","children":[{"type":"text","value":"Values: Lists","position":{"start":{"line":12,"column":51,"offset":600},"end":{"line":12,"column":64,"offset":613},"indent":[]}}],"position":{"start":{"line":12,"column":50,"offset":599},"end":{"line":12,"column":144,"offset":693},"indent":[]}},{"type":"text","value":" in the Rules language documentation.","position":{"start":{"line":12,"column":144,"offset":693},"end":{"line":12,"column":181,"offset":730},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":550},"end":{"line":12,"column":181,"offset":730},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Get started","position":{"start":{"line":14,"column":4,"offset":735},"end":{"line":14,"column":15,"offset":746},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":732},"end":{"line":14,"column":15,"offset":746},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To get started, review the Lists ","position":{"start":{"line":16,"column":1,"offset":748},"end":{"line":16,"column":34,"offset":781},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-lists/json-object/","children":[{"type":"text","value":"JSON object","position":{"start":{"line":16,"column":35,"offset":782},"end":{"line":16,"column":46,"offset":793},"indent":[]}}],"position":{"start":{"line":16,"column":34,"offset":781},"end":{"line":16,"column":75,"offset":822},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":16,"column":75,"offset":822},"end":{"line":16,"column":80,"offset":827},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-lists/endpoints/","children":[{"type":"text","value":"Endpoints","position":{"start":{"line":16,"column":81,"offset":828},"end":{"line":16,"column":90,"offset":837},"indent":[]}}],"position":{"start":{"line":16,"column":80,"offset":827},"end":{"line":16,"column":117,"offset":864},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":16,"column":117,"offset":864},"end":{"line":16,"column":118,"offset":865},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":748},"end":{"line":16,"column":118,"offset":865},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":19,"column":74,"offset":941}}}}},{"node":{"fields":{"slug":"/api/cf-lists/endpoints"},"frontmatter":{"order":495,"title":"Endpoints","summary":null,"demo":null,"tags":null},"headings":[{"value":"Endpoints"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Endpoints","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":12,"offset":12},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12},"indent":[]}},{"type":"html","value":"<ContentColumn>","position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":16,"offset":29},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To invoke a ","position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":13,"offset":43},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#rules-lists-properties","children":[{"type":"text","value":"Cloudflare Rules Lists API","position":{"start":{"line":6,"column":14,"offset":44},"end":{"line":6,"column":40,"offset":70},"indent":[]}}],"position":{"start":{"line":6,"column":13,"offset":43},"end":{"line":6,"column":93,"offset":123},"indent":[]}},{"type":"text","value":" operation, append the endpoint to the Cloudflare API base URL:","position":{"start":{"line":6,"column":93,"offset":123},"end":{"line":6,"column":156,"offset":186},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":156,"offset":186},"indent":[]}},{"type":"paragraph","children":[{"type":"inlineCode","value":"https://api.cloudflare.com/client/v4/","position":{"start":{"line":8,"column":1,"offset":188},"end":{"line":8,"column":40,"offset":227},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":188},"end":{"line":8,"column":40,"offset":227},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For authentication instructions, refer to ","position":{"start":{"line":10,"column":1,"offset":229},"end":{"line":10,"column":43,"offset":271},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-requests","children":[{"type":"text","value":"Getting Started: Requests","position":{"start":{"line":10,"column":44,"offset":272},"end":{"line":10,"column":69,"offset":297},"indent":[]}}],"position":{"start":{"line":10,"column":43,"offset":271},"end":{"line":10,"column":124,"offset":352},"indent":[]}},{"type":"text","value":" in the Cloudflare API documentation.","position":{"start":{"line":10,"column":124,"offset":352},"end":{"line":10,"column":161,"offset":389},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":229},"end":{"line":10,"column":161,"offset":389},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For help with endpoints and pagination, refer to ","position":{"start":{"line":12,"column":1,"offset":391},"end":{"line":12,"column":50,"offset":440},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-endpoints","children":[{"type":"text","value":"Getting Started: Endpoints","position":{"start":{"line":12,"column":51,"offset":441},"end":{"line":12,"column":77,"offset":467},"indent":[]}}],"position":{"start":{"line":12,"column":50,"offset":440},"end":{"line":12,"column":133,"offset":523},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":12,"column":133,"offset":523},"end":{"line":12,"column":134,"offset":524},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":391},"end":{"line":12,"column":134,"offset":524},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":14,"column":1,"offset":526},"end":{"line":14,"column":42,"offset":567},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Rules Lists API endpoints require a value for ","position":{"start":{"line":16,"column":1,"offset":569},"end":{"line":16,"column":51,"offset":619},"indent":[]}},{"type":"inlineCode","value":"<ACCOUNT_ID>","position":{"start":{"line":16,"column":51,"offset":619},"end":{"line":16,"column":65,"offset":633},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":16,"column":65,"offset":633},"end":{"line":16,"column":66,"offset":634},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":569},"end":{"line":16,"column":66,"offset":634},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To retrieve a list of accounts to which you have access, use the ","position":{"start":{"line":18,"column":1,"offset":636},"end":{"line":18,"column":66,"offset":701},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#accounts-list-accounts","children":[{"type":"text","value":"List Accounts","position":{"start":{"line":18,"column":67,"offset":702},"end":{"line":18,"column":80,"offset":715},"indent":[]}}],"position":{"start":{"line":18,"column":66,"offset":701},"end":{"line":18,"column":133,"offset":768},"indent":[]}},{"type":"text","value":" operation and note the IDs of the accounts you want to manage.","position":{"start":{"line":18,"column":133,"offset":768},"end":{"line":18,"column":196,"offset":831},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":636},"end":{"line":18,"column":196,"offset":831},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":20,"column":1,"offset":833},"end":{"line":20,"column":9,"offset":841},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Rules Lists API supports the operations outlined below. Visit the associated links for examples.","position":{"start":{"line":22,"column":1,"offset":843},"end":{"line":22,"column":112,"offset":954},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":843},"end":{"line":22,"column":112,"offset":954},"indent":[]}},{"type":"html","value":"</ContentColumn>","position":{"start":{"line":24,"column":1,"offset":956},"end":{"line":24,"column":17,"offset":972},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Manage lists","position":{"start":{"line":26,"column":4,"offset":977},"end":{"line":26,"column":16,"offset":989},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":974},"end":{"line":26,"column":16,"offset":989},"indent":[]}},{"type":"html","value":"<table style=\"table-layout:fixed; width:100%;\">\n  <thead>\n      <tr>\n          <th style='width: 20%'>Operation</th>\n          <th>Method & Endpoint</th>\n          <th style='width: 30%'>Notes</th>\n      </tr>\n  </thead>\n  <tbody>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-create-list'>Create a List</a></td>\n        <td><code class=\"InlineCode\">POST accounts/{'<ACCOUNT_ID>'}/rules/lists</code></td>\n        <td style='width:25%; word-wrap:break-word; white-space:normal'>Creates an empty list.</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-list-lists'>List Lists</a></td>\n        <td><code class=\"InlineCode\">GET accounts/{'<ACCOUNT_ID>'}/rules/lists</code></td>\n        <td style='width:25%; word-wrap:break-word; white-space:normal'>Fetch all lists for the account. (This request does not fetch the items in the lists.)</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-get-list'>Get a List</a></td>\n        <td><code class=\"InlineCode\">GET accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}</code></td>\n        <td style='width:25%; word-wrap:break-word; white-space:normal'>Fetches a list by its <code class=\"InlineCode\">id</code>. (This request does not display the items in the list.)</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-update-list'>Update a List</a></td>\n        <td><code class=\"InlineCode\">PUT accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}</code></td>\n        <td style='width:25%; word-wrap:break-word; white-space:normal'>\n            <p>Updates the <code class=\"InlineCode\">description</code> of a list. You cannot edit the <code class=\"InlineCode\">name</code> or <code class=\"InlineCode\">kind</code>, and you cannot update items in a list.</p>\n            <p>To update an item in a list, use the <a href='https://api.cloudflare.com/#rules-lists-replace-list-items'>Replace List Items</a> operation.</p>\n        </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-delete-list'>Delete a List</a></td>\n        <td><code class=\"InlineCode\">DELETE accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}</code></td>\n        <td style='width:25%; word-wrap:break-word; white-space:normal'>Deletes the list, but only when no filters reference it. </td>\n      </tr>\n  </tbody>\n</table>","position":{"start":{"line":28,"column":1,"offset":991},"end":{"line":66,"column":9,"offset":3390},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Manage items in a list","position":{"start":{"line":68,"column":4,"offset":3395},"end":{"line":68,"column":26,"offset":3417},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":3392},"end":{"line":68,"column":26,"offset":3417},"indent":[]}},{"type":"html","value":"<ContentColumn>","position":{"start":{"line":70,"column":1,"offset":3419},"end":{"line":70,"column":16,"offset":3434},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Nearly all the operations for managing items in a list are asynchronous. When you add or delete a large amount of items to or from a list, there may be a delay before the bulk operation is complete.","position":{"start":{"line":72,"column":1,"offset":3436},"end":{"line":72,"column":199,"offset":3634},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":3436},"end":{"line":72,"column":199,"offset":3634},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Asynchronous list operations return an ","position":{"start":{"line":74,"column":1,"offset":3636},"end":{"line":74,"column":40,"offset":3675},"indent":[]}},{"type":"inlineCode","value":"operation_id","position":{"start":{"line":74,"column":40,"offset":3675},"end":{"line":74,"column":54,"offset":3689},"indent":[]}},{"type":"text","value":", which you can use to monitor the status of an API operation. To monitor the status of an asynchronous operation, use the ","position":{"start":{"line":74,"column":54,"offset":3689},"end":{"line":74,"column":177,"offset":3812},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#rules-lists-get-bulk-operation","children":[{"type":"text","value":"Get Bulk Operation","position":{"start":{"line":74,"column":178,"offset":3813},"end":{"line":74,"column":196,"offset":3831},"indent":[]}}],"position":{"start":{"line":74,"column":177,"offset":3812},"end":{"line":74,"column":257,"offset":3892},"indent":[]}},{"type":"text","value":" endpoint and specify the ID of the operation you want to monitor.","position":{"start":{"line":74,"column":257,"offset":3892},"end":{"line":74,"column":323,"offset":3958},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":3636},"end":{"line":74,"column":323,"offset":3958},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you make requests to a list while a bulk operation on that list is in progress, the requests are queued and processed in sequence (first in, first out). Requests for successful asynchronous operations return an ","position":{"start":{"line":76,"column":1,"offset":3960},"end":{"line":76,"column":217,"offset":4176},"indent":[]}},{"type":"inlineCode","value":"HTTP 201","position":{"start":{"line":76,"column":217,"offset":4176},"end":{"line":76,"column":227,"offset":4186},"indent":[]}},{"type":"text","value":" status code.","position":{"start":{"line":76,"column":227,"offset":4186},"end":{"line":76,"column":240,"offset":4199},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":3960},"end":{"line":76,"column":240,"offset":4199},"indent":[]}},{"type":"html","value":"</ContentColumn>","position":{"start":{"line":78,"column":1,"offset":4201},"end":{"line":78,"column":17,"offset":4217},"indent":[]}},{"type":"html","value":"<table style=\"table-layout:fixed; width:100%;\">\n  <thead>\n      <tr>\n          <th style=\"width: 20%\">Operation</th>\n          <th>Method & Endpoint</th>\n          <th style='width: 30%'>Notes</th>\n      </tr>\n  </thead>\n  <tbody>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-list-list-items'>List Items</a></td>\n          <td><code class=\"InlineCode\">GET accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}/items</code></td>\n          <td><p>Fetches all items in a list.</p>\n              <p>Items are sorted in ascending order by IP address.</p>\n              <p>CIDRs are sorted by IP address, then by the subnet mask.</p>\n          </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-get-list-item'>Get a List Item</a></td>\n          <td><code class=\"InlineCode\">GET accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}/items/{'<ITEM_ID>'}</code></td>\n          <td><p>Fetches an item from a list by ID.</p>\n          </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-create-list-items'>Create List Items</a></td>\n          <td><code class=\"InlineCode\">POST accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}/items</code></td>\n          <td>\n            <p>Appends a new item or items to a list.</p>\n            <p>Replaces entries that already exist in the list, does not delete any items.</p>\n            <p>Overwrites the <code class=\"InlineCode\">comment</code> of the original item.</p>\n            <p>The response includes an <code class=\"InlineCode\">operation_id</code>.</p>\n          </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-replace-list-items'>Replace List Items</a></td>\n          <td><code class=\"InlineCode\">PUT accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}/items</code></td>\n          <td>\n              <p>Deletes all current items in the list and replaces them with <code class=\"InlineCode\">items</code>.</p>\n              <p>When <code class=\"InlineCode\">items</code> is empty, deletes <strong>all</strong> items in the list.</p>\n              <p>The response includes an <code class=\"InlineCode\">operation_id</code>.</p>\n          </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#rules-lists-delete-list-items'>Delete List Items</a></td>\n          <td><code class=\"InlineCode\">DELETE accounts/{'<ACCOUNT_ID>'}/rules/lists/{'<LIST_ID>'}/items</code></td>\n          <td>\n              <p>Deletes specified list items.</p>\n              <p>The response includes an <code class=\"InlineCode\">operation_id</code>.</p>\n          </td>\n      </tr>\n  </tbody>\n</table>","position":{"start":{"line":80,"column":1,"offset":4219},"end":{"line":131,"column":9,"offset":6887},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":134,"column":111,"offset":7000}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules/delete"},"frontmatter":{"order":435,"title":"DELETE examples","summary":null,"demo":null,"tags":null},"headings":[{"value":"DELETE examples"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"DELETE examples","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":18,"offset":18},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":18,"offset":18},"indent":[]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":4,"column":1,"offset":20},"end":{"line":4,"column":34,"offset":53},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":6,"column":1,"offset":55},"end":{"line":6,"column":5,"offset":59},"indent":[]}},{"type":"inlineCode","value":"DELETE","position":{"start":{"line":6,"column":5,"offset":59},"end":{"line":6,"column":13,"offset":67},"indent":[]}},{"type":"text","value":" operation does not delete any filter related to the Firewall Rule. To delete the filter, use the ","position":{"start":{"line":6,"column":13,"offset":67},"end":{"line":6,"column":111,"offset":165},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"text","value":"Filters API","position":{"start":{"line":6,"column":112,"offset":166},"end":{"line":6,"column":123,"offset":177},"indent":[]}}],"position":{"start":{"line":6,"column":111,"offset":165},"end":{"line":6,"column":141,"offset":195},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":141,"offset":195},"end":{"line":6,"column":142,"offset":196},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":55},"end":{"line":6,"column":142,"offset":196},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":8,"column":1,"offset":198},"end":{"line":8,"column":9,"offset":206},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Delete multiple rules","position":{"start":{"line":10,"column":4,"offset":211},"end":{"line":10,"column":25,"offset":232},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":208},"end":{"line":10,"column":25,"offset":232},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example deletes Firewall Rules with IDs ","position":{"start":{"line":12,"column":1,"offset":234},"end":{"line":12,"column":46,"offset":279},"indent":[]}},{"type":"inlineCode","value":"<RULE_ID_1>","position":{"start":{"line":12,"column":46,"offset":279},"end":{"line":12,"column":59,"offset":292},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":12,"column":59,"offset":292},"end":{"line":12,"column":64,"offset":297},"indent":[]}},{"type":"inlineCode","value":"<RULE_ID_2>","position":{"start":{"line":12,"column":64,"offset":297},"end":{"line":12,"column":77,"offset":310},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":12,"column":77,"offset":310},"end":{"line":12,"column":78,"offset":311},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":234},"end":{"line":12,"column":78,"offset":311},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X DELETE \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules?id=<RULE_ID_1>&id=<RULE_ID_2>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":14,"column":1,"offset":313},"end":{"line":22,"column":4,"offset":523},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID_1>\"\n    },\n    {\n      \"id\": \"<RULE_ID_2>\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":24,"column":1,"offset":525},"end":{"line":41,"column":4,"offset":713},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Delete a single rule","position":{"start":{"line":43,"column":4,"offset":718},"end":{"line":43,"column":24,"offset":738},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":715},"end":{"line":43,"column":24,"offset":738},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example deletes the rule with ID ","position":{"start":{"line":45,"column":1,"offset":740},"end":{"line":45,"column":39,"offset":778},"indent":[]}},{"type":"inlineCode","value":"<RULE_ID>","position":{"start":{"line":45,"column":39,"offset":778},"end":{"line":45,"column":50,"offset":789},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":45,"column":50,"offset":789},"end":{"line":45,"column":51,"offset":790},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":740},"end":{"line":45,"column":51,"offset":790},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X DELETE \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules/<RULE_ID>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":47,"column":1,"offset":792},"end":{"line":55,"column":4,"offset":982},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID>\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":57,"column":1,"offset":984},"end":{"line":71,"column":4,"offset":1131},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":74,"column":99,"offset":1232}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules/endpoints"},"frontmatter":{"order":415,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Endpoints"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Endpoints","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":12,"offset":12},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12},"indent":[]}},{"type":"html","value":"<ContentColumn>","position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":16,"offset":29},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To invoke a Cloudflare Firewall Rules API operation, append the endpoint to the Cloudflare API base URL:","position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":105,"offset":135},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":105,"offset":135},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"https://api.cloudflare.com/client/v4/","position":{"start":{"line":8,"column":1,"offset":137},"end":{"line":10,"column":4,"offset":185},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For authentication instructions, refer to ","position":{"start":{"line":12,"column":1,"offset":187},"end":{"line":12,"column":43,"offset":229},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-requests","children":[{"type":"text","value":"Getting Started: Requests","position":{"start":{"line":12,"column":44,"offset":230},"end":{"line":12,"column":69,"offset":255},"indent":[]}}],"position":{"start":{"line":12,"column":43,"offset":229},"end":{"line":12,"column":124,"offset":310},"indent":[]}},{"type":"text","value":" in the Cloudflare API documentation.","position":{"start":{"line":12,"column":124,"offset":310},"end":{"line":12,"column":161,"offset":347},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":187},"end":{"line":12,"column":161,"offset":347},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For help with endpoints and pagination, refer to ","position":{"start":{"line":14,"column":1,"offset":349},"end":{"line":14,"column":50,"offset":398},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-endpoints","children":[{"type":"text","value":"Getting Started: Endpoints","position":{"start":{"line":14,"column":51,"offset":399},"end":{"line":14,"column":77,"offset":425},"indent":[]}}],"position":{"start":{"line":14,"column":50,"offset":398},"end":{"line":14,"column":133,"offset":481},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":14,"column":133,"offset":481},"end":{"line":14,"column":134,"offset":482},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":349},"end":{"line":14,"column":134,"offset":482},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":16,"column":1,"offset":484},"end":{"line":16,"column":42,"offset":525},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules API endpoints require a value for ","position":{"start":{"line":18,"column":1,"offset":527},"end":{"line":18,"column":54,"offset":580},"indent":[]}},{"type":"inlineCode","value":"<ZONE_ID>","position":{"start":{"line":18,"column":54,"offset":580},"end":{"line":18,"column":65,"offset":591},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":18,"column":65,"offset":591},"end":{"line":18,"column":66,"offset":592},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":527},"end":{"line":18,"column":66,"offset":592},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To retrieve a list of zones associated with your account, use the ","position":{"start":{"line":20,"column":1,"offset":594},"end":{"line":20,"column":67,"offset":660},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#zone-list-zones","children":[{"type":"text","value":"List Zones","position":{"start":{"line":20,"column":68,"offset":661},"end":{"line":20,"column":78,"offset":671},"indent":[]}}],"position":{"start":{"line":20,"column":67,"offset":660},"end":{"line":20,"column":124,"offset":717},"indent":[]}},{"type":"text","value":" operation and note the zone ID associated with the domain whose Firewall Rules you want to manage.","position":{"start":{"line":20,"column":124,"offset":717},"end":{"line":20,"column":223,"offset":816},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":594},"end":{"line":20,"column":223,"offset":816},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":22,"column":1,"offset":818},"end":{"line":22,"column":9,"offset":826},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules API supports the operations outlined below. Visit the pages in this section for examples.","position":{"start":{"line":24,"column":1,"offset":828},"end":{"line":24,"column":120,"offset":947},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":828},"end":{"line":24,"column":120,"offset":947},"indent":[]}},{"type":"html","value":"</ContentColumn>","position":{"start":{"line":26,"column":1,"offset":949},"end":{"line":26,"column":17,"offset":965},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n      <tr>\n          <th style='width: 20%'>Operation</th>\n          <th>Method & Endpoint</th>\n          <th style='width: 30%'>Notes</th>\n      </tr>\n  </thead>\n  <tbody>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-create-firewall-rules'>Create Firewall Rules</a></td>\n        <td><code class=\"InlineCode\">POST&nbsp;zones/{'<ZONE_ID>'}/firewall/rules</code></td>\n        <td>Handled as a single transaction. If there is an error, the entire operation fails.</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-list-of-firewall-rules'>List Firewall Rules</a></td>\n        <td><code class=\"InlineCode\">GET&nbsp;zones/{'<ZONE_ID>'}/firewall/rules</code></td>\n        <td>Lists all current Firewall Rules. Results return paginated with 25 items per page by default. Use optional parameters to narrow results. </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-get-individual-firewall-rule'>Get a Firewall Rule</a></td>\n        <td><code class=\"InlineCode\">GET&nbsp;zones/{'<ZONE_ID>'}/firewall/rules/{'<RULE_ID>'}</code></td>\n        <td>Retrieve a single Firewall Rule by ID.</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-update-firewall-rules'>Update Firewall Rules</a></td>\n        <td><code class=\"InlineCode\">PUT&nbsp;zones/{'<ZONE_ID>'}/firewall/rules</code></td>\n        <td>Handled as a single transaction. All rules must exist for operation to succeed. If there is an error, the entire operation fails.</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-update-individual-firewall-rule'>Update a Firewall Rule</a></td>\n        <td><code class=\"InlineCode\">PUT&nbsp;zones/{'<ZONE_ID>'}/firewall/rules/{'<RULE_ID>'}</code></td>\n        <td>Update a single Firewall Rule by ID.</td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-delete-firewall-rules'>Delete Firewall Rules</a></td>\n        <td><code class=\"InlineCode\">DELETE&nbsp;zones/{'<ZONE_ID>'}/firewall/rules</code></td>\n        <td><p>Delete existing Firewall Rules. Must specify list of Firewall Rule IDs.</p>\n        <p>Empty requests result in no deletion. Returns HTTP status code 200 if a specified rule does not exist.</p>\n        </td>\n      </tr>\n      <tr>\n        <td><a href='https://api.cloudflare.com/#firewall-rules-delete-individual-firewall-rules'>Delete a Firewall Rule</a></td>\n        <td><code class=\"InlineCode\">DELETE&nbsp;zones/{'<ZONE_ID>'}/firewall/rules/{'<RULE_ID>'}</code></td>\n        <td><p>Delete a Firewall Rule by ID.</p></td>\n      </tr>\n  </tbody>\n</table>","position":{"start":{"line":28,"column":1,"offset":967},"end":{"line":75,"column":9,"offset":3719},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":78,"column":91,"offset":3812}}}}},{"node":{"fields":{"slug":"/api/cf-lists/json-object"},"frontmatter":{"order":490,"title":"JSON object","summary":null,"demo":null,"tags":null},"headings":[{"value":"JSON object"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"JSON object","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":14,"offset":14},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":14,"offset":14},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"List object structure and properties","position":{"start":{"line":4,"column":4,"offset":19},"end":{"line":4,"column":40,"offset":55},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":16},"end":{"line":4,"column":40,"offset":55},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A JSON response for the ","position":{"start":{"line":6,"column":1,"offset":57},"end":{"line":6,"column":25,"offset":81},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#rules-lists-properties","children":[{"type":"text","value":"Rules Lists API","position":{"start":{"line":6,"column":26,"offset":82},"end":{"line":6,"column":41,"offset":97},"indent":[]}}],"position":{"start":{"line":6,"column":25,"offset":81},"end":{"line":6,"column":94,"offset":150},"indent":[]}},{"type":"text","value":" has this structure:","position":{"start":{"line":6,"column":94,"offset":150},"end":{"line":6,"column":114,"offset":170},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":57},"end":{"line":6,"column":114,"offset":170},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"id\": \"2c0fc9fa937b11eaa1b71c4d701ab86e\",\n  \"name\": \"my_list_name\",\n  \"description\": \"List description.\",\n  \"kind\": \"(ip|redirect)\",\n  \"num_items\": 10,\n  \"num_referencing_filters\": 2,\n  \"created_on\": \"2021-01-01T08:00:00Z\",\n  \"modified_on\": \"2021-01-10T14:00:00Z\"\n}","position":{"start":{"line":8,"column":1,"offset":172},"end":{"line":19,"column":4,"offset":453},"indent":[1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This table summarizes the object properties:","position":{"start":{"line":21,"column":1,"offset":455},"end":{"line":21,"column":45,"offset":499},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":455},"end":{"line":21,"column":45,"offset":499},"indent":[]}},{"type":"html","value":"<TableWrap>\n  <table style=\"width: 100%\">\n    <thead>\n        <tr>\n            <th>Property</th>\n            <th>Description</th>\n            <th>Constraints</th>\n        </tr>\n    </thead>\n    <tbody style=\"vertical-align:top\">\n        <tr>\n          <td><code>id</code><br /><Type>String</Type></td>\n          <td>A UUIDv4 identifier generated by Cloudflare.</td>\n          <td>\n            <p>Unique, read only.</p>\n            <p>Length: 32 characters.</p>\n          </td>\n        </tr>\n        <tr>\n          <td><code>name</code><br /><Type>String</Type></td>\n          <td>An informative name for the list.</td>\n          <td>\n            <p>Maximum length: 50 characters.</p>\n            <p>Only alphanumeric and underscore (<code class='InlineCode'>_</code>) characters are valid.</p>\n            <p>A valid name satisfies this regular expression: <code class=\"InlineCode\">^[a-zA-Z0-9_]+$</code>.</p>\n          </td>\n        </tr>\n        <tr>\n            <td><code>description</code><br /><Type>String</Type></td>\n            <td>An informative summary of the list.</td>\n            <td>Maximum length: 500 characters.</td>\n        </tr>\n        <tr>\n            <td><code>kind</code><br /><Type>String</Type></td>\n            <td>The type of data in the list.</td>\n            <td>Valid values: <code class=\"InlineCode\">ip</code>, <code class=\"InlineCode\">redirect</code></td>\n        </tr>\n        <tr>\n            <td><code>num_items</code><br /><Type>Number</Type></td>\n            <td>The number of items in the list.</td>\n            <td>Read only.</td>\n        </tr>\n        <tr>\n            <td><code>num_referencing_filters</code><br /><Type>Number</Type></td>\n            <td>The number of filters that reference this list.</td>\n            <td>Read only.</td>\n        </tr>\n        <tr>\n            <td><code>created_on</code><br /><Type>String</Type></td>\n            <td>The  <a href='https://tools.ietf.org/html/rfc3339'>RFC 3339</a> timestamp the list was created.</td>\n            <td>Read only.</td>\n        </tr>\n        <tr>\n            <td><code>modified_on</code><br /><Type>String</Type></td>\n            <td>The  <a href='https://tools.ietf.org/html/rfc3339'>RFC 3339</a> timestamp when the list was last modified.</td>\n            <td>Read only.</td>\n        </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":23,"column":1,"offset":501},"end":{"line":82,"column":13,"offset":2836},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"List item object structure and properties","position":{"start":{"line":84,"column":4,"offset":2841},"end":{"line":84,"column":45,"offset":2882},"indent":[]}}],"position":{"start":{"line":84,"column":1,"offset":2838},"end":{"line":84,"column":45,"offset":2882},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A fully populated JSON object for an IP List item has the following structure:","position":{"start":{"line":86,"column":1,"offset":2884},"end":{"line":86,"column":79,"offset":2962},"indent":[]}}],"position":{"start":{"line":86,"column":1,"offset":2884},"end":{"line":86,"column":79,"offset":2962},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"id\": \"7c5dae5552338874e5053f2534d2767a\",\n  \"ip\": \"10.0.0.1/32\",\n  \"comment\": \"CF DNS server\",\n  \"created_on\": \"2021-10-01T05:20:00.12345Z\",\n  \"modified_on\": \"2021-10-01T05:20:00.12345Z\"\n}","position":{"start":{"line":88,"column":1,"offset":2964},"end":{"line":96,"column":4,"offset":3168},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"A fully populated JSON object for a Bulk Redirect List item has the following structure:","position":{"start":{"line":98,"column":1,"offset":3170},"end":{"line":98,"column":89,"offset":3258},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":3170},"end":{"line":98,"column":89,"offset":3258},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"id\": \"7c5dae5552338874e5053f2534d2767a\",\n  \"redirect\": {\n    \"source_url\": \"https://example.com/blog\",\n    \"target_url\": \"https://example.com/blog/latest\",\n    \"status_code\": 301,\n    \"include_subdomains\": false,\n    \"subpath_matching\": false,\n    \"preserve_query_string\": false,\n    \"preserve_path_suffix\": true\n  },\n  \"created_on\": \"2021-10-11T12:39:02Z\",\n  \"modified_on\": \"2021-10-11T12:39:02Z\"\n}","position":{"start":{"line":100,"column":1,"offset":3260},"end":{"line":115,"column":4,"offset":3676},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The JSON object properties for a list item are defined as follows:","position":{"start":{"line":117,"column":1,"offset":3678},"end":{"line":117,"column":67,"offset":3744},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":3678},"end":{"line":117,"column":67,"offset":3744},"indent":[]}},{"type":"html","value":"<TableWrap>\n  <table style=\"width: 100%\">\n    <thead>\n        <tr>\n            <th>Property</th>\n            <th>Description</th>\n            <th>Constraints</th>\n        </tr>\n    </thead>\n    <tbody style=\"vertical-align:top\">\n        <tr>\n          <td><code>id</code><br /><Type>String</Type></td>\n          <td>A UUIDv4 identifier generated by Cloudflare.</td>\n          <td>\n            <p>Unique, read only.</p>\n            <p>Length: 32 characters.</p>\n          </td>\n        </tr>\n        <tr>\n            <td><code>ip</code><br /><Type>String</Type></td>\n            <td>An IP address or CIDR range.</td>\n            <td>\n              <p>Applies only to IP Lists.</p>\n              <p>Any of these formats can exist in the same IP List:\n                <ul>\n                    <li>IPv4 address</li>\n                    <li>IPv6 (up to <code>/64</code>) address</li>\n                    <li>IPv4 ranges as <code>/32</code> through <code>/2</code> CIDRs</li>\n                    <li>IPv6 ranges as <code>/64</code> through <code>/4</code> CIDRs</li>\n                </ul>\n              </p>\n            </td>\n        </tr>\n        <tr>\n            <td><code>comment</code><br /><Type>String</Type></td>\n            <td>An informative summary of the item.</td>\n            <td><p>Applies only to IP Lists.</p>\n            <p>Maximum length: 500 characters.</p></td>\n        </tr>\n        <tr>\n            <td><code>redirect</code><br /><Type>Object</Type></td>\n            <td>An object that contains the definition of a URL Redirect. Refer to <a href=\"https://developers.cloudflare.com/rules/bulk-redirects/reference/parameters\">URL Redirect parameters</a> for details.</td>\n            <td><p>Applies only to Bulk Redirect Lists.</p></td>\n        </tr>\n        <tr>\n            <td><code>created_on</code><br /><Type>String</Type></td>\n            <td>The  <a href='https://tools.ietf.org/html/rfc3339'>RFC 3339</a> timestamp when the list was created.</td>\n            <td>Read only.</td>\n        </tr>\n        <tr>\n            <td><code>modified_on</code><br /><Type>String</Type></td>\n            <td>The  <a href='https://tools.ietf.org/html/rfc3339'>RFC 3339</a> timestamp when the item was last modified.</td>\n            <td>Read only.</td>\n        </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":119,"column":1,"offset":3746},"end":{"line":175,"column":13,"offset":6056},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For a detailed specification, refer to the ","position":{"start":{"line":177,"column":1,"offset":6058},"end":{"line":177,"column":44,"offset":6101},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#rules-lists-properties","children":[{"type":"text","value":"Rules Lists API","position":{"start":{"line":177,"column":45,"offset":6102},"end":{"line":177,"column":60,"offset":6117},"indent":[]}}],"position":{"start":{"line":177,"column":44,"offset":6101},"end":{"line":177,"column":113,"offset":6170},"indent":[]}},{"type":"text","value":" documentation.","position":{"start":{"line":177,"column":113,"offset":6170},"end":{"line":177,"column":128,"offset":6185},"indent":[]}}],"position":{"start":{"line":177,"column":1,"offset":6058},"end":{"line":177,"column":128,"offset":6185},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":180,"column":95,"offset":6282}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules/get"},"frontmatter":{"order":425,"title":"GET examples","summary":null,"demo":null,"tags":null},"headings":[{"value":"GET examples"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"GET examples","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Get all rules","position":{"start":{"line":4,"column":4,"offset":20},"end":{"line":4,"column":17,"offset":33},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":17,"offset":33},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example returns all the Firewall Rules in the zone with ID ","position":{"start":{"line":6,"column":1,"offset":35},"end":{"line":6,"column":65,"offset":99},"indent":[]}},{"type":"inlineCode","value":"<ZONE_ID>","position":{"start":{"line":6,"column":65,"offset":99},"end":{"line":6,"column":76,"offset":110},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":76,"offset":110},"end":{"line":6,"column":77,"offset":111},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":35},"end":{"line":6,"column":77,"offset":111},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X GET \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":8,"column":1,"offset":113},"end":{"line":16,"column":4,"offset":290},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID_1>\",\n      \"paused\": false,\n      \"description\": \"allow API traffic without challenge\",\n      \"action\": \"allow\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_1>\",\n        \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"paused\": false,\n        \"description\": \"/api\"\n      }\n    },\n    {\n      \"id\": \"<RULE_ID_2>\",\n      \"paused\": false,\n      \"description\": \"do not challenge login from office\",\n      \"action\": \"allow\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_2>\",\n        \"expression\": \"ip.src in {2400:cb00::/32 2803:f800::/32 2c0f:f248::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n        \"paused\": false,\n        \"description\": \"Login from office\"\n      }\n    },\n    {\n      \"id\": \"<RULE_ID_3>\",\n      \"paused\": false,\n      \"description\": \"challenge login\",\n      \"action\": \"challenge\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_3>\",\n        \"expression\": \"(http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n        \"paused\": false,\n        \"description\": \"Login\"\n      }\n    },\n    {\n      \"id\": \"<RULE_ID_4>\",\n      \"paused\": false,\n      \"description\": \"JS challenge site\",\n      \"action\": \"js_challenge\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_4>\",\n        \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"paused\": false,\n        \"description\": \"not /api\"\n      }\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": [],\n  \"result_info\": {\n    \"page\": 1,\n    \"per_page\": 25,\n    \"count\": 4,\n    \"total_count\": 4,\n    \"total_pages\": 1\n  }\n}","position":{"start":{"line":18,"column":1,"offset":292},"end":{"line":88,"column":4,"offset":2104},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Get rule by ID","position":{"start":{"line":90,"column":4,"offset":2109},"end":{"line":90,"column":18,"offset":2123},"indent":[]}}],"position":{"start":{"line":90,"column":1,"offset":2106},"end":{"line":90,"column":18,"offset":2123},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example returns the Firewall Rule with ID ","position":{"start":{"line":92,"column":1,"offset":2125},"end":{"line":92,"column":48,"offset":2172},"indent":[]}},{"type":"inlineCode","value":"<RULE_ID>","position":{"start":{"line":92,"column":48,"offset":2172},"end":{"line":92,"column":59,"offset":2183},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":92,"column":59,"offset":2183},"end":{"line":92,"column":60,"offset":2184},"indent":[]}}],"position":{"start":{"line":92,"column":1,"offset":2125},"end":{"line":92,"column":60,"offset":2184},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X GET \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules/<RULE_ID>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":94,"column":1,"offset":2186},"end":{"line":102,"column":4,"offset":2373},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"<RULE_ID>\",\n    \"paused\": false,\n    \"description\": \"do not challenge login from office\",\n    \"action\": \"allow\",\n    \"priority\": null,\n    \"filter\": {\n      \"id\": \"<FILTER_ID>\",\n      \"expression\": \"ip.src in {2400:cb00::/32 2803:f800::/32 2c0f:f248::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n      \"paused\": false,\n      \"description\": \"Login from office\"\n    }\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":104,"column":1,"offset":2375},"end":{"line":126,"column":4,"offset":2939},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":129,"column":96,"offset":3037}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules"},"frontmatter":{"order":405,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Firewall Rules API"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Firewall Rules API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":21,"offset":21},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the Firewall Rules API to programmatically manage your rules.","position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":66,"offset":88},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":66,"offset":88},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When working with the Firewall Rules API, refer to these topics for additional context:","position":{"start":{"line":6,"column":1,"offset":90},"end":{"line":6,"column":88,"offset":177},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":90},"end":{"line":6,"column":88,"offset":177},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-firewall-rules/actions","children":[{"type":"text","value":"Firewall Rules actions","position":{"start":{"line":8,"column":4,"offset":182},"end":{"line":8,"column":26,"offset":204},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":181},"end":{"line":8,"column":55,"offset":233},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":181},"end":{"line":8,"column":55,"offset":233},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":179},"end":{"line":8,"column":55,"offset":233},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"text","value":"Cloudflare Filters API","position":{"start":{"line":9,"column":4,"offset":237},"end":{"line":9,"column":26,"offset":259},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":236},"end":{"line":9,"column":44,"offset":277},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":236},"end":{"line":9,"column":44,"offset":277},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":234},"end":{"line":9,"column":44,"offset":277},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":179},"end":{"line":9,"column":44,"offset":277},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"To get started with the API, review the Firewall Rules API ","position":{"start":{"line":11,"column":1,"offset":279},"end":{"line":11,"column":60,"offset":338},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-firewall-rules/json-object","children":[{"type":"text","value":"JSON object","position":{"start":{"line":11,"column":61,"offset":339},"end":{"line":11,"column":72,"offset":350},"indent":[]}}],"position":{"start":{"line":11,"column":60,"offset":338},"end":{"line":11,"column":109,"offset":387},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":11,"column":109,"offset":387},"end":{"line":11,"column":114,"offset":392},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-firewall-rules/endpoints","children":[{"type":"text","value":"Endpoints","position":{"start":{"line":11,"column":115,"offset":393},"end":{"line":11,"column":124,"offset":402},"indent":[]}}],"position":{"start":{"line":11,"column":114,"offset":392},"end":{"line":11,"column":159,"offset":437},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":11,"column":159,"offset":437},"end":{"line":11,"column":160,"offset":438},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":279},"end":{"line":11,"column":160,"offset":438},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information on the Rules language used to write rule expressions, refer to ","position":{"start":{"line":13,"column":1,"offset":440},"end":{"line":13,"column":85,"offset":524},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language","children":[{"type":"text","value":"Rules language","position":{"start":{"line":13,"column":86,"offset":525},"end":{"line":13,"column":100,"offset":539},"indent":[]}}],"position":{"start":{"line":13,"column":85,"offset":524},"end":{"line":13,"column":166,"offset":605},"indent":[]}},{"type":"text","value":" in the Ruleset Engine documentation.","position":{"start":{"line":13,"column":166,"offset":605},"end":{"line":13,"column":203,"offset":642},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":440},"end":{"line":13,"column":203,"offset":642},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Differences from other Cloudflare APIs","position":{"start":{"line":15,"column":4,"offset":647},"end":{"line":15,"column":42,"offset":685},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":644},"end":{"line":15,"column":42,"offset":685},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules API behaves differently from most Cloudflare APIs in two ways:","position":{"start":{"line":17,"column":1,"offset":687},"end":{"line":17,"column":82,"offset":768},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":687},"end":{"line":17,"column":82,"offset":768},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"API calls accept and return multiple items, and allow applying data changes to multiple items.","position":{"start":{"line":19,"column":3,"offset":772},"end":{"line":19,"column":97,"offset":866},"indent":[]}}],"position":{"start":{"line":19,"column":3,"offset":772},"end":{"line":19,"column":97,"offset":866},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":770},"end":{"line":19,"column":97,"offset":866},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Although API calls return the ","position":{"start":{"line":20,"column":3,"offset":869},"end":{"line":20,"column":33,"offset":899},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-responses","children":[{"type":"text","value":"standard response","position":{"start":{"line":20,"column":34,"offset":900},"end":{"line":20,"column":51,"offset":917},"indent":[]}}],"position":{"start":{"line":20,"column":33,"offset":899},"end":{"line":20,"column":107,"offset":973},"indent":[]}},{"type":"text","value":", the error object follows the ","position":{"start":{"line":20,"column":107,"offset":973},"end":{"line":20,"column":138,"offset":1004},"indent":[]}},{"type":"link","title":null,"url":"http://jsonapi.org/format/#errors","children":[{"type":"text","value":"JSON API standard","position":{"start":{"line":20,"column":139,"offset":1005},"end":{"line":20,"column":156,"offset":1022},"indent":[]}}],"position":{"start":{"line":20,"column":138,"offset":1004},"end":{"line":20,"column":192,"offset":1058},"indent":[]}},{"type":"text","value":", such that in an error condition, it is clear which item produced the error and why.","position":{"start":{"line":20,"column":192,"offset":1058},"end":{"line":20,"column":277,"offset":1143},"indent":[]}}],"position":{"start":{"line":20,"column":3,"offset":869},"end":{"line":20,"column":277,"offset":1143},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":867},"end":{"line":20,"column":277,"offset":1143},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":770},"end":{"line":20,"column":277,"offset":1143},"indent":[1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":23,"column":73,"offset":1218}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules/json-object"},"frontmatter":{"order":410,"title":"JSON object","summary":null,"demo":null,"tags":null},"headings":[{"value":"Firewall Rules JSON object"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Firewall Rules JSON object","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":29,"offset":29},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":29,"offset":29},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Firewall rule example JSON response","position":{"start":{"line":4,"column":4,"offset":34},"end":{"line":4,"column":39,"offset":69},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":31},"end":{"line":4,"column":39,"offset":69},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A JSON response for the ","position":{"start":{"line":6,"column":1,"offset":71},"end":{"line":6,"column":25,"offset":95},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#firewall-rules-properties","children":[{"type":"text","value":"Firewall Rules API","position":{"start":{"line":6,"column":26,"offset":96},"end":{"line":6,"column":44,"offset":114},"indent":[]}}],"position":{"start":{"line":6,"column":25,"offset":95},"end":{"line":6,"column":100,"offset":170},"indent":[]}},{"type":"text","value":" has this structure:","position":{"start":{"line":6,"column":100,"offset":170},"end":{"line":6,"column":120,"offset":190},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":71},"end":{"line":6,"column":120,"offset":190},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"id\": \"772bf1026a72c400ea576db1ffa16407\",\n  \"filter\": {\n    \"id\": \"6f58318e7fa2477a23112e8118c66f61\",\n    \"expression\": \"http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\"\",\n    \"paused\": false,\n    \"description\": \"WordPress login paths\",\n    \"ref\": \"\"\n  },\n  \"action\": \"challenge\",\n  \"priority\": 1000,\n  \"paused\": false,\n  \"description\": \"Protect blog login page\",\n  \"ref\": \"\"\n}","position":{"start":{"line":8,"column":1,"offset":192},"end":{"line":24,"column":4,"offset":629},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This table summarizes the object properties:","position":{"start":{"line":26,"column":1,"offset":631},"end":{"line":26,"column":45,"offset":675},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":631},"end":{"line":26,"column":45,"offset":675},"indent":[]}},{"type":"html","value":"<TableWrap style='width:100%'>\n  <table style=\"width: 100%;\">\n    <thead>\n      <tr>\n        <th>Name</th>\n        <th>Description</th>\n        <th>Constraints</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td><code>id</code><br /><Type>String</Type></td>\n        <td>A UUIDv4 identifier generated by Cloudflare.</td>\n        <td>\n          <p>Unique, read only</p>\n          <p>Length: 32 characters</p>\n        </td>\n      </tr>\n      <tr>\n        <td><code>filter</code><br /><Type>Object</Type></td>\n        <td>A <a href='/api/cf-filters/json-object'>Cloudflare Filter object</a> that contains an expression for evaluating this rule.</td>\n        <td></td>\n      </tr>\n      <tr>\n        <td><code>action</code><br /><Type>String</Type></td>\n        <td>The action to take when a request satisfies the filter expression for this rule.</td>\n        <td>\n          <em>\n            log<br />\n            bypass<br />\n            allow<br />\n            challenge<br />\n            js_challenge<br />\n            managed_challenge<br />\n            block<br /></em>\n        </td>\n      </tr>\n      <tr>\n        <td><code>priority</code><br /><Type>Number</Type></td>\n        <td>Determines the order of evaluation for the rule relative to others. Lower values indicate greater priority. Rules without a value are evaluated last. For guidance, refer to <a href=\"#avoiding-priority-conflicts\">Avoiding priority conflicts</a>.</td>\n        <td>\n          <p>Read only</p>\n          <p>Maximum length: 32</p>\n        </td>\n      </tr>\n      <tr>\n        <td><code>paused</code><br /><Type>Boolean</Type></td>\n        <td>Returns <code class='InlineCode'>true</code> when the rule is not active. Use <code>ref</code> to enable/disable the rule.</td>\n        <td>Default: <code class='InlineCode'>false</code></td>\n      </tr>\n      <tr>\n        <td><code>description</code><br /><Type>String</Type></td>\n        <td>An informative summary of the rule.</td>\n        <td>Maximum length: 500 characters</td>\n      </tr>\n      <tr>\n        <td><code>ref</code><br /><Type>String</Type></td>\n        <td>A short string for tagging rules.</td>\n        <td>Maximum length: 50 characters</td>\n      </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":28,"column":1,"offset":677},"end":{"line":90,"column":13,"offset":2922},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Avoiding priority conflicts","position":{"start":{"line":92,"column":4,"offset":2927},"end":{"line":92,"column":31,"offset":2954},"indent":[]}}],"position":{"start":{"line":92,"column":1,"offset":2924},"end":{"line":92,"column":31,"offset":2954},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Priority plays a key role in configuring Firewall Rules. With Cloudflare Filters, it is possible to construct conflicting rules such as:","position":{"start":{"line":94,"column":1,"offset":2956},"end":{"line":94,"column":137,"offset":3092},"indent":[]}}],"position":{"start":{"line":94,"column":1,"offset":2956},"end":{"line":94,"column":137,"offset":3092},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Allow requests from the office IP range, and","position":{"start":{"line":96,"column":3,"offset":3096},"end":{"line":96,"column":47,"offset":3140},"indent":[]}}],"position":{"start":{"line":96,"column":3,"offset":3096},"end":{"line":96,"column":47,"offset":3140},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":3094},"end":{"line":96,"column":47,"offset":3140},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Block requests with a specific user agent.","position":{"start":{"line":97,"column":3,"offset":3143},"end":{"line":97,"column":45,"offset":3185},"indent":[]}}],"position":{"start":{"line":97,"column":3,"offset":3143},"end":{"line":97,"column":45,"offset":3185},"indent":[]}}],"position":{"start":{"line":97,"column":1,"offset":3141},"end":{"line":97,"column":45,"offset":3185},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":3094},"end":{"line":97,"column":45,"offset":3185},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Requests from the office IP range using the user agent to block would trigger both rules, but we cannot both allow and block the request. To solve this problem, Firewall Rules follows a strict ordering depending on action and priority.","position":{"start":{"line":99,"column":1,"offset":3187},"end":{"line":99,"column":236,"offset":3422},"indent":[]}}],"position":{"start":{"line":99,"column":1,"offset":3187},"end":{"line":99,"column":236,"offset":3422},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare prioritizes rules in descending order, such that priority 1 is first and rules with no priority are last. For rules of equal priority, Cloudflare orders them by action according to their ","position":{"start":{"line":101,"column":1,"offset":3424},"end":{"line":101,"column":199,"offset":3622},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-rules/actions#supported-actions","children":[{"type":"text","value":"order of precedence","position":{"start":{"line":101,"column":200,"offset":3623},"end":{"line":101,"column":219,"offset":3642},"indent":[]}}],"position":{"start":{"line":101,"column":199,"offset":3622},"end":{"line":101,"column":266,"offset":3689},"indent":[]}},{"type":"text","value":". In the example above, if no priority is set, the rule ","position":{"start":{"line":101,"column":266,"offset":3689},"end":{"line":101,"column":322,"offset":3745},"indent":[]}},{"type":"inlineCode","value":"allow request from the office IP range","position":{"start":{"line":101,"column":322,"offset":3745},"end":{"line":101,"column":362,"offset":3785},"indent":[]}},{"type":"text","value":" would apply because the ","position":{"start":{"line":101,"column":362,"offset":3785},"end":{"line":101,"column":387,"offset":3810},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"allow","position":{"start":{"line":101,"column":388,"offset":3811},"end":{"line":101,"column":393,"offset":3816},"indent":[]}}],"position":{"start":{"line":101,"column":387,"offset":3810},"end":{"line":101,"column":394,"offset":3817},"indent":[]}},{"type":"text","value":" action has a higher precedence than ","position":{"start":{"line":101,"column":394,"offset":3817},"end":{"line":101,"column":431,"offset":3854},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"block","position":{"start":{"line":101,"column":432,"offset":3855},"end":{"line":101,"column":437,"offset":3860},"indent":[]}}],"position":{"start":{"line":101,"column":431,"offset":3854},"end":{"line":101,"column":438,"offset":3861},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":101,"column":438,"offset":3861},"end":{"line":101,"column":439,"offset":3862},"indent":[]}}],"position":{"start":{"line":101,"column":1,"offset":3424},"end":{"line":101,"column":439,"offset":3862},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To reduce the risk of unintended behavior, it is best to explicitly specify the desired priority for potentially conflicting rules.","position":{"start":{"line":103,"column":1,"offset":3864},"end":{"line":103,"column":132,"offset":3995},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":3864},"end":{"line":103,"column":132,"offset":3995},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":106,"column":95,"offset":4092}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules/put"},"frontmatter":{"order":430,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"PUT examples"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"PUT examples","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Update multiple rules","position":{"start":{"line":4,"column":4,"offset":20},"end":{"line":4,"column":25,"offset":41},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":25,"offset":41},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example updates several Firewall Rules using a single API call.","position":{"start":{"line":6,"column":1,"offset":43},"end":{"line":6,"column":69,"offset":111},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":43},"end":{"line":6,"column":69,"offset":111},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can include up to 25 rules in the JSON object array (","position":{"start":{"line":8,"column":1,"offset":113},"end":{"line":8,"column":58,"offset":170},"indent":[]}},{"type":"inlineCode","value":"-d","position":{"start":{"line":8,"column":58,"offset":170},"end":{"line":8,"column":62,"offset":174},"indent":[]}},{"type":"text","value":" flag) to update as a batch. The batch is handled as a transaction.","position":{"start":{"line":8,"column":62,"offset":174},"end":{"line":8,"column":129,"offset":241},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":113},"end":{"line":8,"column":129,"offset":241},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '[\n  {\n    \"id\": \"<RULE_ID>\",\n    \"paused\": false,\n    \"description\": \"Challenge site\",\n    \"action\": \"challenge\",\n    \"priority\": null,\n    \"filter\": {\n      \"id\": \"<FILTER_ID>\",\n      \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n      \"paused\": false,\n      \"description\": \"not /api\"\n    }\n  }\n]'","position":{"start":{"line":10,"column":1,"offset":243},"end":{"line":34,"column":4,"offset":782},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":36,"column":1,"offset":784},"end":{"line":36,"column":34,"offset":817},"indent":[]}},{"type":"paragraph","children":[{"type":"inlineCode","value":"PUT","position":{"start":{"line":38,"column":1,"offset":819},"end":{"line":38,"column":6,"offset":824},"indent":[]}},{"type":"text","value":" does not update the filter specified. It only looks at the filter ID (","position":{"start":{"line":38,"column":6,"offset":824},"end":{"line":38,"column":77,"offset":895},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID>","position":{"start":{"line":38,"column":77,"offset":895},"end":{"line":38,"column":90,"offset":908},"indent":[]}},{"type":"text","value":") to update the rule with a new filter.","position":{"start":{"line":38,"column":90,"offset":908},"end":{"line":38,"column":129,"offset":947},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":819},"end":{"line":38,"column":129,"offset":947},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To update the filter, use the ","position":{"start":{"line":40,"column":1,"offset":949},"end":{"line":40,"column":31,"offset":979},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"text","value":"Filters API","position":{"start":{"line":40,"column":32,"offset":980},"end":{"line":40,"column":43,"offset":991},"indent":[]}}],"position":{"start":{"line":40,"column":31,"offset":979},"end":{"line":40,"column":61,"offset":1009},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":40,"column":61,"offset":1009},"end":{"line":40,"column":62,"offset":1010},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":949},"end":{"line":40,"column":62,"offset":1010},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":42,"column":1,"offset":1012},"end":{"line":42,"column":9,"offset":1020},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID>\",\n      \"paused\": false,\n      \"description\": \"Challenge site\",\n      \"action\": \"challenge\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID>\",\n        \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"paused\": false,\n        \"description\": \"not /api\"\n      }\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":44,"column":1,"offset":1022},"end":{"line":68,"column":4,"offset":1472},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Update a single rule","position":{"start":{"line":70,"column":4,"offset":1477},"end":{"line":70,"column":24,"offset":1497},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":1474},"end":{"line":70,"column":24,"offset":1497},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example updates the Firewall Rule with ID ","position":{"start":{"line":72,"column":1,"offset":1499},"end":{"line":72,"column":48,"offset":1546},"indent":[]}},{"type":"inlineCode","value":"<RULE_ID>","position":{"start":{"line":72,"column":48,"offset":1546},"end":{"line":72,"column":59,"offset":1557},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":72,"column":59,"offset":1557},"end":{"line":72,"column":60,"offset":1558},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":1499},"end":{"line":72,"column":60,"offset":1558},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You must include the following fields in the request body:","position":{"start":{"line":74,"column":1,"offset":1560},"end":{"line":74,"column":59,"offset":1618},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":1560},"end":{"line":74,"column":59,"offset":1618},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"id","position":{"start":{"line":76,"column":3,"offset":1622},"end":{"line":76,"column":7,"offset":1626},"indent":[]}}],"position":{"start":{"line":76,"column":3,"offset":1622},"end":{"line":76,"column":7,"offset":1626},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":1620},"end":{"line":76,"column":7,"offset":1626},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"action","position":{"start":{"line":77,"column":3,"offset":1629},"end":{"line":77,"column":11,"offset":1637},"indent":[]}}],"position":{"start":{"line":77,"column":3,"offset":1629},"end":{"line":77,"column":11,"offset":1637},"indent":[]}}],"position":{"start":{"line":77,"column":1,"offset":1627},"end":{"line":77,"column":11,"offset":1637},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"filter.id","position":{"start":{"line":78,"column":3,"offset":1640},"end":{"line":78,"column":14,"offset":1651},"indent":[]}}],"position":{"start":{"line":78,"column":3,"offset":1640},"end":{"line":78,"column":14,"offset":1651},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":1638},"end":{"line":78,"column":14,"offset":1651},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":1620},"end":{"line":78,"column":14,"offset":1651},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"All other fields are optional.","position":{"start":{"line":80,"column":1,"offset":1653},"end":{"line":80,"column":31,"offset":1683},"indent":[]}}],"position":{"start":{"line":80,"column":1,"offset":1653},"end":{"line":80,"column":31,"offset":1683},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules/<RULE_ID>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n  \"id\": \"<RULE_ID>\",\n  \"paused\": false,\n  \"description\": \"Do not challenge login from office IPv6\",\n  \"action\": \"allow\",\n  \"priority\": null,\n  \"filter\": {\n    \"id\": \"<FILTER_ID>\",\n    \"expression\": \"ip.src in {2400:cb00::/32 2803:f800::/32 2c0f:f248::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n    \"paused\": false,\n    \"description\": \"Login from office\"\n  }\n}' ","position":{"start":{"line":82,"column":1,"offset":1685},"end":{"line":104,"column":4,"offset":2358},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"<RULE_ID>\",\n    \"paused\": false,\n    \"description\": \"Do not challenge login from office IPv6\",\n    \"action\": \"allow\",\n    \"priority\": null,\n    \"filter\": {\n      \"id\": \"<FILTER_ID>\",\n      \"expression\": \"ip.src in {2400:cb00::/32 2803:f800::/32 2c0f:f248::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n      \"paused\": false,\n      \"description\": \"Login from office\"\n    }\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":106,"column":1,"offset":2360},"end":{"line":128,"column":4,"offset":2929},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"html","value":"<Aside type='note' header='Note'>","position":{"start":{"line":130,"column":1,"offset":2931},"end":{"line":130,"column":34,"offset":2964},"indent":[]}},{"type":"paragraph","children":[{"type":"inlineCode","value":"PUT","position":{"start":{"line":132,"column":1,"offset":2966},"end":{"line":132,"column":6,"offset":2971},"indent":[]}},{"type":"text","value":" overwrites fields that are not explicitly passed in the request.","position":{"start":{"line":132,"column":6,"offset":2971},"end":{"line":132,"column":71,"offset":3036},"indent":[]}}],"position":{"start":{"line":132,"column":1,"offset":2966},"end":{"line":132,"column":71,"offset":3036},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, if the request omits ","position":{"start":{"line":134,"column":1,"offset":3038},"end":{"line":134,"column":35,"offset":3072},"indent":[]}},{"type":"inlineCode","value":"description","position":{"start":{"line":134,"column":35,"offset":3072},"end":{"line":134,"column":48,"offset":3085},"indent":[]}},{"type":"text","value":", any previously existing ","position":{"start":{"line":134,"column":48,"offset":3085},"end":{"line":134,"column":74,"offset":3111},"indent":[]}},{"type":"inlineCode","value":"description","position":{"start":{"line":134,"column":74,"offset":3111},"end":{"line":134,"column":87,"offset":3124},"indent":[]}},{"type":"text","value":" value will be erased.","position":{"start":{"line":134,"column":87,"offset":3124},"end":{"line":134,"column":109,"offset":3146},"indent":[]}}],"position":{"start":{"line":134,"column":1,"offset":3038},"end":{"line":134,"column":109,"offset":3146},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To preserve existing values, issue a ","position":{"start":{"line":136,"column":1,"offset":3148},"end":{"line":136,"column":38,"offset":3185},"indent":[]}},{"type":"inlineCode","value":"GET","position":{"start":{"line":136,"column":38,"offset":3185},"end":{"line":136,"column":43,"offset":3190},"indent":[]}},{"type":"text","value":" request and based on the response, determine which fields (and respective values) to include in your ","position":{"start":{"line":136,"column":43,"offset":3190},"end":{"line":136,"column":145,"offset":3292},"indent":[]}},{"type":"inlineCode","value":"PUT","position":{"start":{"line":136,"column":145,"offset":3292},"end":{"line":136,"column":150,"offset":3297},"indent":[]}},{"type":"text","value":" request.","position":{"start":{"line":136,"column":150,"offset":3297},"end":{"line":136,"column":159,"offset":3306},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":3148},"end":{"line":136,"column":159,"offset":3306},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":138,"column":1,"offset":3308},"end":{"line":138,"column":9,"offset":3316},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":141,"column":73,"offset":3391}}}}},{"node":{"fields":{"slug":"/api/cf-firewall-rules/post"},"frontmatter":{"order":420,"title":"POST example","summary":null,"demo":null,"tags":null},"headings":[{"value":"POST example"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"POST example","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example creates several Firewall Rules using a single API call.","position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":69,"offset":85},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":69,"offset":85},"indent":[]}},{"type":"html","value":"<Aside type=\"note\">","position":{"start":{"line":6,"column":1,"offset":87},"end":{"line":6,"column":20,"offset":106},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To create a Firewall Rule you need a ","position":{"start":{"line":8,"column":1,"offset":108},"end":{"line":8,"column":38,"offset":145},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters/what-is-a-filter","children":[{"type":"text","value":"filter","position":{"start":{"line":8,"column":39,"offset":146},"end":{"line":8,"column":45,"offset":152},"indent":[]}}],"position":{"start":{"line":8,"column":38,"offset":145},"end":{"line":8,"column":80,"offset":187},"indent":[]}},{"type":"text","value":" identifier (","position":{"start":{"line":8,"column":80,"offset":187},"end":{"line":8,"column":93,"offset":200},"indent":[]}},{"type":"inlineCode","value":"id","position":{"start":{"line":8,"column":93,"offset":200},"end":{"line":8,"column":97,"offset":204},"indent":[]}},{"type":"text","value":"). If you have not created a filter yet, refer to the ","position":{"start":{"line":8,"column":97,"offset":204},"end":{"line":8,"column":151,"offset":258},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"text","value":"Cloudflare Filters API documentation","position":{"start":{"line":8,"column":152,"offset":259},"end":{"line":8,"column":188,"offset":295},"indent":[]}}],"position":{"start":{"line":8,"column":151,"offset":258},"end":{"line":8,"column":206,"offset":313},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":8,"column":206,"offset":313},"end":{"line":8,"column":207,"offset":314},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":108},"end":{"line":8,"column":207,"offset":314},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":10,"column":1,"offset":316},"end":{"line":10,"column":9,"offset":324},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X POST \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/firewall/rules\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '[\n  {\n    \"filter\": {\n      \"id\": \"<FILTER_ID_1>\"\n    },\n    \"action\": \"allow\",\n    \"description\": \"Do not challenge login from office\"\n  },\n  {\n    \"filter\": {\n      \"id\": \"<FILTER_ID_2>\"\n    },\n    \"action\": \"challenge\",\n    \"description\": \"Challenge login\"\n  },\n  {\n    \"filter\": {\n      \"id\": \"<FILTER_ID_3>\"\n    },\n    \"action\": \"js_challenge\",\n    \"description\": \"JS challenge site\"\n  },\n  {\n    \"filter\": {\n      \"id\": \"<FILTER_ID_4>\"\n    },\n    \"action\": \"allow\",\n    \"description\": \"Allow API traffic without challenge\"\n  }\n]'","position":{"start":{"line":12,"column":1,"offset":326},"end":{"line":51,"column":4,"offset":1084},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID_1>\",\n      \"paused\": false,\n      \"description\": \"Do not challenge login from office\",\n      \"action\": \"allow\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_1>\",\n        \"expression\": \"ip.src in {2400:cb00::/32 2803:f800::/32 2c0f:f248::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n        \"paused\": false,\n        \"description\": \"Login from office\"\n      }\n    },\n    {\n      \"id\": \"<RULE_ID_2>\",\n      \"paused\": false,\n      \"description\": \"Challenge login\",\n      \"action\": \"challenge\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_2>\",\n        \"expression\": \"(http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\",\n        \"paused\": false,\n        \"description\": \"Login\"\n      }\n    },\n    {\n      \"id\": \"<RULE_ID_3>\",\n      \"paused\": false,\n      \"description\": \"JS challenge site\",\n      \"action\": \"js_challenge\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_3>\",\n        \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"paused\": false,\n        \"description\": \"not /api\"\n      }\n    },\n    {\n      \"id\": \"<RULE_ID_4>\",\n      \"paused\": false,\n      \"description\": \"Allow API traffic without challenge\",\n      \"action\": \"allow\",\n      \"priority\": null,\n      \"filter\": {\n        \"id\": \"<FILTER_ID_4>\",\n        \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"paused\": false,\n        \"description\": \"/api\"\n      }\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":53,"column":1,"offset":1086},"end":{"line":116,"column":4,"offset":2780},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":119,"column":96,"offset":2878}}}}},{"node":{"fields":{"slug":"/api/cf-filters/delete"},"frontmatter":{"order":475,"title":"DELETE examples","summary":null,"demo":null,"tags":null},"headings":[{"value":"DELETE examples"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"DELETE examples","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":18,"offset":18},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":18,"offset":18},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Delete multiple filters","position":{"start":{"line":4,"column":4,"offset":23},"end":{"line":4,"column":27,"offset":46},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":20},"end":{"line":4,"column":27,"offset":46},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example deletes filters with IDs ","position":{"start":{"line":6,"column":1,"offset":48},"end":{"line":6,"column":39,"offset":86},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID_1>","position":{"start":{"line":6,"column":39,"offset":86},"end":{"line":6,"column":54,"offset":101},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":6,"column":54,"offset":101},"end":{"line":6,"column":59,"offset":106},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID_2>","position":{"start":{"line":6,"column":59,"offset":106},"end":{"line":6,"column":74,"offset":121},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":74,"offset":121},"end":{"line":6,"column":75,"offset":122},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":48},"end":{"line":6,"column":75,"offset":122},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X DELETE \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters?id=<FILTER_ID_1>&id=<FILTER_ID_2>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":8,"column":1,"offset":124},"end":{"line":16,"column":4,"offset":331},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<FILTER_ID_1>\"\n    },\n    {\n      \"id\": \"<FILTER_ID_2>\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":18,"column":1,"offset":333},"end":{"line":35,"column":4,"offset":525},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Delete a single filter","position":{"start":{"line":37,"column":4,"offset":530},"end":{"line":37,"column":26,"offset":552},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":527},"end":{"line":37,"column":26,"offset":552},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example deletes a single filter with ID ","position":{"start":{"line":39,"column":1,"offset":554},"end":{"line":39,"column":46,"offset":599},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID>","position":{"start":{"line":39,"column":46,"offset":599},"end":{"line":39,"column":59,"offset":612},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":39,"column":59,"offset":612},"end":{"line":39,"column":60,"offset":613},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":554},"end":{"line":39,"column":60,"offset":613},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X DELETE \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters/<FILTER_ID>\"\n-H \"X-Auth-Email: <EMAIL>\"\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":41,"column":1,"offset":615},"end":{"line":49,"column":4,"offset":796},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<FILTER_ID>\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":51,"column":1,"offset":798},"end":{"line":65,"column":4,"offset":947},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":68,"column":99,"offset":1048}}}}},{"node":{"fields":{"slug":"/api/cf-filters/endpoints"},"frontmatter":{"order":455,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Endpoints"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Endpoints","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":12,"offset":12},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12},"indent":[]}},{"type":"html","value":"<ContentColumn>","position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":16,"offset":29},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To invoke a Cloudflare Filters API operation, append the endpoint to the Cloudflare API base URL:","position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":98,"offset":128},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":98,"offset":128},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"https://api.cloudflare.com/client/v4/","position":{"start":{"line":8,"column":1,"offset":130},"end":{"line":10,"column":4,"offset":178},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For authentication instructions, refer to ","position":{"start":{"line":12,"column":1,"offset":180},"end":{"line":12,"column":43,"offset":222},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-requests","children":[{"type":"text","value":"Getting Started: Requests","position":{"start":{"line":12,"column":44,"offset":223},"end":{"line":12,"column":69,"offset":248},"indent":[]}}],"position":{"start":{"line":12,"column":43,"offset":222},"end":{"line":12,"column":124,"offset":303},"indent":[]}},{"type":"text","value":" in the Cloudflare API documentation.","position":{"start":{"line":12,"column":124,"offset":303},"end":{"line":12,"column":161,"offset":340},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":180},"end":{"line":12,"column":161,"offset":340},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For help with endpoints and pagination, refer to ","position":{"start":{"line":14,"column":1,"offset":342},"end":{"line":14,"column":50,"offset":391},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-endpoints","children":[{"type":"text","value":"Getting Started: Endpoints","position":{"start":{"line":14,"column":51,"offset":392},"end":{"line":14,"column":77,"offset":418},"indent":[]}}],"position":{"start":{"line":14,"column":50,"offset":391},"end":{"line":14,"column":133,"offset":474},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":14,"column":133,"offset":474},"end":{"line":14,"column":134,"offset":475},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":342},"end":{"line":14,"column":134,"offset":475},"indent":[]}},{"type":"html","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":16,"column":1,"offset":477},"end":{"line":16,"column":42,"offset":518},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Filters API endpoints require a value for ","position":{"start":{"line":18,"column":1,"offset":520},"end":{"line":18,"column":47,"offset":566},"indent":[]}},{"type":"inlineCode","value":"<ZONE_ID>","position":{"start":{"line":18,"column":47,"offset":566},"end":{"line":18,"column":58,"offset":577},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":18,"column":58,"offset":577},"end":{"line":18,"column":59,"offset":578},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":520},"end":{"line":18,"column":59,"offset":578},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To retrieve a list of zones associated with your account, use the ","position":{"start":{"line":20,"column":1,"offset":580},"end":{"line":20,"column":67,"offset":646},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#zone-list-zones","children":[{"type":"text","value":"List Zones","position":{"start":{"line":20,"column":68,"offset":647},"end":{"line":20,"column":78,"offset":657},"indent":[]}}],"position":{"start":{"line":20,"column":67,"offset":646},"end":{"line":20,"column":124,"offset":703},"indent":[]}},{"type":"text","value":" operation and note the Zone ID associated with the domain for which you want to manage filters.","position":{"start":{"line":20,"column":124,"offset":703},"end":{"line":20,"column":220,"offset":799},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":580},"end":{"line":20,"column":220,"offset":799},"indent":[]}},{"type":"html","value":"</Aside>","position":{"start":{"line":22,"column":1,"offset":801},"end":{"line":22,"column":9,"offset":809},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Filters API supports the operations outlined below. Visit the pages in this section for examples.","position":{"start":{"line":24,"column":1,"offset":811},"end":{"line":24,"column":113,"offset":923},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":811},"end":{"line":24,"column":113,"offset":923},"indent":[]}},{"type":"html","value":"</ContentColumn>","position":{"start":{"line":26,"column":1,"offset":925},"end":{"line":26,"column":17,"offset":941},"indent":[]}},{"type":"html","value":"<table style='table-layout:fixed; width:100%'>\n  <thead>\n    <tr>\n        <th style=\"width: 20%\">Operation</th>\n        <th>Method & Endpoint</th>\n        <th style='width: 30%'>Notes</th>\n    </tr>\n  </thead>\n  <tbody>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-create-filters'>Create filters</a></td>\n          <td><code class=\"InlineCode\">POST zones/{'<ZONE_ID>'}/filters</code></td>\n          <td>Handled as a single transaction. If there is an error, the entire operation fails.</td>\n      </tr>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-list-filters'>Get filters</a></td>\n          <td><code class=\"InlineCode\">GET zones/{'<ZONE_ID>'}/filters</code></td>\n          <td>Lists all current filters. Results return paginated with 25 items per page by default. Use optional parameters to narrow results.</td>\n      </tr>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-list-individual-filter'>Get a filter</a></td>\n          <td><code class=\"InlineCode\">GET zones/{'<ZONE_ID>'}/filters/{'<FILTER_ID>'}</code></td>\n          <td>Retrieve a single filter by ID.</td>\n      </tr>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-update-filters'>Update filters</a></td>\n          <td><code class=\"InlineCode\">PUT zones/{'<ZONE_ID>'}/filters</code></td>\n          <td>Handled as a single transaction. All filters must exist for operation to succeed. If there is an error, the entire operation fails.</td>\n      </tr>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-update-individual-filter'>Update a filter</a></td>\n          <td><code class=\"InlineCode\">PUT zones/{'<ZONE_ID>'}/filters/{'<FILTER_ID>'}</code></td>\n          <td>Update a single filter by ID.</td>\n      </tr>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-delete-filters'>Delete filters</a></td>\n          <td><code class=\"InlineCode\">DELETE zones/{'<ZONE_ID>'}/filters</code></td>\n          <td><p>Delete existing filters. Must specify list of filter IDs.</p>\n          <p>Empty requests result in no deletion. Returns HTTP status code 200 if a specified filter does not exist.</p></td>\n      </tr>\n      <tr>\n          <td><a href='https://api.cloudflare.com/#filters-delete-individual-filter'>Delete a filter</a></td>\n          <td><code class=\"InlineCode\">DELETE zones/{'<ZONE_ID>'}/filters/{'<FILTER_ID>'}</code></td>\n          <td>Delete a filter by ID.</td>\n      </tr>\n  </tbody>\n</table>","position":{"start":{"line":28,"column":1,"offset":943},"end":{"line":74,"column":9,"offset":3445},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":77,"column":91,"offset":3538}}}}},{"node":{"fields":{"slug":"/api/cf-filters/get"},"frontmatter":{"order":465,"title":"GET examples","summary":null,"demo":null,"tags":null},"headings":[{"value":"GET examples"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"GET examples","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Get all filters","position":{"start":{"line":4,"column":4,"offset":20},"end":{"line":4,"column":19,"offset":35},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":19,"offset":35},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example returns all filters in zone with ID ","position":{"start":{"line":6,"column":1,"offset":37},"end":{"line":6,"column":50,"offset":86},"indent":[]}},{"type":"inlineCode","value":"<ZONE_ID>","position":{"start":{"line":6,"column":50,"offset":86},"end":{"line":6,"column":61,"offset":97},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":6,"column":61,"offset":97},"end":{"line":6,"column":62,"offset":98},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":37},"end":{"line":6,"column":62,"offset":98},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X GET \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":8,"column":1,"offset":100},"end":{"line":16,"column":4,"offset":270},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<FILTER_ID_1>\",\n      \"paused\": false,\n      \"description\": \"Login from office\",\n      \"expression\": \"ip.src eq 93.184.216.0 and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n    },\n    {\n      \"id\": \"<FILTER_ID_2>\",\n      \"paused\": false,\n      \"description\": \"Login\",\n      \"expression\": \"(http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n    },\n    {\n      \"id\": \"<FILTER_ID_3>\",\n      \"paused\": false,\n      \"description\": \"not /api\",\n      \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\"\n    },\n    {\n      \"id\": \"<FILTER_ID_4>\",\n      \"paused\": false,\n      \"description\": \"/api\",\n      \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\"\n    },\n    {\n      \"id\": \"<FILTER_ID_5>\",\n      \"paused\": false,\n      \"expression\": \"ip.src eq 93.184.216.0\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": [],\n  \"result_info\": {\n    \"page\": 1,\n    \"per_page\": 25,\n    \"count\": 5,\n    \"total_count\": 5,\n    \"total_pages\": 1\n  }\n}","position":{"start":{"line":18,"column":1,"offset":272},"end":{"line":65,"column":4,"offset":1401},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Get by filter ID","position":{"start":{"line":67,"column":4,"offset":1406},"end":{"line":67,"column":20,"offset":1422},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":1403},"end":{"line":67,"column":20,"offset":1422},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example returns the filter with ID ","position":{"start":{"line":69,"column":1,"offset":1424},"end":{"line":69,"column":41,"offset":1464},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID>","position":{"start":{"line":69,"column":41,"offset":1464},"end":{"line":69,"column":54,"offset":1477},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":69,"column":54,"offset":1477},"end":{"line":69,"column":55,"offset":1478},"indent":[]}}],"position":{"start":{"line":69,"column":1,"offset":1424},"end":{"line":69,"column":55,"offset":1478},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X GET \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters/<FILTER_ID>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":71,"column":1,"offset":1480},"end":{"line":79,"column":4,"offset":1662},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"<FILTER_ID>\",\n    \"paused\": false,\n    \"description\": \"Login from office\",\n    \"expression\": \"ip.src eq 93.184.216.0 and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":81,"column":1,"offset":1664},"end":{"line":96,"column":4,"offset":2003},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":99,"column":96,"offset":2101}}}}},{"node":{"fields":{"slug":"/api/cf-filters"},"frontmatter":{"order":440,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Cloudflare Filters API"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Cloudflare Filters API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":25,"offset":25},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":25,"offset":25},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Cloudflare Filters","position":{"start":{"line":4,"column":3,"offset":29},"end":{"line":4,"column":21,"offset":47},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":23,"offset":49},"indent":[]}},{"type":"text","value":" is an API-only component of Firewall Rules for designing complex criteria that rely on boolean operators and other logic to examine incoming HTTP traffic and look for a match.","position":{"start":{"line":4,"column":23,"offset":49},"end":{"line":4,"column":199,"offset":225},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":199,"offset":225},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, a filter matching:","position":{"start":{"line":6,"column":1,"offset":227},"end":{"line":6,"column":32,"offset":258},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":227},"end":{"line":6,"column":32,"offset":258},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"An HTTP user agent, and","position":{"start":{"line":8,"column":3,"offset":262},"end":{"line":8,"column":26,"offset":285},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":262},"end":{"line":8,"column":26,"offset":285},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":260},"end":{"line":8,"column":26,"offset":285},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The HTTP path, and","position":{"start":{"line":9,"column":3,"offset":288},"end":{"line":9,"column":21,"offset":306},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":288},"end":{"line":9,"column":21,"offset":306},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":286},"end":{"line":9,"column":21,"offset":306},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The source IP address","position":{"start":{"line":10,"column":3,"offset":309},"end":{"line":10,"column":24,"offset":330},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":309},"end":{"line":10,"column":24,"offset":330},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":307},"end":{"line":10,"column":24,"offset":330},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":260},"end":{"line":10,"column":24,"offset":330},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"May be associated with a Firewall Rule declaring that the request should be blocked.","position":{"start":{"line":12,"column":1,"offset":332},"end":{"line":12,"column":85,"offset":416},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":332},"end":{"line":12,"column":85,"offset":416},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use IP Lists within a filter to refer collectively to a group of IP addresses. Refer to the ","position":{"start":{"line":14,"column":1,"offset":418},"end":{"line":14,"column":93,"offset":510},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-lists","children":[{"type":"text","value":"Rules List API","position":{"start":{"line":14,"column":94,"offset":511},"end":{"line":14,"column":108,"offset":525},"indent":[]}}],"position":{"start":{"line":14,"column":93,"offset":510},"end":{"line":14,"column":124,"offset":541},"indent":[]}},{"type":"text","value":" for more information.","position":{"start":{"line":14,"column":124,"offset":541},"end":{"line":14,"column":146,"offset":563},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":418},"end":{"line":14,"column":146,"offset":563},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Before getting started with the Cloudflare Filters API, familiarize yourself with rule ","position":{"start":{"line":16,"column":1,"offset":565},"end":{"line":16,"column":88,"offset":652},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/expressions","children":[{"type":"text","value":"expressions","position":{"start":{"line":16,"column":89,"offset":653},"end":{"line":16,"column":100,"offset":664},"indent":[]}}],"position":{"start":{"line":16,"column":88,"offset":652},"end":{"line":16,"column":178,"offset":742},"indent":[]}},{"type":"text","value":". For a complete reference, refer to ","position":{"start":{"line":16,"column":178,"offset":742},"end":{"line":16,"column":215,"offset":779},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language","children":[{"type":"text","value":"Rules language","position":{"start":{"line":16,"column":216,"offset":780},"end":{"line":16,"column":230,"offset":794},"indent":[]}}],"position":{"start":{"line":16,"column":215,"offset":779},"end":{"line":16,"column":296,"offset":860},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":16,"column":296,"offset":860},"end":{"line":16,"column":297,"offset":861},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":565},"end":{"line":16,"column":297,"offset":861},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Differences from other Cloudflare APIs","position":{"start":{"line":18,"column":4,"offset":866},"end":{"line":18,"column":42,"offset":904},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":863},"end":{"line":18,"column":42,"offset":904},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules API behaves differently from most Cloudflare APIs in two ways:","position":{"start":{"line":20,"column":1,"offset":906},"end":{"line":20,"column":82,"offset":987},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":906},"end":{"line":20,"column":82,"offset":987},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"API calls accept and return multiple items, and allow applying data changes to multiple items.","position":{"start":{"line":22,"column":3,"offset":991},"end":{"line":22,"column":97,"offset":1085},"indent":[]}}],"position":{"start":{"line":22,"column":3,"offset":991},"end":{"line":22,"column":97,"offset":1085},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":989},"end":{"line":22,"column":97,"offset":1085},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Although API calls return the ","position":{"start":{"line":23,"column":3,"offset":1088},"end":{"line":23,"column":33,"offset":1118},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#getting-started-responses","children":[{"type":"text","value":"standard response","position":{"start":{"line":23,"column":34,"offset":1119},"end":{"line":23,"column":51,"offset":1136},"indent":[]}}],"position":{"start":{"line":23,"column":33,"offset":1118},"end":{"line":23,"column":107,"offset":1192},"indent":[]}},{"type":"text","value":", the error object follows the ","position":{"start":{"line":23,"column":107,"offset":1192},"end":{"line":23,"column":138,"offset":1223},"indent":[]}},{"type":"link","title":null,"url":"http://jsonapi.org/format/#errors","children":[{"type":"text","value":"JSON API standard","position":{"start":{"line":23,"column":139,"offset":1224},"end":{"line":23,"column":156,"offset":1241},"indent":[]}}],"position":{"start":{"line":23,"column":138,"offset":1223},"end":{"line":23,"column":192,"offset":1277},"indent":[]}},{"type":"text","value":", such that in an error condition, it is clear which item produced the error and why.","position":{"start":{"line":23,"column":192,"offset":1277},"end":{"line":23,"column":277,"offset":1362},"indent":[]}}],"position":{"start":{"line":23,"column":3,"offset":1088},"end":{"line":23,"column":277,"offset":1362},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1086},"end":{"line":23,"column":277,"offset":1362},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":989},"end":{"line":23,"column":277,"offset":1362},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"To get started, review ","position":{"start":{"line":25,"column":1,"offset":1364},"end":{"line":25,"column":24,"offset":1387},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters/what-is-a-filter/","children":[{"type":"text","value":"What is a filter?","position":{"start":{"line":25,"column":25,"offset":1388},"end":{"line":25,"column":42,"offset":1405},"indent":[]}}],"position":{"start":{"line":25,"column":24,"offset":1387},"end":{"line":25,"column":78,"offset":1441},"indent":[]}},{"type":"text","value":", followed by the Cloudflare Filters ","position":{"start":{"line":25,"column":78,"offset":1441},"end":{"line":25,"column":115,"offset":1478},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-firewall-rules/json-object/","children":[{"type":"text","value":"JSON object","position":{"start":{"line":25,"column":116,"offset":1479},"end":{"line":25,"column":127,"offset":1490},"indent":[]}}],"position":{"start":{"line":25,"column":115,"offset":1478},"end":{"line":25,"column":165,"offset":1528},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":25,"column":165,"offset":1528},"end":{"line":25,"column":170,"offset":1533},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-firewall-rules/endpoints/","children":[{"type":"text","value":"Endpoints","position":{"start":{"line":25,"column":171,"offset":1534},"end":{"line":25,"column":180,"offset":1543},"indent":[]}}],"position":{"start":{"line":25,"column":170,"offset":1533},"end":{"line":25,"column":216,"offset":1579},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":25,"column":216,"offset":1579},"end":{"line":25,"column":217,"offset":1580},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1364},"end":{"line":25,"column":217,"offset":1580},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":28,"column":73,"offset":1655}}}}},{"node":{"fields":{"slug":"/api/cf-filters/json-object"},"frontmatter":{"order":450,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"JSON object"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"JSON object","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":14,"offset":14},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":14,"offset":14},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Filters object structure and properties","position":{"start":{"line":4,"column":4,"offset":19},"end":{"line":4,"column":43,"offset":58},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":16},"end":{"line":4,"column":43,"offset":58},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A JSON response for the ","position":{"start":{"line":6,"column":1,"offset":60},"end":{"line":6,"column":25,"offset":84},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/#filters-properties","children":[{"type":"text","value":"Filters API","position":{"start":{"line":6,"column":26,"offset":85},"end":{"line":6,"column":37,"offset":96},"indent":[]}}],"position":{"start":{"line":6,"column":25,"offset":84},"end":{"line":6,"column":86,"offset":145},"indent":[]}},{"type":"text","value":" has this structure:","position":{"start":{"line":6,"column":86,"offset":145},"end":{"line":6,"column":106,"offset":165},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":60},"end":{"line":6,"column":106,"offset":165},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"id\": \"6f58318e7fa2477a23112e8118c66f61\",\n  \"expression\": \"http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\"\",\n  \"paused\": true,\n  \"description\": \"WordPress login paths\",\n  \"ref\": \"\"\n}","position":{"start":{"line":8,"column":1,"offset":167},"end":{"line":16,"column":4,"offset":410},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following table summarizes the object properties:","position":{"start":{"line":18,"column":1,"offset":412},"end":{"line":18,"column":54,"offset":465},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":412},"end":{"line":18,"column":54,"offset":465},"indent":[]}},{"type":"html","value":"<TableWrap>\n  <table style=\"table-layout:fixed; width: 100%;\">\n    <thead>\n        <tr>\n            <th>Property</th>\n            <th>Description</th>\n            <th>Constraints</th>\n        </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td><code>id</code><br /><Type>String</Type></td>\n        <td>A UUIDv4 identifier generated by Cloudflare.</td>\n        <td>\n          <p>Unique, read only</p>\n          <p>Length: 32 characters</p>\n        </td>\n      </tr>\n        <tr>\n          <td><code>expression</code><br /><Type>String</Type></td>\n          <td>A Rules language expression used to evaluate requests. For more information, refer to <a href=\"https://developers.cloudflare.com/ruleset-engine/rules-language/expressions\">Expressions</a>.\n          </td>\n          <td></td>\n        </tr>\n        <tr>\n            <td><code>paused</code><br /><Type>Boolean</Type></td>\n            <td>Returns <code class='InlineCode'>true</code> when the filter is not active. Use <code>ref</code> to enable/disable the filter.</td>\n            <td>Default: <code class='InlineCode'>false</code></td>\n        </tr>\n        <tr>\n            <td><code>description</code><br /><Type>String</Type></td>\n            <td>An informative summary of the filter.</td>\n            <td>Maximum length: 500 characters</td>\n        </tr>\n        <tr>\n          <td><code>ref</code><br /><Type>String</Type></td>\n          <td>A short string for tagging filters.</td>\n          <td>Maximum length: 50 characters</td>\n        </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":20,"column":1,"offset":467},"end":{"line":61,"column":13,"offset":2015},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":64,"column":73,"offset":2090}}}}},{"node":{"fields":{"slug":"/api/cf-filters/post"},"frontmatter":{"order":460,"title":"POST example","summary":null,"demo":null,"tags":null},"headings":[{"value":"POST example"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"POST example","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example creates several filters using a single API call.","position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":62,"offset":78},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":62,"offset":78},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X POST \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '[\n  { \n    \"expression\": \"ip.src eq 93.184.216.0\"\n  },\n  {\n    \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\", \n    \"description\": \"/api\"\n  },\n  {\n    \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\", \n    \"description\": \"not /api\"\n  },\n  {\n    \"expression\": \"(http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\", \n    \"description\": \"Login\"\n  },\n  {\n    \"expression\": \"ip.src eq 93.184.216.0 and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\", \n    \"description\": \"Login from office\"\n  }\n]'","position":{"start":{"line":6,"column":1,"offset":80},"end":{"line":36,"column":4,"offset":907},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<FILTER_ID_1>\",\n      \"paused\": false,\n      \"expression\": \"ip.src eq 93.184.216.0\"\n    },\n    {\n      \"id\": \"<FILTER_ID_2>\",\n      \"paused\": false,\n      \"description\": \"/api\",\n      \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\"\n    },\n    {\n      \"id\": \"<FILTER_ID_3>\",\n      \"paused\": false,\n      \"description\": \"not /api\",\n      \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\"\n    },\n    {\n      \"id\": \"<FILTER_ID_4>\",\n      \"paused\": false,\n      \"description\": \"Login\",\n      \"expression\": \"(http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n    },\n    {\n      \"id\": \"<FILTER_ID_5>\",\n      \"paused\": false,\n      \"description\": \"Login from office\",\n      \"expression\": \"ip.src eq 93.184.216.0 and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":38,"column":1,"offset":909},"end":{"line":78,"column":4,"offset":1920},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":81,"column":96,"offset":2018}}}}},{"node":{"fields":{"slug":"/api/cf-filters/put"},"frontmatter":{"order":470,"title":"PUT examples","summary":null,"demo":null,"tags":null},"headings":[{"value":"PUT examples"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"PUT examples","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Update multiple filters","position":{"start":{"line":4,"column":4,"offset":20},"end":{"line":4,"column":27,"offset":43},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":27,"offset":43},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example updates two filters with IDs ","position":{"start":{"line":6,"column":1,"offset":45},"end":{"line":6,"column":43,"offset":87},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID_1>","position":{"start":{"line":6,"column":43,"offset":87},"end":{"line":6,"column":58,"offset":102},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":6,"column":58,"offset":102},"end":{"line":6,"column":63,"offset":107},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID_2>","position":{"start":{"line":6,"column":63,"offset":107},"end":{"line":6,"column":78,"offset":122},"indent":[]}},{"type":"text","value":" using a single API call.","position":{"start":{"line":6,"column":78,"offset":122},"end":{"line":6,"column":103,"offset":147},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":45},"end":{"line":6,"column":103,"offset":147},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '[\n  {\n    \"id\": \"<FILTER_ID_1>\",\n    \"paused\": false,\n    \"expression\": \"ip.src eq 93.184.216.0\",\n    \"description\": \"IP of example.org\"\n  },\n  {\n    \"id\": \"<FILTER_ID_2>\",\n    \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\", \n    \"description\": \"/api\"\n  }\n]'","position":{"start":{"line":8,"column":1,"offset":149},"end":{"line":30,"column":4,"offset":635},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<FILTER_ID>\",\n      \"paused\": false,\n      \"description\": \"IP of example.org\",\n      \"expression\": \"ip.src eq 93.184.216.0\"\n    },\n    {\n      \"id\": \"<FILTER_ID_2>\",\n      \"paused\": false,\n      \"description\": \"/api\",\n      \"expression\": \"http.request.uri.path matches \\\"^/api/.*$\\\"\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":32,"column":1,"offset":637},"end":{"line":55,"column":4,"offset":1057},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Update a single filter","position":{"start":{"line":57,"column":4,"offset":1062},"end":{"line":57,"column":26,"offset":1084},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":1059},"end":{"line":57,"column":26,"offset":1084},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example updates the filter with ID ","position":{"start":{"line":59,"column":1,"offset":1086},"end":{"line":59,"column":41,"offset":1126},"indent":[]}},{"type":"inlineCode","value":"<FILTER_ID>","position":{"start":{"line":59,"column":41,"offset":1126},"end":{"line":59,"column":54,"offset":1139},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":59,"column":54,"offset":1139},"end":{"line":59,"column":55,"offset":1140},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":1086},"end":{"line":59,"column":55,"offset":1140},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n\"https://api.cloudflare.com/client/v4/zones/<ZONE_ID>/filters/<FILTER_ID>\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n  \"id\": \"<FILTER_ID>\",\n  \"paused\": false,\n  \"description\": \"Login from office\",\n  \"expression\": \"ip.src in {2400:cb00::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n}' ","position":{"start":{"line":61,"column":1,"offset":1142},"end":{"line":76,"column":4,"offset":1613},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"<FILTER_ID>\",\n    \"paused\": false,\n    \"description\": \"Login from office\",\n    \"expression\": \"ip.src in {2400:cb00::/32 2a06:98c0::/29} and (http.request.uri.path ~ \\\"^.*/wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*/xmlrpc.php$\\\")\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":78,"column":1,"offset":1615},"end":{"line":93,"column":4,"offset":1973},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":96,"column":96,"offset":2071}}}}},{"node":{"fields":{"slug":"/api/cf-filters/what-is-a-filter"},"frontmatter":{"order":445,"title":"What is a filter?","summary":null,"demo":null,"tags":null},"headings":[{"value":"What is a filter?"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"What is a filter?","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":20,"offset":20},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":20,"offset":20},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A filter is a way of saying:","position":{"start":{"line":4,"column":1,"offset":22},"end":{"line":4,"column":29,"offset":50},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":22},"end":{"line":4,"column":29,"offset":50},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"if (traffic matches certain criteria) then...","position":{"start":{"line":6,"column":1,"offset":52},"end":{"line":8,"column":4,"offset":108},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"A filter contains an expression that would return ","position":{"start":{"line":10,"column":1,"offset":110},"end":{"line":10,"column":51,"offset":160},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":10,"column":51,"offset":160},"end":{"line":10,"column":57,"offset":166},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":10,"column":57,"offset":166},"end":{"line":10,"column":61,"offset":170},"indent":[]}},{"type":"inlineCode","value":"false","position":{"start":{"line":10,"column":61,"offset":170},"end":{"line":10,"column":68,"offset":177},"indent":[]}},{"type":"text","value":" when evaluated against traffic passing through Cloudflare.","position":{"start":{"line":10,"column":68,"offset":177},"end":{"line":10,"column":127,"offset":236},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":110},"end":{"line":10,"column":127,"offset":236},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Filter expressions are human and machine readable, and you can compose complex logic to precisely match the traffic that you are interested in detecting and acting upon.","position":{"start":{"line":12,"column":1,"offset":238},"end":{"line":12,"column":170,"offset":407},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":238},"end":{"line":12,"column":170,"offset":407},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A filter typically looks like the following:","position":{"start":{"line":14,"column":1,"offset":409},"end":{"line":14,"column":45,"offset":453},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":409},"end":{"line":14,"column":45,"offset":453},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"id\": \"<FILTER_ID>\",\n  \"expression\": \"(http.request.uri.path ~ \\\"^.*wp-login.php$\\\" or http.request.uri.path ~ \\\"^.*xmlrpc.php$\\\") and ip.src ne 93.184.216.34\",\n  \"description\": \"WordPress login paths via the login page or mobile RPC endpoint\"\n}","position":{"start":{"line":16,"column":1,"offset":455},"end":{"line":22,"column":4,"offset":716},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The expression specified in this example filter is:","position":{"start":{"line":24,"column":1,"offset":718},"end":{"line":24,"column":52,"offset":769},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":718},"end":{"line":24,"column":52,"offset":769},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"(http.request.uri.path ~ \"^.*wp-login.php$\" or http.request.uri.path ~ \"^.*xmlrpc.php$\") and ip.src ne 93.184.216.34","position":{"start":{"line":26,"column":1,"offset":771},"end":{"line":28,"column":4,"offset":898},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This filter expression has a ","position":{"start":{"line":30,"column":1,"offset":900},"end":{"line":30,"column":30,"offset":929},"indent":[]}},{"type":"inlineCode","value":"(this or that) and not this","position":{"start":{"line":30,"column":30,"offset":929},"end":{"line":30,"column":59,"offset":958},"indent":[]}},{"type":"text","value":" structure designed to:","position":{"start":{"line":30,"column":59,"offset":958},"end":{"line":30,"column":82,"offset":981},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":900},"end":{"line":30,"column":82,"offset":981},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Capture two WordPress paths that may be subject to brute force password attacks, and","position":{"start":{"line":32,"column":4,"offset":986},"end":{"line":32,"column":88,"offset":1070},"indent":[]}}],"position":{"start":{"line":32,"column":4,"offset":986},"end":{"line":32,"column":88,"offset":1070},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":983},"end":{"line":32,"column":88,"offset":1070},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Exclude traffic that comes from the IP address ","position":{"start":{"line":33,"column":4,"offset":1074},"end":{"line":33,"column":51,"offset":1121},"indent":[]}},{"type":"inlineCode","value":"93.184.216.34","position":{"start":{"line":33,"column":51,"offset":1121},"end":{"line":33,"column":66,"offset":1136},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":33,"column":66,"offset":1136},"end":{"line":33,"column":67,"offset":1137},"indent":[]}}],"position":{"start":{"line":33,"column":4,"offset":1074},"end":{"line":33,"column":67,"offset":1137},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":1071},"end":{"line":33,"column":67,"offset":1137},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":983},"end":{"line":33,"column":67,"offset":1137},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Imagine that this is an IP for your office. This expression demonstrates a filter that might be used (in a Firewall Rule) to block access to the WordPress login when accessed outside the office network.","position":{"start":{"line":35,"column":1,"offset":1139},"end":{"line":35,"column":203,"offset":1341},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1139},"end":{"line":35,"column":203,"offset":1341},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information on rule expressions, refer to ","position":{"start":{"line":37,"column":1,"offset":1343},"end":{"line":37,"column":52,"offset":1394},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/expressions","children":[{"type":"text","value":"Expressions","position":{"start":{"line":37,"column":53,"offset":1395},"end":{"line":37,"column":64,"offset":1406},"indent":[]}}],"position":{"start":{"line":37,"column":52,"offset":1394},"end":{"line":37,"column":142,"offset":1484},"indent":[]}},{"type":"text","value":" in the Rules language documentation.","position":{"start":{"line":37,"column":142,"offset":1484},"end":{"line":37,"column":179,"offset":1521},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1343},"end":{"line":37,"column":179,"offset":1521},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":39,"column":99,"offset":1621}}}}},{"node":{"fields":{"slug":"/api/cf-filters/validation"},"frontmatter":{"order":480,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Expression validation"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Expression validation","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":24,"offset":24},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":24,"offset":24},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Filters API supports an endpoint for validating expressions.","position":{"start":{"line":4,"column":1,"offset":26},"end":{"line":4,"column":76,"offset":101},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":26},"end":{"line":4,"column":76,"offset":101},"indent":[]}},{"type":"html","value":"<TableWrap>\n  <table style=\"width: 100%;\">\n    <thead>\n        <tr>\n            <th>\n                Operation\n            </th>\n            <th>\n                Method + Endpoint\n            </th>\n            <th>\n                Notes\n            </th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td style='width:25%; word-wrap:break-word; white-space:normal'>Validate expression via query string (<em>?expression=</em>) </td>\n            <td><code class='InlineCode'>GET /filters/validate-expr</code></td>\n            <td>Allows testing and validating expressions without changing anything</td>\n        </tr>\n        <tr>\n            <td style='width:25%; word-wrap:break-word; white-space:normal'>Validate expression via JSON object</td>\n            <td><code class='InlineCode'>POST /filters/validate-expr</code></td>\n            <td>Allows testing and validating expressions without changing anything</td>\n        </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":6,"column":1,"offset":103},"end":{"line":34,"column":13,"offset":1086},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Examples","position":{"start":{"line":36,"column":4,"offset":1091},"end":{"line":36,"column":12,"offset":1099},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1088},"end":{"line":36,"column":12,"offset":1099},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Validate expression via query string","position":{"start":{"line":38,"column":5,"offset":1105},"end":{"line":38,"column":41,"offset":1141},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1101},"end":{"line":38,"column":41,"offset":1141},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"---\nheader: Request\n---\ncurl -X GET \\\n'https://api.cloudflare.com/client/v4/filters/validate-expr?expression=ip.src==34' \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\"","position":{"start":{"line":40,"column":1,"offset":1143},"end":{"line":48,"column":4,"offset":1333},"indent":[1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": null,\n  \"success\": false,\n  \"errors\": [\n    {\n      \"message\": \"Filter parsing error:\\n`ip.src==34`\\n          ^^ couldn't parse address in network: invalid IP address syntax\\n\"\n    }\n  ],\n  \"messages\": null\n}","position":{"start":{"line":50,"column":1,"offset":1335},"end":{"line":64,"column":4,"offset":1595},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note the validation error in the response. In this example, the error is due to an invalid IP address format:","position":{"start":{"line":66,"column":1,"offset":1597},"end":{"line":66,"column":110,"offset":1706},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":1597},"end":{"line":66,"column":110,"offset":1706},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"Filter parsing error:\n`ip.src==34`\n          ^^ couldn't parse address in network: invalid IP address syntax","position":{"start":{"line":68,"column":1,"offset":1708},"end":{"line":72,"column":4,"offset":1827},"indent":[1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Validate expression via JSON object","position":{"start":{"line":74,"column":5,"offset":1833},"end":{"line":74,"column":40,"offset":1868},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":1829},"end":{"line":74,"column":40,"offset":1868},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X POST \\\n\"https://api.cloudflare.com/client/v4/filters/validate-expr\" \\\n-H \"X-Auth-Email: <EMAIL>\" \\\n-H \"X-Auth-Key: <API_KEY>\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n  \"expression\": \"ip.src in {2400:cb00::/32 2405:8100::/2000 2c0f:f248::/32 2a06:98c0::/29}\"\n}' ","position":{"start":{"line":76,"column":1,"offset":1870},"end":{"line":88,"column":4,"offset":2181},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": null,\n  \"success\": false,\n  \"errors\": [\n    {\n      \"message\": \"Filter parsing error:\\n`ip.src in {2400:cb00::/32 2405:8100::/2000 2c0f:f248::/32 2a06:98c0::/29}`\\n                                        ^^^^ number too large to fit in target type while parsing with radix 10\\n\"\n    }\n  ],\n  \"messages\": null\n}","position":{"start":{"line":90,"column":1,"offset":2183},"end":{"line":104,"column":4,"offset":2544},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note the validation error in the response. In this example, the value for the subnet mask, ","position":{"start":{"line":106,"column":1,"offset":2546},"end":{"line":106,"column":92,"offset":2637},"indent":[]}},{"type":"inlineCode","value":"/2000","position":{"start":{"line":106,"column":92,"offset":2637},"end":{"line":106,"column":99,"offset":2644},"indent":[]}},{"type":"text","value":", is not a valid IPv6 CIDR mask:","position":{"start":{"line":106,"column":99,"offset":2644},"end":{"line":106,"column":131,"offset":2676},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":2546},"end":{"line":106,"column":131,"offset":2676},"indent":[]}},{"type":"code","lang":"txt","meta":null,"value":"Filter parsing error:\n`ip.src in {2400:cb00::/32 2405:8100::/2000 2c0f:f248::/32 2a06:98c0::/29}`\n                                        ^^^^ number too large to fit in target type while parsing with radix 10","position":{"start":{"line":108,"column":1,"offset":2678},"end":{"line":112,"column":4,"offset":2898},"indent":[1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":115,"column":88,"offset":2988}}}}},{"node":{"fields":{"slug":"/cf-firewall-language/values"},"frontmatter":{"order":630,"title":"","summary":null,"demo":null,"tags":null},"headings":[{"value":"Values"}],"parent":{"__typename":"File","modifiedTime":"2021-12-17"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Values","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":9,"offset":9},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":9,"offset":9},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When an HTTP request reaches Cloudflare’s edge, Cloudflare creates a table of field–value pairs against which to match expressions. This table exists for as long as the current request is being processed.","position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":205,"offset":215},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":205,"offset":215},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The values that populate Firewall Rules lookup tables are drawn from a variety of sources:","position":{"start":{"line":6,"column":1,"offset":217},"end":{"line":6,"column":91,"offset":307},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":217},"end":{"line":6,"column":91,"offset":307},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Primitive properties","position":{"start":{"line":8,"column":5,"offset":313},"end":{"line":8,"column":25,"offset":333},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":311},"end":{"line":8,"column":27,"offset":335},"indent":[]}},{"type":"text","value":" are obtained directly from the request (","position":{"start":{"line":8,"column":27,"offset":335},"end":{"line":8,"column":68,"offset":376},"indent":[]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":8,"column":68,"offset":376},"end":{"line":8,"column":91,"offset":399},"indent":[]}},{"type":"text","value":", for example).","position":{"start":{"line":8,"column":91,"offset":399},"end":{"line":8,"column":106,"offset":414},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":311},"end":{"line":8,"column":106,"offset":414},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":309},"end":{"line":8,"column":106,"offset":414},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Derived values","position":{"start":{"line":9,"column":5,"offset":419},"end":{"line":9,"column":19,"offset":433},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":417},"end":{"line":9,"column":21,"offset":435},"indent":[]}},{"type":"text","value":" are the product of a transformation, composition, or basic operation. For example, the transformation ","position":{"start":{"line":9,"column":21,"offset":435},"end":{"line":9,"column":124,"offset":538},"indent":[]}},{"type":"inlineCode","value":"lower(http.request.uri.patch)","position":{"start":{"line":9,"column":124,"offset":538},"end":{"line":9,"column":155,"offset":569},"indent":[]}},{"type":"text","value":" converts the value of ","position":{"start":{"line":9,"column":155,"offset":569},"end":{"line":9,"column":178,"offset":592},"indent":[]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":9,"column":178,"offset":592},"end":{"line":9,"column":201,"offset":615},"indent":[]}},{"type":"text","value":" to lowercase.","position":{"start":{"line":9,"column":201,"offset":615},"end":{"line":9,"column":215,"offset":629},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":417},"end":{"line":9,"column":215,"offset":629},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":415},"end":{"line":9,"column":215,"offset":629},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Computed values","position":{"start":{"line":10,"column":5,"offset":634},"end":{"line":10,"column":20,"offset":649},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":632},"end":{"line":10,"column":22,"offset":651},"indent":[]}},{"type":"text","value":" are the product of a lookup, computation, or other intelligence. For example, Cloudflare uses a machine learning process to dynamically calculate threat scores, represented by the ","position":{"start":{"line":10,"column":22,"offset":651},"end":{"line":10,"column":203,"offset":832},"indent":[]}},{"type":"inlineCode","value":"cf.threat_score","position":{"start":{"line":10,"column":203,"offset":832},"end":{"line":10,"column":220,"offset":849},"indent":[]}},{"type":"text","value":" field.","position":{"start":{"line":10,"column":220,"offset":849},"end":{"line":10,"column":227,"offset":856},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":632},"end":{"line":10,"column":227,"offset":856},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":630},"end":{"line":10,"column":227,"offset":856},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":309},"end":{"line":10,"column":227,"offset":856},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"When working with values in Firewall Rules expressions, keep in mind the notes outlined below for escape characters, case sensitivity, and boolean values.","position":{"start":{"line":12,"column":1,"offset":858},"end":{"line":12,"column":155,"offset":1012},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":858},"end":{"line":12,"column":155,"offset":1012},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Escape characters in values","position":{"start":{"line":14,"column":4,"offset":1017},"end":{"line":14,"column":31,"offset":1044},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":1014},"end":{"line":14,"column":31,"offset":1044},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You must manually escape the backslash (","position":{"start":{"line":16,"column":1,"offset":1046},"end":{"line":16,"column":41,"offset":1086},"indent":[]}},{"type":"inlineCode","value":"\\","position":{"start":{"line":16,"column":41,"offset":1086},"end":{"line":16,"column":44,"offset":1089},"indent":[]}},{"type":"text","value":") and double quote (","position":{"start":{"line":16,"column":44,"offset":1089},"end":{"line":16,"column":64,"offset":1109},"indent":[]}},{"type":"inlineCode","value":"\"","position":{"start":{"line":16,"column":64,"offset":1109},"end":{"line":16,"column":67,"offset":1112},"indent":[]}},{"type":"text","value":") characters with a backslash when using them as part of a literal value in an expression.","position":{"start":{"line":16,"column":67,"offset":1112},"end":{"line":16,"column":157,"offset":1202},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1046},"end":{"line":16,"column":157,"offset":1202},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Note in this example that the first and last ","position":{"start":{"line":18,"column":1,"offset":1204},"end":{"line":18,"column":46,"offset":1249},"indent":[]}},{"type":"inlineCode","value":"\"","position":{"start":{"line":18,"column":46,"offset":1249},"end":{"line":18,"column":49,"offset":1252},"indent":[]}},{"type":"text","value":" characters in ","position":{"start":{"line":18,"column":49,"offset":1252},"end":{"line":18,"column":64,"offset":1267},"indent":[]}},{"type":"inlineCode","value":"\"token-type=\\\"JWT\\\"\"","position":{"start":{"line":18,"column":64,"offset":1267},"end":{"line":18,"column":86,"offset":1289},"indent":[]}},{"type":"text","value":" are not part of the literal value, so they do not need escaping:","position":{"start":{"line":18,"column":86,"offset":1289},"end":{"line":18,"column":151,"offset":1354},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1204},"end":{"line":18,"column":151,"offset":1354},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(http.request.uri.query contains \"token-type=\\\"JWT\\\"\")","position":{"start":{"line":20,"column":1,"offset":1356},"end":{"line":22,"column":4,"offset":1421},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Case sensitivity and regular expressions in values","position":{"start":{"line":24,"column":4,"offset":1426},"end":{"line":24,"column":54,"offset":1476},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1423},"end":{"line":24,"column":54,"offset":1476},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Since the evaluation of expressions using string values is case-sensitive, consider writing more than one simple expression to capture variants.","position":{"start":{"line":26,"column":1,"offset":1478},"end":{"line":26,"column":145,"offset":1622},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1478},"end":{"line":26,"column":145,"offset":1622},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Business and Enterprise customer plans have access to the ","position":{"start":{"line":28,"column":1,"offset":1624},"end":{"line":28,"column":70,"offset":1693},"indent":[]}},{"type":"inlineCode","value":"matches","position":{"start":{"line":28,"column":70,"offset":1693},"end":{"line":28,"column":79,"offset":1702},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":28,"column":79,"offset":1702},"end":{"line":28,"column":80,"offset":1703},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators/#comparison-operators","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":28,"column":81,"offset":1704},"end":{"line":28,"column":100,"offset":1723},"indent":[]}}],"position":{"start":{"line":28,"column":80,"offset":1703},"end":{"line":28,"column":156,"offset":1779},"indent":[]}},{"type":"text","value":" which supports regular expressions, so that you can capture multiple variants of a value with a single expression.","position":{"start":{"line":28,"column":156,"offset":1779},"end":{"line":28,"column":271,"offset":1894},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1624},"end":{"line":28,"column":271,"offset":1894},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Boolean values","position":{"start":{"line":30,"column":4,"offset":1899},"end":{"line":30,"column":18,"offset":1913},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1896},"end":{"line":30,"column":18,"offset":1913},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions using boolean fields do not require operator notations or values. You only need to insert the field on its own, as shown in the ","position":{"start":{"line":32,"column":1,"offset":1915},"end":{"line":32,"column":148,"offset":2062},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":32,"column":148,"offset":2062},"end":{"line":32,"column":153,"offset":2067},"indent":[]}},{"type":"text","value":" example below.","position":{"start":{"line":32,"column":153,"offset":2067},"end":{"line":32,"column":168,"offset":2082},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1915},"end":{"line":32,"column":168,"offset":2082},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"ssl","position":{"start":{"line":34,"column":1,"offset":2084},"end":{"line":36,"column":4,"offset":2098},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This simple expression matches requests where the value of the ","position":{"start":{"line":38,"column":1,"offset":2100},"end":{"line":38,"column":64,"offset":2163},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":38,"column":64,"offset":2163},"end":{"line":38,"column":69,"offset":2168},"indent":[]}},{"type":"text","value":" field is ","position":{"start":{"line":38,"column":69,"offset":2168},"end":{"line":38,"column":79,"offset":2178},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":38,"column":79,"offset":2178},"end":{"line":38,"column":85,"offset":2184},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":38,"column":85,"offset":2184},"end":{"line":38,"column":86,"offset":2185},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":2100},"end":{"line":38,"column":86,"offset":2185},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To match requests where ","position":{"start":{"line":40,"column":1,"offset":2187},"end":{"line":40,"column":25,"offset":2211},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":40,"column":25,"offset":2211},"end":{"line":40,"column":30,"offset":2216},"indent":[]}},{"type":"text","value":" is ","position":{"start":{"line":40,"column":30,"offset":2216},"end":{"line":40,"column":34,"offset":2220},"indent":[]}},{"type":"inlineCode","value":"false","position":{"start":{"line":40,"column":34,"offset":2220},"end":{"line":40,"column":41,"offset":2227},"indent":[]}},{"type":"text","value":", use the boolean ","position":{"start":{"line":40,"column":41,"offset":2227},"end":{"line":40,"column":59,"offset":2245},"indent":[]}},{"type":"inlineCode","value":"not","position":{"start":{"line":40,"column":59,"offset":2245},"end":{"line":40,"column":64,"offset":2250},"indent":[]}},{"type":"text","value":" operator :","position":{"start":{"line":40,"column":64,"offset":2250},"end":{"line":40,"column":75,"offset":2261},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2187},"end":{"line":40,"column":75,"offset":2261},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"not ssl","position":{"start":{"line":42,"column":1,"offset":2263},"end":{"line":44,"column":4,"offset":2281},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Arrays","position":{"start":{"line":46,"column":4,"offset":2286},"end":{"line":46,"column":10,"offset":2292},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2283},"end":{"line":46,"column":10,"offset":2292},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language includes ","position":{"start":{"line":48,"column":1,"offset":2294},"end":{"line":48,"column":49,"offset":2342},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/fields","children":[{"type":"text","value":"fields","position":{"start":{"line":48,"column":50,"offset":2343},"end":{"line":48,"column":56,"offset":2349},"indent":[]}}],"position":{"start":{"line":48,"column":49,"offset":2342},"end":{"line":48,"column":87,"offset":2380},"indent":[]}},{"type":"text","value":" of ","position":{"start":{"line":48,"column":87,"offset":2380},"end":{"line":48,"column":91,"offset":2384},"indent":[]}},{"type":"inlineCode","value":"Array","position":{"start":{"line":48,"column":91,"offset":2384},"end":{"line":48,"column":98,"offset":2391},"indent":[]}},{"type":"text","value":" type and ","position":{"start":{"line":48,"column":98,"offset":2391},"end":{"line":48,"column":108,"offset":2401},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/functions","children":[{"type":"text","value":"functions","position":{"start":{"line":48,"column":109,"offset":2402},"end":{"line":48,"column":118,"offset":2411},"indent":[]}}],"position":{"start":{"line":48,"column":108,"offset":2401},"end":{"line":48,"column":152,"offset":2445},"indent":[]}},{"type":"text","value":" with ","position":{"start":{"line":48,"column":152,"offset":2445},"end":{"line":48,"column":158,"offset":2451},"indent":[]}},{"type":"inlineCode","value":"Array","position":{"start":{"line":48,"column":158,"offset":2451},"end":{"line":48,"column":165,"offset":2458},"indent":[]}},{"type":"text","value":" arguments and return values.","position":{"start":{"line":48,"column":165,"offset":2458},"end":{"line":48,"column":194,"offset":2487},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2294},"end":{"line":48,"column":194,"offset":2487},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can access individual array elements using an index (a non-negative value) between square brackets (","position":{"start":{"line":50,"column":1,"offset":2489},"end":{"line":50,"column":105,"offset":2593},"indent":[]}},{"type":"inlineCode","value":"[]","position":{"start":{"line":50,"column":105,"offset":2593},"end":{"line":50,"column":109,"offset":2597},"indent":[]}},{"type":"text","value":"). Array indexes start at ","position":{"start":{"line":50,"column":109,"offset":2597},"end":{"line":50,"column":135,"offset":2623},"indent":[]}},{"type":"inlineCode","value":"0","position":{"start":{"line":50,"column":135,"offset":2623},"end":{"line":50,"column":138,"offset":2626},"indent":[]}},{"type":"text","value":" (zero).","position":{"start":{"line":50,"column":138,"offset":2626},"end":{"line":50,"column":146,"offset":2634},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2489},"end":{"line":50,"column":146,"offset":2634},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the special notation ","position":{"start":{"line":52,"column":1,"offset":2636},"end":{"line":52,"column":26,"offset":2661},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":52,"column":26,"offset":2661},"end":{"line":52,"column":31,"offset":2666},"indent":[]}},{"type":"text","value":" when specifying an expression that will be evaluated for each array element (like the ","position":{"start":{"line":52,"column":31,"offset":2666},"end":{"line":52,"column":118,"offset":2753},"indent":[]}},{"type":"link","title":null,"url":"https://wikipedia.org/wiki/Map_(higher-order_function)","children":[{"type":"inlineCode","value":"map","position":{"start":{"line":52,"column":119,"offset":2754},"end":{"line":52,"column":124,"offset":2759},"indent":[]}},{"type":"text","value":" high-order function","position":{"start":{"line":52,"column":124,"offset":2759},"end":{"line":52,"column":144,"offset":2779},"indent":[]}}],"position":{"start":{"line":52,"column":118,"offset":2753},"end":{"line":52,"column":201,"offset":2836},"indent":[]}},{"type":"text","value":"). This special index notation will unpack the array, call the enclosing function for all its elements individually, and return a new array containing all the individual return values.","position":{"start":{"line":52,"column":201,"offset":2836},"end":{"line":52,"column":385,"offset":3020},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2636},"end":{"line":52,"column":385,"offset":3020},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Examples","position":{"start":{"line":54,"column":5,"offset":3026},"end":{"line":54,"column":13,"offset":3034},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":3022},"end":{"line":54,"column":13,"offset":3034},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Consider the ","position":{"start":{"line":56,"column":1,"offset":3036},"end":{"line":56,"column":14,"offset":3049},"indent":[]}},{"type":"inlineCode","value":"http.request.headers.names","position":{"start":{"line":56,"column":14,"offset":3049},"end":{"line":56,"column":42,"offset":3077},"indent":[]}},{"type":"text","value":" field with type ","position":{"start":{"line":56,"column":42,"offset":3077},"end":{"line":56,"column":59,"offset":3094},"indent":[]}},{"type":"inlineCode","value":"Array<String>","position":{"start":{"line":56,"column":59,"offset":3094},"end":{"line":56,"column":74,"offset":3109},"indent":[]}},{"type":"text","value":" in the following examples:","position":{"start":{"line":56,"column":74,"offset":3109},"end":{"line":56,"column":101,"offset":3136},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":3036},"end":{"line":56,"column":101,"offset":3136},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Obtain the first element in the array:","position":{"start":{"line":58,"column":3,"offset":3140},"end":{"line":58,"column":41,"offset":3178},"indent":[]}},{"type":"html","value":"<br/>","position":{"start":{"line":58,"column":41,"offset":3178},"end":{"line":58,"column":46,"offset":3183},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":58,"column":46,"offset":3183},"end":{"line":59,"column":3,"offset":3186},"indent":[3]}},{"type":"inlineCode","value":"http.request.headers.names[0]","position":{"start":{"line":59,"column":3,"offset":3186},"end":{"line":59,"column":34,"offset":3217},"indent":[]}}],"position":{"start":{"line":58,"column":3,"offset":3140},"end":{"line":59,"column":34,"offset":3217},"indent":[3]}}],"position":{"start":{"line":58,"column":1,"offset":3138},"end":{"line":60,"column":1,"offset":3218},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if the first array element is equal to ","position":{"start":{"line":61,"column":3,"offset":3221},"end":{"line":61,"column":48,"offset":3266},"indent":[]}},{"type":"inlineCode","value":"Content-Type","position":{"start":{"line":61,"column":48,"offset":3266},"end":{"line":61,"column":62,"offset":3280},"indent":[]}},{"type":"text","value":" (case sensitive):","position":{"start":{"line":61,"column":62,"offset":3280},"end":{"line":61,"column":80,"offset":3298},"indent":[]}},{"type":"html","value":"<br/>","position":{"start":{"line":61,"column":80,"offset":3298},"end":{"line":61,"column":85,"offset":3303},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":61,"column":85,"offset":3303},"end":{"line":62,"column":3,"offset":3306},"indent":[3]}},{"type":"inlineCode","value":"http.request.headers.names[0] == \"Content-Type\"","position":{"start":{"line":62,"column":3,"offset":3306},"end":{"line":62,"column":52,"offset":3355},"indent":[]}}],"position":{"start":{"line":61,"column":3,"offset":3221},"end":{"line":62,"column":52,"offset":3355},"indent":[3]}}],"position":{"start":{"line":61,"column":1,"offset":3219},"end":{"line":63,"column":1,"offset":3356},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if any array element is equal to ","position":{"start":{"line":64,"column":3,"offset":3359},"end":{"line":64,"column":42,"offset":3398},"indent":[]}},{"type":"inlineCode","value":"Content-Type","position":{"start":{"line":64,"column":42,"offset":3398},"end":{"line":64,"column":56,"offset":3412},"indent":[]}},{"type":"text","value":" (case sensitive):","position":{"start":{"line":64,"column":56,"offset":3412},"end":{"line":64,"column":74,"offset":3430},"indent":[]}},{"type":"html","value":"<br/>","position":{"start":{"line":64,"column":74,"offset":3430},"end":{"line":64,"column":79,"offset":3435},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":64,"column":79,"offset":3435},"end":{"line":65,"column":3,"offset":3438},"indent":[3]}},{"type":"inlineCode","value":"any(http.request.headers.names[*] == \"Content-Type\")","position":{"start":{"line":65,"column":3,"offset":3438},"end":{"line":65,"column":57,"offset":3492},"indent":[]}}],"position":{"start":{"line":64,"column":3,"offset":3359},"end":{"line":65,"column":57,"offset":3492},"indent":[3]}}],"position":{"start":{"line":64,"column":1,"offset":3357},"end":{"line":66,"column":1,"offset":3493},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if any array element is equal to ","position":{"start":{"line":67,"column":3,"offset":3496},"end":{"line":67,"column":42,"offset":3535},"indent":[]}},{"type":"inlineCode","value":"Content-Type","position":{"start":{"line":67,"column":42,"offset":3535},"end":{"line":67,"column":56,"offset":3549},"indent":[]}},{"type":"text","value":", ignoring the case:","position":{"start":{"line":67,"column":56,"offset":3549},"end":{"line":67,"column":76,"offset":3569},"indent":[]}},{"type":"html","value":"<br/>","position":{"start":{"line":67,"column":76,"offset":3569},"end":{"line":67,"column":81,"offset":3574},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":67,"column":81,"offset":3574},"end":{"line":68,"column":3,"offset":3577},"indent":[3]}},{"type":"inlineCode","value":"any(lower(http.request.headers.names[*])[*] == \"content-type\")","position":{"start":{"line":68,"column":3,"offset":3577},"end":{"line":68,"column":67,"offset":3641},"indent":[]}}],"position":{"start":{"line":67,"column":3,"offset":3496},"end":{"line":68,"column":67,"offset":3641},"indent":[3]}}],"position":{"start":{"line":67,"column":1,"offset":3494},"end":{"line":68,"column":67,"offset":3641},"indent":[1]}}],"position":{"start":{"line":58,"column":1,"offset":3138},"end":{"line":68,"column":67,"offset":3641},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In the last example, the ","position":{"start":{"line":70,"column":1,"offset":3643},"end":{"line":70,"column":26,"offset":3668},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":70,"column":26,"offset":3668},"end":{"line":70,"column":35,"offset":3677},"indent":[]}},{"type":"text","value":" function includes the ","position":{"start":{"line":70,"column":35,"offset":3677},"end":{"line":70,"column":58,"offset":3700},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":70,"column":58,"offset":3700},"end":{"line":70,"column":63,"offset":3705},"indent":[]}},{"type":"text","value":" notation so that the function is evaluated for each array element. This function, used along ","position":{"start":{"line":70,"column":63,"offset":3705},"end":{"line":70,"column":157,"offset":3799},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":70,"column":157,"offset":3799},"end":{"line":70,"column":162,"offset":3804},"indent":[]}},{"type":"text","value":", returns a new array where each element of the input array is converted to lowercase. Then, the string comparison uses ","position":{"start":{"line":70,"column":162,"offset":3804},"end":{"line":70,"column":282,"offset":3924},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":70,"column":282,"offset":3924},"end":{"line":70,"column":287,"offset":3929},"indent":[]}},{"type":"text","value":" to transform the array resulting from applying ","position":{"start":{"line":70,"column":287,"offset":3929},"end":{"line":70,"column":335,"offset":3977},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":70,"column":335,"offset":3977},"end":{"line":70,"column":344,"offset":3986},"indent":[]}},{"type":"text","value":" to each header name into an array of boolean values. Finally, ","position":{"start":{"line":70,"column":344,"offset":3986},"end":{"line":70,"column":407,"offset":4049},"indent":[]}},{"type":"inlineCode","value":"any()","position":{"start":{"line":70,"column":407,"offset":4049},"end":{"line":70,"column":414,"offset":4056},"indent":[]}},{"type":"text","value":" evaluates to true if at least one of these array elements is true.","position":{"start":{"line":70,"column":414,"offset":4056},"end":{"line":70,"column":481,"offset":4123},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":3643},"end":{"line":70,"column":481,"offset":4123},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Final notes","position":{"start":{"line":72,"column":5,"offset":4129},"end":{"line":72,"column":16,"offset":4140},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":4125},"end":{"line":72,"column":16,"offset":4140},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"It is not possible to define your own arrays. You can only use arrays returned by fields, either directly or modified by functions.","position":{"start":{"line":74,"column":1,"offset":4142},"end":{"line":74,"column":132,"offset":4273},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":4142},"end":{"line":74,"column":132,"offset":4273},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Accessing an out-of-bounds array index produces a \"missing value\". A missing value has the following behavior:","position":{"start":{"line":76,"column":1,"offset":4275},"end":{"line":76,"column":111,"offset":4385},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":4275},"end":{"line":76,"column":111,"offset":4385},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Any comparison ","position":{"start":{"line":78,"column":3,"offset":4389},"end":{"line":78,"column":18,"offset":4404},"indent":[]}},{"type":"inlineCode","value":"<expr> <op> <literal>","position":{"start":{"line":78,"column":18,"offset":4404},"end":{"line":78,"column":41,"offset":4427},"indent":[]}},{"type":"text","value":" where ","position":{"start":{"line":78,"column":41,"offset":4427},"end":{"line":78,"column":48,"offset":4434},"indent":[]}},{"type":"inlineCode","value":"<expr>","position":{"start":{"line":78,"column":48,"offset":4434},"end":{"line":78,"column":56,"offset":4442},"indent":[]}},{"type":"text","value":" evaluates to a missing value will evaluate to false.","position":{"start":{"line":78,"column":56,"offset":4442},"end":{"line":78,"column":109,"offset":4495},"indent":[]}}],"position":{"start":{"line":78,"column":3,"offset":4389},"end":{"line":78,"column":109,"offset":4495},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":4387},"end":{"line":78,"column":109,"offset":4495},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Function calls like ","position":{"start":{"line":79,"column":3,"offset":4498},"end":{"line":79,"column":23,"offset":4518},"indent":[]}},{"type":"inlineCode","value":"function(<expr>)","position":{"start":{"line":79,"column":23,"offset":4518},"end":{"line":79,"column":41,"offset":4536},"indent":[]}},{"type":"text","value":", where ","position":{"start":{"line":79,"column":41,"offset":4536},"end":{"line":79,"column":49,"offset":4544},"indent":[]}},{"type":"inlineCode","value":"<expr>","position":{"start":{"line":79,"column":49,"offset":4544},"end":{"line":79,"column":57,"offset":4552},"indent":[]}},{"type":"text","value":" evaluates to a missing value, will return a missing value in most cases, but the exact behavior can vary per function.","position":{"start":{"line":79,"column":57,"offset":4552},"end":{"line":79,"column":176,"offset":4671},"indent":[]}}],"position":{"start":{"line":79,"column":3,"offset":4498},"end":{"line":79,"column":176,"offset":4671},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":4496},"end":{"line":79,"column":176,"offset":4671},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":4387},"end":{"line":79,"column":176,"offset":4671},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"You can only use ","position":{"start":{"line":81,"column":1,"offset":4673},"end":{"line":81,"column":18,"offset":4690},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":81,"column":18,"offset":4690},"end":{"line":81,"column":23,"offset":4695},"indent":[]}},{"type":"text","value":" multiple times in the same expression if applied to the same array. Also, you can only use ","position":{"start":{"line":81,"column":23,"offset":4695},"end":{"line":81,"column":115,"offset":4787},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":81,"column":115,"offset":4787},"end":{"line":81,"column":120,"offset":4792},"indent":[]}},{"type":"text","value":" in the first argument of a function call.","position":{"start":{"line":81,"column":120,"offset":4792},"end":{"line":81,"column":162,"offset":4834},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":4673},"end":{"line":81,"column":162,"offset":4834},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language ","position":{"start":{"line":83,"column":1,"offset":4836},"end":{"line":83,"column":29,"offset":4864},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators","children":[{"type":"text","value":"operators","position":{"start":{"line":83,"column":30,"offset":4865},"end":{"line":83,"column":39,"offset":4874},"indent":[]}}],"position":{"start":{"line":83,"column":29,"offset":4864},"end":{"line":83,"column":73,"offset":4908},"indent":[]}},{"type":"text","value":" do not directly support arrays or the ","position":{"start":{"line":83,"column":73,"offset":4908},"end":{"line":83,"column":112,"offset":4947},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":83,"column":112,"offset":4947},"end":{"line":83,"column":117,"offset":4952},"indent":[]}},{"type":"text","value":" operator — however, they support indexed array elements like ","position":{"start":{"line":83,"column":117,"offset":4952},"end":{"line":83,"column":179,"offset":5014},"indent":[]}},{"type":"inlineCode","value":"array_value[0]","position":{"start":{"line":83,"column":179,"offset":5014},"end":{"line":83,"column":195,"offset":5030},"indent":[]}},{"type":"text","value":". For example, you cannot use ","position":{"start":{"line":83,"column":195,"offset":5030},"end":{"line":83,"column":225,"offset":5060},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":83,"column":225,"offset":5060},"end":{"line":83,"column":230,"offset":5065},"indent":[]}},{"type":"text","value":" with the ","position":{"start":{"line":83,"column":230,"offset":5065},"end":{"line":83,"column":240,"offset":5075},"indent":[]}},{"type":"inlineCode","value":"==","position":{"start":{"line":83,"column":240,"offset":5075},"end":{"line":83,"column":244,"offset":5079},"indent":[]}},{"type":"text","value":" operator outside the context of an enclosing function call:","position":{"start":{"line":83,"column":244,"offset":5079},"end":{"line":83,"column":304,"offset":5139},"indent":[]}}],"position":{"start":{"line":83,"column":1,"offset":4836},"end":{"line":83,"column":304,"offset":5139},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"http.request.headers.names[*] == \"Content-Type\"","position":{"start":{"line":85,"column":3,"offset":5143},"end":{"line":85,"column":52,"offset":5192},"indent":[]}},{"type":"text","value":" — ","position":{"start":{"line":85,"column":52,"offset":5192},"end":{"line":85,"column":55,"offset":5195},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Invalid","position":{"start":{"line":85,"column":57,"offset":5197},"end":{"line":85,"column":64,"offset":5204},"indent":[]}}],"position":{"start":{"line":85,"column":55,"offset":5195},"end":{"line":85,"column":66,"offset":5206},"indent":[]}},{"type":"text","value":" expression","position":{"start":{"line":85,"column":66,"offset":5206},"end":{"line":85,"column":77,"offset":5217},"indent":[]}}],"position":{"start":{"line":85,"column":3,"offset":5143},"end":{"line":85,"column":77,"offset":5217},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":5141},"end":{"line":85,"column":77,"offset":5217},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"any(http.request.headers.names[*] == \"Content-Type\")","position":{"start":{"line":86,"column":3,"offset":5220},"end":{"line":86,"column":57,"offset":5274},"indent":[]}},{"type":"text","value":" — ","position":{"start":{"line":86,"column":57,"offset":5274},"end":{"line":86,"column":60,"offset":5277},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Valid","position":{"start":{"line":86,"column":62,"offset":5279},"end":{"line":86,"column":67,"offset":5284},"indent":[]}}],"position":{"start":{"line":86,"column":60,"offset":5277},"end":{"line":86,"column":69,"offset":5286},"indent":[]}},{"type":"text","value":" expression","position":{"start":{"line":86,"column":69,"offset":5286},"end":{"line":86,"column":80,"offset":5297},"indent":[]}}],"position":{"start":{"line":86,"column":3,"offset":5220},"end":{"line":86,"column":80,"offset":5297},"indent":[]}}],"position":{"start":{"line":86,"column":1,"offset":5218},"end":{"line":86,"column":80,"offset":5297},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":5141},"end":{"line":86,"column":80,"offset":5297},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"IP Lists","position":{"start":{"line":88,"column":4,"offset":5302},"end":{"line":88,"column":12,"offset":5310},"indent":[]}}],"position":{"start":{"line":88,"column":1,"offset":5299},"end":{"line":88,"column":12,"offset":5310},"indent":[]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-firewall-rules/rules-lists","children":[{"type":"text","value":"IP Lists","position":{"start":{"line":90,"column":2,"offset":5313},"end":{"line":90,"column":10,"offset":5321},"indent":[]}}],"position":{"start":{"line":90,"column":1,"offset":5312},"end":{"line":90,"column":43,"offset":5354},"indent":[]}},{"type":"text","value":" allow you to create a group of IP addresses and refer to them collectively, by name, in your firewall rule expressions.","position":{"start":{"line":90,"column":43,"offset":5354},"end":{"line":90,"column":163,"offset":5474},"indent":[]}}],"position":{"start":{"line":90,"column":1,"offset":5312},"end":{"line":90,"column":163,"offset":5474},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To refer to an IP List in a firewall rule expression, use ","position":{"start":{"line":92,"column":1,"offset":5476},"end":{"line":92,"column":59,"offset":5534},"indent":[]}},{"type":"inlineCode","value":"$<list_name>","position":{"start":{"line":92,"column":59,"offset":5534},"end":{"line":92,"column":73,"offset":5548},"indent":[]}},{"type":"text","value":" and specify the ","position":{"start":{"line":92,"column":73,"offset":5548},"end":{"line":92,"column":90,"offset":5565},"indent":[]}},{"type":"inlineCode","value":"in","position":{"start":{"line":92,"column":90,"offset":5565},"end":{"line":92,"column":94,"offset":5569},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":92,"column":94,"offset":5569},"end":{"line":92,"column":95,"offset":5570},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators","children":[{"type":"text","value":"operator","position":{"start":{"line":92,"column":96,"offset":5571},"end":{"line":92,"column":104,"offset":5579},"indent":[]}}],"position":{"start":{"line":92,"column":95,"offset":5570},"end":{"line":92,"column":138,"offset":5613},"indent":[]}},{"type":"text","value":". This example expression filters requests from IP addresses that are in an IP List named ","position":{"start":{"line":92,"column":138,"offset":5613},"end":{"line":92,"column":228,"offset":5703},"indent":[]}},{"type":"inlineCode","value":"office_network","position":{"start":{"line":92,"column":228,"offset":5703},"end":{"line":92,"column":244,"offset":5719},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":92,"column":244,"offset":5719},"end":{"line":92,"column":245,"offset":5720},"indent":[]}}],"position":{"start":{"line":92,"column":1,"offset":5476},"end":{"line":92,"column":245,"offset":5720},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(ip.src in $office_network)","position":{"start":{"line":94,"column":1,"offset":5722},"end":{"line":96,"column":4,"offset":5760},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note that names for IP Lists can only include lowercase letters, numbers, and the underscore (","position":{"start":{"line":98,"column":1,"offset":5762},"end":{"line":98,"column":95,"offset":5856},"indent":[]}},{"type":"inlineCode","value":"_","position":{"start":{"line":98,"column":95,"offset":5856},"end":{"line":98,"column":98,"offset":5859},"indent":[]}},{"type":"text","value":") character. For guidance on creating and managing lists, refer to ","position":{"start":{"line":98,"column":98,"offset":5859},"end":{"line":98,"column":165,"offset":5926},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-dashboard/rules-lists/manage-lists","children":[{"type":"text","value":"Use IP Lists: Manage Lists","position":{"start":{"line":98,"column":166,"offset":5927},"end":{"line":98,"column":192,"offset":5953},"indent":[]}}],"position":{"start":{"line":98,"column":165,"offset":5926},"end":{"line":98,"column":275,"offset":6036},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":98,"column":275,"offset":6036},"end":{"line":98,"column":276,"offset":6037},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":5762},"end":{"line":98,"column":276,"offset":6037},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":101,"column":73,"offset":6112}}}}},{"node":{"fields":{"slug":"/cf-firewall-rules/actions"},"frontmatter":{"order":220,"title":"Actions","summary":null,"demo":null,"tags":null},"headings":[{"value":"Firewall Rules actions"}],"parent":{"__typename":"File","modifiedTime":"2022-02-09"},"mdxAST":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Firewall Rules actions","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":25,"offset":25},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":25,"offset":25},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":4,"column":4,"offset":30},"end":{"line":4,"column":12,"offset":38},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":12,"offset":38},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The action of a Firewall Rule tells Cloudflare how to handle HTTP requests that have matched the rule expression.","position":{"start":{"line":6,"column":1,"offset":40},"end":{"line":6,"column":114,"offset":153},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":40},"end":{"line":6,"column":114,"offset":153},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Supported actions","position":{"start":{"line":8,"column":4,"offset":158},"end":{"line":8,"column":21,"offset":175},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":155},"end":{"line":8,"column":21,"offset":175},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The table below lists the actions available in Firewall Rules. These actions are listed in order of precedence. If the same request matches two different rules which have the same priority, precedence determines the action to take.","position":{"start":{"line":10,"column":1,"offset":177},"end":{"line":10,"column":232,"offset":408},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":177},"end":{"line":10,"column":232,"offset":408},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, the ","position":{"start":{"line":12,"column":1,"offset":410},"end":{"line":12,"column":18,"offset":427},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Allow","position":{"start":{"line":12,"column":19,"offset":428},"end":{"line":12,"column":24,"offset":433},"indent":[]}}],"position":{"start":{"line":12,"column":18,"offset":427},"end":{"line":12,"column":25,"offset":434},"indent":[]}},{"type":"text","value":" action takes precedence over the ","position":{"start":{"line":12,"column":25,"offset":434},"end":{"line":12,"column":59,"offset":468},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":12,"column":60,"offset":469},"end":{"line":12,"column":65,"offset":474},"indent":[]}}],"position":{"start":{"line":12,"column":59,"offset":468},"end":{"line":12,"column":66,"offset":475},"indent":[]}},{"type":"text","value":" action. In a case where a request matches a rule with the ","position":{"start":{"line":12,"column":66,"offset":475},"end":{"line":12,"column":125,"offset":534},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Allow","position":{"start":{"line":12,"column":126,"offset":535},"end":{"line":12,"column":131,"offset":540},"indent":[]}}],"position":{"start":{"line":12,"column":125,"offset":534},"end":{"line":12,"column":132,"offset":541},"indent":[]}},{"type":"text","value":" action and another with the ","position":{"start":{"line":12,"column":132,"offset":541},"end":{"line":12,"column":161,"offset":570},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Block","position":{"start":{"line":12,"column":162,"offset":571},"end":{"line":12,"column":167,"offset":576},"indent":[]}}],"position":{"start":{"line":12,"column":161,"offset":570},"end":{"line":12,"column":168,"offset":577},"indent":[]}},{"type":"text","value":" action, precedence resolves the tie, and Cloudflare allows the request.","position":{"start":{"line":12,"column":168,"offset":577},"end":{"line":12,"column":240,"offset":649},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":410},"end":{"line":12,"column":240,"offset":649},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"There are two exceptions to this behavior: the ","position":{"start":{"line":14,"column":1,"offset":651},"end":{"line":14,"column":48,"offset":698},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":14,"column":49,"offset":699},"end":{"line":14,"column":52,"offset":702},"indent":[]}}],"position":{"start":{"line":14,"column":48,"offset":698},"end":{"line":14,"column":53,"offset":703},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":14,"column":53,"offset":703},"end":{"line":14,"column":58,"offset":708},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Bypass","position":{"start":{"line":14,"column":59,"offset":709},"end":{"line":14,"column":65,"offset":715},"indent":[]}}],"position":{"start":{"line":14,"column":58,"offset":708},"end":{"line":14,"column":66,"offset":716},"indent":[]}},{"type":"text","value":" actions. Unlike other actions, ","position":{"start":{"line":14,"column":66,"offset":716},"end":{"line":14,"column":98,"offset":748},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":14,"column":99,"offset":749},"end":{"line":14,"column":102,"offset":752},"indent":[]}}],"position":{"start":{"line":14,"column":98,"offset":748},"end":{"line":14,"column":103,"offset":753},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":14,"column":103,"offset":753},"end":{"line":14,"column":108,"offset":758},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Bypass","position":{"start":{"line":14,"column":109,"offset":759},"end":{"line":14,"column":115,"offset":765},"indent":[]}}],"position":{"start":{"line":14,"column":108,"offset":758},"end":{"line":14,"column":116,"offset":766},"indent":[]}},{"type":"text","value":" do not terminate further evaluation within Firewall Rules. This means that if a request matches two different rules and one of those rules specifies the ","position":{"start":{"line":14,"column":116,"offset":766},"end":{"line":14,"column":270,"offset":920},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":14,"column":271,"offset":921},"end":{"line":14,"column":274,"offset":924},"indent":[]}}],"position":{"start":{"line":14,"column":270,"offset":920},"end":{"line":14,"column":275,"offset":925},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":14,"column":275,"offset":925},"end":{"line":14,"column":279,"offset":929},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Bypass","position":{"start":{"line":14,"column":280,"offset":930},"end":{"line":14,"column":286,"offset":936},"indent":[]}}],"position":{"start":{"line":14,"column":279,"offset":929},"end":{"line":14,"column":287,"offset":937},"indent":[]}},{"type":"text","value":" action, the second action will be triggered instead, even though ","position":{"start":{"line":14,"column":287,"offset":937},"end":{"line":14,"column":353,"offset":1003},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Log","position":{"start":{"line":14,"column":354,"offset":1004},"end":{"line":14,"column":357,"offset":1007},"indent":[]}}],"position":{"start":{"line":14,"column":353,"offset":1003},"end":{"line":14,"column":358,"offset":1008},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":14,"column":358,"offset":1008},"end":{"line":14,"column":359,"offset":1009},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"Bypass","position":{"start":{"line":14,"column":360,"offset":1010},"end":{"line":14,"column":366,"offset":1016},"indent":[]}}],"position":{"start":{"line":14,"column":359,"offset":1009},"end":{"line":14,"column":367,"offset":1017},"indent":[]}},{"type":"text","value":" has precedence.","position":{"start":{"line":14,"column":367,"offset":1017},"end":{"line":14,"column":383,"offset":1033},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":651},"end":{"line":14,"column":383,"offset":1033},"indent":[]}},{"type":"jsx","value":"<Aside type=\"note\">","position":{"start":{"line":16,"column":1,"offset":1035},"end":{"line":16,"column":20,"offset":1054},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For reference information on rule actions available for Cloudflare products powered by the Ruleset Engine, refer to ","position":{"start":{"line":18,"column":1,"offset":1056},"end":{"line":18,"column":117,"offset":1172},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rules-language/actions","children":[{"type":"text","value":"Rules language: Actions reference","position":{"start":{"line":18,"column":118,"offset":1173},"end":{"line":18,"column":151,"offset":1206},"indent":[]}}],"position":{"start":{"line":18,"column":117,"offset":1172},"end":{"line":18,"column":225,"offset":1280},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":18,"column":225,"offset":1280},"end":{"line":18,"column":226,"offset":1281},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1056},"end":{"line":18,"column":226,"offset":1281},"indent":[]}},{"type":"jsx","value":"</Aside>","position":{"start":{"line":20,"column":1,"offset":1283},"end":{"line":20,"column":9,"offset":1291},"indent":[]}},{"type":"jsx","value":"<TableWrap>\n  <table style=\"width: 100%\">\n  <thead>\n    <tr>\n      <td><strong>Action</strong></td>\n      <td><strong>Description</strong></td>\n      <td><strong>Order of Precedence</strong></td>\n    </tr>\n  </thead>\n    <tbody>\n      <tr>\n        <td><em>Log</em></td>\n        <td>\n          <ul>\n            <li>Records matching requests in the Cloudflare Logs</li>\n            <li>Only available for Enterprise plans</li>\n            <li>\n              Recommended for validating rules before committing to a more\n              severe action\n            </li>\n          </ul>\n        </td>\n        <td>1</td>\n      </tr>\n      <tr>\n        <td><em>Bypass</em></td>\n        <td>\n          <ul>\n            <li>\n              Allows user to dynamically disable Cloudflare security features\n              for a request\n            </li>\n            <li>Available to all plans</li>\n            <li>\n              Matching requests exempt from evaluation by a user-defined list\n              containing one or more of the following Cloudflare Firewall\n              products/features:\n              <ul>\n                <li>User-agent Blocking</li>\n                <li>Browser Integrity Check</li>\n                <li>Hotlinking Protection</li>\n                <li>Security Level (IP Reputation)</li>\n                <li>Rate Limiting</li>\n                <li>Zone Lockdown (PRO, BIZ, ENT)</li>\n                <li>WAF Managed Rules (PRO, BIZ, ENT)</li>\n              </ul>\n            </li>\n            <li>\n              Requests which match the <em>Bypass</em> action are still subject\n              to evaluation (and thus a challenge or block) within Firewall\n              Rules, based on the order of execution.\n            </li>\n          </ul>\n        </td>\n        <td>2</td>\n      </tr>\n      <tr>\n        <td><em>Allow</em></td>\n        <td>\n          <ul>\n            <li>\n              Matching requests are exempt from challenge and block actions\n              triggered by other Firewall Rules content.\n            </li>\n            <li>\n              The scope of the <em>Allow</em> action is limited to Firewall\n              Rules; matching requests are <strong>not</strong> exempt from\n              action by other Cloudflare Firewall products, such as IP Access\n              Rules, WAF, etc.\n            </li>\n            <li>\n              Matched requests will be mitigated if they are part of a DDoS\n              attack.\n            </li>\n          </ul>\n        </td>\n        <td>3</td>\n      </tr>\n      <tr>\n        <td><em>Legacy CAPTCHA</em></td>\n        <td>\n          <ul>\n            <li>\n              This option is not recommended. Instead, choose <strong>Managed Challenge (Recommended)</strong>, which issues CAPTCHAs only when necessary.\n            </li>\n            <li>\n              The client that made the request must pass a CAPTCHA challenge.\n            </li>\n            <li>\n              If successful, Cloudflare accepts the matched request; otherwise,\n              it is blocked.\n            </li>\n          </ul>\n        </td>\n        <td>4</td>\n      </tr>\n      <tr>\n        <td><em>Managed Challenge (Recommended)</em></td>\n        <td>\n          <ul>\n            <li>\n              Helps reduce the lifetimes of human time spent solving CAPTCHAs across the Internet.\n            </li>\n            <li>\n              Depending on the characteristics of a request, Cloudflare will perform the following actions:\n              <ul>\n                <li>\n                  Show a non-interactive challenge page (similar to the current JS Challenge).\n                </li>\n                <li>\n                  Show a CAPTCHA challenge.\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </td>\n        <td>5</td>\n      </tr>\n      <tr>\n        <td><em>JS Challenge</em></td>\n        <td>\n          <ul>\n            <li>\n              Useful for ensuring that bots and spam cannot access the requested\n              resource; browsers, however, are free to satisfy the challenge\n              automatically.\n            </li>\n            <li>\n              The client that made the request must pass a Cloudflare JavaScript\n              Challenge before proceeding.\n            </li>\n            <li>\n              If successful, Cloudflare accepts the matched request; otherwise,\n              it is blocked.\n            </li>\n          </ul>\n        </td>\n        <td>6</td>\n      </tr>\n      <tr>\n        <td><em>Block</em></td>\n        <td>Matching requests are denied access to the site.</td>\n        <td>7</td>\n      </tr>\n    </tbody>","position":{"start":{"line":22,"column":1,"offset":1293},"end":{"line":166,"column":13,"offset":5921},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"  </table>\n</TableWrap>","position":{"start":{"line":168,"column":1,"offset":5923},"end":{"line":169,"column":13,"offset":5946},"indent":[1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Actions\",\"pcx-content-type\":\"reference\",\"order\":220}","position":{"start":{"line":172,"column":1,"offset":5949},"end":{"line":172,"column":91,"offset":6039},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":172,"column":91,"offset":6039}}}}}]}}}