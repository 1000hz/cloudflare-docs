{"componentChunkName":"component---src-components-mdx-custom-renderer-js","path":"/cf-firewall-rules/order-priority","result":{"data":{"mdx":{"id":"ac3b3ed5-0af4-5f91-be24-cb7494a9d92b","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"concept\",\n  \"order\": 230\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"order-and-priority\"\n  }, \"Order and priority\"), mdx(\"h2\", {\n    \"id\": \"overview\"\n  }, \"Overview\"), mdx(\"p\", null, \"Cloudflare Firewall Rules is part of a larger evaluation chain for HTTP requests, as illustrated in the diagram below (click the image to view a larger version). For example, Firewall Rules only evaluates requests that first clear IP Access Rules. If a request is blocked by a rule at any stage in the chain, Cloudflare does not evaluate the request further.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/5bbd49ff428e4d4f2f3d3b8688a8a8f3/29007/firewall-rules-order-and-priority-1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"53.75722543352601%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQoz5WQzU6EMBRGeU3jg8wruHRnjD6C0ZU7M8bMEAlVO8AU5K+NUYkMOBFkAszQXivVjQsD36JNmpx7vlvtNf+4mc2f7Vs4n6R4OjeQ57q6rnueZxgGIcQ0Tdu2McZ3CC0sCyHTcb1TlCRFrWVFdY8XaeTA1eH6EWHHZYxalsUYkwyldElIHMe+78txQRgSsowouyBZXrUa9BFClC2XJ4yJJnoSBN9uStHtBOfq5f/wXvNr7nbFe7Ztahgj/4GBd22R82YDTTWc12Th7/stgOM9uD6Ck31IQ/UNg81S+PQgVpQHM6g/1SqDYdVdDhkC/YVVyVUkLg+gTEfWVpsnLpxNYP0yEP4CCMh12SRWwqgAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Firewall Rules order and priority\",\n    \"title\": \"Firewall Rules order and priority\",\n    \"src\": \"/static/5bbd49ff428e4d4f2f3d3b8688a8a8f3/f868f/firewall-rules-order-and-priority-1.png\",\n    \"srcSet\": [\"/static/5bbd49ff428e4d4f2f3d3b8688a8a8f3/8f77f/firewall-rules-order-and-priority-1.png 346w\", \"/static/5bbd49ff428e4d4f2f3d3b8688a8a8f3/e185b/firewall-rules-order-and-priority-1.png 691w\", \"/static/5bbd49ff428e4d4f2f3d3b8688a8a8f3/f868f/firewall-rules-order-and-priority-1.png 1382w\", \"/static/5bbd49ff428e4d4f2f3d3b8688a8a8f3/29007/firewall-rules-order-and-priority-1.png 1600w\"],\n    \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The execution order diagram does not include products powered by the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/\"\n  }, \"Ruleset Engine\"), \" like the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/waf/\"\n  }, \"WAF\"), \" or \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/rules/transform\"\n  }, \"Transform Rules\"), \".\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"You can use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://support.cloudflare.com/hc/articles/217074967\"\n  }, \"IP Access Rules\"), \" to allowlist requests under certain conditions, effectively excluding these requests from all security checks. However, allowing a given country code will not bypass the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/waf/\"\n  }, \"Cloudflare Web Application Firewall (WAF)\"), \".\")))), mdx(\"p\", null, \"By default, Cloudflare evaluates Firewall Rules in \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"list order\"), \", where rules are evaluated in the order they appear in the Firewall Rules \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Rules List\"), \". List ordering is convenient when working with small numbers of rules because you can manage their order by dragging and dropping them into position. However, as the number of rules grows, managing rules in list order becomes difficult. This is where priority order comes into play.\"), mdx(\"p\", null, \"When \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"priority ordering\"), \" is enabled, Cloudflare evaluates Firewall Rules in order of their \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"priority number\"), \", starting with the lowest. If a request matches two rules with the same priority, action precedence is used to resolve the tie. In this case, only the action of the rule with the highest precedence is executed, unless that action is \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Log\"), \" or \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Bypass\"), \" (refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-rules/actions#supported-actions\"\n  }, \"Firewall Rules actions\"), \" for details). Priority ordering makes it a lot easier to manage large numbers of Firewall Rules, and once the number of rules passes 200, Cloudflare requires it.\"), mdx(\"h2\", {\n    \"id\": \"managing-rule-evaluation-by-list-order\"\n  }, \"Managing rule evaluation by list order\"), mdx(\"p\", null, \"Users with relatively small numbers of Firewall Rules (no more than 200) will find that list ordering is enabled by default. When list ordering is enabled, the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Rules List\"), \" allows you to drag and drop Firewall Rules into position, as shown below:\"), mdx(\"img\", {\n    src: firewallRulesOrderAndPriority2\n  }), mdx(\"p\", null, \"Once there are more than 200 total rules, including inactive rules, you must manage evaluation using priority ordering. When you cross this threshold, the Firewall Rules interface automatically switches to priority ordering.\"), mdx(\"h2\", {\n    \"id\": \"managing-rule-evaluation-by-priority-order\"\n  }, \"Managing rule evaluation by priority order\"), mdx(\"p\", null, \"Although priority ordering is enabled automatically when the number of active and inactive Firewall Rules exceeds 200, you can manually enable priority ordering at any time from the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Rules List\"), \". To manually enable priority ordering, click \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Ordering\"), \" and then select the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Priority Numbers\"), \" radio button, as shown below:\"), mdx(\"img\", {\n    src: firewallRulesOrderAndPriority3\n  }), mdx(\"p\", null, \"Once priority ordering is enabled, you can set a priority number for each Firewall Rule.\"), mdx(\"p\", null, \"To set the priority number for a Firewall Rule, follow these steps:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Locate the desired rule in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Rules List\"), \" and click the associated \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Edit\"), \" button (wrench icon).\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Edit Firewall Rule\"), \" panel will open.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Locate the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Priority\"), \" field and enter a positive integer value.\"))), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/76da699403fa23304ec40c291e0286f2/d9199/firewall-rules-order-and-priority-4.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.14450867052024%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Edit Firewall Rule page\",\n    \"title\": \"Edit Firewall Rule page\",\n    \"src\": \"/static/76da699403fa23304ec40c291e0286f2/d9199/firewall-rules-order-and-priority-4.png\",\n    \"srcSet\": [\"/static/76da699403fa23304ec40c291e0286f2/8f77f/firewall-rules-order-and-priority-4.png 346w\", \"/static/76da699403fa23304ec40c291e0286f2/e185b/firewall-rules-order-and-priority-4.png 691w\", \"/static/76da699403fa23304ec40c291e0286f2/d9199/firewall-rules-order-and-priority-4.png 960w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Click \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Save\"), \" to commit your changes and return to the \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Rules List\"), \".\")), mdx(\"p\", null, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Priority\"), \" column displays the priority value for each rule.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/4d0941d72d625742fbd67735ff385a16/45662/firewall-rules-order-and-priority-5.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"65.60693641618496%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABvElEQVQoz3WSzW7bMBCE+f4v0T5BTr31kBq9JEHdImjgGIJtxXXkxKJs/VgSJVKU+pFMAqNAB4SwpHZ2Z4cUeVHsdrtkv2/bdvIY32GtDV+lur7rp3GYJssax6HjoOtFnueJR5qmxKfTKcuy4/FYelRVZQZSu3PdXt2tP8+Wn2bLL/OYEyqKuq5zD2hSSmiQ2Ya2AeTVjfp6v4V/dbv+9rBTSrWtEpQPfWgCHxpktoHMFMYM5OleX8geh8FqbZxsmpNqjAl9wthFUfR9zzlltdaDA7SJmkz1ejg0TSNo6ESTW5ZMAgFJBK1SWve4SILy0L46NZ6TfbRaI1I8J8kmjlMpn7ZbBMssWywWURSlHnEcr1YrvicP0tJMFmURWgq6I9jLKylMjCpnQFV52aNzW5tOa8a5/jN/zJ/UuV1vNjgloIUhEUbAlpIwUc5WY4xfIa0x3c18/riMmNnJ/nAI21xgnVXueo0JL2Z6ey929E/o5vbu/vfDIZX5B5l/53Md/OCN4B7B5VPzN+eaX8++//j5a//yKrOjwNW6buwFwn3Z/8A4UNdSUrjrc/OEGx4vwfaf5VR4pUXTN53+Cwl/5xcD2H9VAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Firewall Rules tab\",\n    \"title\": \"Firewall Rules tab\",\n    \"src\": \"/static/4d0941d72d625742fbd67735ff385a16/f868f/firewall-rules-order-and-priority-5.png\",\n    \"srcSet\": [\"/static/4d0941d72d625742fbd67735ff385a16/8f77f/firewall-rules-order-and-priority-5.png 346w\", \"/static/4d0941d72d625742fbd67735ff385a16/e185b/firewall-rules-order-and-priority-5.png 691w\", \"/static/4d0941d72d625742fbd67735ff385a16/f868f/firewall-rules-order-and-priority-5.png 1382w\", \"/static/4d0941d72d625742fbd67735ff385a16/45662/firewall-rules-order-and-priority-5.png 1410w\"],\n    \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(Aside, {\n    type: \"note\",\n    header: \"Note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Firewall Rules does not impose default priorities, and you are not required to set a priority for every rule.\")), mdx(\"h2\", {\n    \"id\": \"working-with-priority-ordering\"\n  }, \"Working with priority ordering\"), mdx(\"p\", null, \"Cloudflare has designed priority ordering to be extremely flexible. This flexibility is particularly useful for managing large rulesets programmatically via the Cloudflare API. Use the Update Firewall Rules command to set the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"priority\"), \" property. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/#firewall-rules-properties\"\n  }, \"Cloudflare API: Firewall Rules\"), \" for details.\"), mdx(\"p\", null, \"While your priority numbering scheme can be arbitrary, keep the following in mind:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"The evaluation sequence starts from the lowest priority number\"), \" and goes to the highest.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Rules without a priority number are evaluated last\"), \", in order of their action precedence. For example, a rule with the \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Log\"), \" action is evaluated before a rule that has the \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Block\"), \" action. For more on action precedence, refer to \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/cf-firewall-rules/actions\"\n  }, \"Firewall Rules actions\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Avoid using the number 1 as a priority\"), \" so that you can easily maintain and modify rule order.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Consider grouping ranges of priority numbers into categories\"), \" that have some meaning for your deployment. Here are some examples:\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"5000-9999: Trusted IP addresses\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"10000-19999: Blocking rules for bad crawlers\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"20000-29999: Blocking rules for abusive users/spam\")))));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"","type":null,"updated":null}}},"pageContext":{"id":"ac3b3ed5-0af4-5f91-be24-cb7494a9d92b","fields":{"slug":"/cf-firewall-rules/order-priority"},"frontmatter":{"title":"","type":null,"order":230,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Order and priority","depth":1}],"tableOfContents":{"items":[{"url":"#order-and-priority","title":"Order and priority","items":[{"url":"#overview","title":"Overview"},{"url":"#managing-rule-evaluation-by-list-order","title":"Managing rule evaluation by list order"},{"url":"#managing-rule-evaluation-by-priority-order","title":"Managing rule evaluation by priority order"},{"url":"#working-with-priority-ordering","title":"Working with priority ordering"}]}]},"parent":{"modifiedTime":"2022-02-09","relativePath":"cf-firewall-rules/order-priority.md"}}},"staticQueryHashes":["2814688963","32046230","338033027","598566803","811020565"]}