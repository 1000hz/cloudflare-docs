{"data":{"mdx":{"id":"d20f8b53-45eb-5522-b4bb-dc204a612ca5","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"reference\",\n  \"order\": 610,\n  \"type\": \"table\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar TableWrap = makeShortcode(\"TableWrap\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"operators-and-grouping-symbols\"\n  }, \"Operators and grouping symbols\"), mdx(\"p\", null, \"The Cloudflare Firewall Rules language supports comparison and logical operators:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#comparison-operators\"\n  }, \"Comparison operators\"), \" specify how values defined in an expression must relate to the actual HTTP request value for the expression to return \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"true\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#logical-operators\"\n  }, \"Logical operators\"), \" combine two expressions to form a compound expression and use order of precedence to determine how an expression is evaluated.\")), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/operators/#grouping-symbols\"\n  }, \"Grouping symbols\"), \" allow you to organize expressions, enforce precedence, and nest expressions.\"), mdx(\"h2\", {\n    \"id\": \"comparison-operators\"\n  }, \"Comparison operators\"), mdx(\"p\", null, \"Comparison operators return \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \" when a value from an HTTP request matches a value defined in an expression.\"), mdx(\"p\", null, \"This is the general pattern for using comparison operators:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"<field> <comparison operator> <value>\\n\")), mdx(\"p\", null, \"The Cloudflare Firewall Rules language supports these comparison operators:\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Access to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matches\"), \" operator requires a Cloudflare Business or Enterprise plan.\")), mdx(TableWrap, {\n    style: {\n      \"width\": \"100%\"\n    },\n    mdxType: \"TableWrap\"\n  }, mdx(\"table\", {\n    style: {\n      \"width\": \"100%\"\n    }\n  }, mdx(\"thead\", null, mdx(\"tr\", null, mdx(\"th\", null, \"Name\"), mdx(\"th\", {\n    colSpan: \"2\",\n    style: {\n      \"textAlign\": \"center\"\n    }\n  }, \"Operator Notation\"), mdx(\"th\", {\n    colSpan: \"3\",\n    style: {\n      \"textAlign\": \"center\"\n    }\n  }, \"Supported Data Types\"), mdx(\"th\", null)), mdx(\"tr\", null, mdx(\"td\", null), mdx(\"th\", null, \"English\"), mdx(\"th\", null, \"C-like\"), mdx(\"th\", null, \"String\"), mdx(\"th\", null, \"IP\"), mdx(\"th\", null, \"Number\"), mdx(\"th\", null, \"Example (operator in bold)\"))), mdx(\"tbody\", null, mdx(\"tr\", null, mdx(\"td\", null, \"Equal\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"eq\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"==\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.uri.path \", mdx(\"strong\", null, \"eq\"), \" \\\"/articles/2008/\\\"\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Not equal\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ne\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"!=\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ip.src \", mdx(\"strong\", null, \"ne\"), \" 93.184.216.0\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Less than\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"lt\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"<\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"cf.threat_score \", mdx(\"strong\", null, \"lt\"), \" 10\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Less than\", mdx(\"br\", null), \"or equal\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"le\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"<=\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"cf.threat_score \", mdx(\"strong\", null, \"le\"), \" 20\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Greater than\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"gt\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \">\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"cf.threat_score \", mdx(\"strong\", null, \"gt\"), \" 25\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Greater than\", mdx(\"br\", null), \"or equal\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ge\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \">=\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"cf.threat_score \", mdx(\"strong\", null, \"ge\"), \" 60\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Exactly\", mdx(\"br\", null), \"contains\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"contains\")), mdx(\"td\", null), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.uri.path \", mdx(\"strong\", null, \"contains\"), \" \\\"/articles/\\\"\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Matches\", mdx(\"br\", null), \"regex\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"matches\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"~\")), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.uri.path \", mdx(\"strong\", null, \"matches\"), \" \\\"^/articles/200[7-8]/$\\\"\"))), mdx(\"tr\", null, mdx(\"td\", null, \"Value is in \", mdx(\"br\", null), \"a set of values\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"in\")), mdx(\"td\", null), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ip.src \", mdx(\"strong\", null, \"in\"), \" \", '{ 93.184.216.0 93.184.216.1 }')))))), mdx(\"h2\", {\n    \"id\": \"logical-operators\"\n  }, \"Logical operators\"), mdx(\"p\", null, \"Logical operators combine two or more expressions into a single compound expression. A compound expression has this general syntax:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"<expression> <logical operator> <expression>\\n\")), mdx(\"h3\", {\n    \"id\": \"supported-logical-operators\"\n  }, \"Supported logical operators\"), mdx(\"p\", null, \"Each logical operator has an \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"#order-of-precedence\"\n  }, \"order of precedence\"), \". The order of precedence (along with \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"#grouping-symbols\"\n  }, \"grouping symbols\"), \") determines the order in which Cloudflare evaluates logical operators in an expression. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"not\"), \" operator ranks first in order of precedence.\"), mdx(TableWrap, {\n    mdxType: \"TableWrap\"\n  }, mdx(\"table\", {\n    style: {\n      \"width\": \"100%\"\n    }\n  }, mdx(\"thead\", null, mdx(\"tr\", null, mdx(\"th\", null, \"Name\"), mdx(\"th\", null, \"English\", mdx(\"br\", null), \"Notation\"), mdx(\"th\", null, \"C-like\", mdx(\"br\", null), \"Notation\"), mdx(\"th\", null, \"Example\"), mdx(\"th\", null, \"Order of Precedence\"))), mdx(\"tbody\", null, mdx(\"tr\", null, mdx(\"td\", null, \"Logical NOT\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"not\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"!\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, mdx(\"strong\", null, \"not\"), \" ( http.host eq \\\"www.cloudflare.com\\\" and ip.src in 93.184.216.0/24 )\")), mdx(\"td\", null, \"1\")), mdx(\"tr\", null, mdx(\"td\", null, \"Logical AND\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"and\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"&&\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.host eq \\\"www.cloudflare.com\\\" \", mdx(\"strong\", null, \"and\"), \" ip.src in 93.184.216.0/24\")), mdx(\"td\", null, \"2\")), mdx(\"tr\", null, mdx(\"td\", null, \"Logical XOR\", mdx(\"br\", null), \"(exclusive OR)\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"xor\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"^^\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.host eq \\\"www.cloudflare.com\\\" \", mdx(\"strong\", null, \"xor\"), \" ip.src in 93.184.216.0/24\")), mdx(\"td\", null, \"3\")), mdx(\"tr\", null, mdx(\"td\", null, \"Logical OR\"), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"or\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"||\")), mdx(\"td\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.host eq \\\"www.cloudflare.com\\\" \", mdx(\"strong\", null, \"or\"), \" ip.src in 93.184.216.0/24\")), mdx(\"td\", null, \"4\"))))), mdx(\"h3\", {\n    \"id\": \"order-of-precedence\"\n  }, \"Order of precedence\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"To avoid ambiguity when working with logical operators, use grouping symbols so that the order of evaluation is explicit.\")), mdx(\"p\", null, \"When writing compound expressions, it is important to be aware of the precedence of logical operators so that your expression is evaluated the way you expect.\"), mdx(\"p\", null, \"For example, consider the following generic expression, which uses \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"or\"), \" operators:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-java\"\n  }, \"Expression1 and Expression2 or Expression3\\n\")), mdx(\"p\", null, \"If these operators had no order of precedence, it would not be clear which of two interpretations is correct:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Match when Expression 1 and Expression 2 are both true \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"or\"), \" when Expression 3 is true.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Match when Expression 1 is true \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"and\"), \" either Expression 2 or Expression 3 is true.\")), mdx(\"p\", null, \"Since the logical \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \" operator has precedence over logical \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"or\"), \", the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \" operator must be evaluated first. Interpretation 1 is correct.\"), mdx(\"h2\", {\n    \"id\": \"grouping-symbols\"\n  }, \"Grouping symbols\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Only the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-dashboard/expression-preview-editor/\"\n  }, \"Expression Editor\"), \" and the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/api/\"\n  }, \"Cloudflare API\"), \" support grouping symbols. The \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-dashboard/create-edit-delete-rules/\"\n  }, \"Expression Builder\"), \" does not.\")), mdx(\"p\", null, \"The Firewall Rules language supports parentheses (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"(\"), \",\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \")\"), \") as grouping symbols. Grouping symbols allow you to organize expressions, enforce precedence, and nest expressions.\"), mdx(\"h3\", {\n    \"id\": \"group-expressions\"\n  }, \"Group expressions\"), mdx(\"p\", null, \"Use parentheses to explicitly group expressions that should be evaluated together. In this example, the parentheses do not alter the evaluation of the expression, but they unambiguously call out which logical operators to evaluate first.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-java\"\n  }, \"(Expression1 and Expression2) or Expression3\\n\")), mdx(\"p\", null, \"Because grouping symbols are so explicit, you are less likely to make errors when you use them to write compound expressions.\"), mdx(\"h3\", {\n    \"id\": \"enforce-precedence\"\n  }, \"Enforce precedence\"), mdx(\"p\", null, \"Grouping symbols are a powerful tool to enforce precedence for grouped elements of a compound expression. In this example, parentheses force the logical \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"or\"), \" operator to be evaluated before the logical \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-java\"\n  }, \"Expression1 and (Expression2 or Expression3)\\n\")), mdx(\"p\", null, \"Without parentheses, the logical \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \" operator would take precedence.\"), mdx(\"h3\", {\n    \"id\": \"nest-expressions\"\n  }, \"Nest expressions\"), mdx(\"p\", null, \"You can nest expressions grouped by parentheses inside other groups to create very precise, sophisticated expressions, such as this example for a rule designed to block access to a domain:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"(\\n (http.host eq \\\"api.example.com\\\" and http.request.uri.path eq \\\"/api/v2/auth\\\") or\\n (http.host matches \\\"^(www|store|blog)\\\\.example.com\\\" and http.request.uri.path contains \\\"wp-login.php\\\") or\\n ip.geoip.country in {\\\"CN\\\" \\\"TH\\\" \\\"US\\\" \\\"ID\\\" \\\"KR\\\" \\\"MY\\\" \\\"IT\\\" \\\"SG\\\" \\\"GB\\\"} or ip.geoip.asnum in {12345 54321 11111}\\n) and not ip.src in {11.22.33.0/24}\\n\")), mdx(\"p\", null, \"Note that when evaluating the precedence of logical operators, parentheses inside strings delimited by quotes are ignored, such as those in the following regular expression, drawn from the example above:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"\\\"^(www|store|blog)\\\\.example\\\\.com\\\"\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"","type":"table","updated":null}}},"pageContext":{"id":"d20f8b53-45eb-5522-b4bb-dc204a612ca5","fields":{"slug":"/cf-firewall-language/operators"},"frontmatter":{"title":"","type":"table","order":610,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Operators and grouping symbols","depth":1}],"tableOfContents":{"items":[{"url":"#operators-and-grouping-symbols","title":"Operators and grouping symbols","items":[{"url":"#comparison-operators","title":"Comparison operators"},{"url":"#logical-operators","title":"Logical operators","items":[{"url":"#supported-logical-operators","title":"Supported logical operators"},{"url":"#order-of-precedence","title":"Order of precedence"}]},{"url":"#grouping-symbols","title":"Grouping symbols","items":[{"url":"#group-expressions","title":"Group expressions"},{"url":"#enforce-precedence","title":"Enforce precedence"},{"url":"#nest-expressions","title":"Nest expressions"}]}]}]},"parent":{"modifiedTime":"2021-12-17","relativePath":"cf-firewall-language/operators.md"}}}