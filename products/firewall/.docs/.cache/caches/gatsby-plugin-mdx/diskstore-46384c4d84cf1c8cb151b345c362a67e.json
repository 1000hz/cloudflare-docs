{"expireTime":9007200899183233000,"key":"gatsby-plugin-mdx-entire-payload-b853b6c864b0abe5a494383a53d3b96e-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Preview Firewall Rules","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":25,"offset":25},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":25,"offset":25},"indent":[]}},{"type":"jsx","value":"<ContentColumn>","position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":16,"offset":42},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":6,"column":4,"offset":47},"end":{"line":6,"column":12,"offset":55},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":44},"end":{"line":6,"column":12,"offset":55},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Firewall Rules provides a powerful and flexible platform for filtering HTTP requests and protecting your site amid an evolving threat landscape. However, the same power and flexibility that allows you to tailor Firewall Rules to your specific application and environment can also introduce complexity. In these cases, it is critical that you have a way to test a Firewall Rule before deploying it so that you can ensure the rule will behave the way you expect.","position":{"start":{"line":8,"column":1,"offset":57},"end":{"line":8,"column":472,"offset":528},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":57},"end":{"line":8,"column":472,"offset":528},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To help customers understand the potential impact of a rule, Cloudflare has built ","position":{"start":{"line":10,"column":1,"offset":530},"end":{"line":10,"column":83,"offset":612},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rule Preview","position":{"start":{"line":10,"column":85,"offset":614},"end":{"line":10,"column":97,"offset":626},"indent":[]}}],"position":{"start":{"line":10,"column":83,"offset":612},"end":{"line":10,"column":99,"offset":628},"indent":[]}},{"type":"text","value":". With the click of a button, Rule Preview allows you to test a Firewall Rule against a sample drawn from the last 72 hours of traffic. Rule Preview is built into the ","position":{"start":{"line":10,"column":99,"offset":628},"end":{"line":10,"column":266,"offset":795},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules Expression Editor","position":{"start":{"line":10,"column":268,"offset":797},"end":{"line":10,"column":300,"offset":829},"indent":[]}}],"position":{"start":{"line":10,"column":266,"offset":795},"end":{"line":10,"column":302,"offset":831},"indent":[]}},{"type":"text","value":" so that you can test a rule as you edit it.","position":{"start":{"line":10,"column":302,"offset":831},"end":{"line":10,"column":346,"offset":875},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":530},"end":{"line":10,"column":346,"offset":875},"indent":[]}},{"type":"jsx","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":12,"column":1,"offset":877},"end":{"line":12,"column":42,"offset":918},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Rule Preview requires access to a Cloudflare Enterprise plan.","position":{"start":{"line":14,"column":1,"offset":920},"end":{"line":14,"column":62,"offset":981},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":920},"end":{"line":14,"column":62,"offset":981},"indent":[]}},{"type":"jsx","value":"</Aside>","position":{"start":{"line":16,"column":1,"offset":983},"end":{"line":16,"column":9,"offset":991},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Use Rule Preview","position":{"start":{"line":18,"column":4,"offset":996},"end":{"line":18,"column":20,"offset":1012},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":993},"end":{"line":18,"column":20,"offset":1012},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To test a Firewall Rule with Rule Preview:","position":{"start":{"line":20,"column":1,"offset":1014},"end":{"line":20,"column":43,"offset":1056},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1014},"end":{"line":20,"column":43,"offset":1056},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Locate the desired rule in the ","position":{"start":{"line":22,"column":4,"offset":1061},"end":{"line":22,"column":35,"offset":1092},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Rules List","position":{"start":{"line":22,"column":37,"offset":1094},"end":{"line":22,"column":47,"offset":1104},"indent":[]}}],"position":{"start":{"line":22,"column":35,"offset":1092},"end":{"line":22,"column":49,"offset":1106},"indent":[]}},{"type":"text","value":" and click the associated ","position":{"start":{"line":22,"column":49,"offset":1106},"end":{"line":22,"column":75,"offset":1132},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit","position":{"start":{"line":22,"column":77,"offset":1134},"end":{"line":22,"column":81,"offset":1138},"indent":[]}}],"position":{"start":{"line":22,"column":75,"offset":1132},"end":{"line":22,"column":83,"offset":1140},"indent":[]}},{"type":"text","value":" button (wrench icon). The ","position":{"start":{"line":22,"column":83,"offset":1140},"end":{"line":22,"column":110,"offset":1167},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Edit Firewall Rule","position":{"start":{"line":22,"column":112,"offset":1169},"end":{"line":22,"column":130,"offset":1187},"indent":[]}}],"position":{"start":{"line":22,"column":110,"offset":1167},"end":{"line":22,"column":132,"offset":1189},"indent":[]}},{"type":"text","value":" panel will open.","position":{"start":{"line":22,"column":132,"offset":1189},"end":{"line":22,"column":149,"offset":1206},"indent":[]}}],"position":{"start":{"line":22,"column":4,"offset":1061},"end":{"line":22,"column":149,"offset":1206},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1058},"end":{"line":22,"column":149,"offset":1206},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Click ","position":{"start":{"line":23,"column":4,"offset":1210},"end":{"line":23,"column":10,"offset":1216},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Test rule","position":{"start":{"line":23,"column":12,"offset":1218},"end":{"line":23,"column":21,"offset":1227},"indent":[]}}],"position":{"start":{"line":23,"column":10,"offset":1216},"end":{"line":23,"column":23,"offset":1229},"indent":[]}},{"type":"text","value":" to trigger the test.","position":{"start":{"line":23,"column":23,"offset":1229},"end":{"line":23,"column":44,"offset":1250},"indent":[]}}],"position":{"start":{"line":23,"column":4,"offset":1210},"end":{"line":23,"column":44,"offset":1250},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1207},"end":{"line":23,"column":44,"offset":1250},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1058},"end":{"line":23,"column":44,"offset":1250},"indent":[1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-preview-1.png","alt":"Expression Builder Test Rule button","position":{"start":{"line":25,"column":1,"offset":1252},"end":{"line":25,"column":79,"offset":1330},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1252},"end":{"line":25,"column":79,"offset":1330},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The results of the test are displayed in a plot that simulates how many of the total requests in the last 72 hours would have matched the tested expression.","position":{"start":{"line":27,"column":1,"offset":1332},"end":{"line":27,"column":157,"offset":1488},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":1332},"end":{"line":27,"column":157,"offset":1488},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In this screenshot, a rule that matches all User-Agents that contain the string ","position":{"start":{"line":29,"column":1,"offset":1490},"end":{"line":29,"column":81,"offset":1570},"indent":[]}},{"type":"inlineCode","value":"Mozilla","position":{"start":{"line":29,"column":81,"offset":1570},"end":{"line":29,"column":90,"offset":1579},"indent":[]}},{"type":"text","value":" would block about 8% of requests to the zone:","position":{"start":{"line":29,"column":90,"offset":1579},"end":{"line":29,"column":136,"offset":1625},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1490},"end":{"line":29,"column":136,"offset":1625},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/cf-firewall-rules-preview-rule-plot-chart.png","alt":"Example rule preview results chart","position":{"start":{"line":31,"column":1,"offset":1627},"end":{"line":31,"column":95,"offset":1721},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1627},"end":{"line":31,"column":95,"offset":1721},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Important Notes","position":{"start":{"line":33,"column":4,"offset":1726},"end":{"line":33,"column":19,"offset":1741},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":1723},"end":{"line":33,"column":19,"offset":1741},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Consider the results of Firewall Preview an ","position":{"start":{"line":35,"column":3,"offset":1745},"end":{"line":35,"column":47,"offset":1789},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"indication","position":{"start":{"line":35,"column":48,"offset":1790},"end":{"line":35,"column":58,"offset":1800},"indent":[]}}],"position":{"start":{"line":35,"column":47,"offset":1789},"end":{"line":35,"column":59,"offset":1801},"indent":[]}},{"type":"text","value":" of traffic levels","position":{"start":{"line":35,"column":59,"offset":1801},"end":{"line":35,"column":77,"offset":1819},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1743},"end":{"line":35,"column":79,"offset":1821},"indent":[]}},{"type":"text","value":", not an exact calculation. The sample rate can be as little as 1% of your total traffic.","position":{"start":{"line":35,"column":79,"offset":1821},"end":{"line":35,"column":168,"offset":1910},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1743},"end":{"line":35,"column":168,"offset":1910},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Rule Preview does not take into account other Cloudflare Firewall Rules","position":{"start":{"line":37,"column":3,"offset":1914},"end":{"line":37,"column":74,"offset":1985},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1912},"end":{"line":37,"column":76,"offset":1987},"indent":[]}},{"type":"text","value":" that you have already configured. In effect, Rule Preview tests a single Firewall Rule in isolation. Firewall Events or any other rules with a higher priority that may have blocked or challenged a request are ignored.","position":{"start":{"line":37,"column":76,"offset":1987},"end":{"line":37,"column":294,"offset":2205},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1912},"end":{"line":37,"column":294,"offset":2205},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"You cannot test Firewall Rules that reference ","position":{"start":{"line":39,"column":3,"offset":2209},"end":{"line":39,"column":49,"offset":2255},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/rules-lists","children":[{"type":"text","value":"IP Lists","position":{"start":{"line":39,"column":50,"offset":2256},"end":{"line":39,"column":58,"offset":2264},"indent":[]}}],"position":{"start":{"line":39,"column":49,"offset":2255},"end":{"line":39,"column":86,"offset":2292},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2207},"end":{"line":39,"column":88,"offset":2294},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":39,"column":88,"offset":2294},"end":{"line":39,"column":89,"offset":2295},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2207},"end":{"line":39,"column":89,"offset":2295},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Cloudflare does not store the entirety of requests, so only a limited number of fields are available to Rule Preview","position":{"start":{"line":41,"column":3,"offset":2299},"end":{"line":41,"column":119,"offset":2415},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2297},"end":{"line":41,"column":121,"offset":2417},"indent":[]}},{"type":"text","value":". The table below lists the fields that Rule Preview supports (green cells), broken down by operator. Fields and operators that are not supported are not included in this table.","position":{"start":{"line":41,"column":121,"offset":2417},"end":{"line":41,"column":298,"offset":2594},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2297},"end":{"line":41,"column":298,"offset":2594},"indent":[]}},{"type":"jsx","value":"</ContentColumn>","position":{"start":{"line":43,"column":1,"offset":2596},"end":{"line":43,"column":17,"offset":2612},"indent":[]}},{"type":"jsx","value":"<TableWrap style=\"width:100%\">\n<table style=\"width: 100%\">\n   <thead>\n      <tr>\n        <td></td>\n        <td><strong>Equal</strong></td>\n        <td><strong>Not equal</strong></td>\n        <td><strong>Greater than</strong></td>\n        <td><strong>Less than</strong></td>\n        <td><strong>Greater than or equal</strong></td>\n        <td><strong>Less than or equal</strong></td>\n        <td><strong>In</strong></td>\n        <td><strong>Contains</strong></td>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>\n          <strong>AS Number</strong>\n          <p />\n          <strong><code class=\"InlineCode\">ip.geoip.asnum</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Country\n            <p />\n            <code class=\"InlineCode\">ip.geoip.country</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Hostname\n            <p />\n            <code class=\"InlineCode\">http.host</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >IP Address\n            <p />\n            <code class=\"InlineCode\">ip.src</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Referer\n            <p />\n            <code class=\"InlineCode\">http.referer</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >Request method\n            <p />\n            <code class=\"InlineCode\">http.request.method</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >SSL\n            <p />\n            <code class=\"InlineCode\">ssl</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >URI\n            <p />\n            <code class=\"InlineCode\">http.request.uri</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >URI path\n            <p />\n            <code class=\"InlineCode\">http.request.uri.path</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >URI query string\n            <p />\n            <code class=\"InlineCode\">http.request.uri.query</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong\n            >User agent\n            <p />\n            <code class=\"InlineCode\">http.user_agent</code></strong\n          >\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n    </tbody>\n  </table>\n</TableWrap>","position":{"start":{"line":45,"column":1,"offset":2614},"end":{"line":248,"column":13,"offset":7126},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Preview rules\",\"pcx-content-type\":\"concept\",\"type\":\"table\",\"order\":330}","position":{"start":{"line":250,"column":1,"offset":7128},"end":{"line":250,"column":110,"offset":7237},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":250,"column":110,"offset":7237}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Preview rules\",\n  \"pcx-content-type\": \"concept\",\n  \"type\": \"table\",\n  \"order\": 330\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar ContentColumn = makeShortcode(\"ContentColumn\");\nvar Aside = makeShortcode(\"Aside\");\nvar TableWrap = makeShortcode(\"TableWrap\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"preview-firewall-rules\"\n  }, \"Preview Firewall Rules\"), mdx(ContentColumn, {\n    mdxType: \"ContentColumn\"\n  }, mdx(\"h2\", {\n    \"id\": \"overview\"\n  }, \"Overview\"), mdx(\"p\", null, \"Cloudflare Firewall Rules provides a powerful and flexible platform for filtering HTTP requests and protecting your site amid an evolving threat landscape. However, the same power and flexibility that allows you to tailor Firewall Rules to your specific application and environment can also introduce complexity. In these cases, it is critical that you have a way to test a Firewall Rule before deploying it so that you can ensure the rule will behave the way you expect.\"), mdx(\"p\", null, \"To help customers understand the potential impact of a rule, Cloudflare has built \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Rule Preview\"), \". With the click of a button, Rule Preview allows you to test a Firewall Rule against a sample drawn from the last 72 hours of traffic. Rule Preview is built into the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Firewall Rules Expression Editor\"), \" so that you can test a rule as you edit it.\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Rule Preview requires access to a Cloudflare Enterprise plan.\")), mdx(\"h2\", {\n    \"id\": \"use-rule-preview\"\n  }, \"Use Rule Preview\"), mdx(\"p\", null, \"To test a Firewall Rule with Rule Preview:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Locate the desired rule in the \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Rules List\"), \" and click the associated \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Edit\"), \" button (wrench icon). The \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Edit Firewall Rule\"), \" panel will open.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Click \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Test rule\"), \" to trigger the test.\")), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"800px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/032f7146250489e2f1cc6d9cac1d5ebd/5a190/firewall-rules-preview-1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.14450867052024%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Expression Builder Test Rule button\",\n    \"title\": \"Expression Builder Test Rule button\",\n    \"src\": \"/static/032f7146250489e2f1cc6d9cac1d5ebd/5a190/firewall-rules-preview-1.png\",\n    \"srcSet\": [\"/static/032f7146250489e2f1cc6d9cac1d5ebd/8f77f/firewall-rules-preview-1.png 346w\", \"/static/032f7146250489e2f1cc6d9cac1d5ebd/e185b/firewall-rules-preview-1.png 691w\", \"/static/032f7146250489e2f1cc6d9cac1d5ebd/5a190/firewall-rules-preview-1.png 800w\"],\n    \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"The results of the test are displayed in a plot that simulates how many of the total requests in the last 72 hours would have matched the tested expression.\"), mdx(\"p\", null, \"In this screenshot, a rule that matches all User-Agents that contain the string \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Mozilla\"), \" would block about 8% of requests to the zone:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/766df311c1c152862187711265501875/1df5b/cf-firewall-rules-preview-rule-plot-chart.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"64.73988439306359%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABMklEQVQoz41Sy07EMAzM//8cJ049VLAHWKhK0ibO08mO+1JhYcXIrRw3M35VTdP0tWAYBrxrrcxcH6LtUM6Rcw7XtTZwSinjOHrv4eTfgPjH8Pl+veKOwiGlhGxtV/0hf4+Uc4hCURDQWltrIRGjGCD6fyOkPFMoRcjBSuVkrVsNPuiH1r3ha065clXzbIlIyt7BtaGowo8q3wYWFqzjgSRjYIaenl/ehnnt/xEZHCIflwEcUeGcaDFl9IKbUhdXJMOkcEdhVK+XC85n8jeV1oyZuq4zRq9B7LLve2gptA9m+zcyc0SPRTLJnoMP51zbe9/58QFPATMXRMtSpsLjA3aOf4fFMlQxvJLEYeTZnCIRCgnrBZBSeoaMI08hQgASfnFWmx2N2hxHMEPM65oxY/R8AyqI/AFJ1QjtAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Example rule preview results chart\",\n    \"title\": \"Example rule preview results chart\",\n    \"src\": \"/static/766df311c1c152862187711265501875/f868f/cf-firewall-rules-preview-rule-plot-chart.png\",\n    \"srcSet\": [\"/static/766df311c1c152862187711265501875/8f77f/cf-firewall-rules-preview-rule-plot-chart.png 346w\", \"/static/766df311c1c152862187711265501875/e185b/cf-firewall-rules-preview-rule-plot-chart.png 691w\", \"/static/766df311c1c152862187711265501875/f868f/cf-firewall-rules-preview-rule-plot-chart.png 1382w\", \"/static/766df311c1c152862187711265501875/1df5b/cf-firewall-rules-preview-rule-plot-chart.png 1999w\"],\n    \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"h2\", {\n    \"id\": \"important-notes\"\n  }, \"Important Notes\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Consider the results of Firewall Preview an \", mdx(\"em\", {\n    parentName: \"strong\"\n  }, \"indication\"), \" of traffic levels\"), \", not an exact calculation. The sample rate can be as little as 1% of your total traffic.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Rule Preview does not take into account other Cloudflare Firewall Rules\"), \" that you have already configured. In effect, Rule Preview tests a single Firewall Rule in isolation. Firewall Events or any other rules with a higher priority that may have blocked or challenged a request are ignored.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"You cannot test Firewall Rules that reference \", mdx(\"a\", {\n    parentName: \"strong\",\n    \"href\": \"/cf-dashboard/rules-lists\"\n  }, \"IP Lists\")), \".\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Cloudflare does not store the entirety of requests, so only a limited number of fields are available to Rule Preview\"), \". The table below lists the fields that Rule Preview supports (green cells), broken down by operator. Fields and operators that are not supported are not included in this table.\")), mdx(TableWrap, {\n    style: {\n      \"width\": \"100%\"\n    },\n    mdxType: \"TableWrap\"\n  }, mdx(\"table\", {\n    style: {\n      \"width\": \"100%\"\n    }\n  }, mdx(\"thead\", null, mdx(\"tr\", null, mdx(\"td\", null), mdx(\"td\", null, mdx(\"strong\", null, \"Equal\")), mdx(\"td\", null, mdx(\"strong\", null, \"Not equal\")), mdx(\"td\", null, mdx(\"strong\", null, \"Greater than\")), mdx(\"td\", null, mdx(\"strong\", null, \"Less than\")), mdx(\"td\", null, mdx(\"strong\", null, \"Greater than or equal\")), mdx(\"td\", null, mdx(\"strong\", null, \"Less than or equal\")), mdx(\"td\", null, mdx(\"strong\", null, \"In\")), mdx(\"td\", null, mdx(\"strong\", null, \"Contains\")))), mdx(\"tbody\", null, mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"AS Number\"), mdx(\"p\", null), mdx(\"strong\", null, mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ip.geoip.asnum\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"Country\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ip.geoip.country\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"Hostname\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.host\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"IP Address\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ip.src\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"Referer\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.referer\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"Request method\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.method\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"SSL\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"ssl\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"URI\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.uri\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"URI path\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.uri.path\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"URI query string\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.request.uri.query\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\")), mdx(\"tr\", null, mdx(\"td\", null, mdx(\"strong\", null, \"User agent\", mdx(\"p\", null), mdx(\"code\", {\n    className: \"InlineCode\"\n  }, \"http.user_agent\"))), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u2705\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u274C\"), mdx(\"td\", null, \"\\u2705\"))))));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Preview rules\",\n  \"pcx-content-type\": \"concept\",\n  \"type\": \"table\",\n  \"order\": 330\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\nconst ContentColumn = makeShortcode(\"ContentColumn\");\nconst Aside = makeShortcode(\"Aside\");\nconst TableWrap = makeShortcode(\"TableWrap\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"preview-firewall-rules\"\n    }}>{`Preview Firewall Rules`}</h1>\n    <ContentColumn mdxType=\"ContentColumn\">\n      <h2 {...{\n        \"id\": \"overview\"\n      }}>{`Overview`}</h2>\n      <p>{`Cloudflare Firewall Rules provides a powerful and flexible platform for filtering HTTP requests and protecting your site amid an evolving threat landscape. However, the same power and flexibility that allows you to tailor Firewall Rules to your specific application and environment can also introduce complexity. In these cases, it is critical that you have a way to test a Firewall Rule before deploying it so that you can ensure the rule will behave the way you expect.`}</p>\n      <p>{`To help customers understand the potential impact of a rule, Cloudflare has built `}<strong parentName=\"p\">{`Rule Preview`}</strong>{`. With the click of a button, Rule Preview allows you to test a Firewall Rule against a sample drawn from the last 72 hours of traffic. Rule Preview is built into the `}<strong parentName=\"p\">{`Firewall Rules Expression Editor`}</strong>{` so that you can test a rule as you edit it.`}</p>\n      <Aside type='warning' header='Important' mdxType=\"Aside\">\n        <p>{`Rule Preview requires access to a Cloudflare Enterprise plan.`}</p>\n      </Aside>\n      <h2 {...{\n        \"id\": \"use-rule-preview\"\n      }}>{`Use Rule Preview`}</h2>\n      <p>{`To test a Firewall Rule with Rule Preview:`}</p>\n      <ol>\n        <li parentName=\"ol\">{`Locate the desired rule in the `}<strong parentName=\"li\">{`Rules List`}</strong>{` and click the associated `}<strong parentName=\"li\">{`Edit`}</strong>{` button (wrench icon). The `}<strong parentName=\"li\">{`Edit Firewall Rule`}</strong>{` panel will open.`}</li>\n        <li parentName=\"ol\">{`Click `}<strong parentName=\"li\">{`Test rule`}</strong>{` to trigger the test.`}</li>\n      </ol>\n      <p><span parentName=\"p\" {...{\n          \"className\": \"gatsby-resp-image-wrapper\",\n          \"style\": {\n            \"position\": \"relative\",\n            \"display\": \"block\",\n            \"marginLeft\": \"auto\",\n            \"marginRight\": \"auto\",\n            \"maxWidth\": \"800px\"\n          }\n        }}>{`\n      `}<a parentName=\"span\" {...{\n            \"className\": \"gatsby-resp-image-link\",\n            \"href\": \"/static/032f7146250489e2f1cc6d9cac1d5ebd/5a190/firewall-rules-preview-1.png\",\n            \"style\": {\n              \"display\": \"block\"\n            },\n            \"target\": \"_blank\",\n            \"rel\": \"noopener\"\n          }}>{`\n    `}<span parentName=\"a\" {...{\n              \"className\": \"gatsby-resp-image-background-image\",\n              \"style\": {\n                \"paddingBottom\": \"75.14450867052024%\",\n                \"position\": \"relative\",\n                \"bottom\": \"0\",\n                \"left\": \"0\",\n                \"display\": \"block\"\n              }\n            }}></span>{`\n  `}<img parentName=\"a\" {...{\n              \"className\": \"gatsby-resp-image-image\",\n              \"alt\": \"Expression Builder Test Rule button\",\n              \"title\": \"Expression Builder Test Rule button\",\n              \"src\": \"/static/032f7146250489e2f1cc6d9cac1d5ebd/5a190/firewall-rules-preview-1.png\",\n              \"srcSet\": [\"/static/032f7146250489e2f1cc6d9cac1d5ebd/8f77f/firewall-rules-preview-1.png 346w\", \"/static/032f7146250489e2f1cc6d9cac1d5ebd/e185b/firewall-rules-preview-1.png 691w\", \"/static/032f7146250489e2f1cc6d9cac1d5ebd/5a190/firewall-rules-preview-1.png 800w\"],\n              \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n              \"style\": {\n                \"width\": \"100%\",\n                \"height\": \"100%\",\n                \"margin\": \"0\",\n                \"verticalAlign\": \"middle\",\n                \"position\": \"absolute\",\n                \"top\": \"0\",\n                \"left\": \"0\"\n              },\n              \"loading\": \"lazy\"\n            }}></img>{`\n  `}</a>{`\n    `}</span></p>\n      <p>{`The results of the test are displayed in a plot that simulates how many of the total requests in the last 72 hours would have matched the tested expression.`}</p>\n      <p>{`In this screenshot, a rule that matches all User-Agents that contain the string `}<inlineCode parentName=\"p\">{`Mozilla`}</inlineCode>{` would block about 8% of requests to the zone:`}</p>\n      <p><span parentName=\"p\" {...{\n          \"className\": \"gatsby-resp-image-wrapper\",\n          \"style\": {\n            \"position\": \"relative\",\n            \"display\": \"block\",\n            \"marginLeft\": \"auto\",\n            \"marginRight\": \"auto\",\n            \"maxWidth\": \"1382px\"\n          }\n        }}>{`\n      `}<a parentName=\"span\" {...{\n            \"className\": \"gatsby-resp-image-link\",\n            \"href\": \"/static/766df311c1c152862187711265501875/1df5b/cf-firewall-rules-preview-rule-plot-chart.png\",\n            \"style\": {\n              \"display\": \"block\"\n            },\n            \"target\": \"_blank\",\n            \"rel\": \"noopener\"\n          }}>{`\n    `}<span parentName=\"a\" {...{\n              \"className\": \"gatsby-resp-image-background-image\",\n              \"style\": {\n                \"paddingBottom\": \"64.73988439306359%\",\n                \"position\": \"relative\",\n                \"bottom\": \"0\",\n                \"left\": \"0\",\n                \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABMklEQVQoz41Sy07EMAzM//8cJ049VLAHWKhK0ibO08mO+1JhYcXIrRw3M35VTdP0tWAYBrxrrcxcH6LtUM6Rcw7XtTZwSinjOHrv4eTfgPjH8Pl+veKOwiGlhGxtV/0hf4+Uc4hCURDQWltrIRGjGCD6fyOkPFMoRcjBSuVkrVsNPuiH1r3ha065clXzbIlIyt7BtaGowo8q3wYWFqzjgSRjYIaenl/ehnnt/xEZHCIflwEcUeGcaDFl9IKbUhdXJMOkcEdhVK+XC85n8jeV1oyZuq4zRq9B7LLve2gptA9m+zcyc0SPRTLJnoMP51zbe9/58QFPATMXRMtSpsLjA3aOf4fFMlQxvJLEYeTZnCIRCgnrBZBSeoaMI08hQgASfnFWmx2N2hxHMEPM65oxY/R8AyqI/AFJ1QjtAAAAAElFTkSuQmCC')\",\n                \"backgroundSize\": \"cover\",\n                \"display\": \"block\"\n              }\n            }}></span>{`\n  `}<img parentName=\"a\" {...{\n              \"className\": \"gatsby-resp-image-image\",\n              \"alt\": \"Example rule preview results chart\",\n              \"title\": \"Example rule preview results chart\",\n              \"src\": \"/static/766df311c1c152862187711265501875/f868f/cf-firewall-rules-preview-rule-plot-chart.png\",\n              \"srcSet\": [\"/static/766df311c1c152862187711265501875/8f77f/cf-firewall-rules-preview-rule-plot-chart.png 346w\", \"/static/766df311c1c152862187711265501875/e185b/cf-firewall-rules-preview-rule-plot-chart.png 691w\", \"/static/766df311c1c152862187711265501875/f868f/cf-firewall-rules-preview-rule-plot-chart.png 1382w\", \"/static/766df311c1c152862187711265501875/1df5b/cf-firewall-rules-preview-rule-plot-chart.png 1999w\"],\n              \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n              \"style\": {\n                \"width\": \"100%\",\n                \"height\": \"100%\",\n                \"margin\": \"0\",\n                \"verticalAlign\": \"middle\",\n                \"position\": \"absolute\",\n                \"top\": \"0\",\n                \"left\": \"0\"\n              },\n              \"loading\": \"lazy\"\n            }}></img>{`\n  `}</a>{`\n    `}</span></p>\n      <h2 {...{\n        \"id\": \"important-notes\"\n      }}>{`Important Notes`}</h2>\n      <p><strong parentName=\"p\">{`Consider the results of Firewall Preview an `}<em parentName=\"strong\">{`indication`}</em>{` of traffic levels`}</strong>{`, not an exact calculation. The sample rate can be as little as 1% of your total traffic.`}</p>\n      <p><strong parentName=\"p\">{`Rule Preview does not take into account other Cloudflare Firewall Rules`}</strong>{` that you have already configured. In effect, Rule Preview tests a single Firewall Rule in isolation. Firewall Events or any other rules with a higher priority that may have blocked or challenged a request are ignored.`}</p>\n      <p><strong parentName=\"p\">{`You cannot test Firewall Rules that reference `}<a parentName=\"strong\" {...{\n            \"href\": \"/cf-dashboard/rules-lists\"\n          }}>{`IP Lists`}</a></strong>{`.`}</p>\n      <p><strong parentName=\"p\">{`Cloudflare does not store the entirety of requests, so only a limited number of fields are available to Rule Preview`}</strong>{`. The table below lists the fields that Rule Preview supports (green cells), broken down by operator. Fields and operators that are not supported are not included in this table.`}</p>\n    </ContentColumn>\n    <TableWrap style=\"width:100%\" mdxType=\"TableWrap\">\n      <table style=\"width: 100%\">\n   <thead>\n      <tr>\n        <td></td>\n        <td><strong>Equal</strong></td>\n        <td><strong>Not equal</strong></td>\n        <td><strong>Greater than</strong></td>\n        <td><strong>Less than</strong></td>\n        <td><strong>Greater than or equal</strong></td>\n        <td><strong>Less than or equal</strong></td>\n        <td><strong>In</strong></td>\n        <td><strong>Contains</strong></td>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>\n          <strong>AS Number</strong>\n          <p />\n          <strong><code class=\"InlineCode\">ip.geoip.asnum</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>Country\n            <p />\n            <code class=\"InlineCode\">ip.geoip.country</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>Hostname\n            <p />\n            <code class=\"InlineCode\">http.host</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>IP Address\n            <p />\n            <code class=\"InlineCode\">ip.src</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>Referer\n            <p />\n            <code class=\"InlineCode\">http.referer</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>Request method\n            <p />\n            <code class=\"InlineCode\">http.request.method</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>SSL\n            <p />\n            <code class=\"InlineCode\">ssl</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>URI\n            <p />\n            <code class=\"InlineCode\">http.request.uri</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>URI path\n            <p />\n            <code class=\"InlineCode\">http.request.uri.path</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>URI query string\n            <p />\n            <code class=\"InlineCode\">http.request.uri.query</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n      <tr>\n        <td>\n          <strong>User agent\n            <p />\n            <code class=\"InlineCode\">http.user_agent</code></strong>\n        </td>\n        <td>&#x2705;</td>\n        <td>&#x2705;</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>❌</td>\n        <td>&#x2705;</td>\n      </tr>\n    </tbody>\n  </table>\n    </TableWrap>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}