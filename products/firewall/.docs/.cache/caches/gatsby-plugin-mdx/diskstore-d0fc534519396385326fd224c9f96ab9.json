{"expireTime":9007200899183228000,"key":"gatsby-plugin-mdx-entire-payload-ae5919f0c6b2b711dc698272f319a355-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Values","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":9,"offset":9},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":9,"offset":9},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When an HTTP request reaches Cloudflare’s edge, Cloudflare creates a table of field–value pairs against which to match expressions. This table exists for as long as the current request is being processed.","position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":205,"offset":215},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":205,"offset":215},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The values that populate Firewall Rules lookup tables are drawn from a variety of sources:","position":{"start":{"line":6,"column":1,"offset":217},"end":{"line":6,"column":91,"offset":307},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":217},"end":{"line":6,"column":91,"offset":307},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Primitive properties","position":{"start":{"line":8,"column":5,"offset":313},"end":{"line":8,"column":25,"offset":333},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":311},"end":{"line":8,"column":27,"offset":335},"indent":[]}},{"type":"text","value":" are obtained directly from the request (","position":{"start":{"line":8,"column":27,"offset":335},"end":{"line":8,"column":68,"offset":376},"indent":[]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":8,"column":68,"offset":376},"end":{"line":8,"column":91,"offset":399},"indent":[]}},{"type":"text","value":", for example).","position":{"start":{"line":8,"column":91,"offset":399},"end":{"line":8,"column":106,"offset":414},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":311},"end":{"line":8,"column":106,"offset":414},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":309},"end":{"line":8,"column":106,"offset":414},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Derived values","position":{"start":{"line":9,"column":5,"offset":419},"end":{"line":9,"column":19,"offset":433},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":417},"end":{"line":9,"column":21,"offset":435},"indent":[]}},{"type":"text","value":" are the product of a transformation, composition, or basic operation. For example, the transformation ","position":{"start":{"line":9,"column":21,"offset":435},"end":{"line":9,"column":124,"offset":538},"indent":[]}},{"type":"inlineCode","value":"lower(http.request.uri.patch)","position":{"start":{"line":9,"column":124,"offset":538},"end":{"line":9,"column":155,"offset":569},"indent":[]}},{"type":"text","value":" converts the value of ","position":{"start":{"line":9,"column":155,"offset":569},"end":{"line":9,"column":178,"offset":592},"indent":[]}},{"type":"inlineCode","value":"http.request.uri.path","position":{"start":{"line":9,"column":178,"offset":592},"end":{"line":9,"column":201,"offset":615},"indent":[]}},{"type":"text","value":" to lowercase.","position":{"start":{"line":9,"column":201,"offset":615},"end":{"line":9,"column":215,"offset":629},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":417},"end":{"line":9,"column":215,"offset":629},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":415},"end":{"line":9,"column":215,"offset":629},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Computed values","position":{"start":{"line":10,"column":5,"offset":634},"end":{"line":10,"column":20,"offset":649},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":632},"end":{"line":10,"column":22,"offset":651},"indent":[]}},{"type":"text","value":" are the product of a lookup, computation, or other intelligence. For example, Cloudflare uses a machine learning process to dynamically calculate threat scores, represented by the ","position":{"start":{"line":10,"column":22,"offset":651},"end":{"line":10,"column":203,"offset":832},"indent":[]}},{"type":"inlineCode","value":"cf.threat_score","position":{"start":{"line":10,"column":203,"offset":832},"end":{"line":10,"column":220,"offset":849},"indent":[]}},{"type":"text","value":" field.","position":{"start":{"line":10,"column":220,"offset":849},"end":{"line":10,"column":227,"offset":856},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":632},"end":{"line":10,"column":227,"offset":856},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":630},"end":{"line":10,"column":227,"offset":856},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":309},"end":{"line":10,"column":227,"offset":856},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"When working with values in Firewall Rules expressions, keep in mind the notes outlined below for escape characters, case sensitivity, and boolean values.","position":{"start":{"line":12,"column":1,"offset":858},"end":{"line":12,"column":155,"offset":1012},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":858},"end":{"line":12,"column":155,"offset":1012},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Escape characters in values","position":{"start":{"line":14,"column":4,"offset":1017},"end":{"line":14,"column":31,"offset":1044},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":1014},"end":{"line":14,"column":31,"offset":1044},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You must manually escape the backslash (","position":{"start":{"line":16,"column":1,"offset":1046},"end":{"line":16,"column":41,"offset":1086},"indent":[]}},{"type":"inlineCode","value":"\\","position":{"start":{"line":16,"column":41,"offset":1086},"end":{"line":16,"column":44,"offset":1089},"indent":[]}},{"type":"text","value":") and double quote (","position":{"start":{"line":16,"column":44,"offset":1089},"end":{"line":16,"column":64,"offset":1109},"indent":[]}},{"type":"inlineCode","value":"\"","position":{"start":{"line":16,"column":64,"offset":1109},"end":{"line":16,"column":67,"offset":1112},"indent":[]}},{"type":"text","value":") characters with a backslash when using them as part of a literal value in an expression.","position":{"start":{"line":16,"column":67,"offset":1112},"end":{"line":16,"column":157,"offset":1202},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1046},"end":{"line":16,"column":157,"offset":1202},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Note in this example that the first and last ","position":{"start":{"line":18,"column":1,"offset":1204},"end":{"line":18,"column":46,"offset":1249},"indent":[]}},{"type":"inlineCode","value":"\"","position":{"start":{"line":18,"column":46,"offset":1249},"end":{"line":18,"column":49,"offset":1252},"indent":[]}},{"type":"text","value":" characters in ","position":{"start":{"line":18,"column":49,"offset":1252},"end":{"line":18,"column":64,"offset":1267},"indent":[]}},{"type":"inlineCode","value":"\"token-type=\\\"JWT\\\"\"","position":{"start":{"line":18,"column":64,"offset":1267},"end":{"line":18,"column":86,"offset":1289},"indent":[]}},{"type":"text","value":" are not part of the literal value, so they do not need escaping:","position":{"start":{"line":18,"column":86,"offset":1289},"end":{"line":18,"column":151,"offset":1354},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1204},"end":{"line":18,"column":151,"offset":1354},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(http.request.uri.query contains \"token-type=\\\"JWT\\\"\")","position":{"start":{"line":20,"column":1,"offset":1356},"end":{"line":22,"column":4,"offset":1421},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Case sensitivity and regular expressions in values","position":{"start":{"line":24,"column":4,"offset":1426},"end":{"line":24,"column":54,"offset":1476},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1423},"end":{"line":24,"column":54,"offset":1476},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Since the evaluation of expressions using string values is case-sensitive, consider writing more than one simple expression to capture variants.","position":{"start":{"line":26,"column":1,"offset":1478},"end":{"line":26,"column":145,"offset":1622},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1478},"end":{"line":26,"column":145,"offset":1622},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Cloudflare Business and Enterprise customer plans have access to the ","position":{"start":{"line":28,"column":1,"offset":1624},"end":{"line":28,"column":70,"offset":1693},"indent":[]}},{"type":"inlineCode","value":"matches","position":{"start":{"line":28,"column":70,"offset":1693},"end":{"line":28,"column":79,"offset":1702},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":28,"column":79,"offset":1702},"end":{"line":28,"column":80,"offset":1703},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators/#comparison-operators","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":28,"column":81,"offset":1704},"end":{"line":28,"column":100,"offset":1723},"indent":[]}}],"position":{"start":{"line":28,"column":80,"offset":1703},"end":{"line":28,"column":156,"offset":1779},"indent":[]}},{"type":"text","value":" which supports regular expressions, so that you can capture multiple variants of a value with a single expression.","position":{"start":{"line":28,"column":156,"offset":1779},"end":{"line":28,"column":271,"offset":1894},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1624},"end":{"line":28,"column":271,"offset":1894},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Boolean values","position":{"start":{"line":30,"column":4,"offset":1899},"end":{"line":30,"column":18,"offset":1913},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1896},"end":{"line":30,"column":18,"offset":1913},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions using boolean fields do not require operator notations or values. You only need to insert the field on its own, as shown in the ","position":{"start":{"line":32,"column":1,"offset":1915},"end":{"line":32,"column":148,"offset":2062},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":32,"column":148,"offset":2062},"end":{"line":32,"column":153,"offset":2067},"indent":[]}},{"type":"text","value":" example below.","position":{"start":{"line":32,"column":153,"offset":2067},"end":{"line":32,"column":168,"offset":2082},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1915},"end":{"line":32,"column":168,"offset":2082},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"ssl","position":{"start":{"line":34,"column":1,"offset":2084},"end":{"line":36,"column":4,"offset":2098},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This simple expression matches requests where the value of the ","position":{"start":{"line":38,"column":1,"offset":2100},"end":{"line":38,"column":64,"offset":2163},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":38,"column":64,"offset":2163},"end":{"line":38,"column":69,"offset":2168},"indent":[]}},{"type":"text","value":" field is ","position":{"start":{"line":38,"column":69,"offset":2168},"end":{"line":38,"column":79,"offset":2178},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":38,"column":79,"offset":2178},"end":{"line":38,"column":85,"offset":2184},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":38,"column":85,"offset":2184},"end":{"line":38,"column":86,"offset":2185},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":2100},"end":{"line":38,"column":86,"offset":2185},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To match requests where ","position":{"start":{"line":40,"column":1,"offset":2187},"end":{"line":40,"column":25,"offset":2211},"indent":[]}},{"type":"inlineCode","value":"ssl","position":{"start":{"line":40,"column":25,"offset":2211},"end":{"line":40,"column":30,"offset":2216},"indent":[]}},{"type":"text","value":" is ","position":{"start":{"line":40,"column":30,"offset":2216},"end":{"line":40,"column":34,"offset":2220},"indent":[]}},{"type":"inlineCode","value":"false","position":{"start":{"line":40,"column":34,"offset":2220},"end":{"line":40,"column":41,"offset":2227},"indent":[]}},{"type":"text","value":", use the boolean ","position":{"start":{"line":40,"column":41,"offset":2227},"end":{"line":40,"column":59,"offset":2245},"indent":[]}},{"type":"inlineCode","value":"not","position":{"start":{"line":40,"column":59,"offset":2245},"end":{"line":40,"column":64,"offset":2250},"indent":[]}},{"type":"text","value":" operator :","position":{"start":{"line":40,"column":64,"offset":2250},"end":{"line":40,"column":75,"offset":2261},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2187},"end":{"line":40,"column":75,"offset":2261},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"not ssl","position":{"start":{"line":42,"column":1,"offset":2263},"end":{"line":44,"column":4,"offset":2281},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Arrays","position":{"start":{"line":46,"column":4,"offset":2286},"end":{"line":46,"column":10,"offset":2292},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2283},"end":{"line":46,"column":10,"offset":2292},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Cloudflare Firewall Rules language includes ","position":{"start":{"line":48,"column":1,"offset":2294},"end":{"line":48,"column":49,"offset":2342},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/fields","children":[{"type":"text","value":"fields","position":{"start":{"line":48,"column":50,"offset":2343},"end":{"line":48,"column":56,"offset":2349},"indent":[]}}],"position":{"start":{"line":48,"column":49,"offset":2342},"end":{"line":48,"column":87,"offset":2380},"indent":[]}},{"type":"text","value":" of ","position":{"start":{"line":48,"column":87,"offset":2380},"end":{"line":48,"column":91,"offset":2384},"indent":[]}},{"type":"inlineCode","value":"Array","position":{"start":{"line":48,"column":91,"offset":2384},"end":{"line":48,"column":98,"offset":2391},"indent":[]}},{"type":"text","value":" type and ","position":{"start":{"line":48,"column":98,"offset":2391},"end":{"line":48,"column":108,"offset":2401},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/functions","children":[{"type":"text","value":"functions","position":{"start":{"line":48,"column":109,"offset":2402},"end":{"line":48,"column":118,"offset":2411},"indent":[]}}],"position":{"start":{"line":48,"column":108,"offset":2401},"end":{"line":48,"column":152,"offset":2445},"indent":[]}},{"type":"text","value":" with ","position":{"start":{"line":48,"column":152,"offset":2445},"end":{"line":48,"column":158,"offset":2451},"indent":[]}},{"type":"inlineCode","value":"Array","position":{"start":{"line":48,"column":158,"offset":2451},"end":{"line":48,"column":165,"offset":2458},"indent":[]}},{"type":"text","value":" arguments and return values.","position":{"start":{"line":48,"column":165,"offset":2458},"end":{"line":48,"column":194,"offset":2487},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2294},"end":{"line":48,"column":194,"offset":2487},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can access individual array elements using an index (a non-negative value) between square brackets (","position":{"start":{"line":50,"column":1,"offset":2489},"end":{"line":50,"column":105,"offset":2593},"indent":[]}},{"type":"inlineCode","value":"[]","position":{"start":{"line":50,"column":105,"offset":2593},"end":{"line":50,"column":109,"offset":2597},"indent":[]}},{"type":"text","value":"). Array indexes start at ","position":{"start":{"line":50,"column":109,"offset":2597},"end":{"line":50,"column":135,"offset":2623},"indent":[]}},{"type":"inlineCode","value":"0","position":{"start":{"line":50,"column":135,"offset":2623},"end":{"line":50,"column":138,"offset":2626},"indent":[]}},{"type":"text","value":" (zero).","position":{"start":{"line":50,"column":138,"offset":2626},"end":{"line":50,"column":146,"offset":2634},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2489},"end":{"line":50,"column":146,"offset":2634},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the special notation ","position":{"start":{"line":52,"column":1,"offset":2636},"end":{"line":52,"column":26,"offset":2661},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":52,"column":26,"offset":2661},"end":{"line":52,"column":31,"offset":2666},"indent":[]}},{"type":"text","value":" when specifying an expression that will be evaluated for each array element (like the ","position":{"start":{"line":52,"column":31,"offset":2666},"end":{"line":52,"column":118,"offset":2753},"indent":[]}},{"type":"link","title":null,"url":"https://wikipedia.org/wiki/Map_(higher-order_function)","children":[{"type":"inlineCode","value":"map","position":{"start":{"line":52,"column":119,"offset":2754},"end":{"line":52,"column":124,"offset":2759},"indent":[]}},{"type":"text","value":" high-order function","position":{"start":{"line":52,"column":124,"offset":2759},"end":{"line":52,"column":144,"offset":2779},"indent":[]}}],"position":{"start":{"line":52,"column":118,"offset":2753},"end":{"line":52,"column":201,"offset":2836},"indent":[]}},{"type":"text","value":"). This special index notation will unpack the array, call the enclosing function for all its elements individually, and return a new array containing all the individual return values.","position":{"start":{"line":52,"column":201,"offset":2836},"end":{"line":52,"column":385,"offset":3020},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2636},"end":{"line":52,"column":385,"offset":3020},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Examples","position":{"start":{"line":54,"column":5,"offset":3026},"end":{"line":54,"column":13,"offset":3034},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":3022},"end":{"line":54,"column":13,"offset":3034},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Consider the ","position":{"start":{"line":56,"column":1,"offset":3036},"end":{"line":56,"column":14,"offset":3049},"indent":[]}},{"type":"inlineCode","value":"http.request.headers.names","position":{"start":{"line":56,"column":14,"offset":3049},"end":{"line":56,"column":42,"offset":3077},"indent":[]}},{"type":"text","value":" field with type ","position":{"start":{"line":56,"column":42,"offset":3077},"end":{"line":56,"column":59,"offset":3094},"indent":[]}},{"type":"inlineCode","value":"Array<String>","position":{"start":{"line":56,"column":59,"offset":3094},"end":{"line":56,"column":74,"offset":3109},"indent":[]}},{"type":"text","value":" in the following examples:","position":{"start":{"line":56,"column":74,"offset":3109},"end":{"line":56,"column":101,"offset":3136},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":3036},"end":{"line":56,"column":101,"offset":3136},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Obtain the first element in the array:","position":{"start":{"line":58,"column":3,"offset":3140},"end":{"line":58,"column":41,"offset":3178},"indent":[]}},{"type":"jsx","value":"<br/>","position":{"start":{"line":58,"column":41,"offset":3178},"end":{"line":58,"column":46,"offset":3183},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":58,"column":46,"offset":3183},"end":{"line":59,"column":3,"offset":3186},"indent":[3]}},{"type":"inlineCode","value":"http.request.headers.names[0]","position":{"start":{"line":59,"column":3,"offset":3186},"end":{"line":59,"column":34,"offset":3217},"indent":[]}}],"position":{"start":{"line":58,"column":3,"offset":3140},"end":{"line":59,"column":34,"offset":3217},"indent":[3]}}],"position":{"start":{"line":58,"column":1,"offset":3138},"end":{"line":60,"column":1,"offset":3218},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if the first array element is equal to ","position":{"start":{"line":61,"column":3,"offset":3221},"end":{"line":61,"column":48,"offset":3266},"indent":[]}},{"type":"inlineCode","value":"Content-Type","position":{"start":{"line":61,"column":48,"offset":3266},"end":{"line":61,"column":62,"offset":3280},"indent":[]}},{"type":"text","value":" (case sensitive):","position":{"start":{"line":61,"column":62,"offset":3280},"end":{"line":61,"column":80,"offset":3298},"indent":[]}},{"type":"jsx","value":"<br/>","position":{"start":{"line":61,"column":80,"offset":3298},"end":{"line":61,"column":85,"offset":3303},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":61,"column":85,"offset":3303},"end":{"line":62,"column":3,"offset":3306},"indent":[3]}},{"type":"inlineCode","value":"http.request.headers.names[0] == \"Content-Type\"","position":{"start":{"line":62,"column":3,"offset":3306},"end":{"line":62,"column":52,"offset":3355},"indent":[]}}],"position":{"start":{"line":61,"column":3,"offset":3221},"end":{"line":62,"column":52,"offset":3355},"indent":[3]}}],"position":{"start":{"line":61,"column":1,"offset":3219},"end":{"line":63,"column":1,"offset":3356},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if any array element is equal to ","position":{"start":{"line":64,"column":3,"offset":3359},"end":{"line":64,"column":42,"offset":3398},"indent":[]}},{"type":"inlineCode","value":"Content-Type","position":{"start":{"line":64,"column":42,"offset":3398},"end":{"line":64,"column":56,"offset":3412},"indent":[]}},{"type":"text","value":" (case sensitive):","position":{"start":{"line":64,"column":56,"offset":3412},"end":{"line":64,"column":74,"offset":3430},"indent":[]}},{"type":"jsx","value":"<br/>","position":{"start":{"line":64,"column":74,"offset":3430},"end":{"line":64,"column":79,"offset":3435},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":64,"column":79,"offset":3435},"end":{"line":65,"column":3,"offset":3438},"indent":[3]}},{"type":"inlineCode","value":"any(http.request.headers.names[*] == \"Content-Type\")","position":{"start":{"line":65,"column":3,"offset":3438},"end":{"line":65,"column":57,"offset":3492},"indent":[]}}],"position":{"start":{"line":64,"column":3,"offset":3359},"end":{"line":65,"column":57,"offset":3492},"indent":[3]}}],"position":{"start":{"line":64,"column":1,"offset":3357},"end":{"line":66,"column":1,"offset":3493},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if any array element is equal to ","position":{"start":{"line":67,"column":3,"offset":3496},"end":{"line":67,"column":42,"offset":3535},"indent":[]}},{"type":"inlineCode","value":"Content-Type","position":{"start":{"line":67,"column":42,"offset":3535},"end":{"line":67,"column":56,"offset":3549},"indent":[]}},{"type":"text","value":", ignoring the case:","position":{"start":{"line":67,"column":56,"offset":3549},"end":{"line":67,"column":76,"offset":3569},"indent":[]}},{"type":"jsx","value":"<br/>","position":{"start":{"line":67,"column":76,"offset":3569},"end":{"line":67,"column":81,"offset":3574},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":67,"column":81,"offset":3574},"end":{"line":68,"column":3,"offset":3577},"indent":[3]}},{"type":"inlineCode","value":"any(lower(http.request.headers.names[*])[*] == \"content-type\")","position":{"start":{"line":68,"column":3,"offset":3577},"end":{"line":68,"column":67,"offset":3641},"indent":[]}}],"position":{"start":{"line":67,"column":3,"offset":3496},"end":{"line":68,"column":67,"offset":3641},"indent":[3]}}],"position":{"start":{"line":67,"column":1,"offset":3494},"end":{"line":68,"column":67,"offset":3641},"indent":[1]}}],"position":{"start":{"line":58,"column":1,"offset":3138},"end":{"line":68,"column":67,"offset":3641},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In the last example, the ","position":{"start":{"line":70,"column":1,"offset":3643},"end":{"line":70,"column":26,"offset":3668},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":70,"column":26,"offset":3668},"end":{"line":70,"column":35,"offset":3677},"indent":[]}},{"type":"text","value":" function includes the ","position":{"start":{"line":70,"column":35,"offset":3677},"end":{"line":70,"column":58,"offset":3700},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":70,"column":58,"offset":3700},"end":{"line":70,"column":63,"offset":3705},"indent":[]}},{"type":"text","value":" notation so that the function is evaluated for each array element. This function, used along ","position":{"start":{"line":70,"column":63,"offset":3705},"end":{"line":70,"column":157,"offset":3799},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":70,"column":157,"offset":3799},"end":{"line":70,"column":162,"offset":3804},"indent":[]}},{"type":"text","value":", returns a new array where each element of the input array is converted to lowercase. Then, the string comparison uses ","position":{"start":{"line":70,"column":162,"offset":3804},"end":{"line":70,"column":282,"offset":3924},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":70,"column":282,"offset":3924},"end":{"line":70,"column":287,"offset":3929},"indent":[]}},{"type":"text","value":" to transform the array resulting from applying ","position":{"start":{"line":70,"column":287,"offset":3929},"end":{"line":70,"column":335,"offset":3977},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":70,"column":335,"offset":3977},"end":{"line":70,"column":344,"offset":3986},"indent":[]}},{"type":"text","value":" to each header name into an array of boolean values. Finally, ","position":{"start":{"line":70,"column":344,"offset":3986},"end":{"line":70,"column":407,"offset":4049},"indent":[]}},{"type":"inlineCode","value":"any()","position":{"start":{"line":70,"column":407,"offset":4049},"end":{"line":70,"column":414,"offset":4056},"indent":[]}},{"type":"text","value":" evaluates to true if at least one of these array elements is true.","position":{"start":{"line":70,"column":414,"offset":4056},"end":{"line":70,"column":481,"offset":4123},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":3643},"end":{"line":70,"column":481,"offset":4123},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Final notes","position":{"start":{"line":72,"column":5,"offset":4129},"end":{"line":72,"column":16,"offset":4140},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":4125},"end":{"line":72,"column":16,"offset":4140},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"It is not possible to define your own arrays. You can only use arrays returned by fields, either directly or modified by functions.","position":{"start":{"line":74,"column":1,"offset":4142},"end":{"line":74,"column":132,"offset":4273},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":4142},"end":{"line":74,"column":132,"offset":4273},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Accessing an out-of-bounds array index produces a \"missing value\". A missing value has the following behavior:","position":{"start":{"line":76,"column":1,"offset":4275},"end":{"line":76,"column":111,"offset":4385},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":4275},"end":{"line":76,"column":111,"offset":4385},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Any comparison ","position":{"start":{"line":78,"column":3,"offset":4389},"end":{"line":78,"column":18,"offset":4404},"indent":[]}},{"type":"inlineCode","value":"<expr> <op> <literal>","position":{"start":{"line":78,"column":18,"offset":4404},"end":{"line":78,"column":41,"offset":4427},"indent":[]}},{"type":"text","value":" where ","position":{"start":{"line":78,"column":41,"offset":4427},"end":{"line":78,"column":48,"offset":4434},"indent":[]}},{"type":"inlineCode","value":"<expr>","position":{"start":{"line":78,"column":48,"offset":4434},"end":{"line":78,"column":56,"offset":4442},"indent":[]}},{"type":"text","value":" evaluates to a missing value will evaluate to false.","position":{"start":{"line":78,"column":56,"offset":4442},"end":{"line":78,"column":109,"offset":4495},"indent":[]}}],"position":{"start":{"line":78,"column":3,"offset":4389},"end":{"line":78,"column":109,"offset":4495},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":4387},"end":{"line":78,"column":109,"offset":4495},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Function calls like ","position":{"start":{"line":79,"column":3,"offset":4498},"end":{"line":79,"column":23,"offset":4518},"indent":[]}},{"type":"inlineCode","value":"function(<expr>)","position":{"start":{"line":79,"column":23,"offset":4518},"end":{"line":79,"column":41,"offset":4536},"indent":[]}},{"type":"text","value":", where ","position":{"start":{"line":79,"column":41,"offset":4536},"end":{"line":79,"column":49,"offset":4544},"indent":[]}},{"type":"inlineCode","value":"<expr>","position":{"start":{"line":79,"column":49,"offset":4544},"end":{"line":79,"column":57,"offset":4552},"indent":[]}},{"type":"text","value":" evaluates to a missing value, will return a missing value in most cases, but the exact behavior can vary per function.","position":{"start":{"line":79,"column":57,"offset":4552},"end":{"line":79,"column":176,"offset":4671},"indent":[]}}],"position":{"start":{"line":79,"column":3,"offset":4498},"end":{"line":79,"column":176,"offset":4671},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":4496},"end":{"line":79,"column":176,"offset":4671},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":4387},"end":{"line":79,"column":176,"offset":4671},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"You can only use ","position":{"start":{"line":81,"column":1,"offset":4673},"end":{"line":81,"column":18,"offset":4690},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":81,"column":18,"offset":4690},"end":{"line":81,"column":23,"offset":4695},"indent":[]}},{"type":"text","value":" multiple times in the same expression if applied to the same array. Also, you can only use ","position":{"start":{"line":81,"column":23,"offset":4695},"end":{"line":81,"column":115,"offset":4787},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":81,"column":115,"offset":4787},"end":{"line":81,"column":120,"offset":4792},"indent":[]}},{"type":"text","value":" in the first argument of a function call.","position":{"start":{"line":81,"column":120,"offset":4792},"end":{"line":81,"column":162,"offset":4834},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":4673},"end":{"line":81,"column":162,"offset":4834},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Firewall Rules language ","position":{"start":{"line":83,"column":1,"offset":4836},"end":{"line":83,"column":29,"offset":4864},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators","children":[{"type":"text","value":"operators","position":{"start":{"line":83,"column":30,"offset":4865},"end":{"line":83,"column":39,"offset":4874},"indent":[]}}],"position":{"start":{"line":83,"column":29,"offset":4864},"end":{"line":83,"column":73,"offset":4908},"indent":[]}},{"type":"text","value":" do not directly support arrays or the ","position":{"start":{"line":83,"column":73,"offset":4908},"end":{"line":83,"column":112,"offset":4947},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":83,"column":112,"offset":4947},"end":{"line":83,"column":117,"offset":4952},"indent":[]}},{"type":"text","value":" operator — however, they support indexed array elements like ","position":{"start":{"line":83,"column":117,"offset":4952},"end":{"line":83,"column":179,"offset":5014},"indent":[]}},{"type":"inlineCode","value":"array_value[0]","position":{"start":{"line":83,"column":179,"offset":5014},"end":{"line":83,"column":195,"offset":5030},"indent":[]}},{"type":"text","value":". For example, you cannot use ","position":{"start":{"line":83,"column":195,"offset":5030},"end":{"line":83,"column":225,"offset":5060},"indent":[]}},{"type":"inlineCode","value":"[*]","position":{"start":{"line":83,"column":225,"offset":5060},"end":{"line":83,"column":230,"offset":5065},"indent":[]}},{"type":"text","value":" with the ","position":{"start":{"line":83,"column":230,"offset":5065},"end":{"line":83,"column":240,"offset":5075},"indent":[]}},{"type":"inlineCode","value":"==","position":{"start":{"line":83,"column":240,"offset":5075},"end":{"line":83,"column":244,"offset":5079},"indent":[]}},{"type":"text","value":" operator outside the context of an enclosing function call:","position":{"start":{"line":83,"column":244,"offset":5079},"end":{"line":83,"column":304,"offset":5139},"indent":[]}}],"position":{"start":{"line":83,"column":1,"offset":4836},"end":{"line":83,"column":304,"offset":5139},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"http.request.headers.names[*] == \"Content-Type\"","position":{"start":{"line":85,"column":3,"offset":5143},"end":{"line":85,"column":52,"offset":5192},"indent":[]}},{"type":"text","value":" — ","position":{"start":{"line":85,"column":52,"offset":5192},"end":{"line":85,"column":55,"offset":5195},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Invalid","position":{"start":{"line":85,"column":57,"offset":5197},"end":{"line":85,"column":64,"offset":5204},"indent":[]}}],"position":{"start":{"line":85,"column":55,"offset":5195},"end":{"line":85,"column":66,"offset":5206},"indent":[]}},{"type":"text","value":" expression","position":{"start":{"line":85,"column":66,"offset":5206},"end":{"line":85,"column":77,"offset":5217},"indent":[]}}],"position":{"start":{"line":85,"column":3,"offset":5143},"end":{"line":85,"column":77,"offset":5217},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":5141},"end":{"line":85,"column":77,"offset":5217},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"any(http.request.headers.names[*] == \"Content-Type\")","position":{"start":{"line":86,"column":3,"offset":5220},"end":{"line":86,"column":57,"offset":5274},"indent":[]}},{"type":"text","value":" — ","position":{"start":{"line":86,"column":57,"offset":5274},"end":{"line":86,"column":60,"offset":5277},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Valid","position":{"start":{"line":86,"column":62,"offset":5279},"end":{"line":86,"column":67,"offset":5284},"indent":[]}}],"position":{"start":{"line":86,"column":60,"offset":5277},"end":{"line":86,"column":69,"offset":5286},"indent":[]}},{"type":"text","value":" expression","position":{"start":{"line":86,"column":69,"offset":5286},"end":{"line":86,"column":80,"offset":5297},"indent":[]}}],"position":{"start":{"line":86,"column":3,"offset":5220},"end":{"line":86,"column":80,"offset":5297},"indent":[]}}],"position":{"start":{"line":86,"column":1,"offset":5218},"end":{"line":86,"column":80,"offset":5297},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":5141},"end":{"line":86,"column":80,"offset":5297},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"IP Lists","position":{"start":{"line":88,"column":4,"offset":5302},"end":{"line":88,"column":12,"offset":5310},"indent":[]}}],"position":{"start":{"line":88,"column":1,"offset":5299},"end":{"line":88,"column":12,"offset":5310},"indent":[]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"/cf-firewall-rules/rules-lists","children":[{"type":"text","value":"IP Lists","position":{"start":{"line":90,"column":2,"offset":5313},"end":{"line":90,"column":10,"offset":5321},"indent":[]}}],"position":{"start":{"line":90,"column":1,"offset":5312},"end":{"line":90,"column":43,"offset":5354},"indent":[]}},{"type":"text","value":" allow you to create a group of IP addresses and refer to them collectively, by name, in your firewall rule expressions.","position":{"start":{"line":90,"column":43,"offset":5354},"end":{"line":90,"column":163,"offset":5474},"indent":[]}}],"position":{"start":{"line":90,"column":1,"offset":5312},"end":{"line":90,"column":163,"offset":5474},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To refer to an IP List in a firewall rule expression, use ","position":{"start":{"line":92,"column":1,"offset":5476},"end":{"line":92,"column":59,"offset":5534},"indent":[]}},{"type":"inlineCode","value":"$<list_name>","position":{"start":{"line":92,"column":59,"offset":5534},"end":{"line":92,"column":73,"offset":5548},"indent":[]}},{"type":"text","value":" and specify the ","position":{"start":{"line":92,"column":73,"offset":5548},"end":{"line":92,"column":90,"offset":5565},"indent":[]}},{"type":"inlineCode","value":"in","position":{"start":{"line":92,"column":90,"offset":5565},"end":{"line":92,"column":94,"offset":5569},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":92,"column":94,"offset":5569},"end":{"line":92,"column":95,"offset":5570},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators","children":[{"type":"text","value":"operator","position":{"start":{"line":92,"column":96,"offset":5571},"end":{"line":92,"column":104,"offset":5579},"indent":[]}}],"position":{"start":{"line":92,"column":95,"offset":5570},"end":{"line":92,"column":138,"offset":5613},"indent":[]}},{"type":"text","value":". This example expression filters requests from IP addresses that are in an IP List named ","position":{"start":{"line":92,"column":138,"offset":5613},"end":{"line":92,"column":228,"offset":5703},"indent":[]}},{"type":"inlineCode","value":"office_network","position":{"start":{"line":92,"column":228,"offset":5703},"end":{"line":92,"column":244,"offset":5719},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":92,"column":244,"offset":5719},"end":{"line":92,"column":245,"offset":5720},"indent":[]}}],"position":{"start":{"line":92,"column":1,"offset":5476},"end":{"line":92,"column":245,"offset":5720},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(ip.src in $office_network)","position":{"start":{"line":94,"column":1,"offset":5722},"end":{"line":96,"column":4,"offset":5760},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note that names for IP Lists can only include lowercase letters, numbers, and the underscore (","position":{"start":{"line":98,"column":1,"offset":5762},"end":{"line":98,"column":95,"offset":5856},"indent":[]}},{"type":"inlineCode","value":"_","position":{"start":{"line":98,"column":95,"offset":5856},"end":{"line":98,"column":98,"offset":5859},"indent":[]}},{"type":"text","value":") character. For guidance on creating and managing lists, refer to ","position":{"start":{"line":98,"column":98,"offset":5859},"end":{"line":98,"column":165,"offset":5926},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/firewall/cf-dashboard/rules-lists/manage-lists","children":[{"type":"text","value":"Use IP Lists: Manage Lists","position":{"start":{"line":98,"column":166,"offset":5927},"end":{"line":98,"column":192,"offset":5953},"indent":[]}}],"position":{"start":{"line":98,"column":165,"offset":5926},"end":{"line":98,"column":275,"offset":6036},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":98,"column":275,"offset":6036},"end":{"line":98,"column":276,"offset":6037},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":5762},"end":{"line":98,"column":276,"offset":6037},"indent":[]}},{"type":"export","value":"export const _frontmatter = {\"pcx-content-type\":\"reference\",\"order\":630}","position":{"start":{"line":101,"column":1,"offset":6040},"end":{"line":101,"column":73,"offset":6112},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":101,"column":73,"offset":6112}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"reference\",\n  \"order\": 630\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"values\"\n  }, \"Values\"), mdx(\"p\", null, \"When an HTTP request reaches Cloudflare\\u2019s edge, Cloudflare creates a table of field\\u2013value pairs against which to match expressions. This table exists for as long as the current request is being processed.\"), mdx(\"p\", null, \"The values that populate Firewall Rules lookup tables are drawn from a variety of sources:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Primitive properties\"), \" are obtained directly from the request (\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.request.uri.path\"), \", for example).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Derived values\"), \" are the product of a transformation, composition, or basic operation. For example, the transformation \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"lower(http.request.uri.patch)\"), \" converts the value of \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.request.uri.path\"), \" to lowercase.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Computed values\"), \" are the product of a lookup, computation, or other intelligence. For example, Cloudflare uses a machine learning process to dynamically calculate threat scores, represented by the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"cf.threat_score\"), \" field.\")), mdx(\"p\", null, \"When working with values in Firewall Rules expressions, keep in mind the notes outlined below for escape characters, case sensitivity, and boolean values.\"), mdx(\"h2\", {\n    \"id\": \"escape-characters-in-values\"\n  }, \"Escape characters in values\"), mdx(\"p\", null, \"You must manually escape the backslash (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\\\\"), \") and double quote (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\\"\"), \") characters with a backslash when using them as part of a literal value in an expression.\"), mdx(\"p\", null, \"Note in this example that the first and last \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\\"\"), \" characters in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\\"token-type=\\\\\\\"JWT\\\\\\\"\\\"\"), \" are not part of the literal value, so they do not need escaping:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"(http.request.uri.query contains \\\"token-type=\\\\\\\"JWT\\\\\\\"\\\")\\n\")), mdx(\"h2\", {\n    \"id\": \"case-sensitivity-and-regular-expressions-in-values\"\n  }, \"Case sensitivity and regular expressions in values\"), mdx(\"p\", null, \"Since the evaluation of expressions using string values is case-sensitive, consider writing more than one simple expression to capture variants.\"), mdx(\"p\", null, \"Cloudflare Business and Enterprise customer plans have access to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matches\"), \" \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/operators/#comparison-operators\"\n  }, \"comparison operator\"), \" which supports regular expressions, so that you can capture multiple variants of a value with a single expression.\"), mdx(\"h2\", {\n    \"id\": \"boolean-values\"\n  }, \"Boolean values\"), mdx(\"p\", null, \"Simple expressions using boolean fields do not require operator notations or values. You only need to insert the field on its own, as shown in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ssl\"), \" example below.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"ssl\\n\")), mdx(\"p\", null, \"This simple expression matches requests where the value of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ssl\"), \" field is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \".\"), mdx(\"p\", null, \"To match requests where \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ssl\"), \" is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"false\"), \", use the boolean \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"not\"), \" operator :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"not ssl\\n\")), mdx(\"h2\", {\n    \"id\": \"arrays\"\n  }, \"Arrays\"), mdx(\"p\", null, \"The Cloudflare Firewall Rules language includes \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/fields\"\n  }, \"fields\"), \" of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Array\"), \" type and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/functions\"\n  }, \"functions\"), \" with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Array\"), \" arguments and return values.\"), mdx(\"p\", null, \"You can access individual array elements using an index (a non-negative value) between square brackets (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[]\"), \"). Array indexes start at \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0\"), \" (zero).\"), mdx(\"p\", null, \"Use the special notation \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" when specifying an expression that will be evaluated for each array element (like the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://wikipedia.org/wiki/Map_(higher-order_function)\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"map\"), \" high-order function\"), \"). This special index notation will unpack the array, call the enclosing function for all its elements individually, and return a new array containing all the individual return values.\"), mdx(\"h3\", {\n    \"id\": \"examples\"\n  }, \"Examples\"), mdx(\"p\", null, \"Consider the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http.request.headers.names\"), \" field with type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Array<String>\"), \" in the following examples:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Obtain the first element in the array:\", mdx(\"br\", null), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http.request.headers.names[0]\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if the first array element is equal to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Content-Type\"), \" (case sensitive):\", mdx(\"br\", null), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http.request.headers.names[0] == \\\"Content-Type\\\"\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if any array element is equal to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Content-Type\"), \" (case sensitive):\", mdx(\"br\", null), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"any(http.request.headers.names[*] == \\\"Content-Type\\\")\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if any array element is equal to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Content-Type\"), \", ignoring the case:\", mdx(\"br\", null), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"any(lower(http.request.headers.names[*])[*] == \\\"content-type\\\")\")))), mdx(\"p\", null, \"In the last example, the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"lower()\"), \" function includes the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" notation so that the function is evaluated for each array element. This function, used along \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \", returns a new array where each element of the input array is converted to lowercase. Then, the string comparison uses \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" to transform the array resulting from applying \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"lower()\"), \" to each header name into an array of boolean values. Finally, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"any()\"), \" evaluates to true if at least one of these array elements is true.\"), mdx(\"h3\", {\n    \"id\": \"final-notes\"\n  }, \"Final notes\"), mdx(\"p\", null, \"It is not possible to define your own arrays. You can only use arrays returned by fields, either directly or modified by functions.\"), mdx(\"p\", null, \"Accessing an out-of-bounds array index produces a \\\"missing value\\\". A missing value has the following behavior:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Any comparison \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<expr> <op> <literal>\"), \" where \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<expr>\"), \" evaluates to a missing value will evaluate to false.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Function calls like \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"function(<expr>)\"), \", where \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<expr>\"), \" evaluates to a missing value, will return a missing value in most cases, but the exact behavior can vary per function.\")), mdx(\"p\", null, \"You can only use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" multiple times in the same expression if applied to the same array. Also, you can only use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" in the first argument of a function call.\"), mdx(\"p\", null, \"The Firewall Rules language \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/operators\"\n  }, \"operators\"), \" do not directly support arrays or the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" operator \\u2014 however, they support indexed array elements like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"array_value[0]\"), \". For example, you cannot use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[*]\"), \" with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"==\"), \" operator outside the context of an enclosing function call:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.request.headers.names[*] == \\\"Content-Type\\\"\"), \" \\u2014 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Invalid\"), \" expression\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"any(http.request.headers.names[*] == \\\"Content-Type\\\")\"), \" \\u2014 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Valid\"), \" expression\")), mdx(\"h2\", {\n    \"id\": \"ip-lists\"\n  }, \"IP Lists\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-rules/rules-lists\"\n  }, \"IP Lists\"), \" allow you to create a group of IP addresses and refer to them collectively, by name, in your firewall rule expressions.\"), mdx(\"p\", null, \"To refer to an IP List in a firewall rule expression, use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$<list_name>\"), \" and specify the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"in\"), \" \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/operators\"\n  }, \"operator\"), \". This example expression filters requests from IP addresses that are in an IP List named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"office_network\"), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"(ip.src in $office_network)\\n\")), mdx(\"p\", null, \"Note that names for IP Lists can only include lowercase letters, numbers, and the underscore (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"_\"), \") character. For guidance on creating and managing lists, refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/firewall/cf-dashboard/rules-lists/manage-lists\"\n  }, \"Use IP Lists: Manage Lists\"), \".\"));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"pcx-content-type\": \"reference\",\n  \"order\": 630\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"values\"\n    }}>{`Values`}</h1>\n    <p>{`When an HTTP request reaches Cloudflare’s edge, Cloudflare creates a table of field–value pairs against which to match expressions. This table exists for as long as the current request is being processed.`}</p>\n    <p>{`The values that populate Firewall Rules lookup tables are drawn from a variety of sources:`}</p>\n    <ul>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Primitive properties`}</strong>{` are obtained directly from the request (`}<inlineCode parentName=\"li\">{`http.request.uri.path`}</inlineCode>{`, for example).`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Derived values`}</strong>{` are the product of a transformation, composition, or basic operation. For example, the transformation `}<inlineCode parentName=\"li\">{`lower(http.request.uri.patch)`}</inlineCode>{` converts the value of `}<inlineCode parentName=\"li\">{`http.request.uri.path`}</inlineCode>{` to lowercase.`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Computed values`}</strong>{` are the product of a lookup, computation, or other intelligence. For example, Cloudflare uses a machine learning process to dynamically calculate threat scores, represented by the `}<inlineCode parentName=\"li\">{`cf.threat_score`}</inlineCode>{` field.`}</li>\n    </ul>\n    <p>{`When working with values in Firewall Rules expressions, keep in mind the notes outlined below for escape characters, case sensitivity, and boolean values.`}</p>\n    <h2 {...{\n      \"id\": \"escape-characters-in-values\"\n    }}>{`Escape characters in values`}</h2>\n    <p>{`You must manually escape the backslash (`}<inlineCode parentName=\"p\">{`\\\\`}</inlineCode>{`) and double quote (`}<inlineCode parentName=\"p\">{`\"`}</inlineCode>{`) characters with a backslash when using them as part of a literal value in an expression.`}</p>\n    <p>{`Note in this example that the first and last `}<inlineCode parentName=\"p\">{`\"`}</inlineCode>{` characters in `}<inlineCode parentName=\"p\">{`\"token-type=\\\\\"JWT\\\\\"\"`}</inlineCode>{` are not part of the literal value, so they do not need escaping:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`(http.request.uri.query contains \"token-type=\\\\\"JWT\\\\\"\")\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"case-sensitivity-and-regular-expressions-in-values\"\n    }}>{`Case sensitivity and regular expressions in values`}</h2>\n    <p>{`Since the evaluation of expressions using string values is case-sensitive, consider writing more than one simple expression to capture variants.`}</p>\n    <p>{`Cloudflare Business and Enterprise customer plans have access to the `}<inlineCode parentName=\"p\">{`matches`}</inlineCode>{` `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/operators/#comparison-operators\"\n      }}>{`comparison operator`}</a>{` which supports regular expressions, so that you can capture multiple variants of a value with a single expression.`}</p>\n    <h2 {...{\n      \"id\": \"boolean-values\"\n    }}>{`Boolean values`}</h2>\n    <p>{`Simple expressions using boolean fields do not require operator notations or values. You only need to insert the field on its own, as shown in the `}<inlineCode parentName=\"p\">{`ssl`}</inlineCode>{` example below.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`ssl\n`}</code></pre>\n    <p>{`This simple expression matches requests where the value of the `}<inlineCode parentName=\"p\">{`ssl`}</inlineCode>{` field is `}<inlineCode parentName=\"p\">{`true`}</inlineCode>{`.`}</p>\n    <p>{`To match requests where `}<inlineCode parentName=\"p\">{`ssl`}</inlineCode>{` is `}<inlineCode parentName=\"p\">{`false`}</inlineCode>{`, use the boolean `}<inlineCode parentName=\"p\">{`not`}</inlineCode>{` operator :`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`not ssl\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"arrays\"\n    }}>{`Arrays`}</h2>\n    <p>{`The Cloudflare Firewall Rules language includes `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/fields\"\n      }}>{`fields`}</a>{` of `}<inlineCode parentName=\"p\">{`Array`}</inlineCode>{` type and `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/functions\"\n      }}>{`functions`}</a>{` with `}<inlineCode parentName=\"p\">{`Array`}</inlineCode>{` arguments and return values.`}</p>\n    <p>{`You can access individual array elements using an index (a non-negative value) between square brackets (`}<inlineCode parentName=\"p\">{`[]`}</inlineCode>{`). Array indexes start at `}<inlineCode parentName=\"p\">{`0`}</inlineCode>{` (zero).`}</p>\n    <p>{`Use the special notation `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` when specifying an expression that will be evaluated for each array element (like the `}<a parentName=\"p\" {...{\n        \"href\": \"https://wikipedia.org/wiki/Map_(higher-order_function)\"\n      }}><inlineCode parentName=\"a\">{`map`}</inlineCode>{` high-order function`}</a>{`). This special index notation will unpack the array, call the enclosing function for all its elements individually, and return a new array containing all the individual return values.`}</p>\n    <h3 {...{\n      \"id\": \"examples\"\n    }}>{`Examples`}</h3>\n    <p>{`Consider the `}<inlineCode parentName=\"p\">{`http.request.headers.names`}</inlineCode>{` field with type `}<inlineCode parentName=\"p\">{`Array<String>`}</inlineCode>{` in the following examples:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Obtain the first element in the array:`}<br />{`\n`}<inlineCode parentName=\"p\">{`http.request.headers.names[0]`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Check if the first array element is equal to `}<inlineCode parentName=\"p\">{`Content-Type`}</inlineCode>{` (case sensitive):`}<br />{`\n`}<inlineCode parentName=\"p\">{`http.request.headers.names[0] == \"Content-Type\"`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Check if any array element is equal to `}<inlineCode parentName=\"p\">{`Content-Type`}</inlineCode>{` (case sensitive):`}<br />{`\n`}<inlineCode parentName=\"p\">{`any(http.request.headers.names[*] == \"Content-Type\")`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Check if any array element is equal to `}<inlineCode parentName=\"p\">{`Content-Type`}</inlineCode>{`, ignoring the case:`}<br />{`\n`}<inlineCode parentName=\"p\">{`any(lower(http.request.headers.names[*])[*] == \"content-type\")`}</inlineCode></p>\n      </li>\n    </ul>\n    <p>{`In the last example, the `}<inlineCode parentName=\"p\">{`lower()`}</inlineCode>{` function includes the `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` notation so that the function is evaluated for each array element. This function, used along `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{`, returns a new array where each element of the input array is converted to lowercase. Then, the string comparison uses `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` to transform the array resulting from applying `}<inlineCode parentName=\"p\">{`lower()`}</inlineCode>{` to each header name into an array of boolean values. Finally, `}<inlineCode parentName=\"p\">{`any()`}</inlineCode>{` evaluates to true if at least one of these array elements is true.`}</p>\n    <h3 {...{\n      \"id\": \"final-notes\"\n    }}>{`Final notes`}</h3>\n    <p>{`It is not possible to define your own arrays. You can only use arrays returned by fields, either directly or modified by functions.`}</p>\n    <p>{`Accessing an out-of-bounds array index produces a \"missing value\". A missing value has the following behavior:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Any comparison `}<inlineCode parentName=\"li\">{`<expr> <op> <literal>`}</inlineCode>{` where `}<inlineCode parentName=\"li\">{`<expr>`}</inlineCode>{` evaluates to a missing value will evaluate to false.`}</li>\n      <li parentName=\"ul\">{`Function calls like `}<inlineCode parentName=\"li\">{`function(<expr>)`}</inlineCode>{`, where `}<inlineCode parentName=\"li\">{`<expr>`}</inlineCode>{` evaluates to a missing value, will return a missing value in most cases, but the exact behavior can vary per function.`}</li>\n    </ul>\n    <p>{`You can only use `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` multiple times in the same expression if applied to the same array. Also, you can only use `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` in the first argument of a function call.`}</p>\n    <p>{`The Firewall Rules language `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/operators\"\n      }}>{`operators`}</a>{` do not directly support arrays or the `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` operator — however, they support indexed array elements like `}<inlineCode parentName=\"p\">{`array_value[0]`}</inlineCode>{`. For example, you cannot use `}<inlineCode parentName=\"p\">{`[*]`}</inlineCode>{` with the `}<inlineCode parentName=\"p\">{`==`}</inlineCode>{` operator outside the context of an enclosing function call:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`http.request.headers.names[*] == \"Content-Type\"`}</inlineCode>{` — `}<strong parentName=\"li\">{`Invalid`}</strong>{` expression`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`any(http.request.headers.names[*] == \"Content-Type\")`}</inlineCode>{` — `}<strong parentName=\"li\">{`Valid`}</strong>{` expression`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"ip-lists\"\n    }}>{`IP Lists`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-rules/rules-lists\"\n      }}>{`IP Lists`}</a>{` allow you to create a group of IP addresses and refer to them collectively, by name, in your firewall rule expressions.`}</p>\n    <p>{`To refer to an IP List in a firewall rule expression, use `}<inlineCode parentName=\"p\">{`$<list_name>`}</inlineCode>{` and specify the `}<inlineCode parentName=\"p\">{`in`}</inlineCode>{` `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/operators\"\n      }}>{`operator`}</a>{`. This example expression filters requests from IP addresses that are in an IP List named `}<inlineCode parentName=\"p\">{`office_network`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`(ip.src in $office_network)\n`}</code></pre>\n    <p>{`Note that names for IP Lists can only include lowercase letters, numbers, and the underscore (`}<inlineCode parentName=\"p\">{`_`}</inlineCode>{`) character. For guidance on creating and managing lists, refer to `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/firewall/cf-dashboard/rules-lists/manage-lists\"\n      }}>{`Use IP Lists: Manage Lists`}</a>{`.`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}