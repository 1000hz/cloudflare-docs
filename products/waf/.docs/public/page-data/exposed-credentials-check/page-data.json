{"componentChunkName":"component---src-components-mdx-custom-renderer-js","path":"/exposed-credentials-check","result":{"data":{"mdx":{"id":"7b2f6016-0331-5a4a-920f-8c43786a9398","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"concept\",\n  \"order\": 5\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"automated-exposed-credentials-check\"\n  }, \"Automated exposed credentials check\"), mdx(Aside, {\n    type: \"note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"This feature is available\\xA0to all paid plans.\")), mdx(\"p\", null, \"Many web applications have suffered credential stuffing attacks in the recent past. In these attacks there is a massive number of login attempts using username/password pairs from databases of exposed credentials.\"), mdx(\"p\", null, \"Cloudflare offers you automated checks for exposed credentials using Cloudflare Web Application Firewall (WAF).\"), mdx(\"p\", null, \"The WAF provides two mechanisms for this check:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Exposed Credentials Check Managed Ruleset\"), \", which contains predefined rules for popular CMS applications. By enabling this ruleset for a given zone, you immediately enable checks for exposed credentials for these well-known applications.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The ability to write \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"custom rules\"), \" for a zone that check for exposed credentials according to your criteria for specific applications.\"))), mdx(\"p\", null, \"Cloudflare updates the databases of exposed credentials supporting the exposed credentials check feature on a regular basis. The username/password credentials in clear text never leave the Cloudflare network. The WAF only uses an anonymized version of the username when determining if there are previously exposed credentials with that username.\"), mdx(\"h2\", {\n    \"id\": \"available-actions\"\n  }, \"Available actions\"), mdx(\"p\", null, \"The WAF can perform one of the following actions when it detects exposed credentials:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"CF-Exposed Credentials Header\"), \" \\u2014 Adds a new HTTP header to HTTP requests with exposed credentials. Your application at the origin can then force a password reset, start a two-factor authentication process, or perform any other action. The name of the added HTTP header is \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Exposed-Credential-Check\"), \" and its value is \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"1\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Log\"), \" \\u2014 Only available on Enterprise plans. Logs requests with exposed credentials in the Cloudflare Logs. Recommended for validating a rule before committing to a more severe action.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Block\"), \" \\u2014 Blocks HTTP requests containing exposed credentials.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"JS Challenge\"), \" \\u2014 Presents a Cloudflare JavaScript Captcha challenge to the clients making HTTP requests with exposed credentials.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Challenge (Captcha)\"), \" \\u2014 Presents a Captcha challenge to the clients making HTTP requests with exposed credentials.\")), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Cloudflare recommends that you only use the following actions: \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"CF-Exposed Credentials Header\"), \" (named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rewrite\"), \" in the API) or \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Log\"), \" (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"log\"), \").\")), mdx(\"h2\", {\n    \"id\": \"the-exposed-credentials-check-managed-ruleset\"\n  }, \"The Exposed Credentials Check Managed Ruleset\"), mdx(\"p\", null, \"Cloudflare WAF includes an Exposed Credentials Check Managed Ruleset, a set of pre-configured rules for well-known CMS applications that include the following:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"WordPress\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Joomla\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Drupal\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Ghost\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Plone\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Magento\")), mdx(\"p\", null, \"Additionally, this Managed Ruleset also includes generic rules for other common patterns:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Check forms submitted using a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"POST\"), \" request containing \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"username\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"password\"), \" arguments\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Check credentials sent as JSON with \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"email\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"password\"), \" keys\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Check credentials sent as JSON with \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"username\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"password\"), \" keys\")), mdx(\"p\", null, \"The default action for the rules in the Exposed Credentials Check Managed Ruleset is \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"CF-Exposed Credentials Header\"), \" (named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rewrite\"), \" in the API).\"), mdx(Aside, {\n    type: \"note\",\n    header: \"Note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"The Managed Ruleset contains an additional rule that blocks HTTP requests already containing the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Exposed-Credential-Check\"), \" HTTP header used by the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"CF-Exposed Credentials Header\"), \" action. These requests could be used to trick the origin into believing that a request contained (or did not contain) exposed credentials.\")), mdx(\"p\", null, \"You can turn the Managed Ruleset on/off and customize the action performed by each rule when there is a match. Check \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/exposed-credentials-check/configure-dashboard\"\n  }, \"Configure exposed credentials check in the dashboard\"), \" for more information.\"), mdx(\"h2\", {\n    \"id\": \"exposed-credentials-checks-in-custom-rules\"\n  }, \"Exposed credentials checks in custom rules\"), mdx(Aside, {\n    type: \"warning\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Currently, exposed credentials checks in custom rules are only available via API.\")), mdx(\"p\", null, \"You can also check for exposed credentials in custom rules. One common use case is to create custom rules on the end user authentication endpoints of your application to check for exposed credentials.\"), mdx(\"p\", null, \"To check for exposed credentials in a custom rule, include the exposed credentials check in the rule definition and specify how to obtain the username and password values from the HTTP request.\"), mdx(\"p\", null, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \" to include exposed credentials check in a custom rule. For more information, see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/exposed-credentials-check/configure-api#create-a-custom-rule-checking-for-exposed-credentials\"\n  }, \"Create a custom rule checking for exposed credentials\"), \".\"), mdx(Aside, {\n    type: \"note\",\n    header: \"Note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Rules that check for exposed credentials run before Rate Limiting Rules.\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"","type":null,"updated":null}}},"pageContext":{"id":"7b2f6016-0331-5a4a-920f-8c43786a9398","fields":{"slug":"/exposed-credentials-check"},"frontmatter":{"pcx_content_type":"concept","title":"","type":null,"order":5,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Automated exposed credentials check","depth":1}],"tableOfContents":{"items":[{"url":"#automated-exposed-credentials-check","title":"Automated exposed credentials check","items":[{"url":"#available-actions","title":"Available actions"},{"url":"#the-exposed-credentials-check-managed-ruleset","title":"The Exposed Credentials Check Managed Ruleset"},{"url":"#exposed-credentials-checks-in-custom-rules","title":"Exposed credentials checks in custom rules"}]}]},"parent":{"modifiedTime":"2022-01-25","relativePath":"exposed-credentials-check/index.md"}}},"staticQueryHashes":["2814688963","32046230","338033027","598566803","811020565"]}