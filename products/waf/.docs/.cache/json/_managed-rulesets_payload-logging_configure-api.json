{"data":{"mdx":{"id":"26138167-5401-563d-a532-ba1c46487066","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Configure payload logging via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"order\": 3\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"configure-payload-logging-for-a-managed-ruleset-via-api\"\n  }, \"Configure payload logging for a Managed Ruleset via API\"), mdx(\"p\", null, \"You can use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/\"\n  }, \"Rulesets API\"), \" to configure payload logging for a Managed Ruleset.\"), mdx(\"h2\", {\n    \"id\": \"configure-and-enable-payload-logging\"\n  }, \"Configure and enable payload logging\"), mdx(\"p\", null, \"To configure:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule\"\n  }, \"Update rule in ruleset\"), \" API method to update the rule that executes the Managed Ruleset.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"In the configuration of the rule that executes the Managed Ruleset, include a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matched_data\"), \" object in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \" to configure payload logging.\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matched_data\"), \" object has the following structure:\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nhighlight: [3,4,5]\\n---\\n\\\"action_parameters\\\": {\\n  // ...\\n  \\\"matched_data\\\": {\\n    \\\"public_key\\\": \\\"<PUBLIC_KEY_VALUE>\\\"\\n  }\\n}\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<PUBLIC_KEY_VALUE>\"), \" with the public key you want to use for payload logging.\"))), mdx(\"p\", null, \"You can generate a public key \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/managed-rulesets/payload-logging/command-line/generate-key-pair\"\n  }, \"in the command line\"), \" or \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/managed-rulesets/payload-logging/configure\"\n  }, \"in the Cloudflare dashboard\"), \".\"), mdx(\"h3\", {\n    \"id\": \"example\"\n  }, \"Example\"), mdx(\"p\", null, \"The following example updates rule \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{rule-id-1}\"), \" that executes the Cloudflare Managed Ruleset for zone \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{zone-id}\"), \", configuring payload logging with the provided public key.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\nhighlight: [9,10,11]\\n---\\ncurl -X PATCH \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zone/{zone-id}/rulesets/{ruleset-id}/rules/{rule-id-1}\\\" \\\\\\n-d '{\\n  \\\"action\\\": \\\"execute\\\",\\n  \\\"action_parameters\\\": {\\n    \\\"id\\\": \\\"{cloudflare-managed-ruleset-id}\\\",\\n    \\\"matched_data\\\": {\\n      \\\"public_key\\\": \\\"{your-public-key}\\\"\\n    }\\n  },\\n  \\\"expression\\\": \\\"true\\\",\\n  \\\"description\\\": \\\"Executes the Cloudflare Managed Ruleset\\\"\\n}'\\n\")), mdx(\"p\", null, \"The response includes the complete ruleset after updating the rule.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{zone-level-phase-ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Ruleset 1\\\",\\n    \\\"description\\\": \\\"\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"3\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id-1}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"execute\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"id\\\": \\\"{cloudflare-managed-ruleset-id}\\\",\\n          \\\"version\\\": \\\"latest\\\",\\n          \\\"matched_data\\\": {\\n            \\\"public_key\\\": \\\"{your-public-key}\\\"\\n          }\\n        },\\n        \\\"expression\\\": \\\"true\\\",\\n        \\\"description\\\": \\\"Executes the Cloudflare Managed Ruleset\\\",\\n        \\\"last_updated\\\": \\\"2021-06-28T18:08:14.003361Z\\\",\\n        \\\"ref\\\": \\\"{ruleset-ref-1}\\\",\\n        \\\"enabled\\\": true\\n      },\\n      // ...\\n    ],\\n    \\\"last_updated\\\": \\\"2021-06-28T18:08:14.003361Z\\\",\\n    \\\"phase\\\": \\\"http_request_firewall_managed\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"p\", null, \"For more information on deploying Managed Rulesets via API, see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset\"\n  }, \"Deploy a Managed Ruleset\"), \" in the Ruleset Engine documentation.\"), mdx(\"hr\", null), mdx(\"h2\", {\n    \"id\": \"disable-payload-logging\"\n  }, \"Disable payload logging\"), mdx(\"p\", null, \"To disable payload logging for a Managed Ruleset:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule\"\n  }, \"Update rule in ruleset\"), \" API method to update the rule that executes the Managed Ruleset.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Modify the rule definition so that there is no \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matched_data\"), \" object in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \".\"))), mdx(\"p\", null, \"The following example rule executes a Managed Ruleset with payload logging disabled:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"action\\\": \\\"execute\\\",\\n  \\\"action_parameters\\\": {\\n    \\\"id\\\": \\\"{managed-ruleset-id}\\\"\\n  },\\n  \\\"expression\\\": \\\"true\\\",\\n  \\\"description\\\": \\\"\\\"\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"Configure payload logging via API","type":null,"updated":null}}},"pageContext":{"id":"26138167-5401-563d-a532-ba1c46487066","fields":{"slug":"/managed-rulesets/payload-logging/configure-api"},"frontmatter":{"pcx_content_type":"how-to","title":"Configure payload logging via API","type":null,"order":3,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Configure payload logging for a Managed Ruleset via API","depth":1}],"tableOfContents":{"items":[{"url":"#configure-payload-logging-for-a-managed-ruleset-via-api","title":"Configure payload logging for a Managed Ruleset via API","items":[{"url":"#configure-and-enable-payload-logging","title":"Configure and enable payload logging","items":[{"url":"#example","title":"Example"}]},{"url":"#disable-payload-logging","title":"Disable payload logging"}]}]},"parent":{"modifiedTime":"2022-01-25","relativePath":"managed-rulesets/payload-logging/configure-api.md"}}}