{"expireTime":9007200897882661000,"key":"gatsby-plugin-mdx-entire-payload-03fc412e80607a1a58ab24f761f62cc1-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Configure payload logging for a Managed Ruleset via API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":58,"offset":58},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":58,"offset":58},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can use the ","position":{"start":{"line":4,"column":1,"offset":60},"end":{"line":4,"column":17,"offset":76},"indent":[]}},{"type":"link","title":null,"url":"https://api.cloudflare.com/","children":[{"type":"text","value":"Rulesets API","position":{"start":{"line":4,"column":18,"offset":77},"end":{"line":4,"column":30,"offset":89},"indent":[]}}],"position":{"start":{"line":4,"column":17,"offset":76},"end":{"line":4,"column":60,"offset":119},"indent":[]}},{"type":"text","value":" to configure payload logging for a Managed Ruleset.","position":{"start":{"line":4,"column":60,"offset":119},"end":{"line":4,"column":112,"offset":171},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":60},"end":{"line":4,"column":112,"offset":171},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Configure and enable payload logging","position":{"start":{"line":6,"column":4,"offset":176},"end":{"line":6,"column":40,"offset":212},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":173},"end":{"line":6,"column":40,"offset":212},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To configure:","position":{"start":{"line":8,"column":1,"offset":214},"end":{"line":8,"column":14,"offset":227},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":214},"end":{"line":8,"column":14,"offset":227},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":10,"column":4,"offset":232},"end":{"line":10,"column":12,"offset":240},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule","children":[{"type":"text","value":"Update rule in ruleset","position":{"start":{"line":10,"column":13,"offset":241},"end":{"line":10,"column":35,"offset":263},"indent":[]}}],"position":{"start":{"line":10,"column":12,"offset":240},"end":{"line":10,"column":111,"offset":339},"indent":[]}},{"type":"text","value":" API method to update the rule that executes the Managed Ruleset.","position":{"start":{"line":10,"column":111,"offset":339},"end":{"line":10,"column":176,"offset":404},"indent":[]}}],"position":{"start":{"line":10,"column":4,"offset":232},"end":{"line":10,"column":176,"offset":404},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":229},"end":{"line":11,"column":1,"offset":405},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"In the configuration of the rule that executes the Managed Ruleset, include a ","position":{"start":{"line":12,"column":4,"offset":409},"end":{"line":12,"column":82,"offset":487},"indent":[]}},{"type":"inlineCode","value":"matched_data","position":{"start":{"line":12,"column":82,"offset":487},"end":{"line":12,"column":96,"offset":501},"indent":[]}},{"type":"text","value":" object in ","position":{"start":{"line":12,"column":96,"offset":501},"end":{"line":12,"column":107,"offset":512},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":12,"column":107,"offset":512},"end":{"line":12,"column":126,"offset":531},"indent":[]}},{"type":"text","value":" to configure payload logging.","position":{"start":{"line":12,"column":126,"offset":531},"end":{"line":12,"column":156,"offset":561},"indent":[]}}],"position":{"start":{"line":12,"column":4,"offset":409},"end":{"line":12,"column":156,"offset":561},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":14,"column":5,"offset":567},"end":{"line":14,"column":9,"offset":571},"indent":[]}},{"type":"inlineCode","value":"matched_data","position":{"start":{"line":14,"column":9,"offset":571},"end":{"line":14,"column":23,"offset":585},"indent":[]}},{"type":"text","value":" object has the following structure:","position":{"start":{"line":14,"column":23,"offset":585},"end":{"line":14,"column":59,"offset":621},"indent":[]}}],"position":{"start":{"line":14,"column":5,"offset":567},"end":{"line":14,"column":59,"offset":621},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nhighlight: [3,4,5]\n---\n\"action_parameters\": {\n  // ...\n  \"matched_data\": {\n    \"public_key\": \"<PUBLIC_KEY_VALUE>\"\n  }\n}","position":{"start":{"line":16,"column":5,"offset":627},"end":{"line":26,"column":8,"offset":802},"indent":[5,5,5,5,5,5,5,5,5,5]}},{"type":"paragraph","children":[{"type":"text","value":"Replace ","position":{"start":{"line":28,"column":5,"offset":808},"end":{"line":28,"column":13,"offset":816},"indent":[]}},{"type":"inlineCode","value":"<PUBLIC_KEY_VALUE>","position":{"start":{"line":28,"column":13,"offset":816},"end":{"line":28,"column":33,"offset":836},"indent":[]}},{"type":"text","value":" with the public key you want to use for payload logging.","position":{"start":{"line":28,"column":33,"offset":836},"end":{"line":28,"column":90,"offset":893},"indent":[]}}],"position":{"start":{"line":28,"column":5,"offset":808},"end":{"line":28,"column":90,"offset":893},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":406},"end":{"line":28,"column":90,"offset":893},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":10,"column":1,"offset":229},"end":{"line":28,"column":90,"offset":893},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"You can generate a public key ","position":{"start":{"line":30,"column":1,"offset":895},"end":{"line":30,"column":31,"offset":925},"indent":[]}},{"type":"link","title":null,"url":"/managed-rulesets/payload-logging/command-line/generate-key-pair","children":[{"type":"text","value":"in the command line","position":{"start":{"line":30,"column":32,"offset":926},"end":{"line":30,"column":51,"offset":945},"indent":[]}}],"position":{"start":{"line":30,"column":31,"offset":925},"end":{"line":30,"column":118,"offset":1012},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":30,"column":118,"offset":1012},"end":{"line":30,"column":122,"offset":1016},"indent":[]}},{"type":"link","title":null,"url":"/managed-rulesets/payload-logging/configure","children":[{"type":"text","value":"in the Cloudflare dashboard","position":{"start":{"line":30,"column":123,"offset":1017},"end":{"line":30,"column":150,"offset":1044},"indent":[]}}],"position":{"start":{"line":30,"column":122,"offset":1016},"end":{"line":30,"column":196,"offset":1090},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":30,"column":196,"offset":1090},"end":{"line":30,"column":197,"offset":1091},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":895},"end":{"line":30,"column":197,"offset":1091},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Example","position":{"start":{"line":32,"column":5,"offset":1097},"end":{"line":32,"column":12,"offset":1104},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1093},"end":{"line":32,"column":12,"offset":1104},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The following example updates rule ","position":{"start":{"line":34,"column":1,"offset":1106},"end":{"line":34,"column":36,"offset":1141},"indent":[]}},{"type":"inlineCode","value":"{rule-id-1}","position":{"start":{"line":34,"column":36,"offset":1141},"end":{"line":34,"column":49,"offset":1154},"indent":[]}},{"type":"text","value":" that executes the Cloudflare Managed Ruleset for zone ","position":{"start":{"line":34,"column":49,"offset":1154},"end":{"line":34,"column":104,"offset":1209},"indent":[]}},{"type":"inlineCode","value":"{zone-id}","position":{"start":{"line":34,"column":104,"offset":1209},"end":{"line":34,"column":115,"offset":1220},"indent":[]}},{"type":"text","value":", configuring payload logging with the provided public key.","position":{"start":{"line":34,"column":115,"offset":1220},"end":{"line":34,"column":174,"offset":1279},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1106},"end":{"line":34,"column":174,"offset":1279},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\nhighlight: [9,10,11]\n---\ncurl -X PATCH \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zone/{zone-id}/rulesets/{ruleset-id}/rules/{rule-id-1}\" \\\n-d '{\n  \"action\": \"execute\",\n  \"action_parameters\": {\n    \"id\": \"{cloudflare-managed-ruleset-id}\",\n    \"matched_data\": {\n      \"public_key\": \"{your-public-key}\"\n    }\n  },\n  \"expression\": \"true\",\n  \"description\": \"Executes the Cloudflare Managed Ruleset\"\n}'","position":{"start":{"line":36,"column":1,"offset":1281},"end":{"line":56,"column":4,"offset":1776},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response includes the complete ruleset after updating the rule.","position":{"start":{"line":58,"column":1,"offset":1778},"end":{"line":58,"column":68,"offset":1845},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":1778},"end":{"line":58,"column":68,"offset":1845},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{zone-level-phase-ruleset-id}\",\n    \"name\": \"Zone-level Ruleset 1\",\n    \"description\": \"\",\n    \"kind\": \"zone\",\n    \"version\": \"3\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id-1}\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"{cloudflare-managed-ruleset-id}\",\n          \"version\": \"latest\",\n          \"matched_data\": {\n            \"public_key\": \"{your-public-key}\"\n          }\n        },\n        \"expression\": \"true\",\n        \"description\": \"Executes the Cloudflare Managed Ruleset\",\n        \"last_updated\": \"2021-06-28T18:08:14.003361Z\",\n        \"ref\": \"{ruleset-ref-1}\",\n        \"enabled\": true\n      },\n      // ...\n    ],\n    \"last_updated\": \"2021-06-28T18:08:14.003361Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":60,"column":1,"offset":1847},"end":{"line":98,"column":4,"offset":2749},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For more information on deploying Managed Rulesets via API, see ","position":{"start":{"line":100,"column":1,"offset":2751},"end":{"line":100,"column":65,"offset":2815},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset","children":[{"type":"text","value":"Deploy a Managed Ruleset","position":{"start":{"line":100,"column":66,"offset":2816},"end":{"line":100,"column":90,"offset":2840},"indent":[]}}],"position":{"start":{"line":100,"column":65,"offset":2815},"end":{"line":100,"column":181,"offset":2931},"indent":[]}},{"type":"text","value":" in the Ruleset Engine documentation.","position":{"start":{"line":100,"column":181,"offset":2931},"end":{"line":100,"column":218,"offset":2968},"indent":[]}}],"position":{"start":{"line":100,"column":1,"offset":2751},"end":{"line":100,"column":218,"offset":2968},"indent":[]}},{"type":"thematicBreak","position":{"start":{"line":102,"column":1,"offset":2970},"end":{"line":102,"column":4,"offset":2973},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Disable payload logging","position":{"start":{"line":104,"column":4,"offset":2978},"end":{"line":104,"column":27,"offset":3001},"indent":[]}}],"position":{"start":{"line":104,"column":1,"offset":2975},"end":{"line":104,"column":27,"offset":3001},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To disable payload logging for a Managed Ruleset:","position":{"start":{"line":106,"column":1,"offset":3003},"end":{"line":106,"column":50,"offset":3052},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":3003},"end":{"line":106,"column":50,"offset":3052},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":108,"column":4,"offset":3057},"end":{"line":108,"column":12,"offset":3065},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule","children":[{"type":"text","value":"Update rule in ruleset","position":{"start":{"line":108,"column":13,"offset":3066},"end":{"line":108,"column":35,"offset":3088},"indent":[]}}],"position":{"start":{"line":108,"column":12,"offset":3065},"end":{"line":108,"column":111,"offset":3164},"indent":[]}},{"type":"text","value":" API method to update the rule that executes the Managed Ruleset.","position":{"start":{"line":108,"column":111,"offset":3164},"end":{"line":108,"column":176,"offset":3229},"indent":[]}}],"position":{"start":{"line":108,"column":4,"offset":3057},"end":{"line":108,"column":176,"offset":3229},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3054},"end":{"line":109,"column":1,"offset":3230},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Modify the rule definition so that there is no ","position":{"start":{"line":110,"column":4,"offset":3234},"end":{"line":110,"column":51,"offset":3281},"indent":[]}},{"type":"inlineCode","value":"matched_data","position":{"start":{"line":110,"column":51,"offset":3281},"end":{"line":110,"column":65,"offset":3295},"indent":[]}},{"type":"text","value":" object in ","position":{"start":{"line":110,"column":65,"offset":3295},"end":{"line":110,"column":76,"offset":3306},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":110,"column":76,"offset":3306},"end":{"line":110,"column":95,"offset":3325},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":110,"column":95,"offset":3325},"end":{"line":110,"column":96,"offset":3326},"indent":[]}}],"position":{"start":{"line":110,"column":4,"offset":3234},"end":{"line":110,"column":96,"offset":3326},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":3231},"end":{"line":110,"column":96,"offset":3326},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3054},"end":{"line":110,"column":96,"offset":3326},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example rule executes a Managed Ruleset with payload logging disabled:","position":{"start":{"line":112,"column":1,"offset":3328},"end":{"line":112,"column":85,"offset":3412},"indent":[]}}],"position":{"start":{"line":112,"column":1,"offset":3328},"end":{"line":112,"column":85,"offset":3412},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"action\": \"execute\",\n  \"action_parameters\": {\n    \"id\": \"{managed-ruleset-id}\"\n  },\n  \"expression\": \"true\",\n  \"description\": \"\"\n}","position":{"start":{"line":114,"column":1,"offset":3414},"end":{"line":123,"column":4,"offset":3559},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Configure payload logging via API\",\"pcx-content-type\":\"how-to\",\"order\":3}","position":{"start":{"line":126,"column":1,"offset":3562},"end":{"line":126,"column":112,"offset":3673},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":126,"column":112,"offset":3673}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Configure payload logging via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"order\": 3\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"configure-payload-logging-for-a-managed-ruleset-via-api\"\n  }, \"Configure payload logging for a Managed Ruleset via API\"), mdx(\"p\", null, \"You can use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/\"\n  }, \"Rulesets API\"), \" to configure payload logging for a Managed Ruleset.\"), mdx(\"h2\", {\n    \"id\": \"configure-and-enable-payload-logging\"\n  }, \"Configure and enable payload logging\"), mdx(\"p\", null, \"To configure:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule\"\n  }, \"Update rule in ruleset\"), \" API method to update the rule that executes the Managed Ruleset.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"In the configuration of the rule that executes the Managed Ruleset, include a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matched_data\"), \" object in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \" to configure payload logging.\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matched_data\"), \" object has the following structure:\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nhighlight: [3,4,5]\\n---\\n\\\"action_parameters\\\": {\\n  // ...\\n  \\\"matched_data\\\": {\\n    \\\"public_key\\\": \\\"<PUBLIC_KEY_VALUE>\\\"\\n  }\\n}\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<PUBLIC_KEY_VALUE>\"), \" with the public key you want to use for payload logging.\"))), mdx(\"p\", null, \"You can generate a public key \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/managed-rulesets/payload-logging/command-line/generate-key-pair\"\n  }, \"in the command line\"), \" or \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/managed-rulesets/payload-logging/configure\"\n  }, \"in the Cloudflare dashboard\"), \".\"), mdx(\"h3\", {\n    \"id\": \"example\"\n  }, \"Example\"), mdx(\"p\", null, \"The following example updates rule \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{rule-id-1}\"), \" that executes the Cloudflare Managed Ruleset for zone \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{zone-id}\"), \", configuring payload logging with the provided public key.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\nhighlight: [9,10,11]\\n---\\ncurl -X PATCH \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zone/{zone-id}/rulesets/{ruleset-id}/rules/{rule-id-1}\\\" \\\\\\n-d '{\\n  \\\"action\\\": \\\"execute\\\",\\n  \\\"action_parameters\\\": {\\n    \\\"id\\\": \\\"{cloudflare-managed-ruleset-id}\\\",\\n    \\\"matched_data\\\": {\\n      \\\"public_key\\\": \\\"{your-public-key}\\\"\\n    }\\n  },\\n  \\\"expression\\\": \\\"true\\\",\\n  \\\"description\\\": \\\"Executes the Cloudflare Managed Ruleset\\\"\\n}'\\n\")), mdx(\"p\", null, \"The response includes the complete ruleset after updating the rule.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{zone-level-phase-ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Ruleset 1\\\",\\n    \\\"description\\\": \\\"\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"3\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id-1}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"execute\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"id\\\": \\\"{cloudflare-managed-ruleset-id}\\\",\\n          \\\"version\\\": \\\"latest\\\",\\n          \\\"matched_data\\\": {\\n            \\\"public_key\\\": \\\"{your-public-key}\\\"\\n          }\\n        },\\n        \\\"expression\\\": \\\"true\\\",\\n        \\\"description\\\": \\\"Executes the Cloudflare Managed Ruleset\\\",\\n        \\\"last_updated\\\": \\\"2021-06-28T18:08:14.003361Z\\\",\\n        \\\"ref\\\": \\\"{ruleset-ref-1}\\\",\\n        \\\"enabled\\\": true\\n      },\\n      // ...\\n    ],\\n    \\\"last_updated\\\": \\\"2021-06-28T18:08:14.003361Z\\\",\\n    \\\"phase\\\": \\\"http_request_firewall_managed\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"p\", null, \"For more information on deploying Managed Rulesets via API, see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset\"\n  }, \"Deploy a Managed Ruleset\"), \" in the Ruleset Engine documentation.\"), mdx(\"hr\", null), mdx(\"h2\", {\n    \"id\": \"disable-payload-logging\"\n  }, \"Disable payload logging\"), mdx(\"p\", null, \"To disable payload logging for a Managed Ruleset:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule\"\n  }, \"Update rule in ruleset\"), \" API method to update the rule that executes the Managed Ruleset.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Modify the rule definition so that there is no \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matched_data\"), \" object in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \".\"))), mdx(\"p\", null, \"The following example rule executes a Managed Ruleset with payload logging disabled:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"action\\\": \\\"execute\\\",\\n  \\\"action_parameters\\\": {\\n    \\\"id\\\": \\\"{managed-ruleset-id}\\\"\\n  },\\n  \\\"expression\\\": \\\"true\\\",\\n  \\\"description\\\": \\\"\\\"\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Configure payload logging via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"order\": 3\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"configure-payload-logging-for-a-managed-ruleset-via-api\"\n    }}>{`Configure payload logging for a Managed Ruleset via API`}</h1>\n    <p>{`You can use the `}<a parentName=\"p\" {...{\n        \"href\": \"https://api.cloudflare.com/\"\n      }}>{`Rulesets API`}</a>{` to configure payload logging for a Managed Ruleset.`}</p>\n    <h2 {...{\n      \"id\": \"configure-and-enable-payload-logging\"\n    }}>{`Configure and enable payload logging`}</h2>\n    <p>{`To configure:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule\"\n          }}>{`Update rule in ruleset`}</a>{` API method to update the rule that executes the Managed Ruleset.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`In the configuration of the rule that executes the Managed Ruleset, include a `}<inlineCode parentName=\"p\">{`matched_data`}</inlineCode>{` object in `}<inlineCode parentName=\"p\">{`action_parameters`}</inlineCode>{` to configure payload logging.`}</p>\n        <p parentName=\"li\">{`The `}<inlineCode parentName=\"p\">{`matched_data`}</inlineCode>{` object has the following structure:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nhighlight: [3,4,5]\n---\n\"action_parameters\": {\n  // ...\n  \"matched_data\": {\n    \"public_key\": \"<PUBLIC_KEY_VALUE>\"\n  }\n}\n`}</code></pre>\n        <p parentName=\"li\">{`Replace `}<inlineCode parentName=\"p\">{`<PUBLIC_KEY_VALUE>`}</inlineCode>{` with the public key you want to use for payload logging.`}</p>\n      </li>\n    </ol>\n    <p>{`You can generate a public key `}<a parentName=\"p\" {...{\n        \"href\": \"/managed-rulesets/payload-logging/command-line/generate-key-pair\"\n      }}>{`in the command line`}</a>{` or `}<a parentName=\"p\" {...{\n        \"href\": \"/managed-rulesets/payload-logging/configure\"\n      }}>{`in the Cloudflare dashboard`}</a>{`.`}</p>\n    <h3 {...{\n      \"id\": \"example\"\n    }}>{`Example`}</h3>\n    <p>{`The following example updates rule `}<inlineCode parentName=\"p\">{`{rule-id-1}`}</inlineCode>{` that executes the Cloudflare Managed Ruleset for zone `}<inlineCode parentName=\"p\">{`{zone-id}`}</inlineCode>{`, configuring payload logging with the provided public key.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`---\nheader: Request\nhighlight: [9,10,11]\n---\ncurl -X PATCH \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zone/{zone-id}/rulesets/{ruleset-id}/rules/{rule-id-1}\" \\\\\n-d '{\n  \"action\": \"execute\",\n  \"action_parameters\": {\n    \"id\": \"{cloudflare-managed-ruleset-id}\",\n    \"matched_data\": {\n      \"public_key\": \"{your-public-key}\"\n    }\n  },\n  \"expression\": \"true\",\n  \"description\": \"Executes the Cloudflare Managed Ruleset\"\n}'\n`}</code></pre>\n    <p>{`The response includes the complete ruleset after updating the rule.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{zone-level-phase-ruleset-id}\",\n    \"name\": \"Zone-level Ruleset 1\",\n    \"description\": \"\",\n    \"kind\": \"zone\",\n    \"version\": \"3\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id-1}\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"{cloudflare-managed-ruleset-id}\",\n          \"version\": \"latest\",\n          \"matched_data\": {\n            \"public_key\": \"{your-public-key}\"\n          }\n        },\n        \"expression\": \"true\",\n        \"description\": \"Executes the Cloudflare Managed Ruleset\",\n        \"last_updated\": \"2021-06-28T18:08:14.003361Z\",\n        \"ref\": \"{ruleset-ref-1}\",\n        \"enabled\": true\n      },\n      // ...\n    ],\n    \"last_updated\": \"2021-06-28T18:08:14.003361Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n    <p>{`For more information on deploying Managed Rulesets via API, see `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset\"\n      }}>{`Deploy a Managed Ruleset`}</a>{` in the Ruleset Engine documentation.`}</p>\n    <hr></hr>\n    <h2 {...{\n      \"id\": \"disable-payload-logging\"\n    }}>{`Disable payload logging`}</h2>\n    <p>{`To disable payload logging for a Managed Ruleset:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule\"\n          }}>{`Update rule in ruleset`}</a>{` API method to update the rule that executes the Managed Ruleset.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Modify the rule definition so that there is no `}<inlineCode parentName=\"p\">{`matched_data`}</inlineCode>{` object in `}<inlineCode parentName=\"p\">{`action_parameters`}</inlineCode>{`.`}</p>\n      </li>\n    </ol>\n    <p>{`The following example rule executes a Managed Ruleset with payload logging disabled:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"action\": \"execute\",\n  \"action_parameters\": {\n    \"id\": \"{managed-ruleset-id}\"\n  },\n  \"expression\": \"true\",\n  \"description\": \"\"\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}