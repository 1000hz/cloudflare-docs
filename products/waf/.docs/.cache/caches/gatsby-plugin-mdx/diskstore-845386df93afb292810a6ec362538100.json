{"expireTime":9007200897882662000,"key":"gatsby-plugin-mdx-entire-payload-c6851a7d1b115c2627015c2ec170495d-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Configure exposed credentials checks via API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":47,"offset":47},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":47,"offset":47},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Configure exposed credentials checks using the ","position":{"start":{"line":4,"column":1,"offset":49},"end":{"line":4,"column":48,"offset":96},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api","children":[{"type":"text","value":"Rulesets API","position":{"start":{"line":4,"column":49,"offset":97},"end":{"line":4,"column":61,"offset":109},"indent":[]}}],"position":{"start":{"line":4,"column":48,"offset":96},"end":{"line":4,"column":125,"offset":173},"indent":[]}},{"type":"text","value":". You can deploy the Exposed Credentials Check Managed Ruleset and create custom rules that check for exposed credentials.","position":{"start":{"line":4,"column":125,"offset":173},"end":{"line":4,"column":247,"offset":295},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":49},"end":{"line":4,"column":247,"offset":295},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Deploy the Exposed Credentials Check Managed Ruleset","position":{"start":{"line":6,"column":4,"offset":300},"end":{"line":6,"column":56,"offset":352},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":297},"end":{"line":6,"column":56,"offset":352},"indent":[]}},{"type":"jsx","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":8,"column":1,"offset":354},"end":{"line":8,"column":42,"offset":395},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You must deploy the Managed Ruleset to the ","position":{"start":{"line":10,"column":1,"offset":397},"end":{"line":10,"column":44,"offset":440},"indent":[]}},{"type":"inlineCode","value":"http_request_firewall_managed","position":{"start":{"line":10,"column":44,"offset":440},"end":{"line":10,"column":75,"offset":471},"indent":[]}},{"type":"text","value":" phase.","position":{"start":{"line":10,"column":75,"offset":471},"end":{"line":10,"column":82,"offset":478},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":397},"end":{"line":10,"column":82,"offset":478},"indent":[]}},{"type":"jsx","value":"</Aside>","position":{"start":{"line":12,"column":1,"offset":480},"end":{"line":12,"column":9,"offset":488},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To deploy the Managed Ruleset for a given zone, do the following:","position":{"start":{"line":14,"column":1,"offset":490},"end":{"line":14,"column":66,"offset":555},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":490},"end":{"line":14,"column":66,"offset":555},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Obtain the zone ID of the zone where you want to deploy the Managed Ruleset.","position":{"start":{"line":16,"column":4,"offset":560},"end":{"line":16,"column":80,"offset":636},"indent":[]}}],"position":{"start":{"line":16,"column":4,"offset":560},"end":{"line":16,"column":80,"offset":636},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":557},"end":{"line":16,"column":80,"offset":636},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":17,"column":4,"offset":640},"end":{"line":17,"column":12,"offset":648},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets","children":[{"type":"text","value":"List existing rulesets","position":{"start":{"line":17,"column":13,"offset":649},"end":{"line":17,"column":35,"offset":671},"indent":[]}}],"position":{"start":{"line":17,"column":12,"offset":648},"end":{"line":17,"column":127,"offset":763},"indent":[]}},{"type":"text","value":" method to obtain the following ruleset IDs:","position":{"start":{"line":17,"column":127,"offset":763},"end":{"line":17,"column":171,"offset":807},"indent":[]}}],"position":{"start":{"line":17,"column":4,"offset":640},"end":{"line":17,"column":171,"offset":807},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ruleset ID of the ruleset for the ","position":{"start":{"line":18,"column":7,"offset":814},"end":{"line":18,"column":45,"offset":852},"indent":[]}},{"type":"inlineCode","value":"http_request_firewall_managed","position":{"start":{"line":18,"column":45,"offset":852},"end":{"line":18,"column":76,"offset":883},"indent":[]}},{"type":"text","value":" phase at the zone level","position":{"start":{"line":18,"column":76,"offset":883},"end":{"line":18,"column":100,"offset":907},"indent":[]}}],"position":{"start":{"line":18,"column":7,"offset":814},"end":{"line":18,"column":100,"offset":907},"indent":[]}}],"position":{"start":{"line":18,"column":5,"offset":812},"end":{"line":18,"column":100,"offset":907},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ruleset ID of the Exposed Credentials Check Managed Ruleset","position":{"start":{"line":19,"column":7,"offset":914},"end":{"line":19,"column":70,"offset":977},"indent":[]}}],"position":{"start":{"line":19,"column":7,"offset":914},"end":{"line":19,"column":70,"offset":977},"indent":[]}}],"position":{"start":{"line":19,"column":5,"offset":912},"end":{"line":19,"column":70,"offset":977},"indent":[]}}],"position":{"start":{"line":18,"column":5,"offset":812},"end":{"line":19,"column":70,"offset":977},"indent":[5]}}],"position":{"start":{"line":17,"column":1,"offset":637},"end":{"line":19,"column":70,"offset":977},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If the ","position":{"start":{"line":20,"column":4,"offset":981},"end":{"line":20,"column":11,"offset":988},"indent":[]}},{"type":"inlineCode","value":"http_request_firewall_managed","position":{"start":{"line":20,"column":11,"offset":988},"end":{"line":20,"column":42,"offset":1019},"indent":[]}},{"type":"text","value":" phase ruleset does not exist, create it using the Create ruleset method.","position":{"start":{"line":20,"column":42,"offset":1019},"end":{"line":20,"column":115,"offset":1092},"indent":[]}}],"position":{"start":{"line":20,"column":4,"offset":981},"end":{"line":20,"column":115,"offset":1092},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":978},"end":{"line":20,"column":115,"offset":1092},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":21,"column":4,"offset":1096},"end":{"line":21,"column":12,"offset":1104},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#view-a-specific-ruleset","children":[{"type":"text","value":"View ruleset","position":{"start":{"line":21,"column":13,"offset":1105},"end":{"line":21,"column":25,"offset":1117},"indent":[]}}],"position":{"start":{"line":21,"column":12,"offset":1104},"end":{"line":21,"column":118,"offset":1210},"indent":[]}},{"type":"text","value":" method to get the rules already associated with the phase ruleset where you want to deploy the Managed Ruleset.","position":{"start":{"line":21,"column":118,"offset":1210},"end":{"line":21,"column":230,"offset":1322},"indent":[]}}],"position":{"start":{"line":21,"column":4,"offset":1096},"end":{"line":21,"column":230,"offset":1322},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":1093},"end":{"line":21,"column":230,"offset":1322},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":22,"column":4,"offset":1326},"end":{"line":22,"column":12,"offset":1334},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":22,"column":13,"offset":1335},"end":{"line":22,"column":27,"offset":1349},"indent":[]}}],"position":{"start":{"line":22,"column":12,"offset":1334},"end":{"line":22,"column":98,"offset":1420},"indent":[]}},{"type":"text","value":" method to add a rule to the phase ruleset deploying the Exposed Credentials Check Managed Ruleset. Make sure you include the existing rules in the phase ruleset in your ","position":{"start":{"line":22,"column":98,"offset":1420},"end":{"line":22,"column":268,"offset":1590},"indent":[]}},{"type":"inlineCode","value":"PUT","position":{"start":{"line":22,"column":268,"offset":1590},"end":{"line":22,"column":273,"offset":1595},"indent":[]}},{"type":"text","value":" request.","position":{"start":{"line":22,"column":273,"offset":1595},"end":{"line":22,"column":282,"offset":1604},"indent":[]}}],"position":{"start":{"line":22,"column":4,"offset":1326},"end":{"line":22,"column":282,"offset":1604},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1323},"end":{"line":22,"column":282,"offset":1604},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":557},"end":{"line":22,"column":282,"offset":1604},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For more information on deploying a Managed Ruleset, check ","position":{"start":{"line":24,"column":1,"offset":1606},"end":{"line":24,"column":60,"offset":1665},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset","children":[{"type":"text","value":"Deploy a Managed Ruleset","position":{"start":{"line":24,"column":61,"offset":1666},"end":{"line":24,"column":85,"offset":1690},"indent":[]}}],"position":{"start":{"line":24,"column":60,"offset":1665},"end":{"line":24,"column":176,"offset":1781},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":24,"column":176,"offset":1781},"end":{"line":24,"column":177,"offset":1782},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1606},"end":{"line":24,"column":177,"offset":1782},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Configure an override for the Exposed Credentials Check Managed Ruleset","position":{"start":{"line":26,"column":5,"offset":1788},"end":{"line":26,"column":76,"offset":1859},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1784},"end":{"line":26,"column":76,"offset":1859},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"An override allows you to define an action or status different from the default values as configured by Cloudflare. You can define overrides at the ruleset, tag, and rule level for all Managed Rulesets, including the Exposed Credentials Check Managed Ruleset.","position":{"start":{"line":28,"column":1,"offset":1861},"end":{"line":28,"column":260,"offset":2120},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1861},"end":{"line":28,"column":260,"offset":2120},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For more information on defining overrides for Managed Rulesets using the Rulesets API, check ","position":{"start":{"line":30,"column":1,"offset":2122},"end":{"line":30,"column":95,"offset":2216},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset","children":[{"type":"text","value":"Override a Managed Ruleset","position":{"start":{"line":30,"column":96,"offset":2217},"end":{"line":30,"column":122,"offset":2243},"indent":[]}}],"position":{"start":{"line":30,"column":95,"offset":2216},"end":{"line":30,"column":215,"offset":2336},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":30,"column":215,"offset":2336},"end":{"line":30,"column":216,"offset":2337},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":2122},"end":{"line":30,"column":216,"offset":2337},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Create a custom rule checking for exposed credentials","position":{"start":{"line":32,"column":4,"offset":2342},"end":{"line":32,"column":57,"offset":2395},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2339},"end":{"line":32,"column":57,"offset":2395},"indent":[]}},{"type":"jsx","value":"<Aside type=\"note\">","position":{"start":{"line":34,"column":1,"offset":2397},"end":{"line":34,"column":20,"offset":2416},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This feature is only available to customers on an Enterprise plan.","position":{"start":{"line":36,"column":1,"offset":2418},"end":{"line":36,"column":67,"offset":2484},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":2418},"end":{"line":36,"column":67,"offset":2484},"indent":[]}},{"type":"jsx","value":"</Aside>","position":{"start":{"line":38,"column":1,"offset":2486},"end":{"line":38,"column":9,"offset":2494},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can create rules that check for exposed credentials using the ","position":{"start":{"line":40,"column":1,"offset":2496},"end":{"line":40,"column":67,"offset":2562},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api","children":[{"type":"text","value":"Rulesets API","position":{"start":{"line":40,"column":68,"offset":2563},"end":{"line":40,"column":80,"offset":2575},"indent":[]}}],"position":{"start":{"line":40,"column":67,"offset":2562},"end":{"line":40,"column":144,"offset":2639},"indent":[]}},{"type":"text","value":". Include these rules in a custom ruleset, which you must create at the account level, and then deploy the custom ruleset to a phase.","position":{"start":{"line":40,"column":144,"offset":2639},"end":{"line":40,"column":277,"offset":2772},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2496},"end":{"line":40,"column":277,"offset":2772},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A rule with exposed credentials check has a match when both the rule expression and the result from the exposed credentials check are true.","position":{"start":{"line":42,"column":1,"offset":2774},"end":{"line":42,"column":140,"offset":2913},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":2774},"end":{"line":42,"column":140,"offset":2913},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To check for exposed credentials in a custom rule, include the field ","position":{"start":{"line":44,"column":1,"offset":2915},"end":{"line":44,"column":70,"offset":2984},"indent":[]}},{"type":"inlineCode","value":"exposed_credential_check","position":{"start":{"line":44,"column":70,"offset":2984},"end":{"line":44,"column":96,"offset":3010},"indent":[]}},{"type":"text","value":" in the rule definition. This field requires the following options:","position":{"start":{"line":44,"column":96,"offset":3010},"end":{"line":44,"column":163,"offset":3077},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":2915},"end":{"line":44,"column":163,"offset":3077},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"username_expression","position":{"start":{"line":46,"column":3,"offset":3081},"end":{"line":46,"column":24,"offset":3102},"indent":[]}},{"type":"text","value":" — Expression that selects the user ID used in the credentials check. This field can have up to 1024 characters.","position":{"start":{"line":46,"column":24,"offset":3102},"end":{"line":46,"column":136,"offset":3214},"indent":[]}}],"position":{"start":{"line":46,"column":3,"offset":3081},"end":{"line":46,"column":136,"offset":3214},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":3079},"end":{"line":46,"column":136,"offset":3214},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"password_expression","position":{"start":{"line":47,"column":3,"offset":3217},"end":{"line":47,"column":24,"offset":3238},"indent":[]}},{"type":"text","value":" — Expression that selects the password used in the credentials check. This field can have up to 1024 characters.","position":{"start":{"line":47,"column":24,"offset":3238},"end":{"line":47,"column":137,"offset":3351},"indent":[]}}],"position":{"start":{"line":47,"column":3,"offset":3217},"end":{"line":47,"column":137,"offset":3351},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":3215},"end":{"line":47,"column":137,"offset":3351},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":3079},"end":{"line":47,"column":137,"offset":3351},"indent":[1]}},{"type":"jsx","value":"<Aside type='warning' header='Important'>","position":{"start":{"line":49,"column":1,"offset":3353},"end":{"line":49,"column":42,"offset":3394},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"These options have additional requirements:","position":{"start":{"line":51,"column":1,"offset":3396},"end":{"line":51,"column":44,"offset":3439},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":3396},"end":{"line":51,"column":44,"offset":3439},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Each expression must evaluate to a string.","position":{"start":{"line":53,"column":3,"offset":3443},"end":{"line":53,"column":45,"offset":3485},"indent":[]}}],"position":{"start":{"line":53,"column":3,"offset":3443},"end":{"line":53,"column":45,"offset":3485},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":3441},"end":{"line":53,"column":45,"offset":3485},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can only use the ","position":{"start":{"line":54,"column":3,"offset":3488},"end":{"line":54,"column":24,"offset":3509},"indent":[]}},{"type":"inlineCode","value":"upper()","position":{"start":{"line":54,"column":24,"offset":3509},"end":{"line":54,"column":33,"offset":3518},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":54,"column":33,"offset":3518},"end":{"line":54,"column":35,"offset":3520},"indent":[]}},{"type":"inlineCode","value":"lower()","position":{"start":{"line":54,"column":35,"offset":3520},"end":{"line":54,"column":44,"offset":3529},"indent":[]}},{"type":"text","value":", and ","position":{"start":{"line":54,"column":44,"offset":3529},"end":{"line":54,"column":50,"offset":3535},"indent":[]}},{"type":"inlineCode","value":"url_decode()","position":{"start":{"line":54,"column":50,"offset":3535},"end":{"line":54,"column":64,"offset":3549},"indent":[]}},{"type":"text","value":" functions, and you cannot nest these functions.","position":{"start":{"line":54,"column":64,"offset":3549},"end":{"line":54,"column":112,"offset":3597},"indent":[]}}],"position":{"start":{"line":54,"column":3,"offset":3488},"end":{"line":54,"column":112,"offset":3597},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":3486},"end":{"line":54,"column":112,"offset":3597},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":3441},"end":{"line":54,"column":112,"offset":3597},"indent":[1]}},{"type":"jsx","value":"</Aside>","position":{"start":{"line":56,"column":1,"offset":3599},"end":{"line":56,"column":9,"offset":3607},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can use the ","position":{"start":{"line":58,"column":1,"offset":3609},"end":{"line":58,"column":17,"offset":3625},"indent":[]}},{"type":"inlineCode","value":"exposed_credential_check","position":{"start":{"line":58,"column":17,"offset":3625},"end":{"line":58,"column":43,"offset":3651},"indent":[]}},{"type":"text","value":" field in rules with one of the following actions: ","position":{"start":{"line":58,"column":43,"offset":3651},"end":{"line":58,"column":94,"offset":3702},"indent":[]}},{"type":"inlineCode","value":"rewrite","position":{"start":{"line":58,"column":94,"offset":3702},"end":{"line":58,"column":103,"offset":3711},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":58,"column":103,"offset":3711},"end":{"line":58,"column":105,"offset":3713},"indent":[]}},{"type":"inlineCode","value":"log","position":{"start":{"line":58,"column":105,"offset":3713},"end":{"line":58,"column":110,"offset":3718},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":58,"column":110,"offset":3718},"end":{"line":58,"column":112,"offset":3720},"indent":[]}},{"type":"inlineCode","value":"block","position":{"start":{"line":58,"column":112,"offset":3720},"end":{"line":58,"column":119,"offset":3727},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":58,"column":119,"offset":3727},"end":{"line":58,"column":121,"offset":3729},"indent":[]}},{"type":"inlineCode","value":"challenge","position":{"start":{"line":58,"column":121,"offset":3729},"end":{"line":58,"column":132,"offset":3740},"indent":[]}},{"type":"text","value":", or ","position":{"start":{"line":58,"column":132,"offset":3740},"end":{"line":58,"column":137,"offset":3745},"indent":[]}},{"type":"inlineCode","value":"js_challenge","position":{"start":{"line":58,"column":137,"offset":3745},"end":{"line":58,"column":151,"offset":3759},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":58,"column":151,"offset":3759},"end":{"line":58,"column":152,"offset":3760},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":3609},"end":{"line":58,"column":152,"offset":3760},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To create and deploy a custom ruleset, follow the workflow described in ","position":{"start":{"line":60,"column":1,"offset":3762},"end":{"line":60,"column":73,"offset":3834},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/custom-rulesets","children":[{"type":"text","value":"Work with custom rulesets","position":{"start":{"line":60,"column":74,"offset":3835},"end":{"line":60,"column":99,"offset":3860},"indent":[]}}],"position":{"start":{"line":60,"column":73,"offset":3834},"end":{"line":60,"column":166,"offset":3927},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":60,"column":166,"offset":3927},"end":{"line":60,"column":167,"offset":3928},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":3762},"end":{"line":60,"column":167,"offset":3928},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Example","position":{"start":{"line":62,"column":5,"offset":3934},"end":{"line":62,"column":12,"offset":3941},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":3930},"end":{"line":62,"column":12,"offset":3941},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The following ","position":{"start":{"line":64,"column":1,"offset":3943},"end":{"line":64,"column":15,"offset":3957},"indent":[]}},{"type":"inlineCode","value":"POST","position":{"start":{"line":64,"column":15,"offset":3957},"end":{"line":64,"column":21,"offset":3963},"indent":[]}},{"type":"text","value":" example creates a new custom ruleset with a rule that checks for exposed credentials. The rule has a match if both the rule expression and the ","position":{"start":{"line":64,"column":21,"offset":3963},"end":{"line":64,"column":165,"offset":4107},"indent":[]}},{"type":"inlineCode","value":"exposed_credential_check","position":{"start":{"line":64,"column":165,"offset":4107},"end":{"line":64,"column":191,"offset":4133},"indent":[]}},{"type":"text","value":" result are ","position":{"start":{"line":64,"column":191,"offset":4133},"end":{"line":64,"column":203,"offset":4145},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":64,"column":203,"offset":4145},"end":{"line":64,"column":209,"offset":4151},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":64,"column":209,"offset":4151},"end":{"line":64,"column":210,"offset":4152},"indent":[]}}],"position":{"start":{"line":64,"column":1,"offset":3943},"end":{"line":64,"column":210,"offset":4152},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"curl -X POST \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/accounts/{account-id}/rulesets\" \\\n-d '{\n  \"name\": \"Custom Ruleset 1\",\n  \"kind\": \"custom\",\n  \"description\": \"This ruleset includes a rule checking for exposed credentials.\",\n  \"rules\": [\n    {\n      \"action\": \"log\",\n      \"expression\": \"http.request.method == \\\"POST\\\" && http.request.uri == \\\"/login.php\\\"\",\n      \"exposed_credential_check\": {\n        \"username_expression\": \"url_decode(http.request.body.form[\\\"username\\\"][0])\",\n        \"password_expression\": \"url_decode(http.request.body.form[\\\"password\\\"][0])\"\n      }\n    }\n  ],\n  \"phase\": \"http_request_firewall_custom\"\n}'","position":{"start":{"line":66,"column":1,"offset":4154},"end":{"line":87,"column":4,"offset":4866},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response returns the created ruleset. Note the presence of the ","position":{"start":{"line":89,"column":1,"offset":4868},"end":{"line":89,"column":68,"offset":4935},"indent":[]}},{"type":"inlineCode","value":"exposed_credential_check","position":{"start":{"line":89,"column":68,"offset":4935},"end":{"line":89,"column":94,"offset":4961},"indent":[]}},{"type":"text","value":" field on the rule definition.","position":{"start":{"line":89,"column":94,"offset":4961},"end":{"line":89,"column":124,"offset":4991},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":4868},"end":{"line":89,"column":124,"offset":4991},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"{\n  \"result\": {\n    \"id\": \"{custom-ruleset-id}\",\n    \"name\": \"Custom Ruleset 1\",\n    \"description\": \"This ruleset includes a rule checking for exposed credentials.\",\n    \"kind\": \"custom\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"id\": \"{custom-rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"log\",\n        \"expression\": \"http.request.method == \\\"POST\\\" && http.request.uri == \\\"/login.php\\\"\",\n        \"exposed_credential_check\": {\n          \"username_expression\": \"url_decode(http.request.body.form[\\\"username\\\"][0])\",\n          \"password_expression\": \"url_decode(http.request.body.form[\\\"password\\\"][0])\"\n        },\n        \"last_updated\": \"2021-03-19T10:48:04.057775Z\",\n        \"ref\": \"{custom-rule-ref}\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-03-19T10:48:04.057775Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":91,"column":1,"offset":4993},"end":{"line":121,"column":4,"offset":5921},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The example above uses the ","position":{"start":{"line":123,"column":1,"offset":5923},"end":{"line":123,"column":28,"offset":5950},"indent":[]}},{"type":"inlineCode","value":"url_decode()","position":{"start":{"line":123,"column":28,"offset":5950},"end":{"line":123,"column":42,"offset":5964},"indent":[]}},{"type":"text","value":" function because fields in the request body (available in ","position":{"start":{"line":123,"column":42,"offset":5964},"end":{"line":123,"column":101,"offset":6023},"indent":[]}},{"type":"inlineCode","value":"http.request.body.form","position":{"start":{"line":123,"column":101,"offset":6023},"end":{"line":123,"column":125,"offset":6047},"indent":[]}},{"type":"text","value":") are URL-encoded when the content type is ","position":{"start":{"line":123,"column":125,"offset":6047},"end":{"line":123,"column":168,"offset":6090},"indent":[]}},{"type":"inlineCode","value":"application/x-www-form-urlencoded","position":{"start":{"line":123,"column":168,"offset":6090},"end":{"line":123,"column":203,"offset":6125},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":123,"column":203,"offset":6125},"end":{"line":123,"column":204,"offset":6126},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":5923},"end":{"line":123,"column":204,"offset":6126},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"After creating a custom ruleset, deploy it to a phase so that it can execute. Refer to ","position":{"start":{"line":125,"column":1,"offset":6128},"end":{"line":125,"column":88,"offset":6215},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/custom-rulesets/deploy-custom-ruleset","children":[{"type":"text","value":"Deploy a custom ruleset","position":{"start":{"line":125,"column":89,"offset":6216},"end":{"line":125,"column":112,"offset":6239},"indent":[]}}],"position":{"start":{"line":125,"column":88,"offset":6215},"end":{"line":125,"column":201,"offset":6328},"indent":[]}},{"type":"text","value":" for more information.","position":{"start":{"line":125,"column":201,"offset":6328},"end":{"line":125,"column":223,"offset":6350},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":6128},"end":{"line":125,"column":223,"offset":6350},"indent":[]}},{"type":"export","value":"export const _frontmatter = {\"pcx-content-type\":\"interim\",\"order\":3}","position":{"start":{"line":128,"column":1,"offset":6353},"end":{"line":128,"column":69,"offset":6421},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":128,"column":69,"offset":6421}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"interim\",\n  \"order\": 3\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"configure-exposed-credentials-checks-via-api\"\n  }, \"Configure exposed credentials checks via API\"), mdx(\"p\", null, \"Configure exposed credentials checks using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \". You can deploy the Exposed Credentials Check Managed Ruleset and create custom rules that check for exposed credentials.\"), mdx(\"h2\", {\n    \"id\": \"deploy-the-exposed-credentials-check-managed-ruleset\"\n  }, \"Deploy the Exposed Credentials Check Managed Ruleset\"), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"You must deploy the Managed Ruleset to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_firewall_managed\"), \" phase.\")), mdx(\"p\", null, \"To deploy the Managed Ruleset for a given zone, do the following:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Obtain the zone ID of the zone where you want to deploy the Managed Ruleset.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n  }, \"List existing rulesets\"), \" method to obtain the following ruleset IDs:\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The ruleset ID of the ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_request_firewall_managed\"), \" phase at the zone level\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The ruleset ID of the Exposed Credentials Check Managed Ruleset\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"If the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_request_firewall_managed\"), \" phase ruleset does not exist, create it using the Create ruleset method.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#view-a-specific-ruleset\"\n  }, \"View ruleset\"), \" method to get the rules already associated with the phase ruleset where you want to deploy the Managed Ruleset.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method to add a rule to the phase ruleset deploying the Exposed Credentials Check Managed Ruleset. Make sure you include the existing rules in the phase ruleset in your \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"PUT\"), \" request.\")), mdx(\"p\", null, \"For more information on deploying a Managed Ruleset, check \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset\"\n  }, \"Deploy a Managed Ruleset\"), \".\"), mdx(\"h3\", {\n    \"id\": \"configure-an-override-for-the-exposed-credentials-check-managed-ruleset\"\n  }, \"Configure an override for the Exposed Credentials Check Managed Ruleset\"), mdx(\"p\", null, \"An override allows you to define an action or status different from the default values as configured by Cloudflare. You can define overrides at the ruleset, tag, and rule level for all Managed Rulesets, including the Exposed Credentials Check Managed Ruleset.\"), mdx(\"p\", null, \"For more information on defining overrides for Managed Rulesets using the Rulesets API, check \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset\"\n  }, \"Override a Managed Ruleset\"), \".\"), mdx(\"h2\", {\n    \"id\": \"create-a-custom-rule-checking-for-exposed-credentials\"\n  }, \"Create a custom rule checking for exposed credentials\"), mdx(Aside, {\n    type: \"note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"This feature is only available\\xA0to customers on an Enterprise plan.\")), mdx(\"p\", null, \"You can create rules that check for exposed credentials using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \". Include these rules in a custom ruleset, which you must create at the account level, and then deploy the custom ruleset to a phase.\"), mdx(\"p\", null, \"A rule with exposed credentials check has a match when both the rule expression and the result from the exposed credentials check are true.\"), mdx(\"p\", null, \"To check for exposed credentials in a custom rule, include the field \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"exposed_credential_check\"), \" in the rule definition. This field requires the following options:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"username_expression\"), \" \\u2014 Expression that selects the user ID used in the credentials check. This field can have up to 1024 characters.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"password_expression\"), \" \\u2014 Expression that selects the password used in the credentials check. This field can have up to 1024 characters.\")), mdx(Aside, {\n    type: \"warning\",\n    header: \"Important\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"These options have additional requirements:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Each expression must evaluate to a string.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"You can only use the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"upper()\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"lower()\"), \", and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"url_decode()\"), \" functions, and you cannot nest these functions.\"))), mdx(\"p\", null, \"You can use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"exposed_credential_check\"), \" field in rules with one of the following actions: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rewrite\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"log\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"block\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"challenge\"), \", or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"js_challenge\"), \".\"), mdx(\"p\", null, \"To create and deploy a custom ruleset, follow the workflow described in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/custom-rulesets\"\n  }, \"Work with custom rulesets\"), \".\"), mdx(\"h3\", {\n    \"id\": \"example\"\n  }, \"Example\"), mdx(\"p\", null, \"The following \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"POST\"), \" example creates a new custom ruleset with a rule that checks for exposed credentials. The rule has a match if both the rule expression and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"exposed_credential_check\"), \" result are \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"curl -X POST \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/accounts/{account-id}/rulesets\\\" \\\\\\n-d '{\\n  \\\"name\\\": \\\"Custom Ruleset 1\\\",\\n  \\\"kind\\\": \\\"custom\\\",\\n  \\\"description\\\": \\\"This ruleset includes a rule checking for exposed credentials.\\\",\\n  \\\"rules\\\": [\\n    {\\n      \\\"action\\\": \\\"log\\\",\\n      \\\"expression\\\": \\\"http.request.method == \\\\\\\"POST\\\\\\\" && http.request.uri == \\\\\\\"/login.php\\\\\\\"\\\",\\n      \\\"exposed_credential_check\\\": {\\n        \\\"username_expression\\\": \\\"url_decode(http.request.body.form[\\\\\\\"username\\\\\\\"][0])\\\",\\n        \\\"password_expression\\\": \\\"url_decode(http.request.body.form[\\\\\\\"password\\\\\\\"][0])\\\"\\n      }\\n    }\\n  ],\\n  \\\"phase\\\": \\\"http_request_firewall_custom\\\"\\n}'\\n\")), mdx(\"p\", null, \"The response returns the created ruleset. Note the presence of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"exposed_credential_check\"), \" field on the rule definition.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{custom-ruleset-id}\\\",\\n    \\\"name\\\": \\\"Custom Ruleset 1\\\",\\n    \\\"description\\\": \\\"This ruleset includes a rule checking for exposed credentials.\\\",\\n    \\\"kind\\\": \\\"custom\\\",\\n    \\\"version\\\": \\\"1\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{custom-rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"log\\\",\\n        \\\"expression\\\": \\\"http.request.method == \\\\\\\"POST\\\\\\\" && http.request.uri == \\\\\\\"/login.php\\\\\\\"\\\",\\n        \\\"exposed_credential_check\\\": {\\n          \\\"username_expression\\\": \\\"url_decode(http.request.body.form[\\\\\\\"username\\\\\\\"][0])\\\",\\n          \\\"password_expression\\\": \\\"url_decode(http.request.body.form[\\\\\\\"password\\\\\\\"][0])\\\"\\n        },\\n        \\\"last_updated\\\": \\\"2021-03-19T10:48:04.057775Z\\\",\\n        \\\"ref\\\": \\\"{custom-rule-ref}\\\",\\n        \\\"enabled\\\": true\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-03-19T10:48:04.057775Z\\\",\\n    \\\"phase\\\": \\\"http_request_firewall_custom\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"p\", null, \"The example above uses the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"url_decode()\"), \" function because fields in the request body (available in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http.request.body.form\"), \") are URL-encoded when the content type is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"application/x-www-form-urlencoded\"), \".\"), mdx(\"p\", null, \"After creating a custom ruleset, deploy it to a phase so that it can execute. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/custom-rulesets/deploy-custom-ruleset\"\n  }, \"Deploy a custom ruleset\"), \" for more information.\"));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"pcx-content-type\": \"interim\",\n  \"order\": 3\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\nconst Aside = makeShortcode(\"Aside\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"configure-exposed-credentials-checks-via-api\"\n    }}>{`Configure exposed credentials checks via API`}</h1>\n    <p>{`Configure exposed credentials checks using the `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n      }}>{`Rulesets API`}</a>{`. You can deploy the Exposed Credentials Check Managed Ruleset and create custom rules that check for exposed credentials.`}</p>\n    <h2 {...{\n      \"id\": \"deploy-the-exposed-credentials-check-managed-ruleset\"\n    }}>{`Deploy the Exposed Credentials Check Managed Ruleset`}</h2>\n    <Aside type='warning' header='Important' mdxType=\"Aside\">\n      <p>{`You must deploy the Managed Ruleset to the `}<inlineCode parentName=\"p\">{`http_request_firewall_managed`}</inlineCode>{` phase.`}</p>\n    </Aside>\n    <p>{`To deploy the Managed Ruleset for a given zone, do the following:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Obtain the zone ID of the zone where you want to deploy the Managed Ruleset.`}</li>\n      <li parentName=\"ol\">{`Use the `}<a parentName=\"li\" {...{\n          \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n        }}>{`List existing rulesets`}</a>{` method to obtain the following ruleset IDs:`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`The ruleset ID of the ruleset for the `}<inlineCode parentName=\"li\">{`http_request_firewall_managed`}</inlineCode>{` phase at the zone level`}</li>\n          <li parentName=\"ul\">{`The ruleset ID of the Exposed Credentials Check Managed Ruleset`}</li>\n        </ul></li>\n      <li parentName=\"ol\">{`If the `}<inlineCode parentName=\"li\">{`http_request_firewall_managed`}</inlineCode>{` phase ruleset does not exist, create it using the Create ruleset method.`}</li>\n      <li parentName=\"ol\">{`Use the `}<a parentName=\"li\" {...{\n          \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#view-a-specific-ruleset\"\n        }}>{`View ruleset`}</a>{` method to get the rules already associated with the phase ruleset where you want to deploy the Managed Ruleset.`}</li>\n      <li parentName=\"ol\">{`Use the `}<a parentName=\"li\" {...{\n          \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n        }}>{`Update ruleset`}</a>{` method to add a rule to the phase ruleset deploying the Exposed Credentials Check Managed Ruleset. Make sure you include the existing rules in the phase ruleset in your `}<inlineCode parentName=\"li\">{`PUT`}</inlineCode>{` request.`}</li>\n    </ol>\n    <p>{`For more information on deploying a Managed Ruleset, check `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset\"\n      }}>{`Deploy a Managed Ruleset`}</a>{`.`}</p>\n    <h3 {...{\n      \"id\": \"configure-an-override-for-the-exposed-credentials-check-managed-ruleset\"\n    }}>{`Configure an override for the Exposed Credentials Check Managed Ruleset`}</h3>\n    <p>{`An override allows you to define an action or status different from the default values as configured by Cloudflare. You can define overrides at the ruleset, tag, and rule level for all Managed Rulesets, including the Exposed Credentials Check Managed Ruleset.`}</p>\n    <p>{`For more information on defining overrides for Managed Rulesets using the Rulesets API, check `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset\"\n      }}>{`Override a Managed Ruleset`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"create-a-custom-rule-checking-for-exposed-credentials\"\n    }}>{`Create a custom rule checking for exposed credentials`}</h2>\n    <Aside type=\"note\" mdxType=\"Aside\">\n      <p>{`This feature is only available to customers on an Enterprise plan.`}</p>\n    </Aside>\n    <p>{`You can create rules that check for exposed credentials using the `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n      }}>{`Rulesets API`}</a>{`. Include these rules in a custom ruleset, which you must create at the account level, and then deploy the custom ruleset to a phase.`}</p>\n    <p>{`A rule with exposed credentials check has a match when both the rule expression and the result from the exposed credentials check are true.`}</p>\n    <p>{`To check for exposed credentials in a custom rule, include the field `}<inlineCode parentName=\"p\">{`exposed_credential_check`}</inlineCode>{` in the rule definition. This field requires the following options:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`username_expression`}</inlineCode>{` — Expression that selects the user ID used in the credentials check. This field can have up to 1024 characters.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`password_expression`}</inlineCode>{` — Expression that selects the password used in the credentials check. This field can have up to 1024 characters.`}</li>\n    </ul>\n    <Aside type='warning' header='Important' mdxType=\"Aside\">\n      <p>{`These options have additional requirements:`}</p>\n      <ul>\n        <li parentName=\"ul\">{`Each expression must evaluate to a string.`}</li>\n        <li parentName=\"ul\">{`You can only use the `}<inlineCode parentName=\"li\">{`upper()`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`lower()`}</inlineCode>{`, and `}<inlineCode parentName=\"li\">{`url_decode()`}</inlineCode>{` functions, and you cannot nest these functions.`}</li>\n      </ul>\n    </Aside>\n    <p>{`You can use the `}<inlineCode parentName=\"p\">{`exposed_credential_check`}</inlineCode>{` field in rules with one of the following actions: `}<inlineCode parentName=\"p\">{`rewrite`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`log`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`block`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`challenge`}</inlineCode>{`, or `}<inlineCode parentName=\"p\">{`js_challenge`}</inlineCode>{`.`}</p>\n    <p>{`To create and deploy a custom ruleset, follow the workflow described in `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/custom-rulesets\"\n      }}>{`Work with custom rulesets`}</a>{`.`}</p>\n    <h3 {...{\n      \"id\": \"example\"\n    }}>{`Example`}</h3>\n    <p>{`The following `}<inlineCode parentName=\"p\">{`POST`}</inlineCode>{` example creates a new custom ruleset with a rule that checks for exposed credentials. The rule has a match if both the rule expression and the `}<inlineCode parentName=\"p\">{`exposed_credential_check`}</inlineCode>{` result are `}<inlineCode parentName=\"p\">{`true`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`curl -X POST \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/accounts/{account-id}/rulesets\" \\\\\n-d '{\n  \"name\": \"Custom Ruleset 1\",\n  \"kind\": \"custom\",\n  \"description\": \"This ruleset includes a rule checking for exposed credentials.\",\n  \"rules\": [\n    {\n      \"action\": \"log\",\n      \"expression\": \"http.request.method == \\\\\"POST\\\\\" && http.request.uri == \\\\\"/login.php\\\\\"\",\n      \"exposed_credential_check\": {\n        \"username_expression\": \"url_decode(http.request.body.form[\\\\\"username\\\\\"][0])\",\n        \"password_expression\": \"url_decode(http.request.body.form[\\\\\"password\\\\\"][0])\"\n      }\n    }\n  ],\n  \"phase\": \"http_request_firewall_custom\"\n}'\n`}</code></pre>\n    <p>{`The response returns the created ruleset. Note the presence of the `}<inlineCode parentName=\"p\">{`exposed_credential_check`}</inlineCode>{` field on the rule definition.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"result\": {\n    \"id\": \"{custom-ruleset-id}\",\n    \"name\": \"Custom Ruleset 1\",\n    \"description\": \"This ruleset includes a rule checking for exposed credentials.\",\n    \"kind\": \"custom\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"id\": \"{custom-rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"log\",\n        \"expression\": \"http.request.method == \\\\\"POST\\\\\" && http.request.uri == \\\\\"/login.php\\\\\"\",\n        \"exposed_credential_check\": {\n          \"username_expression\": \"url_decode(http.request.body.form[\\\\\"username\\\\\"][0])\",\n          \"password_expression\": \"url_decode(http.request.body.form[\\\\\"password\\\\\"][0])\"\n        },\n        \"last_updated\": \"2021-03-19T10:48:04.057775Z\",\n        \"ref\": \"{custom-rule-ref}\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-03-19T10:48:04.057775Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n    <p>{`The example above uses the `}<inlineCode parentName=\"p\">{`url_decode()`}</inlineCode>{` function because fields in the request body (available in `}<inlineCode parentName=\"p\">{`http.request.body.form`}</inlineCode>{`) are URL-encoded when the content type is `}<inlineCode parentName=\"p\">{`application/x-www-form-urlencoded`}</inlineCode>{`.`}</p>\n    <p>{`After creating a custom ruleset, deploy it to a phase so that it can execute. Refer to `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/custom-rulesets/deploy-custom-ruleset\"\n      }}>{`Deploy a custom ruleset`}</a>{` for more information.`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}