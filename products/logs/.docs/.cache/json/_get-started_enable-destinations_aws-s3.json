{"data":{"mdx":{"id":"5ed45916-8d49-5839-adc6-881d1a54338a","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Enable Amazon S3\",\n  \"order\": 55,\n  \"pcx-content-type\": \"how-to\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"enable-logpush-to-amazon-s3\"\n  }, \"Enable Logpush to Amazon S3\"), mdx(\"p\", null, \"Cloudflare Logpush supports pushing logs directly to Amazon S3 via the Cloudflare dashboard or via API. Customers that use AWS GovCloud locations should use our \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"S3-compatible endpoint\"), \" and not the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Amazon S3 endpoint\"), \".\"), mdx(\"h2\", {\n    \"id\": \"manage-via-the-cloudflare-dashboard\"\n  }, \"Manage via the Cloudflare dashboard\"), mdx(\"p\", null, \"Enable Logpush to Amazon S3 via the dashboard.\"), mdx(\"p\", null, \"To enable the Cloudflare Logpush service:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Log in to the Cloudflare dashboard.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Select the Enterprise domain you want to use with Logpush.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Go to \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Analytics\"), \" > \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Logs\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Click \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Connect a service\"), \". A modal window opens where you will need to complete several steps.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Select the dataset you want to push to a storage service.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Select the data fields to include in your logs. Add or remove fields later by modifying your settings in \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Logs\"), \" > \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Logpush\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Select \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Amazon S3\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Enter or select the following destination information:\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Bucket path\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Daily subfolders\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Bucket region\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Encryption constraint in bucket policy\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"For \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Grant Cloudflare access to upload files to your bucket\"), \", make sure your bucket has a policy (if you did not add it already):\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Copy the JSON policy, then go to your bucket in the Amazon S3 console and paste the policy in \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Permissions\"), \" > \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Bucket Policy\"), \" and click \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Save\"), \".\"))))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Click \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Validate access\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Enter the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Ownership token\"), \" (included in a file or log Cloudflare sends to your provider) and click \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Prove ownership\"), \". To find the ownership token, click the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Open\"), \" button in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Overview\"), \" tab of the ownership challenge file.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Click \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Save and Start Pushing\"), \" to finish enabling Logpush.\"))), mdx(\"p\", null, \"Once connected, Cloudflare lists Amazon S3 as a connected service under \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Logs\"), \" > \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Logpush\"), \". Edit or remove connected services from here.\"), mdx(\"h2\", {\n    \"id\": \"manage-via-api\"\n  }, \"Manage via API\"), mdx(\"p\", null, \"Cloudflare uses Amazon Identity and Access Management (IAM) to gain access to your S3 bucket. The Cloudflare IAM user needs \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"PutObject\"), \" permission for the bucket.\"), mdx(\"p\", null, \"Logs are written into that bucket as gzipped objects using the S3 Access Control List (ACL)\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Bucket-owner-full-control\"), \" permission.\"), mdx(EnableReadPermissions, {\n    mdxType: \"EnableReadPermissions\"\n  }), mdx(\"p\", null, \"For illustrative purposes, imagine that you want to store logs in the bucket \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"burritobot\"), \", in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"logs\"), \" directory. The S3 URL would then be \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"s3://burritobot/logs\"), \".\"), mdx(\"p\", null, \"To enable Logpush to Amazon S3:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Create an S3 bucket. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/AmazonS3/latest/gsg/CreatingABucket.html\"\n  }, \"instructions from Amazon\"), \".\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Note: Buckets in China regions (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cn-north-1\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cn-northwest-1\"), \") are currently not supported.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Edit and paste the policy below into \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"S3\"), \" > \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Bucket\"), \" > \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Permissions\"), \" > \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Bucket Policy\"), \", replacing the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Resource\"), \" value with your own bucket path:\"))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"Id\\\": \\\"Policy1506627184792\\\",\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Sid\\\": \\\"Stmt1506627150918\\\",\\n      \\\"Action\\\": [\\n        \\\"s3:PutObject\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"arn:aws:s3:::burritobot/logs/*\\\",\\n      \\\"Principal\\\": {\\n        \\\"AWS\\\": [\\n          \\\"arn:aws:iam::391854517948:user/cloudflare-logpush\\\"\\n        ]\\n      }\\n    }\\n  ]\\n}\\n\")), mdx(Aside, {\n    type: \"note\",\n    header: \"Note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Logpush uses multipart upload for S3. Aborted uploads will result in incomplete files remaining in your bucket. To minimize your storage costs, Amazon recommends configuring a lifecycle rule using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AbortIncompleteMultipartUpload\"), \" action. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/AmazonS3/latest/dev/mpuoverview.html#mpu-abort-incomplete-mpu-lifecycle-config\"\n  }, \"Uploading and copying objects using multipart upload\"), \".\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"Enable Amazon S3","type":null,"updated":null}}},"pageContext":{"id":"5ed45916-8d49-5839-adc6-881d1a54338a","fields":{"slug":"/get-started/enable-destinations/aws-s3"},"frontmatter":{"pcx_content_type":"how-to","title":"Enable Amazon S3","type":null,"order":55,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Enable Logpush to Amazon S3","depth":1}],"tableOfContents":{"items":[{"url":"#enable-logpush-to-amazon-s3","title":"Enable Logpush to Amazon S3","items":[{"url":"#manage-via-the-cloudflare-dashboard","title":"Manage via the Cloudflare dashboard"},{"url":"#manage-via-api","title":"Manage via API"}]}]},"parent":{"modifiedTime":"2022-01-27","relativePath":"get-started/enable-destinations/aws-s3/index.md"}}}