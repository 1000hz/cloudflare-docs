{"expireTime":9007200897961981000,"key":"gatsby-plugin-mdx-entire-payload-facf0dd5d3834d93e91bd6433782f81a-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Create an HTTP Response Header Modification Rule via API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":59,"offset":59},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":59,"offset":59},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":4,"column":1,"offset":61},"end":{"line":4,"column":9,"offset":69},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api","children":[{"type":"text","value":"Rulesets API","position":{"start":{"line":4,"column":10,"offset":70},"end":{"line":4,"column":22,"offset":82},"indent":[]}}],"position":{"start":{"line":4,"column":9,"offset":69},"end":{"line":4,"column":86,"offset":146},"indent":[]}},{"type":"text","value":" to create HTTP Response Header Modification Rules via API. Define the header modification configuration in the ","position":{"start":{"line":4,"column":86,"offset":146},"end":{"line":4,"column":198,"offset":258},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":4,"column":198,"offset":258},"end":{"line":4,"column":217,"offset":277},"indent":[]}},{"type":"text","value":" field. Refer to ","position":{"start":{"line":4,"column":217,"offset":277},"end":{"line":4,"column":234,"offset":294},"indent":[]}},{"type":"link","title":null,"url":"/transform/response-header-modification/examples","children":[{"type":"text","value":"Response header modification examples","position":{"start":{"line":4,"column":235,"offset":295},"end":{"line":4,"column":272,"offset":332},"indent":[]}}],"position":{"start":{"line":4,"column":234,"offset":294},"end":{"line":4,"column":323,"offset":383},"indent":[]}},{"type":"text","value":" for examples of rule definitions.","position":{"start":{"line":4,"column":323,"offset":383},"end":{"line":4,"column":357,"offset":417},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":61},"end":{"line":4,"column":357,"offset":417},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When creating an HTTP Response Header Modification Rule via API, make sure you:","position":{"start":{"line":6,"column":1,"offset":419},"end":{"line":6,"column":80,"offset":498},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":419},"end":{"line":6,"column":80,"offset":498},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Set the rule action to ","position":{"start":{"line":8,"column":3,"offset":502},"end":{"line":8,"column":26,"offset":525},"indent":[]}},{"type":"inlineCode","value":"rewrite","position":{"start":{"line":8,"column":26,"offset":525},"end":{"line":8,"column":35,"offset":534},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":8,"column":35,"offset":534},"end":{"line":8,"column":36,"offset":535},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":502},"end":{"line":8,"column":36,"offset":535},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":500},"end":{"line":8,"column":36,"offset":535},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Define the ","position":{"start":{"line":9,"column":3,"offset":538},"end":{"line":9,"column":14,"offset":549},"indent":[]}},{"type":"link","title":null,"url":"/transform/request-header-modification/reference/parameters","children":[{"type":"text","value":"header modification parameters","position":{"start":{"line":9,"column":15,"offset":550},"end":{"line":9,"column":45,"offset":580},"indent":[]}}],"position":{"start":{"line":9,"column":14,"offset":549},"end":{"line":9,"column":107,"offset":642},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":9,"column":107,"offset":642},"end":{"line":9,"column":115,"offset":650},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":9,"column":115,"offset":650},"end":{"line":9,"column":134,"offset":669},"indent":[]}},{"type":"text","value":" field according to the operation to perform (set or remove header).","position":{"start":{"line":9,"column":134,"offset":669},"end":{"line":9,"column":202,"offset":737},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":538},"end":{"line":9,"column":202,"offset":737},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":536},"end":{"line":9,"column":202,"offset":737},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Deploy the rule to the ","position":{"start":{"line":10,"column":3,"offset":740},"end":{"line":10,"column":26,"offset":763},"indent":[]}},{"type":"inlineCode","value":"http_response_headers_transform","position":{"start":{"line":10,"column":26,"offset":763},"end":{"line":10,"column":59,"offset":796},"indent":[]}},{"type":"text","value":" phase at the zone level.","position":{"start":{"line":10,"column":59,"offset":796},"end":{"line":10,"column":84,"offset":821},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":740},"end":{"line":10,"column":84,"offset":821},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":738},"end":{"line":10,"column":84,"offset":821},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":500},"end":{"line":10,"column":84,"offset":821},"indent":[1,1]}},{"type":"thematicBreak","position":{"start":{"line":12,"column":1,"offset":823},"end":{"line":12,"column":4,"offset":826},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Follow this workflow to create an HTTP Response Header Modification Rule for a given zone via API:","position":{"start":{"line":14,"column":1,"offset":828},"end":{"line":14,"column":99,"offset":926},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":828},"end":{"line":14,"column":99,"offset":926},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":16,"column":4,"offset":931},"end":{"line":16,"column":12,"offset":939},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets","children":[{"type":"text","value":"List existing rulesets","position":{"start":{"line":16,"column":13,"offset":940},"end":{"line":16,"column":35,"offset":962},"indent":[]}}],"position":{"start":{"line":16,"column":12,"offset":939},"end":{"line":16,"column":127,"offset":1054},"indent":[]}},{"type":"text","value":" method to check if there is already a ruleset for the ","position":{"start":{"line":16,"column":127,"offset":1054},"end":{"line":16,"column":182,"offset":1109},"indent":[]}},{"type":"inlineCode","value":"http_response_headers_transform","position":{"start":{"line":16,"column":182,"offset":1109},"end":{"line":16,"column":215,"offset":1142},"indent":[]}},{"type":"text","value":" phase at the zone level.","position":{"start":{"line":16,"column":215,"offset":1142},"end":{"line":16,"column":240,"offset":1167},"indent":[]}}],"position":{"start":{"line":16,"column":4,"offset":931},"end":{"line":16,"column":240,"offset":1167},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":928},"end":{"line":17,"column":1,"offset":1168},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If the phase ruleset does not exist, create it using the ","position":{"start":{"line":18,"column":4,"offset":1172},"end":{"line":18,"column":61,"offset":1229},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create","children":[{"type":"text","value":"Create ruleset","position":{"start":{"line":18,"column":62,"offset":1230},"end":{"line":18,"column":76,"offset":1244},"indent":[]}}],"position":{"start":{"line":18,"column":61,"offset":1229},"end":{"line":18,"column":147,"offset":1315},"indent":[]}},{"type":"text","value":" method with the zone-level endpoint. In the new ruleset properties, set the following values:","position":{"start":{"line":18,"column":147,"offset":1315},"end":{"line":18,"column":241,"offset":1409},"indent":[]}}],"position":{"start":{"line":18,"column":4,"offset":1172},"end":{"line":18,"column":241,"offset":1409},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"kind","position":{"start":{"line":20,"column":9,"offset":1419},"end":{"line":20,"column":13,"offset":1423},"indent":[]}}],"position":{"start":{"line":20,"column":7,"offset":1417},"end":{"line":20,"column":15,"offset":1425},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":20,"column":15,"offset":1425},"end":{"line":20,"column":17,"offset":1427},"indent":[]}},{"type":"inlineCode","value":"zone","position":{"start":{"line":20,"column":17,"offset":1427},"end":{"line":20,"column":23,"offset":1433},"indent":[]}}],"position":{"start":{"line":20,"column":7,"offset":1417},"end":{"line":20,"column":23,"offset":1433},"indent":[]}}],"position":{"start":{"line":20,"column":5,"offset":1415},"end":{"line":20,"column":23,"offset":1433},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"phase","position":{"start":{"line":21,"column":9,"offset":1442},"end":{"line":21,"column":14,"offset":1447},"indent":[]}}],"position":{"start":{"line":21,"column":7,"offset":1440},"end":{"line":21,"column":16,"offset":1449},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":21,"column":16,"offset":1449},"end":{"line":21,"column":18,"offset":1451},"indent":[]}},{"type":"inlineCode","value":"http_response_headers_transform","position":{"start":{"line":21,"column":18,"offset":1451},"end":{"line":21,"column":51,"offset":1484},"indent":[]}}],"position":{"start":{"line":21,"column":7,"offset":1440},"end":{"line":21,"column":51,"offset":1484},"indent":[]}}],"position":{"start":{"line":21,"column":5,"offset":1438},"end":{"line":21,"column":51,"offset":1484},"indent":[]}}],"position":{"start":{"line":20,"column":5,"offset":1415},"end":{"line":21,"column":51,"offset":1484},"indent":[5]}}],"position":{"start":{"line":18,"column":1,"offset":1169},"end":{"line":22,"column":1,"offset":1485},"indent":[1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":23,"column":4,"offset":1489},"end":{"line":23,"column":12,"offset":1497},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":23,"column":13,"offset":1498},"end":{"line":23,"column":27,"offset":1512},"indent":[]}}],"position":{"start":{"line":23,"column":12,"offset":1497},"end":{"line":23,"column":98,"offset":1583},"indent":[]}},{"type":"text","value":" method to add an HTTP Response Header Modification Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the ","position":{"start":{"line":23,"column":98,"offset":1583},"end":{"line":23,"column":251,"offset":1736},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create","children":[{"type":"text","value":"Create ruleset","position":{"start":{"line":23,"column":252,"offset":1737},"end":{"line":23,"column":266,"offset":1751},"indent":[]}}],"position":{"start":{"line":23,"column":251,"offset":1736},"end":{"line":23,"column":337,"offset":1822},"indent":[]}},{"type":"text","value":" request mentioned in the previous step.","position":{"start":{"line":23,"column":337,"offset":1822},"end":{"line":23,"column":377,"offset":1862},"indent":[]}}],"position":{"start":{"line":23,"column":4,"offset":1489},"end":{"line":23,"column":377,"offset":1862},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1486},"end":{"line":23,"column":377,"offset":1862},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":928},"end":{"line":23,"column":377,"offset":1862},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Examples","position":{"start":{"line":25,"column":5,"offset":1868},"end":{"line":25,"column":13,"offset":1876},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1864},"end":{"line":25,"column":13,"offset":1876},"indent":[]}},{"type":"jsx","value":"<details>\n<summary>Example: Add an HTTP response header with a static value</summary>\n<div>","position":{"start":{"line":27,"column":1,"offset":1878},"end":{"line":29,"column":6,"offset":1969},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":31,"column":1,"offset":1971},"end":{"line":31,"column":68,"offset":2038},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":31,"column":68,"offset":2038},"end":{"line":31,"column":82,"offset":2052},"indent":[]}},{"type":"text","value":") to a single HTTP Response Header Modification Rule — adding an HTTP response header with a static value — using the ","position":{"start":{"line":31,"column":82,"offset":2052},"end":{"line":31,"column":200,"offset":2170},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":31,"column":201,"offset":2171},"end":{"line":31,"column":215,"offset":2185},"indent":[]}}],"position":{"start":{"line":31,"column":200,"offset":2170},"end":{"line":31,"column":286,"offset":2256},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":31,"column":286,"offset":2256},"end":{"line":31,"column":294,"offset":2264},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1971},"end":{"line":31,"column":294,"offset":2264},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n      \"description\": \"My first HTTP Response Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Source\": {\n            \"operation\": \"set\",\n            \"value\": \"Cloudflare\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":33,"column":1,"offset":2266},"end":{"line":58,"column":4,"offset":2840},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":60,"column":1,"offset":2842},"end":{"line":60,"column":74,"offset":2915},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2842},"end":{"line":60,"column":74,"offset":2915},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Response Headers Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Response Header Modification Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Source\": {\n              \"operation\": \"set\",\n              \"value\": \"Cloudflare\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n        \"description\": \"My first HTTP Response Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_response_headers_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":62,"column":1,"offset":2917},"end":{"line":99,"column":4,"offset":3882},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":101,"column":1,"offset":3884},"end":{"line":102,"column":11,"offset":3901},"indent":[1]}},{"type":"jsx","value":"<details>\n<summary>Example: Add an HTTP response header with a dynamic value</summary>\n<div>","position":{"start":{"line":104,"column":1,"offset":3903},"end":{"line":106,"column":6,"offset":3995},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":108,"column":1,"offset":3997},"end":{"line":108,"column":68,"offset":4064},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":108,"column":68,"offset":4064},"end":{"line":108,"column":82,"offset":4078},"indent":[]}},{"type":"text","value":") to a single HTTP Response Header Modification Rule — adding an HTTP response header with a dynamic value — using the ","position":{"start":{"line":108,"column":82,"offset":4078},"end":{"line":108,"column":201,"offset":4197},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":108,"column":202,"offset":4198},"end":{"line":108,"column":216,"offset":4212},"indent":[]}}],"position":{"start":{"line":108,"column":201,"offset":4197},"end":{"line":108,"column":287,"offset":4283},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":108,"column":287,"offset":4283},"end":{"line":108,"column":295,"offset":4291},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3997},"end":{"line":108,"column":295,"offset":4291},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n      \"description\": \"My first HTTP Response Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Bot-Score\": {\n            \"operation\": \"set\",\n            \"expression\": \"to_string(cf.bot_management.score)\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":110,"column":1,"offset":4293},"end":{"line":135,"column":4,"offset":4899},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":137,"column":1,"offset":4901},"end":{"line":137,"column":74,"offset":4974},"indent":[]}}],"position":{"start":{"line":137,"column":1,"offset":4901},"end":{"line":137,"column":74,"offset":4974},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Response Headers Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Response Header Modification Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Bot-Score\": {\n              \"operation\": \"set\",\n              \"expression\": \"to_string(cf.bot_management.score)\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n        \"description\": \"My first HTTP Response Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_response_headers_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":139,"column":1,"offset":4976},"end":{"line":176,"column":4,"offset":5973},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":178,"column":1,"offset":5975},"end":{"line":179,"column":11,"offset":5992},"indent":[1]}},{"type":"jsx","value":"<details>\n<summary>Example: Remove an HTTP response header</summary>\n<div>","position":{"start":{"line":181,"column":1,"offset":5994},"end":{"line":183,"column":6,"offset":6068},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":185,"column":1,"offset":6070},"end":{"line":185,"column":68,"offset":6137},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":185,"column":68,"offset":6137},"end":{"line":185,"column":82,"offset":6151},"indent":[]}},{"type":"text","value":") to a single HTTP Response Header Modification Rule — removing an HTTP response header — using the ","position":{"start":{"line":185,"column":82,"offset":6151},"end":{"line":185,"column":182,"offset":6251},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":185,"column":183,"offset":6252},"end":{"line":185,"column":197,"offset":6266},"indent":[]}}],"position":{"start":{"line":185,"column":182,"offset":6251},"end":{"line":185,"column":268,"offset":6337},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":185,"column":268,"offset":6337},"end":{"line":185,"column":276,"offset":6345},"indent":[]}}],"position":{"start":{"line":185,"column":1,"offset":6070},"end":{"line":185,"column":276,"offset":6345},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n      \"description\": \"My first HTTP Response Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"cf-connecting-ip\": {\n            \"operation\": \"remove\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":187,"column":1,"offset":6347},"end":{"line":211,"column":4,"offset":6897},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":213,"column":1,"offset":6899},"end":{"line":213,"column":74,"offset":6972},"indent":[]}}],"position":{"start":{"line":213,"column":1,"offset":6899},"end":{"line":213,"column":74,"offset":6972},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Response Headers Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Response Header Modification Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"cf-connecting-ip\": {\n              \"operation\": \"remove\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n        \"description\": \"My first HTTP Response Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_response_headers_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":215,"column":1,"offset":6974},"end":{"line":251,"column":4,"offset":7913},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":253,"column":1,"offset":7915},"end":{"line":254,"column":11,"offset":7932},"indent":[1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Create a rule via API\",\"pcx-content-type\":\"how-to\",\"type\":\"overview\",\"order\":2}","position":{"start":{"line":257,"column":1,"offset":7935},"end":{"line":257,"column":118,"offset":8052},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":257,"column":118,"offset":8052}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Create a rule via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"type\": \"overview\",\n  \"order\": 2\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"create-an-http-response-header-modification-rule-via-api\"\n  }, \"Create an HTTP Response Header Modification Rule via API\"), mdx(\"p\", null, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \" to create HTTP Response Header Modification Rules via API. Define the header modification configuration in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \" field. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/transform/response-header-modification/examples\"\n  }, \"Response header modification examples\"), \" for examples of rule definitions.\"), mdx(\"p\", null, \"When creating an HTTP Response Header Modification Rule via API, make sure you:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Set the rule action to \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"rewrite\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Define the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/transform/request-header-modification/reference/parameters\"\n  }, \"header modification parameters\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"action_parameters\"), \" field according to the operation to perform (set or remove header).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Deploy the rule to the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_response_headers_transform\"), \" phase at the zone level.\")), mdx(\"hr\", null), mdx(\"p\", null, \"Follow this workflow to create an HTTP Response Header Modification Rule for a given zone via API:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n  }, \"List existing rulesets\"), \" method to check if there is already a ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_response_headers_transform\"), \" phase at the zone level.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"If the phase ruleset does not exist, create it using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"Create ruleset\"), \" method with the zone-level endpoint. In the new ruleset properties, set the following values:\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"kind\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"zone\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"phase\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_response_headers_transform\")))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method to add an HTTP Response Header Modification Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"Create ruleset\"), \" request mentioned in the previous step.\"))), mdx(\"h3\", {\n    \"id\": \"examples\"\n  }, \"Examples\"), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Add an HTTP response header with a static value\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single HTTP Response Header Modification Rule \\u2014 adding an HTTP response header with a static value \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n      \\\"description\\\": \\\"My first HTTP Response Header Modification Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"headers\\\": {\\n          \\\"X-Source\\\": {\\n            \\\"operation\\\": \\\"set\\\",\\n            \\\"value\\\": \\\"Cloudflare\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Response Headers Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Response Header Modification Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"headers\\\": {\\n            \\\"X-Source\\\": {\\n              \\\"operation\\\": \\\"set\\\",\\n              \\\"value\\\": \\\"Cloudflare\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n        \\\"description\\\": \\\"My first HTTP Response Header Modification Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_response_headers_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Add an HTTP response header with a dynamic value\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single HTTP Response Header Modification Rule \\u2014 adding an HTTP response header with a dynamic value \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n      \\\"description\\\": \\\"My first HTTP Response Header Modification Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"headers\\\": {\\n          \\\"X-Bot-Score\\\": {\\n            \\\"operation\\\": \\\"set\\\",\\n            \\\"expression\\\": \\\"to_string(cf.bot_management.score)\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Response Headers Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Response Header Modification Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"headers\\\": {\\n            \\\"X-Bot-Score\\\": {\\n              \\\"operation\\\": \\\"set\\\",\\n              \\\"expression\\\": \\\"to_string(cf.bot_management.score)\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n        \\\"description\\\": \\\"My first HTTP Response Header Modification Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_response_headers_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Remove an HTTP response header\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single HTTP Response Header Modification Rule \\u2014 removing an HTTP response header \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n      \\\"description\\\": \\\"My first HTTP Response Header Modification Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"headers\\\": {\\n          \\\"cf-connecting-ip\\\": {\\n            \\\"operation\\\": \\\"remove\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Response Headers Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Response Header Modification Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"headers\\\": {\\n            \\\"cf-connecting-ip\\\": {\\n              \\\"operation\\\": \\\"remove\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n        \\\"description\\\": \\\"My first HTTP Response Header Modification Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_response_headers_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Create a rule via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"type\": \"overview\",\n  \"order\": 2\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"create-an-http-response-header-modification-rule-via-api\"\n    }}>{`Create an HTTP Response Header Modification Rule via API`}</h1>\n    <p>{`Use the `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n      }}>{`Rulesets API`}</a>{` to create HTTP Response Header Modification Rules via API. Define the header modification configuration in the `}<inlineCode parentName=\"p\">{`action_parameters`}</inlineCode>{` field. Refer to `}<a parentName=\"p\" {...{\n        \"href\": \"/transform/response-header-modification/examples\"\n      }}>{`Response header modification examples`}</a>{` for examples of rule definitions.`}</p>\n    <p>{`When creating an HTTP Response Header Modification Rule via API, make sure you:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Set the rule action to `}<inlineCode parentName=\"li\">{`rewrite`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`Define the `}<a parentName=\"li\" {...{\n          \"href\": \"/transform/request-header-modification/reference/parameters\"\n        }}>{`header modification parameters`}</a>{` in the `}<inlineCode parentName=\"li\">{`action_parameters`}</inlineCode>{` field according to the operation to perform (set or remove header).`}</li>\n      <li parentName=\"ul\">{`Deploy the rule to the `}<inlineCode parentName=\"li\">{`http_response_headers_transform`}</inlineCode>{` phase at the zone level.`}</li>\n    </ul>\n    <hr></hr>\n    <p>{`Follow this workflow to create an HTTP Response Header Modification Rule for a given zone via API:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n          }}>{`List existing rulesets`}</a>{` method to check if there is already a ruleset for the `}<inlineCode parentName=\"p\">{`http_response_headers_transform`}</inlineCode>{` phase at the zone level.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`If the phase ruleset does not exist, create it using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n          }}>{`Create ruleset`}</a>{` method with the zone-level endpoint. In the new ruleset properties, set the following values:`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><strong parentName=\"li\">{`kind`}</strong>{`: `}<inlineCode parentName=\"li\">{`zone`}</inlineCode></li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`phase`}</strong>{`: `}<inlineCode parentName=\"li\">{`http_response_headers_transform`}</inlineCode></li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method to add an HTTP Response Header Modification Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n          }}>{`Create ruleset`}</a>{` request mentioned in the previous step.`}</p>\n      </li>\n    </ol>\n    <h3 {...{\n      \"id\": \"examples\"\n    }}>{`Examples`}</h3>\n    <details>\n      <summary>Example: Add an HTTP response header with a static value</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single HTTP Response Header Modification Rule — adding an HTTP response header with a static value — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n      \"description\": \"My first HTTP Response Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Source\": {\n            \"operation\": \"set\",\n            \"value\": \"Cloudflare\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Response Headers Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Response Header Modification Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Source\": {\n              \"operation\": \"set\",\n              \"value\": \"Cloudflare\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n        \"description\": \"My first HTTP Response Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_response_headers_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n    <details>\n      <summary>Example: Add an HTTP response header with a dynamic value</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single HTTP Response Header Modification Rule — adding an HTTP response header with a dynamic value — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n      \"description\": \"My first HTTP Response Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Bot-Score\": {\n            \"operation\": \"set\",\n            \"expression\": \"to_string(cf.bot_management.score)\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Response Headers Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Response Header Modification Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Bot-Score\": {\n              \"operation\": \"set\",\n              \"expression\": \"to_string(cf.bot_management.score)\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n        \"description\": \"My first HTTP Response Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_response_headers_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n    <details>\n      <summary>Example: Remove an HTTP response header</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single HTTP Response Header Modification Rule — removing an HTTP response header — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n      \"description\": \"My first HTTP Response Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"cf-connecting-ip\": {\n            \"operation\": \"remove\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Response Headers Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Response Header Modification Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"cf-connecting-ip\": {\n              \"operation\": \"remove\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n        \"description\": \"My first HTTP Response Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_response_headers_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}