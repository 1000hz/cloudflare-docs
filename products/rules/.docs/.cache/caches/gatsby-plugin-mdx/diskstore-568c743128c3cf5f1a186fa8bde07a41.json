{"expireTime":9007200897961980000,"key":"gatsby-plugin-mdx-entire-payload-b33dfa367b16f6ce8f3e8ef069c11d78-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Create a URL Rewrite Rule via API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":36,"offset":36},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":36,"offset":36},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":4,"column":1,"offset":38},"end":{"line":4,"column":9,"offset":46},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api","children":[{"type":"text","value":"Rulesets API","position":{"start":{"line":4,"column":10,"offset":47},"end":{"line":4,"column":22,"offset":59},"indent":[]}}],"position":{"start":{"line":4,"column":9,"offset":46},"end":{"line":4,"column":86,"offset":123},"indent":[]}},{"type":"text","value":" to create URL Rewrite Rules via API. Define the rewrite configuration in the ","position":{"start":{"line":4,"column":86,"offset":123},"end":{"line":4,"column":164,"offset":201},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":4,"column":164,"offset":201},"end":{"line":4,"column":183,"offset":220},"indent":[]}},{"type":"text","value":" field. Refer to ","position":{"start":{"line":4,"column":183,"offset":220},"end":{"line":4,"column":200,"offset":237},"indent":[]}},{"type":"link","title":null,"url":"/transform/url-rewrite/examples","children":[{"type":"text","value":"URL rewrite examples","position":{"start":{"line":4,"column":201,"offset":238},"end":{"line":4,"column":221,"offset":258},"indent":[]}}],"position":{"start":{"line":4,"column":200,"offset":237},"end":{"line":4,"column":255,"offset":292},"indent":[]}},{"type":"text","value":" for examples of rule definitions.","position":{"start":{"line":4,"column":255,"offset":292},"end":{"line":4,"column":289,"offset":326},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":38},"end":{"line":4,"column":289,"offset":326},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When creating a URL Rewrite Rule via API, make sure you:","position":{"start":{"line":6,"column":1,"offset":328},"end":{"line":6,"column":57,"offset":384},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":328},"end":{"line":6,"column":57,"offset":384},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Set the rule action to ","position":{"start":{"line":8,"column":3,"offset":388},"end":{"line":8,"column":26,"offset":411},"indent":[]}},{"type":"inlineCode","value":"rewrite","position":{"start":{"line":8,"column":26,"offset":411},"end":{"line":8,"column":35,"offset":420},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":388},"end":{"line":8,"column":35,"offset":420},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":386},"end":{"line":8,"column":35,"offset":420},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Define the ","position":{"start":{"line":9,"column":3,"offset":423},"end":{"line":9,"column":14,"offset":434},"indent":[]}},{"type":"link","title":null,"url":"/transform/url-rewrite/reference/parameters","children":[{"type":"text","value":"URL rewrite parameters","position":{"start":{"line":9,"column":15,"offset":435},"end":{"line":9,"column":37,"offset":457},"indent":[]}}],"position":{"start":{"line":9,"column":14,"offset":434},"end":{"line":9,"column":83,"offset":503},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":9,"column":83,"offset":503},"end":{"line":9,"column":91,"offset":511},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":9,"column":91,"offset":511},"end":{"line":9,"column":110,"offset":530},"indent":[]}},{"type":"text","value":" field according to the type of URL rewrite (static or dynamic)","position":{"start":{"line":9,"column":110,"offset":530},"end":{"line":9,"column":173,"offset":593},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":423},"end":{"line":9,"column":173,"offset":593},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":421},"end":{"line":9,"column":173,"offset":593},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Deploy the rule to the ","position":{"start":{"line":10,"column":3,"offset":596},"end":{"line":10,"column":26,"offset":619},"indent":[]}},{"type":"inlineCode","value":"http_request_transform","position":{"start":{"line":10,"column":26,"offset":619},"end":{"line":10,"column":50,"offset":643},"indent":[]}},{"type":"text","value":" phase at the zone level","position":{"start":{"line":10,"column":50,"offset":643},"end":{"line":10,"column":74,"offset":667},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":596},"end":{"line":10,"column":74,"offset":667},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":594},"end":{"line":10,"column":74,"offset":667},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":386},"end":{"line":10,"column":74,"offset":667},"indent":[1,1]}},{"type":"thematicBreak","position":{"start":{"line":12,"column":1,"offset":669},"end":{"line":12,"column":4,"offset":672},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Follow this workflow to create a URL Rewrite Rule for a given zone via API:","position":{"start":{"line":14,"column":1,"offset":674},"end":{"line":14,"column":76,"offset":749},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":674},"end":{"line":14,"column":76,"offset":749},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":16,"column":4,"offset":754},"end":{"line":16,"column":12,"offset":762},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets","children":[{"type":"text","value":"List existing rulesets","position":{"start":{"line":16,"column":13,"offset":763},"end":{"line":16,"column":35,"offset":785},"indent":[]}}],"position":{"start":{"line":16,"column":12,"offset":762},"end":{"line":16,"column":127,"offset":877},"indent":[]}},{"type":"text","value":" method to check if there is already a ruleset for the ","position":{"start":{"line":16,"column":127,"offset":877},"end":{"line":16,"column":182,"offset":932},"indent":[]}},{"type":"inlineCode","value":"http_request_transform","position":{"start":{"line":16,"column":182,"offset":932},"end":{"line":16,"column":206,"offset":956},"indent":[]}},{"type":"text","value":" phase at the zone level.","position":{"start":{"line":16,"column":206,"offset":956},"end":{"line":16,"column":231,"offset":981},"indent":[]}}],"position":{"start":{"line":16,"column":4,"offset":754},"end":{"line":16,"column":231,"offset":981},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":751},"end":{"line":17,"column":1,"offset":982},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If the phase ruleset does not exist, create it using the ","position":{"start":{"line":18,"column":4,"offset":986},"end":{"line":18,"column":61,"offset":1043},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create","children":[{"type":"text","value":"Create ruleset","position":{"start":{"line":18,"column":62,"offset":1044},"end":{"line":18,"column":76,"offset":1058},"indent":[]}}],"position":{"start":{"line":18,"column":61,"offset":1043},"end":{"line":18,"column":147,"offset":1129},"indent":[]}},{"type":"text","value":" method with the zone-level endpoint. In the new ruleset properties, set the following values:","position":{"start":{"line":18,"column":147,"offset":1129},"end":{"line":18,"column":241,"offset":1223},"indent":[]}}],"position":{"start":{"line":18,"column":4,"offset":986},"end":{"line":18,"column":241,"offset":1223},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"kind","position":{"start":{"line":20,"column":9,"offset":1233},"end":{"line":20,"column":13,"offset":1237},"indent":[]}}],"position":{"start":{"line":20,"column":7,"offset":1231},"end":{"line":20,"column":15,"offset":1239},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":20,"column":15,"offset":1239},"end":{"line":20,"column":17,"offset":1241},"indent":[]}},{"type":"inlineCode","value":"zone","position":{"start":{"line":20,"column":17,"offset":1241},"end":{"line":20,"column":23,"offset":1247},"indent":[]}}],"position":{"start":{"line":20,"column":7,"offset":1231},"end":{"line":20,"column":23,"offset":1247},"indent":[]}}],"position":{"start":{"line":20,"column":5,"offset":1229},"end":{"line":20,"column":23,"offset":1247},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"phase","position":{"start":{"line":21,"column":9,"offset":1256},"end":{"line":21,"column":14,"offset":1261},"indent":[]}}],"position":{"start":{"line":21,"column":7,"offset":1254},"end":{"line":21,"column":16,"offset":1263},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":21,"column":16,"offset":1263},"end":{"line":21,"column":18,"offset":1265},"indent":[]}},{"type":"inlineCode","value":"http_request_transform","position":{"start":{"line":21,"column":18,"offset":1265},"end":{"line":21,"column":42,"offset":1289},"indent":[]}}],"position":{"start":{"line":21,"column":7,"offset":1254},"end":{"line":21,"column":42,"offset":1289},"indent":[]}}],"position":{"start":{"line":21,"column":5,"offset":1252},"end":{"line":21,"column":42,"offset":1289},"indent":[]}}],"position":{"start":{"line":20,"column":5,"offset":1229},"end":{"line":21,"column":42,"offset":1289},"indent":[5]}}],"position":{"start":{"line":18,"column":1,"offset":983},"end":{"line":22,"column":1,"offset":1290},"indent":[1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":23,"column":4,"offset":1294},"end":{"line":23,"column":12,"offset":1302},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":23,"column":13,"offset":1303},"end":{"line":23,"column":27,"offset":1317},"indent":[]}}],"position":{"start":{"line":23,"column":12,"offset":1302},"end":{"line":23,"column":98,"offset":1388},"indent":[]}},{"type":"text","value":" method to add a URL Rewrite Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the ","position":{"start":{"line":23,"column":98,"offset":1388},"end":{"line":23,"column":228,"offset":1518},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create","children":[{"type":"text","value":"Create ruleset","position":{"start":{"line":23,"column":229,"offset":1519},"end":{"line":23,"column":243,"offset":1533},"indent":[]}}],"position":{"start":{"line":23,"column":228,"offset":1518},"end":{"line":23,"column":314,"offset":1604},"indent":[]}},{"type":"text","value":" request mentioned in the previous step.","position":{"start":{"line":23,"column":314,"offset":1604},"end":{"line":23,"column":354,"offset":1644},"indent":[]}}],"position":{"start":{"line":23,"column":4,"offset":1294},"end":{"line":23,"column":354,"offset":1644},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1291},"end":{"line":23,"column":354,"offset":1644},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":751},"end":{"line":23,"column":354,"offset":1644},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Examples","position":{"start":{"line":25,"column":5,"offset":1650},"end":{"line":25,"column":13,"offset":1658},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1646},"end":{"line":25,"column":13,"offset":1658},"indent":[]}},{"type":"jsx","value":"<details>\n<summary>Example: Add a rule that performs a static URL rewrite</summary>\n<div>","position":{"start":{"line":27,"column":1,"offset":1660},"end":{"line":29,"column":6,"offset":1749},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":31,"column":1,"offset":1751},"end":{"line":31,"column":68,"offset":1818},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":31,"column":68,"offset":1818},"end":{"line":31,"column":82,"offset":1832},"indent":[]}},{"type":"text","value":") to a single URL Rewrite Rule — performing a static rewrite of the URI path — using the ","position":{"start":{"line":31,"column":82,"offset":1832},"end":{"line":31,"column":171,"offset":1921},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":31,"column":172,"offset":1922},"end":{"line":31,"column":186,"offset":1936},"indent":[]}}],"position":{"start":{"line":31,"column":171,"offset":1921},"end":{"line":31,"column":257,"offset":2007},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":31,"column":257,"offset":2007},"end":{"line":31,"column":265,"offset":2015},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1751},"end":{"line":31,"column":265,"offset":2015},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(http.request.uri.query contains \\\"eu\\\")\",\n      \"description\": \"My first static URL Rewrite Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"uri\": {\n          \"path\": {\n            \"value\": \"/emea.html\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":33,"column":1,"offset":2017},"end":{"line":57,"column":4,"offset":2530},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":59,"column":1,"offset":2532},"end":{"line":59,"column":74,"offset":2605},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":2532},"end":{"line":59,"column":74,"offset":2605},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"uri\": {\n            \"path\": {\n              \"value\": \"/emea.html\"\n            }\n          }\n        },\n        \"expression\": \"(http.request.uri.query contains \\\"eu\\\")\",\n        \"description\": \"My first static URL Rewrite Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":61,"column":1,"offset":2607},"end":{"line":97,"column":4,"offset":3464},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":99,"column":1,"offset":3466},"end":{"line":100,"column":11,"offset":3483},"indent":[1]}},{"type":"jsx","value":"<details>\n<summary>Example: Add a rule that performs a dynamic URL rewrite</summary>\n<div>","position":{"start":{"line":102,"column":1,"offset":3485},"end":{"line":104,"column":6,"offset":3575},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":106,"column":1,"offset":3577},"end":{"line":106,"column":68,"offset":3644},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":106,"column":68,"offset":3644},"end":{"line":106,"column":82,"offset":3658},"indent":[]}},{"type":"text","value":") to a single URL Rewrite Rule — performing a dynamic rewrite of the URI path — using the ","position":{"start":{"line":106,"column":82,"offset":3658},"end":{"line":106,"column":172,"offset":3748},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":106,"column":173,"offset":3749},"end":{"line":106,"column":187,"offset":3763},"indent":[]}}],"position":{"start":{"line":106,"column":172,"offset":3748},"end":{"line":106,"column":258,"offset":3834},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":106,"column":258,"offset":3834},"end":{"line":106,"column":266,"offset":3842},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":3577},"end":{"line":106,"column":266,"offset":3842},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"starts_with(http.request.uri.path, \\\"/news/2012/\\\")\",\n      \"description\": \"My first dynamic URL Rewrite Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"uri\": {\n          \"path\": {\n            \"expression\": \"concat(\\\"/archive\\\", http.request.uri.path)\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":108,"column":1,"offset":3844},"end":{"line":132,"column":4,"offset":4407},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":134,"column":1,"offset":4409},"end":{"line":134,"column":74,"offset":4482},"indent":[]}}],"position":{"start":{"line":134,"column":1,"offset":4409},"end":{"line":134,"column":74,"offset":4482},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"uri\": {\n            \"path\": {\n              \"expression\": \"concat(\\\"/archive\\\", http.request.uri.path)\"\n            }\n          }\n        },\n        \"expression\": \"starts_with(http.request.uri.path, \\\"/news/2012/\\\")\",\n        \"description\": \"My first dynamic URL Rewrite Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":136,"column":1,"offset":4484},"end":{"line":172,"column":4,"offset":5391},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":174,"column":1,"offset":5393},"end":{"line":175,"column":11,"offset":5410},"indent":[1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Create a rule via API\",\"pcx-content-type\":\"how-to\",\"type\":\"overview\",\"order\":2}","position":{"start":{"line":178,"column":1,"offset":5413},"end":{"line":178,"column":118,"offset":5530},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":178,"column":118,"offset":5530}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Create a rule via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"type\": \"overview\",\n  \"order\": 2\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"create-a-url-rewrite-rule-via-api\"\n  }, \"Create a URL Rewrite Rule via API\"), mdx(\"p\", null, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \" to create URL Rewrite Rules via API. Define the rewrite configuration in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \" field. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/transform/url-rewrite/examples\"\n  }, \"URL rewrite examples\"), \" for examples of rule definitions.\"), mdx(\"p\", null, \"When creating a URL Rewrite Rule via API, make sure you:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Set the rule action to \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"rewrite\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Define the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/transform/url-rewrite/reference/parameters\"\n  }, \"URL rewrite parameters\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"action_parameters\"), \" field according to the type of URL rewrite (static or dynamic)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Deploy the rule to the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_request_transform\"), \" phase at the zone level\")), mdx(\"hr\", null), mdx(\"p\", null, \"Follow this workflow to create a URL Rewrite Rule for a given zone via API:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n  }, \"List existing rulesets\"), \" method to check if there is already a ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_transform\"), \" phase at the zone level.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"If the phase ruleset does not exist, create it using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"Create ruleset\"), \" method with the zone-level endpoint. In the new ruleset properties, set the following values:\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"kind\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"zone\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"phase\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_request_transform\")))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method to add a URL Rewrite Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"Create ruleset\"), \" request mentioned in the previous step.\"))), mdx(\"h3\", {\n    \"id\": \"examples\"\n  }, \"Examples\"), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Add a rule that performs a static URL rewrite\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single URL Rewrite Rule \\u2014 performing a static rewrite of the URI path \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(http.request.uri.query contains \\\\\\\"eu\\\\\\\")\\\",\\n      \\\"description\\\": \\\"My first static URL Rewrite Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"uri\\\": {\\n          \\\"path\\\": {\\n            \\\"value\\\": \\\"/emea.html\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Transform Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"uri\\\": {\\n            \\\"path\\\": {\\n              \\\"value\\\": \\\"/emea.html\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(http.request.uri.query contains \\\\\\\"eu\\\\\\\")\\\",\\n        \\\"description\\\": \\\"My first static URL Rewrite Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_request_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Add a rule that performs a dynamic URL rewrite\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single URL Rewrite Rule \\u2014 performing a dynamic rewrite of the URI path \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"starts_with(http.request.uri.path, \\\\\\\"/news/2012/\\\\\\\")\\\",\\n      \\\"description\\\": \\\"My first dynamic URL Rewrite Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"uri\\\": {\\n          \\\"path\\\": {\\n            \\\"expression\\\": \\\"concat(\\\\\\\"/archive\\\\\\\", http.request.uri.path)\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Transform Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"uri\\\": {\\n            \\\"path\\\": {\\n              \\\"expression\\\": \\\"concat(\\\\\\\"/archive\\\\\\\", http.request.uri.path)\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"starts_with(http.request.uri.path, \\\\\\\"/news/2012/\\\\\\\")\\\",\\n        \\\"description\\\": \\\"My first dynamic URL Rewrite Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_request_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Create a rule via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"type\": \"overview\",\n  \"order\": 2\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"create-a-url-rewrite-rule-via-api\"\n    }}>{`Create a URL Rewrite Rule via API`}</h1>\n    <p>{`Use the `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n      }}>{`Rulesets API`}</a>{` to create URL Rewrite Rules via API. Define the rewrite configuration in the `}<inlineCode parentName=\"p\">{`action_parameters`}</inlineCode>{` field. Refer to `}<a parentName=\"p\" {...{\n        \"href\": \"/transform/url-rewrite/examples\"\n      }}>{`URL rewrite examples`}</a>{` for examples of rule definitions.`}</p>\n    <p>{`When creating a URL Rewrite Rule via API, make sure you:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Set the rule action to `}<inlineCode parentName=\"li\">{`rewrite`}</inlineCode></li>\n      <li parentName=\"ul\">{`Define the `}<a parentName=\"li\" {...{\n          \"href\": \"/transform/url-rewrite/reference/parameters\"\n        }}>{`URL rewrite parameters`}</a>{` in the `}<inlineCode parentName=\"li\">{`action_parameters`}</inlineCode>{` field according to the type of URL rewrite (static or dynamic)`}</li>\n      <li parentName=\"ul\">{`Deploy the rule to the `}<inlineCode parentName=\"li\">{`http_request_transform`}</inlineCode>{` phase at the zone level`}</li>\n    </ul>\n    <hr></hr>\n    <p>{`Follow this workflow to create a URL Rewrite Rule for a given zone via API:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n          }}>{`List existing rulesets`}</a>{` method to check if there is already a ruleset for the `}<inlineCode parentName=\"p\">{`http_request_transform`}</inlineCode>{` phase at the zone level.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`If the phase ruleset does not exist, create it using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n          }}>{`Create ruleset`}</a>{` method with the zone-level endpoint. In the new ruleset properties, set the following values:`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><strong parentName=\"li\">{`kind`}</strong>{`: `}<inlineCode parentName=\"li\">{`zone`}</inlineCode></li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`phase`}</strong>{`: `}<inlineCode parentName=\"li\">{`http_request_transform`}</inlineCode></li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method to add a URL Rewrite Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n          }}>{`Create ruleset`}</a>{` request mentioned in the previous step.`}</p>\n      </li>\n    </ol>\n    <h3 {...{\n      \"id\": \"examples\"\n    }}>{`Examples`}</h3>\n    <details>\n      <summary>Example: Add a rule that performs a static URL rewrite</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single URL Rewrite Rule — performing a static rewrite of the URI path — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(http.request.uri.query contains \\\\\"eu\\\\\")\",\n      \"description\": \"My first static URL Rewrite Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"uri\": {\n          \"path\": {\n            \"value\": \"/emea.html\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"uri\": {\n            \"path\": {\n              \"value\": \"/emea.html\"\n            }\n          }\n        },\n        \"expression\": \"(http.request.uri.query contains \\\\\"eu\\\\\")\",\n        \"description\": \"My first static URL Rewrite Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n    <details>\n      <summary>Example: Add a rule that performs a dynamic URL rewrite</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single URL Rewrite Rule — performing a dynamic rewrite of the URI path — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"starts_with(http.request.uri.path, \\\\\"/news/2012/\\\\\")\",\n      \"description\": \"My first dynamic URL Rewrite Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"uri\": {\n          \"path\": {\n            \"expression\": \"concat(\\\\\"/archive\\\\\", http.request.uri.path)\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"uri\": {\n            \"path\": {\n              \"expression\": \"concat(\\\\\"/archive\\\\\", http.request.uri.path)\"\n            }\n          }\n        },\n        \"expression\": \"starts_with(http.request.uri.path, \\\\\"/news/2012/\\\\\")\",\n        \"description\": \"My first dynamic URL Rewrite Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}