{"expireTime":9007200897961981000,"key":"gatsby-plugin-mdx-entire-payload-69c7e5e1d760d4f07aa2713cd14a7e9e-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Create an HTTP Request Header Modification Rule via API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":58,"offset":58},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":58,"offset":58},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":4,"column":1,"offset":60},"end":{"line":4,"column":9,"offset":68},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api","children":[{"type":"text","value":"Rulesets API","position":{"start":{"line":4,"column":10,"offset":69},"end":{"line":4,"column":22,"offset":81},"indent":[]}}],"position":{"start":{"line":4,"column":9,"offset":68},"end":{"line":4,"column":86,"offset":145},"indent":[]}},{"type":"text","value":" to create HTTP Request Header Modification Rules via API. Define the header modification configuration in the ","position":{"start":{"line":4,"column":86,"offset":145},"end":{"line":4,"column":197,"offset":256},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":4,"column":197,"offset":256},"end":{"line":4,"column":216,"offset":275},"indent":[]}},{"type":"text","value":" field. Refer to ","position":{"start":{"line":4,"column":216,"offset":275},"end":{"line":4,"column":233,"offset":292},"indent":[]}},{"type":"link","title":null,"url":"/transform/request-header-modification/examples","children":[{"type":"text","value":"Request header modification examples","position":{"start":{"line":4,"column":234,"offset":293},"end":{"line":4,"column":270,"offset":329},"indent":[]}}],"position":{"start":{"line":4,"column":233,"offset":292},"end":{"line":4,"column":320,"offset":379},"indent":[]}},{"type":"text","value":" for examples of rule definitions.","position":{"start":{"line":4,"column":320,"offset":379},"end":{"line":4,"column":354,"offset":413},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":60},"end":{"line":4,"column":354,"offset":413},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When creating an HTTP Request Header Modification Rule via API, make sure you:","position":{"start":{"line":6,"column":1,"offset":415},"end":{"line":6,"column":79,"offset":493},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":415},"end":{"line":6,"column":79,"offset":493},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Set the rule action to ","position":{"start":{"line":8,"column":3,"offset":497},"end":{"line":8,"column":26,"offset":520},"indent":[]}},{"type":"inlineCode","value":"rewrite","position":{"start":{"line":8,"column":26,"offset":520},"end":{"line":8,"column":35,"offset":529},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":8,"column":35,"offset":529},"end":{"line":8,"column":36,"offset":530},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":497},"end":{"line":8,"column":36,"offset":530},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":495},"end":{"line":8,"column":36,"offset":530},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Define the ","position":{"start":{"line":9,"column":3,"offset":533},"end":{"line":9,"column":14,"offset":544},"indent":[]}},{"type":"link","title":null,"url":"/transform/request-header-modification/reference/parameters","children":[{"type":"text","value":"header modification parameters","position":{"start":{"line":9,"column":15,"offset":545},"end":{"line":9,"column":45,"offset":575},"indent":[]}}],"position":{"start":{"line":9,"column":14,"offset":544},"end":{"line":9,"column":107,"offset":637},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":9,"column":107,"offset":637},"end":{"line":9,"column":115,"offset":645},"indent":[]}},{"type":"inlineCode","value":"action_parameters","position":{"start":{"line":9,"column":115,"offset":645},"end":{"line":9,"column":134,"offset":664},"indent":[]}},{"type":"text","value":" field according to the operation to perform (set or remove header).","position":{"start":{"line":9,"column":134,"offset":664},"end":{"line":9,"column":202,"offset":732},"indent":[]}}],"position":{"start":{"line":9,"column":3,"offset":533},"end":{"line":9,"column":202,"offset":732},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":531},"end":{"line":9,"column":202,"offset":732},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Deploy the rule to the ","position":{"start":{"line":10,"column":3,"offset":735},"end":{"line":10,"column":26,"offset":758},"indent":[]}},{"type":"inlineCode","value":"http_request_late_transform","position":{"start":{"line":10,"column":26,"offset":758},"end":{"line":10,"column":55,"offset":787},"indent":[]}},{"type":"text","value":" phase at the zone level.","position":{"start":{"line":10,"column":55,"offset":787},"end":{"line":10,"column":80,"offset":812},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":735},"end":{"line":10,"column":80,"offset":812},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":733},"end":{"line":10,"column":80,"offset":812},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":495},"end":{"line":10,"column":80,"offset":812},"indent":[1,1]}},{"type":"thematicBreak","position":{"start":{"line":12,"column":1,"offset":814},"end":{"line":12,"column":4,"offset":817},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Follow this workflow to create an HTTP Request Header Modification Rule for a given zone via API:","position":{"start":{"line":14,"column":1,"offset":819},"end":{"line":14,"column":98,"offset":916},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":819},"end":{"line":14,"column":98,"offset":916},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":16,"column":4,"offset":921},"end":{"line":16,"column":12,"offset":929},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets","children":[{"type":"text","value":"List existing rulesets","position":{"start":{"line":16,"column":13,"offset":930},"end":{"line":16,"column":35,"offset":952},"indent":[]}}],"position":{"start":{"line":16,"column":12,"offset":929},"end":{"line":16,"column":127,"offset":1044},"indent":[]}},{"type":"text","value":" method to check if there is already a ruleset for the ","position":{"start":{"line":16,"column":127,"offset":1044},"end":{"line":16,"column":182,"offset":1099},"indent":[]}},{"type":"inlineCode","value":"http_request_late_transform","position":{"start":{"line":16,"column":182,"offset":1099},"end":{"line":16,"column":211,"offset":1128},"indent":[]}},{"type":"text","value":" phase at the zone level.","position":{"start":{"line":16,"column":211,"offset":1128},"end":{"line":16,"column":236,"offset":1153},"indent":[]}}],"position":{"start":{"line":16,"column":4,"offset":921},"end":{"line":16,"column":236,"offset":1153},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":918},"end":{"line":17,"column":1,"offset":1154},"indent":[1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If the phase ruleset does not exist, create it using the ","position":{"start":{"line":18,"column":4,"offset":1158},"end":{"line":18,"column":61,"offset":1215},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create","children":[{"type":"text","value":"Create ruleset","position":{"start":{"line":18,"column":62,"offset":1216},"end":{"line":18,"column":76,"offset":1230},"indent":[]}}],"position":{"start":{"line":18,"column":61,"offset":1215},"end":{"line":18,"column":147,"offset":1301},"indent":[]}},{"type":"text","value":" method with the zone-level endpoint. In the new ruleset properties, set the following values:","position":{"start":{"line":18,"column":147,"offset":1301},"end":{"line":18,"column":241,"offset":1395},"indent":[]}}],"position":{"start":{"line":18,"column":4,"offset":1158},"end":{"line":18,"column":241,"offset":1395},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"kind","position":{"start":{"line":20,"column":9,"offset":1405},"end":{"line":20,"column":13,"offset":1409},"indent":[]}}],"position":{"start":{"line":20,"column":7,"offset":1403},"end":{"line":20,"column":15,"offset":1411},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":20,"column":15,"offset":1411},"end":{"line":20,"column":17,"offset":1413},"indent":[]}},{"type":"inlineCode","value":"zone","position":{"start":{"line":20,"column":17,"offset":1413},"end":{"line":20,"column":23,"offset":1419},"indent":[]}}],"position":{"start":{"line":20,"column":7,"offset":1403},"end":{"line":20,"column":23,"offset":1419},"indent":[]}}],"position":{"start":{"line":20,"column":5,"offset":1401},"end":{"line":20,"column":23,"offset":1419},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"phase","position":{"start":{"line":21,"column":9,"offset":1428},"end":{"line":21,"column":14,"offset":1433},"indent":[]}}],"position":{"start":{"line":21,"column":7,"offset":1426},"end":{"line":21,"column":16,"offset":1435},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":21,"column":16,"offset":1435},"end":{"line":21,"column":18,"offset":1437},"indent":[]}},{"type":"inlineCode","value":"http_request_late_transform","position":{"start":{"line":21,"column":18,"offset":1437},"end":{"line":21,"column":47,"offset":1466},"indent":[]}}],"position":{"start":{"line":21,"column":7,"offset":1426},"end":{"line":21,"column":47,"offset":1466},"indent":[]}}],"position":{"start":{"line":21,"column":5,"offset":1424},"end":{"line":21,"column":47,"offset":1466},"indent":[]}}],"position":{"start":{"line":20,"column":5,"offset":1401},"end":{"line":21,"column":47,"offset":1466},"indent":[5]}}],"position":{"start":{"line":18,"column":1,"offset":1155},"end":{"line":22,"column":1,"offset":1467},"indent":[1,1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":23,"column":4,"offset":1471},"end":{"line":23,"column":12,"offset":1479},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":23,"column":13,"offset":1480},"end":{"line":23,"column":27,"offset":1494},"indent":[]}}],"position":{"start":{"line":23,"column":12,"offset":1479},"end":{"line":23,"column":98,"offset":1565},"indent":[]}},{"type":"text","value":" method to add an HTTP Request Header Modification Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the ","position":{"start":{"line":23,"column":98,"offset":1565},"end":{"line":23,"column":250,"offset":1717},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create","children":[{"type":"text","value":"Create ruleset","position":{"start":{"line":23,"column":251,"offset":1718},"end":{"line":23,"column":265,"offset":1732},"indent":[]}}],"position":{"start":{"line":23,"column":250,"offset":1717},"end":{"line":23,"column":336,"offset":1803},"indent":[]}},{"type":"text","value":" request mentioned in the previous step.","position":{"start":{"line":23,"column":336,"offset":1803},"end":{"line":23,"column":376,"offset":1843},"indent":[]}}],"position":{"start":{"line":23,"column":4,"offset":1471},"end":{"line":23,"column":376,"offset":1843},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1468},"end":{"line":23,"column":376,"offset":1843},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":918},"end":{"line":23,"column":376,"offset":1843},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Examples","position":{"start":{"line":25,"column":5,"offset":1849},"end":{"line":25,"column":13,"offset":1857},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1845},"end":{"line":25,"column":13,"offset":1857},"indent":[]}},{"type":"jsx","value":"<details>\n<summary>Example: Add an HTTP request header with a static value</summary>\n<div>","position":{"start":{"line":27,"column":1,"offset":1859},"end":{"line":29,"column":6,"offset":1949},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":31,"column":1,"offset":1951},"end":{"line":31,"column":68,"offset":2018},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":31,"column":68,"offset":2018},"end":{"line":31,"column":82,"offset":2032},"indent":[]}},{"type":"text","value":") to a single HTTP Request Header Modification Rule — adding an HTTP request header with a static value — using the ","position":{"start":{"line":31,"column":82,"offset":2032},"end":{"line":31,"column":198,"offset":2148},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":31,"column":199,"offset":2149},"end":{"line":31,"column":213,"offset":2163},"indent":[]}}],"position":{"start":{"line":31,"column":198,"offset":2148},"end":{"line":31,"column":284,"offset":2234},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":31,"column":284,"offset":2234},"end":{"line":31,"column":292,"offset":2242},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1951},"end":{"line":31,"column":292,"offset":2242},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n      \"description\": \"My first HTTP Request Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Source\": {\n            \"operation\": \"set\",\n            \"value\": \"Cloudflare\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":33,"column":1,"offset":2244},"end":{"line":58,"column":4,"offset":2817},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":60,"column":1,"offset":2819},"end":{"line":60,"column":74,"offset":2892},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2819},"end":{"line":60,"column":74,"offset":2892},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Late Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Late Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Source\": {\n              \"operation\": \"set\",\n              \"value\": \"Cloudflare\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n        \"description\": \"My first HTTP Request Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_late_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":62,"column":1,"offset":2894},"end":{"line":99,"column":4,"offset":3828},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":101,"column":1,"offset":3830},"end":{"line":102,"column":11,"offset":3847},"indent":[1]}},{"type":"jsx","value":"<details>\n<summary>Example: Add an HTTP request header with a dynamic value</summary>\n<div>","position":{"start":{"line":104,"column":1,"offset":3849},"end":{"line":106,"column":6,"offset":3940},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":108,"column":1,"offset":3942},"end":{"line":108,"column":68,"offset":4009},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":108,"column":68,"offset":4009},"end":{"line":108,"column":82,"offset":4023},"indent":[]}},{"type":"text","value":") to a single HTTP Request Header Modification Rule — adding an HTTP request header with a dynamic value — using the ","position":{"start":{"line":108,"column":82,"offset":4023},"end":{"line":108,"column":199,"offset":4140},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":108,"column":200,"offset":4141},"end":{"line":108,"column":214,"offset":4155},"indent":[]}}],"position":{"start":{"line":108,"column":199,"offset":4140},"end":{"line":108,"column":285,"offset":4226},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":108,"column":285,"offset":4226},"end":{"line":108,"column":293,"offset":4234},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3942},"end":{"line":108,"column":293,"offset":4234},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n      \"description\": \"My first HTTP Request Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Bot-Score\": {\n            \"operation\": \"set\",\n            \"expression\": \"to_string(cf.bot_management.score)\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":110,"column":1,"offset":4236},"end":{"line":135,"column":4,"offset":4841},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":137,"column":1,"offset":4843},"end":{"line":137,"column":74,"offset":4916},"indent":[]}}],"position":{"start":{"line":137,"column":1,"offset":4843},"end":{"line":137,"column":74,"offset":4916},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Late Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Late Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Bot-Score\": {\n              \"operation\": \"set\",\n              \"expression\": \"to_string(cf.bot_management.score)\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n        \"description\": \"My first HTTP Request Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_late_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":139,"column":1,"offset":4918},"end":{"line":176,"column":4,"offset":5884},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":178,"column":1,"offset":5886},"end":{"line":179,"column":11,"offset":5903},"indent":[1]}},{"type":"jsx","value":"<details>\n<summary>Example: Remove an HTTP request header</summary>\n<div>","position":{"start":{"line":181,"column":1,"offset":5905},"end":{"line":183,"column":6,"offset":5978},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following example sets the rules of an existing phase ruleset (","position":{"start":{"line":185,"column":1,"offset":5980},"end":{"line":185,"column":68,"offset":6047},"indent":[]}},{"type":"inlineCode","value":"{ruleset-id}","position":{"start":{"line":185,"column":68,"offset":6047},"end":{"line":185,"column":82,"offset":6061},"indent":[]}},{"type":"text","value":") to a single HTTP Request Header Modification Rule — removing an HTTP request header — using the ","position":{"start":{"line":185,"column":82,"offset":6061},"end":{"line":185,"column":180,"offset":6159},"indent":[]}},{"type":"link","title":null,"url":"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update","children":[{"type":"text","value":"Update ruleset","position":{"start":{"line":185,"column":181,"offset":6160},"end":{"line":185,"column":195,"offset":6174},"indent":[]}}],"position":{"start":{"line":185,"column":180,"offset":6159},"end":{"line":185,"column":266,"offset":6245},"indent":[]}},{"type":"text","value":" method:","position":{"start":{"line":185,"column":266,"offset":6245},"end":{"line":185,"column":274,"offset":6253},"indent":[]}}],"position":{"start":{"line":185,"column":1,"offset":5980},"end":{"line":185,"column":274,"offset":6253},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Request\n---\ncurl -X PUT \\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\n-H \"X-Auth-Key: REDACTED\" \\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n      \"description\": \"My first HTTP Request Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"cf-connecting-ip\": {\n            \"operation\": \"remove\"\n          }\n        }\n      }\n    }\n  ]\n}'","position":{"start":{"line":187,"column":1,"offset":6255},"end":{"line":211,"column":4,"offset":6804},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The response contains the complete definition of the ruleset you updated.","position":{"start":{"line":213,"column":1,"offset":6806},"end":{"line":213,"column":74,"offset":6879},"indent":[]}}],"position":{"start":{"line":213,"column":1,"offset":6806},"end":{"line":213,"column":74,"offset":6879},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Late Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Late Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"cf-connecting-ip\": {\n              \"operation\": \"remove\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\"/en/\\\"))\",\n        \"description\": \"My first HTTP Request Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_late_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}","position":{"start":{"line":215,"column":1,"offset":6881},"end":{"line":251,"column":4,"offset":7789},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"jsx","value":"</div>\n</details>","position":{"start":{"line":253,"column":1,"offset":7791},"end":{"line":254,"column":11,"offset":7808},"indent":[1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Create a rule via API\",\"pcx-content-type\":\"how-to\",\"type\":\"overview\",\"order\":2}","position":{"start":{"line":257,"column":1,"offset":7811},"end":{"line":257,"column":118,"offset":7928},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":257,"column":118,"offset":7928}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Create a rule via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"type\": \"overview\",\n  \"order\": 2\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"create-an-http-request-header-modification-rule-via-api\"\n  }, \"Create an HTTP Request Header Modification Rule via API\"), mdx(\"p\", null, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \" to create HTTP Request Header Modification Rules via API. Define the header modification configuration in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"action_parameters\"), \" field. Refer to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/transform/request-header-modification/examples\"\n  }, \"Request header modification examples\"), \" for examples of rule definitions.\"), mdx(\"p\", null, \"When creating an HTTP Request Header Modification Rule via API, make sure you:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Set the rule action to \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"rewrite\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Define the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/transform/request-header-modification/reference/parameters\"\n  }, \"header modification parameters\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"action_parameters\"), \" field according to the operation to perform (set or remove header).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Deploy the rule to the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_request_late_transform\"), \" phase at the zone level.\")), mdx(\"hr\", null), mdx(\"p\", null, \"Follow this workflow to create an HTTP Request Header Modification Rule for a given zone via API:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n  }, \"List existing rulesets\"), \" method to check if there is already a ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_late_transform\"), \" phase at the zone level.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"If the phase ruleset does not exist, create it using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"Create ruleset\"), \" method with the zone-level endpoint. In the new ruleset properties, set the following values:\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"kind\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"zone\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"phase\"), \": \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http_request_late_transform\")))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method to add an HTTP Request Header Modification Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"Create ruleset\"), \" request mentioned in the previous step.\"))), mdx(\"h3\", {\n    \"id\": \"examples\"\n  }, \"Examples\"), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Add an HTTP request header with a static value\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single HTTP Request Header Modification Rule \\u2014 adding an HTTP request header with a static value \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n      \\\"description\\\": \\\"My first HTTP Request Header Modification Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"headers\\\": {\\n          \\\"X-Source\\\": {\\n            \\\"operation\\\": \\\"set\\\",\\n            \\\"value\\\": \\\"Cloudflare\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Late Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Late Transform Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"headers\\\": {\\n            \\\"X-Source\\\": {\\n              \\\"operation\\\": \\\"set\\\",\\n              \\\"value\\\": \\\"Cloudflare\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n        \\\"description\\\": \\\"My first HTTP Request Header Modification Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_request_late_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Add an HTTP request header with a dynamic value\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single HTTP Request Header Modification Rule \\u2014 adding an HTTP request header with a dynamic value \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n      \\\"description\\\": \\\"My first HTTP Request Header Modification Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"headers\\\": {\\n          \\\"X-Bot-Score\\\": {\\n            \\\"operation\\\": \\\"set\\\",\\n            \\\"expression\\\": \\\"to_string(cf.bot_management.score)\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Late Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Late Transform Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"headers\\\": {\\n            \\\"X-Bot-Score\\\": {\\n              \\\"operation\\\": \\\"set\\\",\\n              \\\"expression\\\": \\\"to_string(cf.bot_management.score)\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n        \\\"description\\\": \\\"My first HTTP Request Header Modification Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_request_late_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))), mdx(\"details\", null, mdx(\"summary\", null, \"Example: Remove an HTTP request header\"), mdx(\"div\", null, mdx(\"p\", null, \"The following example sets the rules of an existing phase ruleset (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ruleset-id}\"), \") to a single HTTP Request Header Modification Rule \\u2014 removing an HTTP request header \\u2014 using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n  }, \"Update ruleset\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Request\\n---\\ncurl -X PUT \\\\\\n-H \\\"X-Auth-Email: user@cloudflare.com\\\" \\\\\\n-H \\\"X-Auth-Key: REDACTED\\\" \\\\\\n\\\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\\\" \\\\\\n-d '{\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n      \\\"description\\\": \\\"My first HTTP Request Header Modification Rule\\\",\\n      \\\"action\\\": \\\"rewrite\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"headers\\\": {\\n          \\\"cf-connecting-ip\\\": {\\n            \\\"operation\\\": \\\"remove\\\"\\n          }\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response contains the complete definition of the ruleset you updated.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"---\\nheader: Response\\n---\\n{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"{ruleset-id}\\\",\\n    \\\"name\\\": \\\"Zone-level Late Transform Ruleset\\\",\\n    \\\"description\\\": \\\"Zone-level ruleset that will execute Late Transform Rules.\\\",\\n    \\\"kind\\\": \\\"zone\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"{rule-id}\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"rewrite\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"headers\\\": {\\n            \\\"cf-connecting-ip\\\": {\\n              \\\"operation\\\": \\\"remove\\\"\\n            }\\n          }\\n        },\\n        \\\"expression\\\": \\\"(starts_with(http.request.uri.path, \\\\\\\"/en/\\\\\\\"))\\\",\\n        \\\"description\\\": \\\"My first HTTP Request Header Modification Rule\\\",\\n        \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n        \\\"ref\\\": \\\"{rule-ref}\\\"\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-04-14T14:42:04.219025Z\\\",\\n    \\\"phase\\\": \\\"http_request_late_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")))));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Create a rule via API\",\n  \"pcx-content-type\": \"how-to\",\n  \"type\": \"overview\",\n  \"order\": 2\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"create-an-http-request-header-modification-rule-via-api\"\n    }}>{`Create an HTTP Request Header Modification Rule via API`}</h1>\n    <p>{`Use the `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n      }}>{`Rulesets API`}</a>{` to create HTTP Request Header Modification Rules via API. Define the header modification configuration in the `}<inlineCode parentName=\"p\">{`action_parameters`}</inlineCode>{` field. Refer to `}<a parentName=\"p\" {...{\n        \"href\": \"/transform/request-header-modification/examples\"\n      }}>{`Request header modification examples`}</a>{` for examples of rule definitions.`}</p>\n    <p>{`When creating an HTTP Request Header Modification Rule via API, make sure you:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Set the rule action to `}<inlineCode parentName=\"li\">{`rewrite`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`Define the `}<a parentName=\"li\" {...{\n          \"href\": \"/transform/request-header-modification/reference/parameters\"\n        }}>{`header modification parameters`}</a>{` in the `}<inlineCode parentName=\"li\">{`action_parameters`}</inlineCode>{` field according to the operation to perform (set or remove header).`}</li>\n      <li parentName=\"ul\">{`Deploy the rule to the `}<inlineCode parentName=\"li\">{`http_request_late_transform`}</inlineCode>{` phase at the zone level.`}</li>\n    </ul>\n    <hr></hr>\n    <p>{`Follow this workflow to create an HTTP Request Header Modification Rule for a given zone via API:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/view#list-existing-rulesets\"\n          }}>{`List existing rulesets`}</a>{` method to check if there is already a ruleset for the `}<inlineCode parentName=\"p\">{`http_request_late_transform`}</inlineCode>{` phase at the zone level.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`If the phase ruleset does not exist, create it using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n          }}>{`Create ruleset`}</a>{` method with the zone-level endpoint. In the new ruleset properties, set the following values:`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><strong parentName=\"li\">{`kind`}</strong>{`: `}<inlineCode parentName=\"li\">{`zone`}</inlineCode></li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`phase`}</strong>{`: `}<inlineCode parentName=\"li\">{`http_request_late_transform`}</inlineCode></li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method to add an HTTP Request Header Modification Rule to the list of ruleset rules (check the examples below). Alternatively, include the rule in the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n          }}>{`Create ruleset`}</a>{` request mentioned in the previous step.`}</p>\n      </li>\n    </ol>\n    <h3 {...{\n      \"id\": \"examples\"\n    }}>{`Examples`}</h3>\n    <details>\n      <summary>Example: Add an HTTP request header with a static value</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single HTTP Request Header Modification Rule — adding an HTTP request header with a static value — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n      \"description\": \"My first HTTP Request Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Source\": {\n            \"operation\": \"set\",\n            \"value\": \"Cloudflare\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Late Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Late Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Source\": {\n              \"operation\": \"set\",\n              \"value\": \"Cloudflare\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n        \"description\": \"My first HTTP Request Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_late_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n    <details>\n      <summary>Example: Add an HTTP request header with a dynamic value</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single HTTP Request Header Modification Rule — adding an HTTP request header with a dynamic value — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n      \"description\": \"My first HTTP Request Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"X-Bot-Score\": {\n            \"operation\": \"set\",\n            \"expression\": \"to_string(cf.bot_management.score)\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Late Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Late Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"X-Bot-Score\": {\n              \"operation\": \"set\",\n              \"expression\": \"to_string(cf.bot_management.score)\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n        \"description\": \"My first HTTP Request Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_late_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n    <details>\n      <summary>Example: Remove an HTTP request header</summary>\n      <div>\n        <p>{`The following example sets the rules of an existing phase ruleset (`}<inlineCode parentName=\"p\">{`{ruleset-id}`}</inlineCode>{`) to a single HTTP Request Header Modification Rule — removing an HTTP request header — using the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/update\"\n          }}>{`Update ruleset`}</a>{` method:`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Request\n---\ncurl -X PUT \\\\\n-H \"X-Auth-Email: user@cloudflare.com\" \\\\\n-H \"X-Auth-Key: REDACTED\" \\\\\n\"https://api.cloudflare.com/client/v4/zones/{zone-id}/rulesets/{ruleset-id}\" \\\\\n-d '{\n  \"rules\": [\n    {\n      \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n      \"description\": \"My first HTTP Request Header Modification Rule\",\n      \"action\": \"rewrite\",\n      \"action_parameters\": {\n        \"headers\": {\n          \"cf-connecting-ip\": {\n            \"operation\": \"remove\"\n          }\n        }\n      }\n    }\n  ]\n}'\n`}</code></pre>\n        <p>{`The response contains the complete definition of the ruleset you updated.`}</p>\n        <pre><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`---\nheader: Response\n---\n{\n  \"result\": {\n    \"id\": \"{ruleset-id}\",\n    \"name\": \"Zone-level Late Transform Ruleset\",\n    \"description\": \"Zone-level ruleset that will execute Late Transform Rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"{rule-id}\",\n        \"version\": \"1\",\n        \"action\": \"rewrite\",\n        \"action_parameters\": {\n          \"headers\": {\n            \"cf-connecting-ip\": {\n              \"operation\": \"remove\"\n            }\n          }\n        },\n        \"expression\": \"(starts_with(http.request.uri.path, \\\\\"/en/\\\\\"))\",\n        \"description\": \"My first HTTP Request Header Modification Rule\",\n        \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n        \"ref\": \"{rule-ref}\"\n      }\n    ],\n    \"last_updated\": \"2021-04-14T14:42:04.219025Z\",\n    \"phase\": \"http_request_late_transform\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n`}</code></pre>\n      </div>\n    </details>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}