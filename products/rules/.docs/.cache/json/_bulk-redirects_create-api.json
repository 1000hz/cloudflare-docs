{"data":{"mdx":{"id":"27b4691f-5afb-552b-81c4-b4d1b54ba75e","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"order\": 6,\n  \"pcx-content-type\": \"how-to\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"create-bulk-redirects-via-api\"\n  }, \"Create Bulk Redirects via API\"), mdx(\"p\", null, \"To create Bulk Redirects via API, you must:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a Bulk Redirect List via API.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Add items (URL Redirects) to the list created in step 1.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a Bulk Redirect Rule via API, which enables the list created in step 1.\")), mdx(\"h2\", {\n    \"id\": \"1-create-a-bulk-redirect-list-via-api\"\n  }, \"1. Create a Bulk Redirect List via API\"), mdx(\"p\", null, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/#rules-lists-create-list\"\n  }, \"Create list\"), \" operation to create a new Bulk Redirect List. The list \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kind\"), \" must be \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"redirect\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"curl -X POST \\\\\\n\\\"https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/rules/lists\\\" \\\\\\n-H \\\"X-Auth-Email: <EMAIL>\\\" \\\\\\n-H \\\"X-Auth-Key: <KEY>\\\" \\\\\\n-d '{\\n  \\\"name\\\": \\\"my_redirect_list\\\",\\n  \\\"description\\\": \\\"My redirect list.\\\",\\n  \\\"kind\\\": \\\"redirect\\\"\\n}'\\n\")), mdx(\"p\", null, \"The response will be similar to the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"f848b6ccb07647749411f504d6f88794\\\",\\n    \\\"name\\\": \\\"my_redirect_list\\\",\\n    \\\"description\\\": \\\"My redirect list.\\\",\\n    \\\"kind\\\": \\\"redirect\\\",\\n    \\\"num_items\\\": 0,\\n    \\\"num_referencing_filters\\\": 0,\\n    \\\"created_on\\\": \\\"2021-10-28T09:11:42Z\\\",\\n    \\\"modified_on\\\": \\\"2021-10-28T09:11:42Z\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"p\", null, \"For more information on list operations, refer to the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/firewall/api/cf-lists\"\n  }, \"Rules Lists API\"), \" documentation.\"), mdx(\"h2\", {\n    \"id\": \"2-add-items-to-the-list\"\n  }, \"2. Add items to the list\"), mdx(\"p\", null, \"Use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/#rules-lists-create-list-items\"\n  }, \"Create list items\"), \" operation to add URL Redirect items to the list:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"curl -X POST \\\\\\n\\\"https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/rules/lists/f848b6ccb07647749411f504d6f88794/items\\\" \\\\\\n-H \\\"X-Auth-Email: <EMAIL>\\\" \\\\\\n-H \\\"X-Auth-Key: <KEY>\\\" \\\\\\n-d '[\\n  {\\n    \\\"redirect\\\": {\\n      \\\"source_url\\\": \\\"example.com/blog/\\\",\\n      \\\"target_url\\\": \\\"https://example.com/blog/latest\\\"\\n    }\\n  },\\n  {\\n    \\\"redirect\\\": {\\n      \\\"source_url\\\": \\\"example.net/\\\",\\n      \\\"target_url\\\": \\\"https://example.net/under-construction.html\\\",\\n      \\\"status_code\\\": 307\\n    }\\n  }\\n]'\\n\")), mdx(\"p\", null, \"The response will be similar to the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"result\\\": {\\n    \\\"operation_id\\\": \\\"92558f8b296d4dbe9d0419e0e53f6622\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"p\", null, \"This is an asynchronous operation. The response will contain an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"operation_id\"), \" which you will use to check if the operation completed successfully using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/#rules-lists-get-bulk-operation\"\n  }, \"Get bulk operation\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"curl \\\"https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/rules/lists/bulk_operations/92558f8b296d4dbe9d0419e0e53f6622\\\" \\\\\\n-H \\\"X-Auth-Email: <EMAIL>\\\" \\\\\\n-H \\\"X-Auth-Key: <KEY>\\\"\\n\")), mdx(\"p\", null, \"If the operation already completed successfully, the response will be similar to the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"92558f8b296d4dbe9d0419e0e53f6622\\\",\\n    \\\"status\\\": \\\"completed\\\",\\n    \\\"completed\\\": \\\"2021-10-28T09:15:42Z\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"3-create-a-bulk-redirect-rule-via-api\"\n  }, \"3. Create a Bulk Redirect Rule via API\"), mdx(\"p\", null, \"Since Bulk Redirect Lists are just containers of URL Redirects, you have to enable the URL Redirects in the list by creating a Bulk Redirect Rule.\"), mdx(\"p\", null, \"Add Bulk Redirect Rules to the ruleset entry point of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_redirect\"), \" phase at the account level. Refer to the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api\"\n  }, \"Rulesets API\"), \" documentation for more information on \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.cloudflare.com/ruleset-engine/rulesets-api/create\"\n  }, \"creating a ruleset\"), \" and supplying a list of rules for the ruleset.\"), mdx(\"p\", null, \"A Bulk Redirect Rule must have:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"action\"), \" set to \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"redirect\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"An \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"action_parameters\"), \" object with additional configuration settings \\u2014 refer to \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/bulk-redirects/reference/json-objects#bulk-redirect-rule\"\n  }, \"API JSON objects: Bulk Redirect Rule\"), \" for details.\")), mdx(\"p\", null, \"The following request of the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/#account-rulesets-create-account-ruleset\"\n  }, \"Create account ruleset\"), \" operation creates a phase entry point ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_redirect\"), \" phase at the account level, and defines a single redirect rule. Use this operation if you have not created a phase entry point ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_redirect\"), \" phase yet.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"curl -X POST \\\"https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/rulesets\\\" \\\\\\n-H \\\"X-Auth-Key: <KEY>\\\" \\\\\\n-H \\\"X-Auth-Email: <EMAIL>\\\" \\\\\\n-d '{\\n  \\\"name\\\": \\\"My redirect ruleset\\\",\\n  \\\"kind\\\": \\\"root\\\",\\n  \\\"phase\\\": \\\"http_request_redirect\\\",\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"http.request.full_uri in $my_redirect_list\\\",\\n      \\\"description\\\": \\\"Bulk Redirect rule.\\\",\\n      \\\"action\\\": \\\"redirect\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"from_list\\\": {\\n          \\\"name\\\": \\\"my_redirect_list\\\",\\n          \\\"key\\\": \\\"http.request.full_uri\\\"\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response will be similar to the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"528f4f03bf0da53a29907199625867be\\\",\\n    \\\"name\\\": \\\"My redirect ruleset\\\",\\n    \\\"kind\\\": \\\"root\\\",\\n    \\\"version\\\": \\\"1\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"8da312df846b4258a05bcd454ea943be\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"expression\\\": \\\"http.request.full_uri in $my_redirect_list\\\",\\n        \\\"description\\\": \\\"Bulk Redirect rule.\\\",\\n        \\\"action\\\": \\\"redirect\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"from_list\\\": {\\n            \\\"name\\\": \\\"my_redirect_list\\\",\\n            \\\"key\\\": \\\"http.request.full_uri\\\"\\n          }\\n        },\\n        \\\"last_updated\\\": \\\"2021-10-28T09:20:42Z\\\",\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-10-28T09:20:42Z\\\",\\n    \\\"phase\\\": \\\"http_request_transform\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")), mdx(\"p\", null, \"If there is already a phase entry point ruleset for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http_request_redirect\"), \" phase, use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://api.cloudflare.com/#account-rulesets-update-account-ruleset\"\n  }, \"Update account ruleset\"), \" operation instead, like in the following example:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"curl -X PUT \\\"https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/rulesets/<RULESET_ID>\\\" \\\\\\n-H \\\"X-Auth-Key: <KEY>\\\" \\\\\\n-H \\\"X-Auth-Email: <EMAIL>\\\" \\\\\\n-d '{\\n  \\\"name\\\": \\\"My redirect ruleset\\\",\\n  \\\"kind\\\": \\\"root\\\",\\n  \\\"phase\\\": \\\"http_request_redirect\\\",\\n  \\\"rules\\\": [\\n    {\\n      \\\"expression\\\": \\\"http.request.full_uri in $my_redirect_list_2\\\",\\n      \\\"description\\\": \\\"Bulk Redirect rule 1\\\",\\n      \\\"action\\\": \\\"redirect\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"from_list\\\": {\\n          \\\"name\\\": \\\"my_redirect_list_1\\\",\\n          \\\"key\\\": \\\"http.request.full_uri\\\"\\n        }\\n      }\\n    },\\n    {\\n      \\\"expression\\\": \\\"http.request.full_uri in $my_redirect_list_2\\\",\\n      \\\"description\\\": \\\"Bulk Redirect rule 2\\\",\\n      \\\"action\\\": \\\"redirect\\\",\\n      \\\"action_parameters\\\": {\\n        \\\"from_list\\\": {\\n          \\\"name\\\": \\\"my_redirect_list_2\\\",\\n          \\\"key\\\": \\\"http.request.full_uri\\\"\\n        }\\n      }\\n    }\\n  ]\\n}'\\n\")), mdx(\"p\", null, \"The response will be similar to the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n  \\\"result\\\": {\\n    \\\"id\\\": \\\"67013aa153df4e5fbda92f92bc979331\\\",\\n    \\\"name\\\": \\\"default\\\",\\n    \\\"description\\\": \\\"\\\",\\n    \\\"kind\\\": \\\"root\\\",\\n    \\\"version\\\": \\\"2\\\",\\n    \\\"rules\\\": [\\n      {\\n        \\\"id\\\": \\\"8be62ab2ef9a4a41af30c24ff8e73e41\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"redirect\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"from_list\\\": {\\n            \\\"name\\\": \\\"my_redirect_list_1\\\",\\n            \\\"key\\\": \\\"http.request.full_uri\\\"\\n          }\\n        },\\n        \\\"expression\\\": \\\"http.request.full_uri in $my_redirect_list_1\\\",\\n        \\\"description\\\": \\\"Bulk Redirect rule 1\\\",\\n        \\\"last_updated\\\": \\\"2021-12-03T15:38:51.658387Z\\\",\\n        \\\"ref\\\": \\\"8be62ab2ef9a4a41af30c24ff8e73e41\\\",\\n        \\\"enabled\\\": true\\n      },\\n      {\\n        \\\"id\\\": \\\"97e38797fb2b4b22a4919800f1318a5c\\\",\\n        \\\"version\\\": \\\"1\\\",\\n        \\\"action\\\": \\\"redirect\\\",\\n        \\\"action_parameters\\\": {\\n          \\\"from_list\\\": {\\n            \\\"name\\\": \\\"my_redirect_list_2\\\",\\n            \\\"key\\\": \\\"http.request.full_uri\\\"\\n          }\\n        },\\n        \\\"expression\\\": \\\"http.request.full_uri in $my_redirect_list_2\\\",\\n        \\\"description\\\": \\\"Bulk Redirect rule 2\\\",\\n        \\\"last_updated\\\": \\\"2021-12-03T15:38:51.658387Z\\\",\\n        \\\"ref\\\": \\\"97e38797fb2b4b22a4919800f1318a5c\\\",\\n        \\\"enabled\\\": true\\n      }\\n    ],\\n    \\\"last_updated\\\": \\\"2021-12-03T15:38:51.658387Z\\\",\\n    \\\"phase\\\": \\\"http_request_redirect\\\"\\n  },\\n  \\\"success\\\": true,\\n  \\\"errors\\\": [],\\n  \\\"messages\\\": []\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"","type":null,"updated":null}}},"pageContext":{"id":"27b4691f-5afb-552b-81c4-b4d1b54ba75e","fields":{"slug":"/bulk-redirects/create-api"},"frontmatter":{"pcx_content_type":"how-to","title":"","type":null,"order":6,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Create Bulk Redirects via API","depth":1}],"tableOfContents":{"items":[{"url":"#create-bulk-redirects-via-api","title":"Create Bulk Redirects via API","items":[{"url":"#1-create-a-bulk-redirect-list-via-api","title":"1. Create a Bulk Redirect List via API"},{"url":"#2-add-items-to-the-list","title":"2. Add items to the list"},{"url":"#3-create-a-bulk-redirect-rule-via-api","title":"3. Create a Bulk Redirect Rule via API"}]}]},"parent":{"modifiedTime":"2022-01-26","relativePath":"bulk-redirects/create-api.md"}}}