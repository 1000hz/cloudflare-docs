{"data":{"mdx":{"id":"dcbd4e25-2a16-5da7-ae6f-5966c947efd7","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"faq\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Aside = makeShortcode(\"Aside\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"web-analytics-faq\"\n  }, \"Web Analytics FAQ\"), mdx(\"h2\", {\n    \"id\": \"errors\"\n  }, \"Errors\"), mdx(\"h3\", {\n    \"id\": \"when-i-add-the-beacon-to-my-website-and-load-the-webpage-i-see-an-error-that-includes-is-not-allowed-by-access-control-allow-origin-cors-whats-happening\"\n  }, \"When I add the beacon to my website and load the webpage, I see an error that includes \\\"is not allowed by Access-Control-Allow-Origin\\\" (CORS). What's happening?\"), mdx(\"p\", null, \"This error usually occurs when the hostname of the site loading the analytics does not match the name of the analytics site configured in the dashboard. Double-check that they are identical. \"), mdx(\"p\", null, \"Cloudflare matches hostnames based on a postfix. For example, if you set up analytics for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"example.com\"), \", we'll allow analytics from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"www.example.com\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"blog.staging.example.com\"), \", and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fooexample.com\"), \". However, we won't allow analytics from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"example.com.br\"), \".\"), mdx(\"p\", null, \"You may also see this error if the site does not send a \\\"Referer\\\" or \\\"Origin\\\" header. The \\\"Referer\\\" header is required (don't try to use the \\\"Referrer-policy\\\" header instead). We have a change in-flight now that only the \\\"Origin\\\" header will be required \\u2013 we believe there is no way to disable that in the browser.\"), mdx(\"h3\", {\n    \"id\": \"the-analytics-beacon-is-blocked-by-ad-blockers-including-adblockplus-brave-duckduckgo-extension-etc-why-is-that\"\n  }, \"The analytics beacon is blocked by ad-blockers (including adblockplus, Brave, DuckDuckGo extension, etc). Why is that?\"), mdx(\"p\", null, \"Cloudflare is aware that the analytics beacon is blocked by these services.\"), mdx(\"p\", null, \"While Cloudflare Web Analytics uses a JS beacon, Cloudflare\\u2019s edge analytics can't be blocked because we can measure every request that's received. Edge analytics are available to any customer who \\\"orange clouds\\\" and proxies traffic through Cloudflare. Currently, users on Pro, Business, and Enterprise plans get advanced web analytics powered by our edge logs.\"), mdx(\"h3\", {\n    \"id\": \"why-am-i-not-seeing-all-the-metrics-for-spa-or-even-mpa\"\n  }, \"Why am I not seeing all the metrics for SPA (or even MPA)?\"), mdx(\"p\", null, \"Every route change that occurs in the single-page app will send the measurement of the route before the route is changed to the beacon endpoint. The measurement for the last route change will be sent whenever the user leaves the tab or closes the browser window. That will trigger visibilityState to a hidden state. Whenever that happens, Beacon JS sends the payload using the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon\"\n  }, \"Navigator.sendBeacon method\"), \" that should not be cancelled even when the browser window is closed. However, due to compatibility, old browsers would fallback to using Ajax (XmlHttpRequest), which can be cancelled when the browser window is closed, so the last payload that gets sent to the beacon endpoint can be lost. Also, due to various network conditions, there can be data loss when the payload is sent to the beacon endpoint. \"), mdx(\"h3\", {\n    \"id\": \"for-the-same-site-why-would-i-see-more-data-reported-with-an-automatic-setup\"\n  }, \"For the same site, why would I see more data reported with an automatic setup?\"), mdx(\"p\", null, \"Unless you are using Rules to control which pages to be measured, using \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web-analytics/getting-started#sites-proxied-through-cloudflare\"\n  }, \"automatic setup\"), \" will inject the JS snippet on all pages (sub-domains) under the zone. \"), mdx(\"p\", null, \"If you used a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web-analytics/getting-started#sites-not-proxied-through-cloudflare\"\n  }, \"manual setup\"), \" instead, only those pages that render the JS snippet will be reported.\"), mdx(Aside, {\n    type: \"note\",\n    mdxType: \"Aside\"\n  }, mdx(\"p\", null, \"Since only one JS snippet can be rendered and used per page, you cannot have multiple snippets on the same page.\")), mdx(\"hr\", null), mdx(\"h2\", {\n    \"id\": \"setup\"\n  }, \"Setup\"), mdx(\"h3\", {\n    \"id\": \"if-im-proxying-my-site-through-cloudflare-already-should-i-manually-add-the-js-beacon\"\n  }, \"If I'm proxying my site through Cloudflare already, should I manually add the JS beacon?\"), mdx(\"p\", null, \"You can, but you don't have to. Cloudflare Web Analytics is designed primarily for customers who do not use Cloudflare's proxy to measure their web traffic.\"), mdx(\"p\", null, \"Existing Cloudflare customers can access analytics collected from our edge on the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Analytics\"), \" tab of the dashboard. You can also enable Browser Insights to measure performance using JavaScript.\"), mdx(\"p\", null, \"Using an orange-clouded domain with \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web-analytics/getting-started#sites-proxied-through-cloudflare\"\n  }, \"automatic setup\"), \" will report stats back to your own domain's \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/cdn-cgi/rum\"), \" endpoint. If you have installed JS snippet yourself (a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web-analytics/getting-started#sites-not-proxied-through-cloudflare\"\n  }, \"manual setup\"), \"), it will report back to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cloudflareinsights.com/cdn-cgi/rum\"), \" endpoint. \"), mdx(\"h3\", {\n    \"id\": \"can-i-add-web-analytics-to-my-site-using-a-tag-manager-like-google-tag-manager-gtm\"\n  }, \"Can I add Web Analytics to my site using a tag manager like Google Tag Manager (GTM)?\"), mdx(\"p\", null, \"Yes. Instead of embedding the script using a tag manager as shown here:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{\\\"token\\\": \\\"$SITE_TOKEN\\\"}'></script>\\n\")), mdx(\"p\", null, \"Add the following script:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"<script defer src='https://static.cloudflareinsights.com/beacon.min.js?token=$SITE_TOKEN'></script>\\n\")), mdx(\"h3\", {\n    \"id\": \"can-i-use-the-same-js-snippet-for-a-different-domain\"\n  }, \"Can I use the same JS Snippet for a different domain?\"), mdx(\"p\", null, \"No. However, if the root domain is the same, you can use the same site tag. For example, if you have provided us a hostname \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"example.com\"), \" when registering a site, you can use the JS snippet from that site for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"abc.example.com\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"def.example.com\"), \" since they use the same root domain. When payload gets sent to the beacon endpoint, we validate the hostname with postfix matching, so if your domain shares the same root domain, that would work. \"), mdx(\"h3\", {\n    \"id\": \"can-i-use-automatic-setup-with-a-dns-only-domain-cname-setup\"\n  }, \"Can I use automatic setup with a DNS-only domain (CNAME setup)?\"), mdx(\"p\", null, \"No, you can only use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web-analytics/getting-started#sites-proxied-through-cloudflare\"\n  }, \"automatic setup\"), \" with JS snippet injection if traffic to your domain is proxied through Cloudflare (orange-clouded).\"), mdx(\"p\", null, \"If you have a DNS-only domain, you will have to do a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web-analytics/getting-started#sites-not-proxied-through-cloudflare\"\n  }, \"manual setup\"), \" instead.\"), mdx(\"hr\", null), mdx(\"h2\", {\n    \"id\": \"functionality\"\n  }, \"Functionality\"), mdx(\"h3\", {\n    \"id\": \"can-i-see-server-side-analytics-by-url\"\n  }, \"Can I see server-side analytics by URL?\"), mdx(\"p\", null, \"Web Analytics only displays client-side analytics. All Cloudflare customers who proxy their traffic also get analytics based on traffic at their edge.\"), mdx(\"p\", null, \"Currently users on Pro, Business, and Enterprise plans get advanced HTTP traffic analytics, which is the only way to see features like a breakdown of traffic by URL based on server-side analytics. \"), mdx(\"h3\", {\n    \"id\": \"can-i-use-web-analytics-with-amp\"\n  }, \"Can I use Web Analytics with AMP?\"), mdx(\"p\", null, \"Not yet, but we plan to support AMP soon. \"), mdx(\"h3\", {\n    \"id\": \"what-is-the-data-retention-policy-for-web-analytics\"\n  }, \"What is the data retention policy for Web Analytics?\"), mdx(\"p\", null, \"One month, but we are planning to increase the retention in the near future.\"), mdx(\"h3\", {\n    \"id\": \"does-cloudflare-web-analytics-support-utm-parameters\"\n  }, \"Does Cloudflare Web Analytics support UTM parameters?\"), mdx(\"p\", null, \"Not yet. UTM parameters are special query string parameters that can help track where traffic is coming from.\\nCurrently Cloudflare Web Analytics don't log query strings to avoid collecting potentially sensitive data, but we may add support for this in the future.\"), mdx(\"h3\", {\n    \"id\": \"does-web-analytics-support-custom-events\"\n  }, \"Does Web Analytics support custom events?\"), mdx(\"p\", null, \"Not yet, but we may add support for this in the future.\"), mdx(\"h3\", {\n    \"id\": \"can-i-track-more-than-one-website-with-web-analytics\"\n  }, \"Can I track more than one website with Web Analytics?\"), mdx(\"p\", null, \"Yes. Right now there's a soft limit of 10 sites per account, but that can be adjusted by contacting Cloudflare support.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"","type":null,"updated":null}}},"pageContext":{"id":"dcbd4e25-2a16-5da7-ae6f-5966c947efd7","fields":{"slug":"/faq/web-analytics"},"frontmatter":{"title":"","type":null,"order":null,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"Web Analytics FAQ","depth":1}],"tableOfContents":{"items":[{"url":"#web-analytics-faq","title":"Web Analytics FAQ","items":[{"url":"#errors","title":"Errors","items":[{"url":"#when-i-add-the-beacon-to-my-website-and-load-the-webpage-i-see-an-error-that-includes-is-not-allowed-by-access-control-allow-origin-cors-whats-happening","title":"When I add the beacon to my website and load the webpage, I see an error that includes \"is not allowed by Access-Control-Allow-Origin\" (CORS). What's happening?"},{"url":"#the-analytics-beacon-is-blocked-by-ad-blockers-including-adblockplus-brave-duckduckgo-extension-etc-why-is-that","title":"The analytics beacon is blocked by ad-blockers (including adblockplus, Brave, DuckDuckGo extension, etc). Why is that?"},{"url":"#why-am-i-not-seeing-all-the-metrics-for-spa-or-even-mpa","title":"Why am I not seeing all the metrics for SPA (or even MPA)?"},{"url":"#for-the-same-site-why-would-i-see-more-data-reported-with-an-automatic-setup","title":"For the same site, why would I see more data reported with an automatic setup?"}]},{"url":"#setup","title":"Setup","items":[{"url":"#if-im-proxying-my-site-through-cloudflare-already-should-i-manually-add-the-js-beacon","title":"If I'm proxying my site through Cloudflare already, should I manually add the JS beacon?"},{"url":"#can-i-add-web-analytics-to-my-site-using-a-tag-manager-like-google-tag-manager-gtm","title":"Can I add Web Analytics to my site using a tag manager like Google Tag Manager (GTM)?"},{"url":"#can-i-use-the-same-js-snippet-for-a-different-domain","title":"Can I use the same JS Snippet for a different domain?"},{"url":"#can-i-use-automatic-setup-with-a-dns-only-domain-cname-setup","title":"Can I use automatic setup with a DNS-only domain (CNAME setup)?"}]},{"url":"#functionality","title":"Functionality","items":[{"url":"#can-i-see-server-side-analytics-by-url","title":"Can I see server-side analytics by URL?"},{"url":"#can-i-use-web-analytics-with-amp","title":"Can I use Web Analytics with AMP?"},{"url":"#what-is-the-data-retention-policy-for-web-analytics","title":"What is the data retention policy for Web Analytics?"},{"url":"#does-cloudflare-web-analytics-support-utm-parameters","title":"Does Cloudflare Web Analytics support UTM parameters?"},{"url":"#does-web-analytics-support-custom-events","title":"Does Web Analytics support custom events?"},{"url":"#can-i-track-more-than-one-website-with-web-analytics","title":"Can I track more than one website with Web Analytics?"}]}]}]},"parent":{"modifiedTime":"2021-10-26","relativePath":"faq/web-analytics/index.md"}}}