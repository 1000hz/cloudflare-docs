{"data":{"mdx":{"id":"16a98903-f621-55ae-b771-dd757b3db7a6","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"About NAv2\",\n  \"pcx-content-type\": \"concept\",\n  \"order\": 2\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"about-network-analytics-v2\"\n  }, \"About Network Analytics v2\"), mdx(\"h2\", {\n    \"id\": \"adaptive-bitrate-sampling\"\n  }, \"Adaptive Bitrate Sampling\"), mdx(\"p\", null, \"In Network Analytics v1 (NAv1), the data is rolled up into one minute roll-up tables, then one hour roll-ups, and finally one day roll-ups. Users can then query either the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipFlows1mGroups\"), \" node for high-resolution data on traffic and attacks in the past 30 days, or query the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipFlows1hGroups\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipFlows1dGroups\"), \" nodes for historical data. However, the data available through these nodes is aggregate data, and that means that the accuracy and cardinality of the results are limited. For example, short traffic spikes will not be visible in the data obtained from these nodes due to the aggregation of samples in the roll-ups.\"), mdx(\"p\", null, \"On the other hand, Network Analytics v2 (NAv2) uses \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Adaptive Bitrate (ABR)\"), \" sampling. This means that users do not need to choose a node based on their query timeframe. Furthermore, the cardinality and accuracy is preserved even for historical data. Depending on the size of the query, the ABR mechanism will choose the best sampling rate and fetch a response from one of the sample tables encapsulated behind each node.\"), mdx(\"h2\", {\n    \"id\": \"edge-sample-enrichment\"\n  }, \"Edge Sample Enrichment\"), mdx(\"p\", null, \"Network Analytics v2 provides more accurate data due to the better sampling rate and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Edge Sample Enrichment\"), \". NAv1 samples 1/8,192 packets (that is, one in every 8,192 packets), while NAv2 sampling rates vary depending on the mitigation service. For example, the sampling rate for Magic Firewall events is 1/100 packets, for dosd is 1/10,000 packets, and for flowtrackd it changes dynamically from 1/100 to 1/10,000 packets based on the volume of packets.\"), mdx(\"p\", null, \"The NAv2 data pipeline is also more resilient compared to NAv1. NAv1 uses Core Sample Enrichment, where raw packet samples are sent from all of Cloudflare's edge data centers to the Core data centers. In the Core data centers, the packet samples are cross-referenced with additional databases and infused with the associated customer account ID, attack ID, attack type, and other metadata. Then, the packet samples are inserted into storage. One of the main shortcomings of this method is the potential congestion of samples when cross-referencing information, which could, in rare cases, cause temporary data lag.\"), mdx(\"p\", null, \"To eliminate this potential data lag, NAv2 uses a new data logging pipeline which relies on Edge Sample Enrichment. By delegating the packet sample enrichment and cross-referencing to the edge data centers, we improve the data pipeline's resilience and tolerance against congestion. Using this method, enriched packet samples are immediately stored in Cloudflare's core data centers as soon as they arrive.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"demo":null,"difficulty":null,"summary":null,"tags":null,"title":"About NAv2","type":null,"updated":null}}},"pageContext":{"id":"16a98903-f621-55ae-b771-dd757b3db7a6","fields":{"slug":"/graphql-api/migration-guides/network-analytics-v2/about"},"frontmatter":{"title":"About NAv2","type":null,"order":2,"hidden":null,"hideChildren":null,"breadcrumbs":null},"headings":[{"value":"About Network Analytics v2","depth":1}],"tableOfContents":{"items":[{"url":"#about-network-analytics-v2","title":"About Network Analytics v2","items":[{"url":"#adaptive-bitrate-sampling","title":"Adaptive Bitrate Sampling"},{"url":"#edge-sample-enrichment","title":"Edge Sample Enrichment"}]}]},"parent":{"modifiedTime":"2021-10-26","relativePath":"graphql-api/migration-guides/network-analytics-v2/about.md"}}}